<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">cap_machine.rules.rules_base</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">machine_utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="machine_utils.solve_finz.html#"><span class="id" title="library">solve_finz</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">proofmode</span> <span class="id" title="library">classes</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">invariants</span> <span class="id" title="library">gen_heap</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">weakestpre</span> <span class="id" title="library">ectx_lifting</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">frac</span> <span class="id" title="library">auth</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra.lib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">excl_auth</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.logical_mapsto.html#"><span class="id" title="library">logical_mapsto</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.cap_lang.html#"><span class="id" title="library">cap_lang</span></a> <a class="idref" href="cap_machine.iris_extra.html#"><span class="id" title="library">iris_extra</span></a> <a class="idref" href="cap_machine.stdpp_extra.html#"><span class="id" title="library">stdpp_extra</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;---------------------------&nbsp;LTAC&nbsp;DEFINITIONS&nbsp;-----------------------------------&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Ltac&nbsp;destruct_cons_hook&nbsp;::=&nbsp;destruct_cons_hook2.&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv_head_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">progress</span> <span class="id" title="var">simplify_map_eq</span>/= <span class="comment">(*&nbsp;simplify&nbsp;memory&nbsp;stuff&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#of_to_val"><span class="id" title="axiom">of_to_val</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.cap_lang.html#of_val"><span class="id" title="definition">of_val</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_var</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">first</span>[<span class="id" title="tactic">discriminate</span> <span class="id" title="var">H</span>|<span class="id" title="tactic">injection</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">cap_lang.prim_step</span></a> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">is_var</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">fail</span> 1); <span class="comment">(*&nbsp;inversion&nbsp;yields&nbsp;many&nbsp;goals&nbsp;if&nbsp;<span class="inlinecode"><span class="id" title="var">e</span></span>&nbsp;is&nbsp;a&nbsp;variable&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;can&nbsp;thus&nbsp;better&nbsp;be&nbsp;avoided.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> φ := <span class="id" title="tactic">fresh</span> "φ" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [| φ]; <span class="id" title="tactic">subst</span> φ; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_rules" class="idref" href="#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="ceriseg:2" class="idref" href="#ceriseg:2"><span class="id" title="binder">ceriseg</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#ceriseG"><span class="id" title="class">ceriseG</span></a> <a id="0101b9beac487b383a5ba2a8f6922788" class="idref" href="#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="binder">Σ</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{ <a id="reservedaddresses:3" class="idref" href="#reservedaddresses:3"><span class="id" title="binder">reservedaddresses</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#ReservedAddresses"><span class="id" title="class">ReservedAddresses</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="MP:4" class="idref" href="#MP:4"><span class="id" title="binder">MP</span></a>: <a class="idref" href="cap_machine.machine_parameters.html#MachineParameters"><span class="id" title="class">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">c</span> : <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">la</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lw</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lregs</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">mem</span> : <a class="idref" href="cap_machine.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lmem</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Conditionally&nbsp;unify&nbsp;on&nbsp;the&nbsp;read&nbsp;register&nbsp;value&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="read_reg_inr" class="idref" href="#read_reg_inr"><span class="id" title="definition">read_reg_inr</span></a> (<a id="lregs:5" class="idref" href="#lregs:5"><span class="id" title="binder">lregs</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="r:6" class="idref" href="#r:6"><span class="id" title="binder">r</span></a> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) <a id="p:7" class="idref" href="#p:7"><span class="id" title="binder">p</span></a> <a id="b:8" class="idref" href="#b:8"><span class="id" title="binder">b</span></a> <a id="e:9" class="idref" href="#e:9"><span class="id" title="binder">e</span></a> <a id="a:10" class="idref" href="#a:10"><span class="id" title="binder">a</span></a> <a id="v:11" class="idref" href="#v:11"><span class="id" title="binder">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:5"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:6"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">b'</span> <span class="id" title="var">e'</span> <span class="id" title="var">a'</span> <span class="id" title="var">v'</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">b'</span> <span class="id" title="var">e'</span> <span class="id" title="var">a'</span> <span class="id" title="var">v'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:7"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:8"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:9"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:10"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:11"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="notation">False</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;registers&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_dupl_false" class="idref" href="#regname_dupl_false"><span class="id" title="lemma">regname_dupl_false</span></a> <a id="r:12" class="idref" href="#r:12"><span class="id" title="binder">r</span></a> <a id="lw1:13" class="idref" href="#lw1:13"><span class="id" title="binder">lw1</span></a> <a id="lw2:14" class="idref" href="#lw2:14"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:12"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:13"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:12"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:14"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">mapsto_valid_2</span> <span class="id" title="notation">with</span> "Hr1 Hr2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">dfrac_full_exclusive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_neq" class="idref" href="#regname_neq"><span class="id" title="lemma">regname_neq</span></a> <a id="r1:15" class="idref" href="#r1:15"><span class="id" title="binder">r1</span></a> <a id="r2:16" class="idref" href="#r2:16"><span class="id" title="binder">r2</span></a> <a id="lw1:17" class="idref" href="#lw1:17"><span class="id" title="binder">lw1</span></a> <a id="lw2:18" class="idref" href="#lw2:18"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:15"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:17"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:16"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:18"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:15"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:16"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2" (?). <span class="id" title="tactic">subst</span> <span class="id" title="var">r1</span>. <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_dupl_false"><span class="id" title="axiom">regname_dupl_false</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_1" class="idref" href="#map_of_regs_1"><span class="id" title="lemma">map_of_regs_1</span></a> (<a id="r1:19" class="idref" href="#r1:19"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:20" class="idref" href="#lw1:20"><span class="id" title="binder">lw1</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:19"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:20"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:21" class="idref" href="#k:21"><span class="id" title="binder"><span id="k:22" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:23" class="idref" href="#y:23"><span class="id" title="binder"><span id="y:24" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:19"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:20"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:21"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:23"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_1" class="idref" href="#regs_of_map_1"><span class="id" title="lemma">regs_of_map_1</span></a> (<a id="r1:25" class="idref" href="#r1:25"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:26" class="idref" href="#lw1:26"><span class="id" title="binder">lw1</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:27" class="idref" href="#k:27"><span class="id" title="binder"><span id="k:28" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:29" class="idref" href="#y:29"><span class="id" title="binder"><span id="y:30" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:25"><span class="id" title="variable">r1</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:26"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]}</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:27"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:29"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:25"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:26"><span class="id" title="variable">lw1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_singleton</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_2" class="idref" href="#map_of_regs_2"><span class="id" title="lemma">map_of_regs_2</span></a> (<a id="r1:31" class="idref" href="#r1:31"><span class="id" title="binder">r1</span></a> <a id="r2:32" class="idref" href="#r2:32"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:33" class="idref" href="#lw1:33"><span class="id" title="binder">lw1</span></a> <a id="lw2:34" class="idref" href="#lw2:34"><span class="id" title="binder">lw2</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:31"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:33"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:32"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:34"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:35" class="idref" href="#k:35"><span class="id" title="binder"><span id="k:36" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:37" class="idref" href="#y:37"><span class="id" title="binder"><span id="y:38" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:31"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:33"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:35"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:37"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:31"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:32"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2". <span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_2" class="idref" href="#regs_of_map_2"><span class="id" title="lemma">regs_of_map_2</span></a> (<a id="r1:39" class="idref" href="#r1:39"><span class="id" title="binder">r1</span></a> <a id="r2:40" class="idref" href="#r2:40"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:41" class="idref" href="#lw1:41"><span class="id" title="binder">lw1</span></a> <a id="lw2:42" class="idref" href="#lw2:42"><span class="id" title="binder">lw2</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:39"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:40"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:43" class="idref" href="#k:43"><span class="id" title="binder"><span id="k:44" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:45" class="idref" href="#y:45"><span class="id" title="binder"><span id="y:46" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:39"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:41"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:43"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:45"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:39"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:41"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:40"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:42"><span class="id" title="variable">lw2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_3" class="idref" href="#map_of_regs_3"><span class="id" title="lemma">map_of_regs_3</span></a> (<a id="r1:47" class="idref" href="#r1:47"><span class="id" title="binder">r1</span></a> <a id="r2:48" class="idref" href="#r2:48"><span class="id" title="binder">r2</span></a> <a id="r3:49" class="idref" href="#r3:49"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:50" class="idref" href="#w1:50"><span class="id" title="binder">w1</span></a> <a id="w2:51" class="idref" href="#w2:51"><span class="id" title="binder">w2</span></a> <a id="w3:52" class="idref" href="#w3:52"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:50"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:48"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:51"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:49"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:52"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:53" class="idref" href="#k:53"><span class="id" title="binder"><span id="k:54" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:55" class="idref" href="#y:55"><span class="id" title="binder"><span id="y:56" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:50"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:53"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:55"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:48"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:49"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:48"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:49"><span class="id" title="variable">r3</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_3" class="idref" href="#regs_of_map_3"><span class="id" title="lemma">regs_of_map_3</span></a> (<a id="r1:57" class="idref" href="#r1:57"><span class="id" title="binder">r1</span></a> <a id="r2:58" class="idref" href="#r2:58"><span class="id" title="binder">r2</span></a> <a id="r3:59" class="idref" href="#r3:59"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:60" class="idref" href="#w1:60"><span class="id" title="binder">w1</span></a> <a id="w2:61" class="idref" href="#w2:61"><span class="id" title="binder">w2</span></a> <a id="w3:62" class="idref" href="#w3:62"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:58"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:59"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:58"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:59"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:63" class="idref" href="#k:63"><span class="id" title="binder"><span id="k:64" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:65" class="idref" href="#y:65"><span class="id" title="binder"><span id="y:66" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:60"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:63"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:65"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:60"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:58"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:61"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:59"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:62"><span class="id" title="variable">w3</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? ? ?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_4" class="idref" href="#map_of_regs_4"><span class="id" title="lemma">map_of_regs_4</span></a> (<a id="r1:67" class="idref" href="#r1:67"><span class="id" title="binder">r1</span></a> <a id="r2:68" class="idref" href="#r2:68"><span class="id" title="binder">r2</span></a> <a id="r3:69" class="idref" href="#r3:69"><span class="id" title="binder">r3</span></a> <a id="r4:70" class="idref" href="#r4:70"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:71" class="idref" href="#w1:71"><span class="id" title="binder">w1</span></a> <a id="w2:72" class="idref" href="#w2:72"><span class="id" title="binder">w2</span></a> <a id="w3:73" class="idref" href="#w3:73"><span class="id" title="binder">w3</span></a> <a id="w4:74" class="idref" href="#w4:74"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:71"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:72"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:73"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w4:74"><span class="id" title="variable">w4</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:75" class="idref" href="#k:75"><span class="id" title="binder"><span id="k:76" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:77" class="idref" href="#y:77"><span class="id" title="binder"><span id="y:78" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:71"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:75"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:77"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3 H4".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H3 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_4" class="idref" href="#regs_of_map_4"><span class="id" title="lemma">regs_of_map_4</span></a> (<a id="r1:79" class="idref" href="#r1:79"><span class="id" title="binder">r1</span></a> <a id="r2:80" class="idref" href="#r2:80"><span class="id" title="binder">r2</span></a> <a id="r3:81" class="idref" href="#r3:81"><span class="id" title="binder">r3</span></a> <a id="r4:82" class="idref" href="#r4:82"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:83" class="idref" href="#w1:83"><span class="id" title="binder">w1</span></a> <a id="w2:84" class="idref" href="#w2:84"><span class="id" title="binder">w2</span></a> <a id="w3:85" class="idref" href="#w3:85"><span class="id" title="binder">w3</span></a> <a id="w4:86" class="idref" href="#w4:86"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:87" class="idref" href="#k:87"><span class="id" title="binder"><span id="k:88" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:89" class="idref" href="#y:89"><span class="id" title="binder"><span id="y:90" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:83"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:87"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:89"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:83"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:84"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:85"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w4:86"><span class="id" title="variable">w4</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;memory&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="addr_dupl_false" class="idref" href="#addr_dupl_false"><span class="id" title="lemma">addr_dupl_false</span></a> <a id="la:91" class="idref" href="#la:91"><span class="id" title="binder">la</span></a> <a id="lw1:92" class="idref" href="#lw1:92"><span class="id" title="binder">lw1</span></a> <a id="lw2:93" class="idref" href="#lw2:93"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la:91"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:92"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:91"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:93"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ha1 Ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">mapsto_valid_2</span> <span class="id" title="notation">with</span> "Ha1 Ha2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">dfrac_full_exclusive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;semantic&nbsp;heap&nbsp;+&nbsp;a&nbsp;map&nbsp;of&nbsp;pointsto&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM_general" class="idref" href="#gen_heap_valid_inSepM_general"><span class="id" title="lemma">gen_heap_valid_inSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:94" class="idref" href="#L:94"><span class="id" title="binder">L</span></a> <a id="V:95" class="idref" href="#V:95"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:96" class="idref" href="#EqDecision0:96"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a>) (<a id="H:97" class="idref" href="#H:97"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="d28bbe011225204c88b57a270b5a3987" class="idref" href="#d28bbe011225204c88b57a270b5a3987"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:99" class="idref" href="#gen_heapG0:99"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d28bbe011225204c88b57a270b5a3987"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="616bc304c6b7e4c8af72eed31cf6fe79" class="idref" href="#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="binder">d</span></a><a id="616bc304c6b7e4c8af72eed31cf6fe79" class="idref" href="#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a>)) (<a id="0068bba064954ff1d2256a45ce198696" class="idref" href="#0068bba064954ff1d2256a45ce198696"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:102" class="idref" href="#l:102"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a>) (<a id="dq:103" class="idref" href="#dq:103"><span class="id" title="binder">dq</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="v:104" class="idref" href="#v:104"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:102"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:103"><span class="id" title="variable">dq</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:104"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#0068bba064954ff1d2256a45ce198696"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:105" class="idref" href="#k:105"><span class="id" title="binder"><span id="k:106" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:107" class="idref" href="#dqw:107"><span class="id" title="binder"><span id="dqw:108" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:105"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:107"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:107"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#0068bba064954ff1d2256a45ce198696"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:102"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:104"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>σ <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM" class="idref" href="#gen_heap_valid_inSepM"><span class="id" title="lemma">gen_heap_valid_inSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:109" class="idref" href="#L:109"><span class="id" title="binder">L</span></a> <a id="V:110" class="idref" href="#V:110"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:111" class="idref" href="#EqDecision0:111"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a>) (<a id="H:112" class="idref" href="#H:112"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="67028e5db0d7f321f964117e73116fa2" class="idref" href="#67028e5db0d7f321f964117e73116fa2"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:114" class="idref" href="#gen_heapG0:114"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:110"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#67028e5db0d7f321f964117e73116fa2"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="30194486bb6c4e804d25f7da04abfdab" class="idref" href="#30194486bb6c4e804d25f7da04abfdab"><span class="id" title="binder">σ</span></a> <a id="387984c2561d9e0751d72243983585d8" class="idref" href="#387984c2561d9e0751d72243983585d8"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:110"><span class="id" title="variable">V</span></a>) (<a id="l:117" class="idref" href="#l:117"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a>) (<a id="q:118" class="idref" href="#q:118"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span>) (<a id="v:119" class="idref" href="#v:119"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:110"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#387984c2561d9e0751d72243983585d8"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:117"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:119"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#30194486bb6c4e804d25f7da04abfdab"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:120" class="idref" href="#k:120"><span class="id" title="binder"><span id="k:121" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:122" class="idref" href="#y:122"><span class="id" title="binder"><span id="y:123" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#387984c2561d9e0751d72243983585d8"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:120"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:118"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:122"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#30194486bb6c4e804d25f7da04abfdab"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:117"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:119"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM'" class="idref" href="#gen_heap_valid_inSepM'"><span class="id" title="lemma">gen_heap_valid_inSepM'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:124" class="idref" href="#L:124"><span class="id" title="binder">L</span></a> <a id="V:125" class="idref" href="#V:125"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:126" class="idref" href="#EqDecision0:126"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a>) (<a id="H:127" class="idref" href="#H:127"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="4cf90600e8413682f73ea298d1219fe2" class="idref" href="#4cf90600e8413682f73ea298d1219fe2"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:129" class="idref" href="#gen_heapG0:129"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:125"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4cf90600e8413682f73ea298d1219fe2"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="edfcf2c1d0f2984bf130d5d32af280c0" class="idref" href="#edfcf2c1d0f2984bf130d5d32af280c0"><span class="id" title="binder">σ</span></a> <a id="373bdbf96b46bf3aa373e85ba19b5d69" class="idref" href="#373bdbf96b46bf3aa373e85ba19b5d69"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:125"><span class="id" title="variable">V</span></a>) (<a id="q:132" class="idref" href="#q:132"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#edfcf2c1d0f2984bf130d5d32af280c0"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:133" class="idref" href="#k:133"><span class="id" title="binder"><span id="k:134" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:135" class="idref" href="#y:135"><span class="id" title="binder"><span id="y:136" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#373bdbf96b46bf3aa373e85ba19b5d69"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:133"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:132"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:135"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:137" class="idref" href="#l:137"><span class="id" title="binder">l</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a>) (<a id="v:138" class="idref" href="#v:138"><span class="id" title="binder">v</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#V:125"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#373bdbf96b46bf3aa373e85ba19b5d69"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:137"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:138"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#edfcf2c1d0f2984bf130d5d32af280c0"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:137"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:138"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM'_general" class="idref" href="#gen_heap_valid_inSepM'_general"><span class="id" title="lemma">gen_heap_valid_inSepM'_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:139" class="idref" href="#L:139"><span class="id" title="binder">L</span></a> <a id="V:140" class="idref" href="#V:140"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:141" class="idref" href="#EqDecision0:141"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a>) (<a id="H:142" class="idref" href="#H:142"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="92fc1184c72183659a7f8012cd13be07" class="idref" href="#92fc1184c72183659a7f8012cd13be07"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:144" class="idref" href="#gen_heapG0:144"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#92fc1184c72183659a7f8012cd13be07"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="570cad8308dcbf910a2525b22eba0976" class="idref" href="#570cad8308dcbf910a2525b22eba0976"><span class="id" title="binder">d</span></a><a id="570cad8308dcbf910a2525b22eba0976" class="idref" href="#570cad8308dcbf910a2525b22eba0976"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a>)) (<a id="1cd9065e8a4e883005d819069f13ddb7" class="idref" href="#1cd9065e8a4e883005d819069f13ddb7"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#1cd9065e8a4e883005d819069f13ddb7"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:147" class="idref" href="#k:147"><span class="id" title="binder"><span id="k:148" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:149" class="idref" href="#dqw:149"><span class="id" title="binder"><span id="dqw:150" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:147"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:149"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:149"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:151" class="idref" href="#l:151"><span class="id" title="binder">l</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a>) (<a id="d:152" class="idref" href="#d:152"><span class="id" title="binder">d</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="v:153" class="idref" href="#v:153"><span class="id" title="binder">v</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:151"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#d:152"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:153"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1cd9065e8a4e883005d819069f13ddb7"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:151"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:153"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">d</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>σ <span class="id" title="var">l</span>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]". <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inclSepM_general" class="idref" href="#gen_heap_valid_inclSepM_general"><span class="id" title="lemma">gen_heap_valid_inclSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:154" class="idref" href="#L:154"><span class="id" title="binder">L</span></a> <a id="V:155" class="idref" href="#V:155"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:156" class="idref" href="#EqDecision0:156"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a>) (<a id="H:157" class="idref" href="#H:157"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="4083cb2bcc85852dfb10cc3813a0b868" class="idref" href="#4083cb2bcc85852dfb10cc3813a0b868"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:159" class="idref" href="#gen_heapG0:159"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:155"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4083cb2bcc85852dfb10cc3813a0b868"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="2fc7cc3ed54450ffecb827be278e72cb" class="idref" href="#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="binder">d</span></a><a id="2fc7cc3ed54450ffecb827be278e72cb" class="idref" href="#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:155"><span class="id" title="variable">V</span></a>)) (<a id="76873164e1875c9cabe83440d7af70c6" class="idref" href="#76873164e1875c9cabe83440d7af70c6"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:155"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#76873164e1875c9cabe83440d7af70c6"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:162" class="idref" href="#k:162"><span class="id" title="binder"><span id="k:163" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:164" class="idref" href="#dqw:164"><span class="id" title="binder"><span id="dqw:165" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:162"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:164"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:164"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><span class="id" title="notation">(</span><span class="id" title="definition">fmap</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">σ</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#76873164e1875c9cabe83440d7af70c6"><span class="id" title="variable">σ</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM'_general"><span class="id" title="axiom">gen_heap_valid_inSepM'_general</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H". <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">d</span>σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="var">HH'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hincl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HH'</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hincl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HH'</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;+&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inclSepM" class="idref" href="#gen_heap_valid_inclSepM"><span class="id" title="lemma">gen_heap_valid_inclSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:166" class="idref" href="#L:166"><span class="id" title="binder">L</span></a> <a id="V:167" class="idref" href="#V:167"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:168" class="idref" href="#EqDecision0:168"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a>) (<a id="H:169" class="idref" href="#H:169"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="de0bdd995243600a0219716b7c05224c" class="idref" href="#de0bdd995243600a0219716b7c05224c"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:171" class="idref" href="#gen_heapG0:171"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:167"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#de0bdd995243600a0219716b7c05224c"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ac8cc0af11d0313b0e423490272f7d38" class="idref" href="#ac8cc0af11d0313b0e423490272f7d38"><span class="id" title="binder">σ</span></a> <a id="96e39509c5c968a1f0fa15accc0fa1e6" class="idref" href="#96e39509c5c968a1f0fa15accc0fa1e6"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:167"><span class="id" title="variable">V</span></a>) (<a id="q:174" class="idref" href="#q:174"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#ac8cc0af11d0313b0e423490272f7d38"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:175" class="idref" href="#k:175"><span class="id" title="binder"><span id="k:176" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:177" class="idref" href="#y:177"><span class="id" title="binder"><span id="y:178" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#96e39509c5c968a1f0fa15accc0fa1e6"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:175"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:174"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:177"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#96e39509c5c968a1f0fa15accc0fa1e6"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#ac8cc0af11d0313b0e423490272f7d38"><span class="id" title="variable">σ</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM'"><span class="id" title="axiom">gen_heap_valid_inSepM'</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (σ' <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span>; <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_allSepM" class="idref" href="#gen_heap_valid_allSepM"><span class="id" title="lemma">gen_heap_valid_allSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:179" class="idref" href="#L:179"><span class="id" title="binder">L</span></a> <a id="V:180" class="idref" href="#V:180"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:181" class="idref" href="#EqDecision0:181"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a>) (<a id="H:182" class="idref" href="#H:182"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="EV:183" class="idref" href="#EV:183"><span class="id" title="binder">EV</span></a>: <span class="id" title="class">Equiv</span> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a>) (<a id="REV:184" class="idref" href="#REV:184"><span class="id" title="binder">REV</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#Reflexive"><span class="id" title="class">Reflexive</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#EV:183"><span class="id" title="variable">EV</span></a>) (<a id="LEV:185" class="idref" href="#LEV:185"><span class="id" title="binder">LEV</span></a>: @<span class="id" title="class">LeibnizEquiv</span> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#EV:183"><span class="id" title="variable">EV</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="f95f1e88d28d837cd72b8674833b46fb" class="idref" href="#f95f1e88d28d837cd72b8674833b46fb"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:187" class="idref" href="#gen_heapG0:187"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f95f1e88d28d837cd72b8674833b46fb"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="b42cfa1eec7d2b00a4392b11732c8740" class="idref" href="#b42cfa1eec7d2b00a4392b11732c8740"><span class="id" title="binder">σ</span></a> <a id="3ffff23e1e93db122c1bd2ae63df0d61" class="idref" href="#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a>) (<a id="q:190" class="idref" href="#q:190"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:191" class="idref" href="#l:191"><span class="id" title="binder">l</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a><span class="id" title="notation">),</span> <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:191"><span class="id" title="variable">l</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#b42cfa1eec7d2b00a4392b11732c8740"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:192" class="idref" href="#k:192"><span class="id" title="binder"><span id="k:193" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:194" class="idref" href="#y:194"><span class="id" title="binder"><span id="y:195" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:192"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:190"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:194"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#b42cfa1eec7d2b00a4392b11732c8740"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * ? ? * <span class="id" title="var">H</span>σ'. <span class="id" title="var">iIntros</span> "A B".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<span class="id" title="notation">⌜</span> <span class="id" title="notation">forall</span> <a id="l:196" class="idref" href="#l:196"><span class="id" title="binder"><span id="l:197" class="id">l</span></span></a><span class="id" title="notation">,</span> σ <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:196"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> σ' <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:196"><span class="id" title="variable">l</span></a> <span class="id" title="notation">⌝</span>)%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[A B]" <span class="id" title="keyword">as</span> %<span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> (<span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span>σ' <span class="id" title="var">l</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="definition">is_Some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ' <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> <span class="id" title="var">H</span>σ'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM"><span class="id" title="axiom">gen_heap_valid_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> σ σ') <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">H</span>σ' <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">map_leibniz</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">leibniz_equiv_iff</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">equiv</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#Reflexive"><span class="id" title="class">Reflexive</span></a>. <span class="id" title="tactic">intros</span> [ <span class="id" title="var">x</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="instance">option_equiv</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">REV</span>. } <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_update_inSepM_general" class="idref" href="#gen_heap_update_inSepM_general"><span class="id" title="lemma">gen_heap_update_inSepM_general</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="L:198" class="idref" href="#L:198"><span class="id" title="binder">L</span></a> <a id="V:199" class="idref" href="#V:199"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>} {<a id="EqDecision0:200" class="idref" href="#EqDecision0:200"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H:201" class="idref" href="#H:201"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a>} {<a id="eb108301922c3577e58b724777773441" class="idref" href="#eb108301922c3577e58b724777773441"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="gen_heapG0:203" class="idref" href="#gen_heapG0:203"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#eb108301922c3577e58b724777773441"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="019a176b853a03971213611fa9d8fc1e" class="idref" href="#019a176b853a03971213611fa9d8fc1e"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a>) (<a id="109fa0b16cc8515a5eaa4883ae7aa4a8" class="idref" href="#109fa0b16cc8515a5eaa4883ae7aa4a8"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a>)) (<a id="l:206" class="idref" href="#l:206"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a>) (<a id="v:207" class="idref" href="#v:207"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="w:208" class="idref" href="#w:208"><span class="id" title="binder">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#109fa0b16cc8515a5eaa4883ae7aa4a8"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:206"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:208"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#019a176b853a03971213611fa9d8fc1e"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:209" class="idref" href="#k:209"><span class="id" title="binder"><span id="k:210" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:211" class="idref" href="#y:211"><span class="id" title="binder"><span id="y:212" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#109fa0b16cc8515a5eaa4883ae7aa4a8"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:209"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:211"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:211"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:206"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#v:207"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:213" class="idref" href="#k:213"><span class="id" title="binder"><span id="k:214" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:215" class="idref" href="#y:215"><span class="id" title="binder"><span id="y:216" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:206"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:207"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span><span class="id" title="notation">),</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:213"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:215"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:215"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hw</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]". <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span>) <span class="id" title="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_delete</span>. <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_update_inSepM" class="idref" href="#gen_heap_update_inSepM"><span class="id" title="lemma">gen_heap_update_inSepM</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="L:217" class="idref" href="#L:217"><span class="id" title="binder">L</span></a> <a id="V:218" class="idref" href="#V:218"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>} {<a id="EqDecision0:219" class="idref" href="#EqDecision0:219"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:217"><span class="id" title="variable">L</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H:220" class="idref" href="#H:220"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:217"><span class="id" title="variable">L</span></a>} {<a id="a64a867eb3871e7528f7f78d097b24f0" class="idref" href="#a64a867eb3871e7528f7f78d097b24f0"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="gen_heapG0:222" class="idref" href="#gen_heapG0:222"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:217"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:218"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a64a867eb3871e7528f7f78d097b24f0"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="d664ada8148ca2c7da21edd48409a73d" class="idref" href="#d664ada8148ca2c7da21edd48409a73d"><span class="id" title="binder">σ</span></a> <a id="32214766c65c4988d47c4a1dda4522f2" class="idref" href="#32214766c65c4988d47c4a1dda4522f2"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:217"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:218"><span class="id" title="variable">V</span></a>) (<a id="l:225" class="idref" href="#l:225"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:217"><span class="id" title="variable">L</span></a>) (<a id="v:226" class="idref" href="#v:226"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:218"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#32214766c65c4988d47c4a1dda4522f2"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:225"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#d664ada8148ca2c7da21edd48409a73d"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:227" class="idref" href="#k:227"><span class="id" title="binder"><span id="k:228" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:229" class="idref" href="#y:229"><span class="id" title="binder"><span id="y:230" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#32214766c65c4988d47c4a1dda4522f2"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:227"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:229"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:225"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#v:226"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:231" class="idref" href="#k:231"><span class="id" title="binder"><span id="k:232" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:233" class="idref" href="#y:233"><span class="id" title="binder"><span id="y:234" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:225"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#v:226"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span><span class="id" title="notation">),</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:231"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:233"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]". <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><span class="id" title="var">v</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span>) <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_delete</span>. <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note:&nbsp;glm&nbsp;and&nbsp;lm&nbsp;should&nbsp;really&nbsp;be&nbsp;the&nbsp;same,&nbsp;but&nbsp;the&nbsp;generalization&nbsp;is&nbsp;needed&nbsp;for&nbsp;the&nbsp;inductive&nbsp;case.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_lmem_version_update_addr" class="idref" href="#gen_heap_lmem_version_update_addr"><span class="id" title="lemma">gen_heap_lmem_version_update_addr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="lmem:235" class="idref" href="#lmem:235"><span class="id" title="binder">lmem</span></a> <a id="glm:236" class="idref" href="#glm:236"><span class="id" title="binder">glm</span></a> <a id="lm:237" class="idref" href="#lm:237"><span class="id" title="binder">lm</span></a> <a id="lmem':238" class="idref" href="#lmem':238"><span class="id" title="binder">lmem'</span></a> <a id="lm':239" class="idref" href="#lm':239"><span class="id" title="binder">lm'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} {<a id="vmap:240" class="idref" href="#vmap:240"><span class="id" title="binder">vmap</span></a> <a id="vmap':241" class="idref" href="#vmap':241"><span class="id" title="binder">vmap'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#VMap"><span class="id" title="definition">VMap</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="a:242" class="idref" href="#a:242"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>} {<a id="v:243" class="idref" href="#v:243"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:235"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:237"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem':238"><span class="id" title="variable">lmem'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#update_version_addr"><span class="id" title="definition">update_version_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#glm:236"><span class="id" title="variable">glm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:242"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:243"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:235"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lm':239"><span class="id" title="variable">lm'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#update_version_addr"><span class="id" title="definition">update_version_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#glm:236"><span class="id" title="variable">glm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:242"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:243"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:237"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#vmap':241"><span class="id" title="variable">vmap'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#update_version_addr_vmap"><span class="id" title="definition">update_version_addr_vmap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:242"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:243"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:240"><span class="id" title="variable">vmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lm:237"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:242"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:243"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:242"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules.rules_base.html#v:243"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:240"><span class="id" title="variable">vmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:237"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:244" class="idref" href="#k:244"><span class="id" title="binder"><span id="k:245" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:246" class="idref" href="#y:246"><span class="id" title="binder"><span id="y:247" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:235"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:244"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:246"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm':239"><span class="id" title="variable">lm'</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:248" class="idref" href="#k:248"><span class="id" title="binder"><span id="k:249" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:250" class="idref" href="#y:250"><span class="id" title="binder"><span id="y:251" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':238"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:248"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:250"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hlmem_incl</span> <span class="id" title="var">Hupdlmem</span> <span class="id" title="var">Hupdlm</span> <span class="id" title="var">Hupdvm</span> <span class="id" title="var">Hmaxvm_lm</span> <span class="id" title="var">Hcur_lm</span>) "Hgen Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.logical_mapsto.html#update_version_addr"><span class="id" title="definition">update_version_addr</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupdlm</span>, <span class="id" title="var">Hupdlmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lm</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">glm</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">lw</span>|]<span class="id" title="var">eqn</span>:<span class="id" title="var">Hlmav</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iMod</span> (<span class="id" title="notation">((</span><span class="id" title="lemma">gen_heap_alloc</span> <span class="id" title="var">lm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">lw</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hgen"<span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> "(Hgen &amp; Ha &amp; _)"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;local&nbsp;knowledge&nbsp;about&nbsp;(a,v)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "[Hmem Ha]"<span class="id" title="notation">)</span>; <span class="id" title="var">last</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken_None</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*shouldn't&nbsp;happen,&nbsp;but&nbsp;okay&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note:&nbsp;glm&nbsp;and&nbsp;lm&nbsp;should&nbsp;really&nbsp;be&nbsp;the&nbsp;same,&nbsp;but&nbsp;the&nbsp;generalization&nbsp;is&nbsp;needed&nbsp;for&nbsp;the&nbsp;inductive&nbsp;case.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_lmem_version_update" class="idref" href="#gen_heap_lmem_version_update"><span class="id" title="lemma">gen_heap_lmem_version_update</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="glm:252" class="idref" href="#glm:252"><span class="id" title="binder">glm</span></a> <a id="lmem:253" class="idref" href="#lmem:253"><span class="id" title="binder">lmem</span></a> <a id="lm:254" class="idref" href="#lm:254"><span class="id" title="binder">lm</span></a> <a id="lmem':255" class="idref" href="#lmem':255"><span class="id" title="binder">lmem'</span></a> <a id="lm':256" class="idref" href="#lm':256"><span class="id" title="binder">lm'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="vmap:257" class="idref" href="#vmap:257"><span class="id" title="binder">vmap</span></a> <a id="vmap':258" class="idref" href="#vmap':258"><span class="id" title="binder">vmap'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#VMap"><span class="id" title="definition">VMap</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la:259" class="idref" href="#la:259"><span class="id" title="binder">la</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>) ( <a id="v:260" class="idref" href="#v:260"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="inductive">NoDup</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:259"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:253"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:254"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem':255"><span class="id" title="variable">lmem'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#glm:252"><span class="id" title="variable">glm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:259"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:260"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:253"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lm':256"><span class="id" title="variable">lm'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#glm:252"><span class="id" title="variable">glm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:259"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:260"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:254"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#vmap':258"><span class="id" title="variable">vmap'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#update_version_region_vmap"><span class="id" title="definition">update_version_region_vmap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:259"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:260"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:257"><span class="id" title="variable">vmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:261" class="idref" href="#a:261"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:254"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:261"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:260"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#la:259"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:262" class="idref" href="#a:262"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:262"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules.rules_base.html#v:260"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:257"><span class="id" title="variable">vmap</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#la:259"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:254"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:263" class="idref" href="#k:263"><span class="id" title="binder"><span id="k:264" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:265" class="idref" href="#y:265"><span class="id" title="binder"><span id="y:266" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:253"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:263"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:265"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm':256"><span class="id" title="variable">lm'</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:267" class="idref" href="#k:267"><span class="id" title="binder"><span id="k:268" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:269" class="idref" href="#y:269"><span class="id" title="binder"><span id="y:270" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':255"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:267"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:269"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">glm</span> <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span> <span class="id" title="var">la</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">glm</span> <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">la</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">la</span> <span class="id" title="var">IH</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iIntros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">glm</span> <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span> <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">HNoDup_la</span> <span class="id" title="var">Hlmem_incl</span> <span class="id" title="var">Hupdlmem</span> <span class="id" title="var">Hupdlm</span> <span class="id" title="var">Hupdvmap</span> <span class="id" title="var">Hmaxv_lm</span> <span class="id" title="var">Hcur_lm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Hgen Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;no&nbsp;addresses&nbsp;updated&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupdlm</span>, <span class="id" title="var">Hupdvmap</span>, <span class="id" title="var">Hupdlmem</span>; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">destruct_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="var">IH</span> <span class="id" title="var">glm</span> <span class="id" title="notation">with</span> "Hgen Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "&gt;[Hgen Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupdlmem</span>, <span class="id" title="var">Hupdlm</span>, <span class="id" title="var">Hupdvmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lm''</span> := <a class="idref" href="cap_machine.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <span class="id" title="var">glm</span> <span class="id" title="var">la</span> <span class="id" title="var">v</span> <span class="id" title="var">lm'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lmem''</span> := <a class="idref" href="cap_machine.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <span class="id" title="var">glm</span> <span class="id" title="var">la</span> <span class="id" title="var">v</span> <span class="id" title="var">lmem'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_lmem_version_update_addr"><span class="id" title="axiom">gen_heap_lmem_version_update_addr</span></a> <span class="id" title="notation">with</span> "Hgen Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "&gt;[Hgen Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#update_version_region_mono"><span class="id" title="axiom">update_version_region_mono</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Hmaxv_lm_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#update_version_region_notin_preserves_lmem"><span class="id" title="axiom">update_version_region_notin_preserves_lmem</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="cap_machine.logical_mapsto.html#update_version_region_notin_preserves_cur"><span class="id" title="axiom">update_version_region_notin_preserves_cur</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> <span class="id" title="var">Ha_notin_la</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Hcur_lm_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prim_step_no_kappa" class="idref" href="#prim_step_no_kappa"><span class="id" title="lemma">prim_step_no_kappa</span></a> {<a id="e1:271" class="idref" href="#e1:271"><span class="id" title="binder">e1</span></a> <a id="d323bf33926087a918ae63af69c820e1" class="idref" href="#d323bf33926087a918ae63af69c820e1"><span class="id" title="binder">σ1</span></a> <a id="311fe340f46e6bc236f5e6292ba29b85" class="idref" href="#311fe340f46e6bc236f5e6292ba29b85"><span class="id" title="binder">κ</span></a> <a id="e2:274" class="idref" href="#e2:274"><span class="id" title="binder">e2</span></a> <a id="b8dffe9bbb19ad2019c816e1a1261e5e" class="idref" href="#b8dffe9bbb19ad2019c816e1a1261e5e"><span class="id" title="binder">σ2</span></a> <a id="efs:276" class="idref" href="#efs:276"><span class="id" title="binder">efs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:271"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d323bf33926087a918ae63af69c820e1"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#311fe340f46e6bc236f5e6292ba29b85"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:274"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b8dffe9bbb19ad2019c816e1a1261e5e"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:276"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#311fe340f46e6bc236f5e6292ba29b85"><span class="id" title="variable">κ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prim_step_no_efs" class="idref" href="#prim_step_no_efs"><span class="id" title="lemma">prim_step_no_efs</span></a> {<a id="e1:277" class="idref" href="#e1:277"><span class="id" title="binder">e1</span></a> <a id="306569c7beaa4662343228a00f2995a7" class="idref" href="#306569c7beaa4662343228a00f2995a7"><span class="id" title="binder">σ1</span></a> <a id="0312412a34d9220673621ab0750616e9" class="idref" href="#0312412a34d9220673621ab0750616e9"><span class="id" title="binder">κ</span></a> <a id="e2:280" class="idref" href="#e2:280"><span class="id" title="binder">e2</span></a> <a id="a5a26c53174bba3b616d69ca4426a58d" class="idref" href="#a5a26c53174bba3b616d69ca4426a58d"><span class="id" title="binder">σ2</span></a> <a id="efs:282" class="idref" href="#efs:282"><span class="id" title="binder">efs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:277"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#306569c7beaa4662343228a00f2995a7"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0312412a34d9220673621ab0750616e9"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:280"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a5a26c53174bba3b616d69ca4426a58d"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:282"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:282"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="LMemF" class="idref" href="#LMemF"><span class="id" title="definition">LMemF</span></a> := <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="transiently" class="idref" href="#transiently"><span class="id" title="definition">transiently</span></a> (<a id="Pcommitted:283" class="idref" href="#Pcommitted:283"><span class="id" title="binder">Pcommitted</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>) (<a id="Ptransient:284" class="idref" href="#Ptransient:284"><span class="id" title="binder">Ptransient</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#Pcommitted:283"><span class="id" title="variable">Pcommitted</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#Ptransient:284"><span class="id" title="variable">Ptransient</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="transiently_intro" class="idref" href="#transiently_intro"><span class="id" title="lemma">transiently_intro</span></a> <a id="P:285" class="idref" href="#P:285"><span class="id" title="binder">P</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#P:285"><span class="id" title="variable">P</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:285"><span class="id" title="variable">P</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:285"><span class="id" title="variable">P</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "$". <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="transiently_abort" class="idref" href="#transiently_abort"><span class="id" title="lemma">transiently_abort</span></a> <a id="Pcommitted:286" class="idref" href="#Pcommitted:286"><span class="id" title="binder">Pcommitted</span></a> <a id="Ptransient:287" class="idref" href="#Ptransient:287"><span class="id" title="binder">Ptransient</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Pcommitted:286"><span class="id" title="variable">Pcommitted</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ptransient:287"><span class="id" title="variable">Ptransient</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#Pcommitted:286"><span class="id" title="variable">Pcommitted</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "[P _]". <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="transiently_commit" class="idref" href="#transiently_commit"><span class="id" title="lemma">transiently_commit</span></a> <a id="Pcommitted:288" class="idref" href="#Pcommitted:288"><span class="id" title="binder">Pcommitted</span></a> <a id="Ptransient:289" class="idref" href="#Ptransient:289"><span class="id" title="binder">Ptransient</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Pcommitted:288"><span class="id" title="variable">Pcommitted</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ptransient:289"><span class="id" title="variable">Ptransient</span></a> <span class="id" title="notation">⊢</span> <span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#Ptransient:289"><span class="id" title="variable">Ptransient</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "[_ Ht]". <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="transiently_mono_2" class="idref" href="#transiently_mono_2"><span class="id" title="lemma">transiently_mono_2</span></a> <a id="Pcommitted:290" class="idref" href="#Pcommitted:290"><span class="id" title="binder">Pcommitted</span></a> <a id="Ptransient1:291" class="idref" href="#Ptransient1:291"><span class="id" title="binder">Ptransient1</span></a> (<a id="Ptransient2:292" class="idref" href="#Ptransient2:292"><span class="id" title="binder">Ptransient2</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#Ptransient1:291"><span class="id" title="variable">Ptransient1</span></a> <span class="id" title="notation">==∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#Ptransient2:292"><span class="id" title="variable">Ptransient2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Pcommitted:290"><span class="id" title="variable">Pcommitted</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ptransient1:291"><span class="id" title="variable">Ptransient1</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Pcommitted:290"><span class="id" title="variable">Pcommitted</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ptransient2:292"><span class="id" title="variable">Ptransient2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> "(HPt &amp; Hcomtrans1)". <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iDestruct</span> "Hcomtrans1" <span class="id" title="keyword">as</span> "($ &amp; _)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hcomtrans1" <span class="id" title="keyword">as</span> "(_ &amp; Htrans1)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "Htrans1" <span class="id" title="keyword">as</span> "Htrans1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"HPt" <span class="id" title="notation">with</span> "Htrans1"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="transiently_proper_strong" class="idref" href="#transiently_proper_strong"><span class="id" title="lemma">transiently_proper_strong</span></a> {<a id="P:293" class="idref" href="#P:293"><span class="id" title="binder">P</span></a> <a id="Q:294" class="idref" href="#Q:294"><span class="id" title="binder">Q</span></a> <a id="R:295" class="idref" href="#R:295"><span class="id" title="binder">R</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#Q:294"><span class="id" title="variable">Q</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#R:295"><span class="id" title="variable">R</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:293"><span class="id" title="variable">P</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Q:294"><span class="id" title="variable">Q</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:293"><span class="id" title="variable">P</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#R:295"><span class="id" title="variable">R</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(HQR &amp; HPQ)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HPQ" <span class="id" title="keyword">as</span> "(HP &amp; _)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "HPQ" <span class="id" title="keyword">as</span> "(_ &amp; HQ)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> "HQ" <span class="id" title="keyword">as</span> "HQ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "HQR".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Instance</span> <a id="elimModal_transiently" class="idref" href="#elimModal_transiently"><span class="id" title="instance">elimModal_transiently</span></a> {<a id="P:296" class="idref" href="#P:296"><span class="id" title="binder">P</span></a> <a id="Q:297" class="idref" href="#Q:297"><span class="id" title="binder">Q</span></a> <a id="R:298" class="idref" href="#R:298"><span class="id" title="binder">R</span></a>} : <span class="id" title="class">ElimModal</span> <span class="id" title="notation">True</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:296"><span class="id" title="variable">P</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Q:297"><span class="id" title="variable">Q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#Q:297"><span class="id" title="variable">Q</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:296"><span class="id" title="variable">P</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#R:298"><span class="id" title="variable">R</span></a>) (<span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#R:298"><span class="id" title="variable">R</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">_</span>) "(HPQ &amp; HK)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#transiently_mono_2"><span class="id" title="axiom">transiently_mono_2</span></a> <span class="id" title="notation">with</span> "[$HK $HPQ]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="state_interp_with_res" class="idref" href="#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> (<a id="db33de950848779038b513c3190fa0c3" class="idref" href="#db33de950848779038b513c3190fa0c3"><span class="id" title="binder">φ</span></a><a id="db33de950848779038b513c3190fa0c3" class="idref" href="#db33de950848779038b513c3190fa0c3"><span class="id" title="binder">t</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>) (<a id="lrt:300" class="idref" href="#lrt:300"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="lmt:301" class="idref" href="#lmt:301"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db33de950848779038b513c3190fa0c3"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#db33de950848779038b513c3190fa0c3"><span class="id" title="variable">t</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:302" class="idref" href="#k:302"><span class="id" title="binder"><span id="k:303" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:304" class="idref" href="#y:304"><span class="id" title="binder"><span id="y:305" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:300"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:302"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:304"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:306" class="idref" href="#k:306"><span class="id" title="binder"><span id="k:307" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:308" class="idref" href="#y:308"><span class="id" title="binder"><span id="y:309" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:301"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:306"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:308"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:308"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="state_interp_transient" class="idref" href="#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> (<a id="6f6ee8af1066fb2568da0a3ff786f582" class="idref" href="#6f6ee8af1066fb2568da0a3ff786f582"><span class="id" title="binder">φ</span></a> <a id="f38a380e4abda7412a31ae071aadae6c" class="idref" href="#f38a380e4abda7412a31ae071aadae6c"><span class="id" title="binder">φ</span></a><a id="f38a380e4abda7412a31ae071aadae6c" class="idref" href="#f38a380e4abda7412a31ae071aadae6c"><span class="id" title="binder">t</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>) (<a id="lr:312" class="idref" href="#lr:312"><span class="id" title="binder">lr</span></a> <a id="lrt:313" class="idref" href="#lrt:313"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="lm:314" class="idref" href="#lm:314"><span class="id" title="binder">lm</span></a> <a id="lmt:315" class="idref" href="#lmt:315"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6f6ee8af1066fb2568da0a3ff786f582"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:312"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:314"><span class="id" title="variable">lm</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f38a380e4abda7412a31ae071aadae6c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#f38a380e4abda7412a31ae071aadae6c"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:313"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:315"><span class="id" title="variable">lmt</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_corr" class="idref" href="#state_interp_corr"><span class="id" title="lemma">state_interp_corr</span></a> {<a id="7687ddc8500105d247e5645e44ef1fc7" class="idref" href="#7687ddc8500105d247e5645e44ef1fc7"><span class="id" title="binder">σ</span></a> <a id="lregs:317" class="idref" href="#lregs:317"><span class="id" title="binder">lregs</span></a>} {<a id="lmem:318" class="idref" href="#lmem:318"><span class="id" title="binder">lmem</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7687ddc8500105d247e5645e44ef1fc7"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:317"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:318"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="lreg_t:319" class="idref" href="#lreg_t:319"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:320" class="idref" href="#lmem_t:320"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:321" class="idref" href="#cur_map:321"><span class="id" title="binder">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:317"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:319"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:318"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:320"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7687ddc8500105d247e5645e44ef1fc7"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#7687ddc8500105d247e5645e44ef1fc7"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:319"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:320"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:321"><span class="id" title="variable">cur_map</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_intro" class="idref" href="#state_interp_transient_intro"><span class="id" title="lemma">state_interp_transient_intro</span></a> {<a id="c01d2eead89dc158de5265463b3141b1" class="idref" href="#c01d2eead89dc158de5265463b3141b1"><span class="id" title="binder">φ</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:323" class="idref" href="#lr:323"><span class="id" title="binder">lr</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:324" class="idref" href="#lm:324"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c01d2eead89dc158de5265463b3141b1"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:323"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:324"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c01d2eead89dc158de5265463b3141b1"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c01d2eead89dc158de5265463b3141b1"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:323"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:323"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:324"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:324"><span class="id" title="variable">lm</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span>. <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#transiently_intro"><span class="id" title="lemma">transiently_intro</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;split&nbsp;off&nbsp;lemma&nbsp;about&nbsp;big_sepM_fmap?&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_intro_nodfracs" class="idref" href="#state_interp_transient_intro_nodfracs"><span class="id" title="lemma">state_interp_transient_intro_nodfracs</span></a> {<a id="9e0a66f49ce2f32b96753315aa09a3d8" class="idref" href="#9e0a66f49ce2f32b96753315aa09a3d8"><span class="id" title="binder">φ</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:326" class="idref" href="#lr:326"><span class="id" title="binder">lr</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:327" class="idref" href="#lm:327"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9e0a66f49ce2f32b96753315aa09a3d8"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:328" class="idref" href="#k:328"><span class="id" title="binder"><span id="k:329" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:330" class="idref" href="#y:330"><span class="id" title="binder"><span id="y:331" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:326"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:328"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:330"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:332" class="idref" href="#k:332"><span class="id" title="binder"><span id="k:333" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:334" class="idref" href="#y:334"><span class="id" title="binder"><span id="y:335" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:327"><span class="id" title="variable">lm</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:332"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:334"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9e0a66f49ce2f32b96753315aa09a3d8"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9e0a66f49ce2f32b96753315aa09a3d8"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:326"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:326"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">(</span><span class="id" title="keyword">fun</span> <a id="y:336" class="idref" href="#y:336"><span class="id" title="binder">y</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:336"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:327"><span class="id" title="variable">lm</span></a>) (<span class="id" title="notation">(</span><span class="id" title="keyword">fun</span> <a id="y:337" class="idref" href="#y:337"><span class="id" title="binder">y</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:337"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:327"><span class="id" title="variable">lm</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient_intro"><span class="id" title="lemma">state_interp_transient_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> "($ &amp; $ &amp; Hm)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_fmap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_elim_abort" class="idref" href="#state_interp_transient_elim_abort"><span class="id" title="lemma">state_interp_transient_elim_abort</span></a> {<a id="4982de2048cadaea8ee125753e0195d2" class="idref" href="#4982de2048cadaea8ee125753e0195d2"><span class="id" title="binder">φ</span></a> <a id="6b5378bee25ea47bf7a7306a02cc9614" class="idref" href="#6b5378bee25ea47bf7a7306a02cc9614"><span class="id" title="binder">φ</span></a><a id="6b5378bee25ea47bf7a7306a02cc9614" class="idref" href="#6b5378bee25ea47bf7a7306a02cc9614"><span class="id" title="binder">t</span></a>: <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:340" class="idref" href="#lr:340"><span class="id" title="binder">lr</span></a> <a id="lrt:341" class="idref" href="#lrt:341"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:342" class="idref" href="#lm:342"><span class="id" title="binder">lm</span></a> <a id="lmt:343" class="idref" href="#lmt:343"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4982de2048cadaea8ee125753e0195d2"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6b5378bee25ea47bf7a7306a02cc9614"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#6b5378bee25ea47bf7a7306a02cc9614"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:340"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:341"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:342"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:343"><span class="id" title="variable">lmt</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4982de2048cadaea8ee125753e0195d2"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:340"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:342"><span class="id" title="variable">lm</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "(H &amp; _)".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_elim_commit" class="idref" href="#state_interp_transient_elim_commit"><span class="id" title="lemma">state_interp_transient_elim_commit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="4f07b0e570d5e4fd553c7a4e79d7f26b" class="idref" href="#4f07b0e570d5e4fd553c7a4e79d7f26b"><span class="id" title="binder">φ</span></a> <a id="b630ac081e1f56a3564e3d88bd2125c5" class="idref" href="#b630ac081e1f56a3564e3d88bd2125c5"><span class="id" title="binder">φ</span></a><a id="b630ac081e1f56a3564e3d88bd2125c5" class="idref" href="#b630ac081e1f56a3564e3d88bd2125c5"><span class="id" title="binder">t</span></a>: <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:346" class="idref" href="#lr:346"><span class="id" title="binder">lr</span></a> <a id="lrt:347" class="idref" href="#lrt:347"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:348" class="idref" href="#lm:348"><span class="id" title="binder">lm</span></a> <a id="lmt:349" class="idref" href="#lmt:349"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4f07b0e570d5e4fd553c7a4e79d7f26b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b630ac081e1f56a3564e3d88bd2125c5"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#b630ac081e1f56a3564e3d88bd2125c5"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:346"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:347"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:348"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:349"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b630ac081e1f56a3564e3d88bd2125c5"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#b630ac081e1f56a3564e3d88bd2125c5"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:347"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:349"><span class="id" title="variable">lmt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#transiently_commit"><span class="id" title="lemma">transiently_commit</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_cap_lang" class="idref" href="#wp_cap_lang"><span class="id" title="lemma">wp_cap_lang</span></a> {<a id="s:350" class="idref" href="#s:350"><span class="id" title="binder">s</span></a> <a id="E:351" class="idref" href="#E:351"><span class="id" title="binder">E</span></a>} {<a id="326757cdd92fb0bb2ad66c321e3a14f7" class="idref" href="#326757cdd92fb0bb2ad66c321e3a14f7"><span class="id" title="binder">Φ</span></a>} : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="e1:353" class="idref" href="#e1:353"><span class="id" title="binder">e1</span></a> : <span class="id" title="projection">language.expr</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:353"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="9fceef72b0b8cbc3a80653ae4c772a89" class="idref" href="#9fceef72b0b8cbc3a80653ae4c772a89"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9fceef72b0b8cbc3a80653ae4c772a89"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:351"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="definition">head_reducible</span> <a class="idref" href="cap_machine.rules.rules_base.html#e1:353"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9fceef72b0b8cbc3a80653ae4c772a89"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e2:355" class="idref" href="#e2:355"><span class="id" title="binder">e2</span></a> : <span class="id" title="projection">language.expr</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="a507827ca6f3fb03b62d200810cae3f7" class="idref" href="#a507827ca6f3fb03b62d200810cae3f7"><span class="id" title="binder">σ2</span></a> : <span class="id" title="projection">ectx_language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:353"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9fceef72b0b8cbc3a80653ae4c772a89"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:355"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a507827ca6f3fb03b62d200810cae3f7"><span class="id" title="variable">σ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:351"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a507827ca6f3fb03b62d200810cae3f7"><span class="id" title="variable">σ2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#326757cdd92fb0bb2ad66c321e3a14f7"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> <a class="idref" href="cap_machine.rules.rules_base.html#e2:355"><span class="id" title="variable">e2</span></a>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:350"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:351"><span class="id" title="variable">E</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:353"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#326757cdd92fb0bb2ad66c321e3a14f7"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? <span class="id" title="var">Hnoval</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>) "Hσ1 /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> σ1 <span class="id" title="notation">with</span> "[$Hσ1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[%Hred H]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iIntros</span> (? ? ?) "%Hstep Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.rules.rules_base.html#prim_step_no_efs"><span class="id" title="axiom">prim_step_no_efs</span></a> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.rules.rules_base.html#prim_step_no_kappa"><span class="id" title="axiom">prim_step_no_kappa</span></a> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">Hstep</span> <span class="id" title="notation">with</span> "Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_instr_exec" class="idref" href="#wp_instr_exec"><span class="id" title="lemma">wp_instr_exec</span></a> {<a id="s:357" class="idref" href="#s:357"><span class="id" title="binder">s</span></a> <a id="E:358" class="idref" href="#E:358"><span class="id" title="binder">E</span></a>} {<a id="d7194bd5765a625292f97a9e9a049515" class="idref" href="#d7194bd5765a625292f97a9e9a049515"><span class="id" title="binder">Φ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="07ebaaecf1b3db966cc52ec59fd67cf5" class="idref" href="#07ebaaecf1b3db966cc52ec59fd67cf5"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#07ebaaecf1b3db966cc52ec59fd67cf5"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:358"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e2:361" class="idref" href="#e2:361"><span class="id" title="binder">e2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ConfFlag"><span class="id" title="inductive">ConfFlag</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="fc02d1fbc6028f055e65d092ad0f409b" class="idref" href="#fc02d1fbc6028f055e65d092ad0f409b"><span class="id" title="binder">σ2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#07ebaaecf1b3db966cc52ec59fd67cf5"><span class="id" title="variable">σ1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e2:361"><span class="id" title="variable">e2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fc02d1fbc6028f055e65d092ad0f409b"><span class="id" title="variable">σ2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:358"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fc02d1fbc6028f055e65d092ad0f409b"><span class="id" title="variable">σ2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#d7194bd5765a625292f97a9e9a049515"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:361"><span class="id" title="variable">e2</span></a>))<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:357"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:358"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#d7194bd5765a625292f97a9e9a049515"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_cap_lang"><span class="id" title="axiom">wp_cap_lang</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1) "Hσ1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">with</span> "Hσ1"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2) "%Hstep".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hstep</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Program Definition</span> <a id="wp_lift_atomic_head_step_no_fork_determ" class="idref" href="#wp_lift_atomic_head_step_no_fork_determ"><span class="id" title="definition">wp_lift_atomic_head_step_no_fork_determ</span></a> {<a id="s:363" class="idref" href="#s:363"><span class="id" title="binder">s</span></a> <a id="E:364" class="idref" href="#E:364"><span class="id" title="binder">E</span></a> <a id="1dc33893afa4954f1b07e42181ff9ebb" class="idref" href="#1dc33893afa4954f1b07e42181ff9ebb"><span class="id" title="binder">Φ</span></a>} <a id="e1:366" class="idref" href="#e1:366"><span class="id" title="binder">e1</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:366"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e41c9295804b7a26f39545410c3b9c45" class="idref" href="#e41c9295804b7a26f39545410c3b9c45"><span class="id" title="binder">σ1</span></a>:<a class="idref" href="cap_machine.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) <a id="ns:368" class="idref" href="#ns:368"><span class="id" title="binder">ns</span></a> <a id="eab1eb3a8784e920fee8e4fa6f0eafa9" class="idref" href="#eab1eb3a8784e920fee8e4fa6f0eafa9"><span class="id" title="binder">κ</span></a> <a id="81adc19ba223b3cb020d0bf70170cfcd" class="idref" href="#81adc19ba223b3cb020d0bf70170cfcd"><span class="id" title="binder">κs</span></a> <a id="nt:371" class="idref" href="#nt:371"><span class="id" title="binder">nt</span></a><span class="id" title="notation">,</span> <span class="id" title="method">state_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#e41c9295804b7a26f39545410c3b9c45"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ns:368"><span class="id" title="variable">ns</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#eab1eb3a8784e920fee8e4fa6f0eafa9"><span class="id" title="variable">κ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#81adc19ba223b3cb020d0bf70170cfcd"><span class="id" title="variable">κs</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#nt:371"><span class="id" title="variable">nt</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:364"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="97de9d1936bb152c7fd4ef79c5a552f6" class="idref" href="#97de9d1936bb152c7fd4ef79c5a552f6"><span class="id" title="binder">κ</span></a> <a id="e2:373" class="idref" href="#e2:373"><span class="id" title="binder">e2</span></a> (<a id="e8c7d46d62ff9b5f8b046955f3594230" class="idref" href="#e8c7d46d62ff9b5f8b046955f3594230"><span class="id" title="binder">σ2</span></a>:<a class="idref" href="cap_machine.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) <a id="efs:375" class="idref" href="#efs:375"><span class="id" title="binder">efs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">cap_lang.prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:366"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e41c9295804b7a26f39545410c3b9c45"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#97de9d1936bb152c7fd4ef79c5a552f6"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:373"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e8c7d46d62ff9b5f8b046955f3594230"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:375"><span class="id" title="variable">efs</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <span class="id" title="notation">|==&gt;</span> <span class="id" title="notation">(</span><span class="id" title="method">state_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#e8c7d46d62ff9b5f8b046955f3594230"><span class="id" title="variable">σ2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ns:368"><span class="id" title="variable">ns</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#81adc19ba223b3cb020d0bf70170cfcd"><span class="id" title="variable">κs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#nt:371"><span class="id" title="variable">nt</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#1dc33893afa4954f1b07e42181ff9ebb"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:373"><span class="id" title="variable">e2</span></a>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.rules.rules_base.html#e1:366"><span class="id" title="variable">e1</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:363"><span class="id" title="variable">s</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:364"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="cap_machine.rules.rules_base.html#1dc33893afa4954f1b07e42181ff9ebb"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "H". <span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>)  "Hσ1 /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span> <span class="id" title="notation">with</span> "[Hσ1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> (<span class="id" title="var">κ'</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span>) "[H1 H2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<span class="id" title="definition">head_reducible</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">κ'</span>, <span class="id" title="var">e2</span>, σ2, <span class="id" title="var">efs</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> (? ? ?) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H1" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#cap_lang_determ"><span class="id" title="axiom">cap_lang_determ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hs1</span> <span class="id" title="var">Hs2</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq1</span> [<span class="id" title="var">Heq2</span> [<span class="id" title="var">Heq3</span> <span class="id" title="var">Heq4</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">iMod</span> "H2". <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">inv</span> <span class="id" title="var">Hs1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;predicates&nbsp;on&nbsp;memory&nbsp;maps&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="extract_sep_if_split" class="idref" href="#extract_sep_if_split"><span class="id" title="lemma">extract_sep_if_split</span></a> (<a id="a:376" class="idref" href="#a:376"><span class="id" title="binder">a</span></a> <a id="pc_a:377" class="idref" href="#pc_a:377"><span class="id" title="binder">pc_a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) <a id="P:378" class="idref" href="#P:378"><span class="id" title="binder">P</span></a> <a id="Q:379" class="idref" href="#Q:379"><span class="id" title="binder">Q</span></a> <a id="R:380" class="idref" href="#R:380"><span class="id" title="binder">R</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:376"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:377"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:378"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Q:379"><span class="id" title="variable">Q</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#R:380"><span class="id" title="variable">R</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">≡</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:376"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:377"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:378"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Q:379"><span class="id" title="variable">Q</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:376"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:377"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#R:380"><span class="id" title="variable">R</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">pc_a</span>)%<span class="id" title="var">la</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iIntros</span> "[H1 H2]"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_0" class="idref" href="#memMap_resource_0"><span class="id" title="lemma">memMap_resource_0</span></a>  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">True</span> <span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:381" class="idref" href="#la:381"><span class="id" title="binder"><span id="la:382" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:383" class="idref" href="#w:383"><span class="id" title="binder"><span id="w:384" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:381"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:383"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_1" class="idref" href="#memMap_resource_1"><span class="id" title="lemma">memMap_resource_1</span></a> (<a id="a:385" class="idref" href="#a:385"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w:386" class="idref" href="#w:386"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a:385"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:386"><span class="id" title="variable">w</span></a>  <span class="id" title="notation">⊣⊢</span> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:387" class="idref" href="#la:387"><span class="id" title="binder"><span id="la:388" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:389" class="idref" href="#w:389"><span class="id" title="binder"><span id="w:390" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a:385"><span class="id" title="variable">a</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w:386"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:387"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:389"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_0"><span class="id" title="axiom">memMap_resource_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[HH _]".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_1_dq" class="idref" href="#memMap_resource_1_dq"><span class="id" title="lemma">memMap_resource_1_dq</span></a> (<a id="a:391" class="idref" href="#a:391"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w:392" class="idref" href="#w:392"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <a id="dq:393" class="idref" href="#dq:393"><span class="id" title="binder">dq</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a:391"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:393"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:392"><span class="id" title="variable">w</span></a>  <span class="id" title="notation">⊣⊢</span> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:394" class="idref" href="#la:394"><span class="id" title="binder"><span id="la:395" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:396" class="idref" href="#w:396"><span class="id" title="binder"><span id="w:397" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a:391"><span class="id" title="variable">a</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w:392"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:394"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:393"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:396"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[HH _]".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne" class="idref" href="#memMap_resource_2ne"><span class="id" title="lemma">memMap_resource_2ne</span></a> (<a id="a1:398" class="idref" href="#a1:398"><span class="id" title="binder">a1</span></a> <a id="a2:399" class="idref" href="#a2:399"><span class="id" title="binder">a2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w1:400" class="idref" href="#w1:400"><span class="id" title="binder">w1</span></a> <a id="w2:401" class="idref" href="#w2:401"><span class="id" title="binder">w2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a1:398"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a2:399"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:402" class="idref" href="#a:402"><span class="id" title="binder"><span id="a:403" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:404" class="idref" href="#w:404"><span class="id" title="binder"><span id="w:405" class="id">w</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a1:398"><span class="id" title="variable">a1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:400"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">a2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:402"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:404"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#a1:398"><span class="id" title="variable">a1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:400"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#a2:399"><span class="id" title="variable">a2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:401"><span class="id" title="variable">w2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a2</span> <span class="id" title="var">w2</span>); <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>. 2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_0"><span class="id" title="axiom">memMap_resource_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 [H2 _ ] ]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 H2]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="address_neq" class="idref" href="#address_neq"><span class="id" title="lemma">address_neq</span></a> <a id="la1:406" class="idref" href="#la1:406"><span class="id" title="binder">la1</span></a> <a id="la2:407" class="idref" href="#la2:407"><span class="id" title="binder">la2</span></a> <a id="lw1:408" class="idref" href="#lw1:408"><span class="id" title="binder">lw1</span></a> <a id="lw2:409" class="idref" href="#lw2:409"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la1:406"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:408"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la2:407"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:409"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:406"><span class="id" title="variable">la1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:407"><span class="id" title="variable">la2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ha1 Ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="machine_utils.finz_base.html#finz_eq_dec"><span class="id" title="instance">finz_eq_dec</span></a> <span class="id" title="var">la1</span><span class="id" title="notation">.1</span> <span class="id" title="var">la2</span><span class="id" title="notation">.1</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="instance">Nat.eq_dec</span> <span class="id" title="var">la1</span><span class="id" title="notation">.2</span> <span class="id" title="var">la2</span><span class="id" title="notation">.2</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExFalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">la1</span> <span class="id" title="keyword">with</span> <span class="id" title="var">la2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#addr_dupl_false"><span class="id" title="axiom">addr_dupl_false</span></a> <span class="id" title="notation">with</span> "[$Ha1] [$Ha2]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#injective_projections"><span class="id" title="lemma">injective_projections</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne_apply" class="idref" href="#memMap_resource_2ne_apply"><span class="id" title="lemma">memMap_resource_2ne_apply</span></a> (<a id="la1:410" class="idref" href="#la1:410"><span class="id" title="binder">la1</span></a> <a id="la2:411" class="idref" href="#la2:411"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:412" class="idref" href="#lw1:412"><span class="id" title="binder">lw1</span></a> <a id="lw2:413" class="idref" href="#lw2:413"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la1:410"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:412"><span class="id" title="variable">lw1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la2:411"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:413"><span class="id" title="variable">lw2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:414" class="idref" href="#la:414"><span class="id" title="binder"><span id="la:415" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:416" class="idref" href="#lw:416"><span class="id" title="binder"><span id="lw:417" class="id">lw</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:410"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:412"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:414"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:416"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:410"><span class="id" title="variable">la1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:411"><span class="id" title="variable">la2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hi Hr2a".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#address_neq"><span class="id" title="axiom">address_neq</span></a>  <span class="id" title="notation">with</span> "Hi Hr2a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hne</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iSplitL</span> "Hi"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen" class="idref" href="#memMap_resource_2gen"><span class="id" title="lemma">memMap_resource_2gen</span></a> (<a id="la1:418" class="idref" href="#la1:418"><span class="id" title="binder">la1</span></a> <a id="la2:419" class="idref" href="#la2:419"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:420" class="idref" href="#lw1:420"><span class="id" title="binder">lw1</span></a> <a id="lw2:421" class="idref" href="#lw2:421"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="notation">∃</span> <a id="lmem:422" class="idref" href="#lmem:422"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:423" class="idref" href="#la:423"><span class="id" title="binder"><span id="la:424" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:425" class="idref" href="#lw:425"><span class="id" title="binder"><span id="lw:426" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:422"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:423"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:425"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:419"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:418"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:422"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:418"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:420"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:422"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:418"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:420"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:418"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:420"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:419"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:418"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:419"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:421"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HeqZ</span> <span class="id" title="var">HeqV</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#Z.eqb_eq"><span class="id" title="lemma">Z.eqb_eq</span></a>, <a class="idref" href="machine_utils.finz_base.html#finz_to_z_eq"><span class="id" title="lemma">finz_to_z_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqZ</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.eqb_eq"><span class="id" title="lemma">Nat.eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">la2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">la1</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#injective_projections"><span class="id" title="lemma">injective_projections</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_1"><span class="id" title="axiom">memMap_resource_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (<span class="id" title="var">lmem</span>) "[HH -&gt;]". <span class="id" title="tactic">by</span> <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> "[Hmap _]". <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (<span class="id" title="var">mem</span>) "[HH -&gt;]" ; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> "Hmap"; <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_d" class="idref" href="#memMap_resource_2gen_d"><span class="id" title="lemma">memMap_resource_2gen_d</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="cf2162083a6185042c6cd8cf95480476" class="idref" href="#cf2162083a6185042c6cd8cf95480476"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la1:428" class="idref" href="#la1:428"><span class="id" title="binder">la1</span></a> <a id="la2:429" class="idref" href="#la2:429"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:430" class="idref" href="#lw1:430"><span class="id" title="binder">lw1</span></a> <a id="lw2:431" class="idref" href="#lw2:431"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">∃</span> <a id="lmem:432" class="idref" href="#lmem:432"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:433" class="idref" href="#la:433"><span class="id" title="binder"><span id="la:434" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:435" class="idref" href="#lw:435"><span class="id" title="binder"><span id="lw:436" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:432"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#cf2162083a6185042c6cd8cf95480476"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:433"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:435"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:429"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:428"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:432"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:428"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:430"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:432"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:428"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:430"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#cf2162083a6185042c6cd8cf95480476"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:428"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:430"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:429"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:428"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cf2162083a6185042c6cd8cf95480476"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:429"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:431"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> (<span class="id" title="var">lmem</span>) "[Hmem Hif]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ((<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_d_dq" class="idref" href="#memMap_resource_2gen_d_dq"><span class="id" title="lemma">memMap_resource_2gen_d_dq</span></a> (<a id="26a760c16d28e84a5f0b2e2dc6404e06" class="idref" href="#26a760c16d28e84a5f0b2e2dc6404e06"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la1:438" class="idref" href="#la1:438"><span class="id" title="binder">la1</span></a> <a id="la2:439" class="idref" href="#la2:439"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="dq1:440" class="idref" href="#dq1:440"><span class="id" title="binder">dq1</span></a> <a id="dq2:441" class="idref" href="#dq2:441"><span class="id" title="binder">dq2</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="lw1:442" class="idref" href="#lw1:442"><span class="id" title="binder">lw1</span></a> <a id="lw2:443" class="idref" href="#lw2:443"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">∃</span> <a id="lmem:444" class="idref" href="#lmem:444"><span class="id" title="binder">lmem</span></a> <a id="dfracs:445" class="idref" href="#dfracs:445"><span class="id" title="binder">dfracs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:446" class="idref" href="#la:446"><span class="id" title="binder"><span id="la:447" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dlw:448" class="idref" href="#dlw:448"><span class="id" title="binder"><span id="dlw:449" class="id">dlw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:445"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:444"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#26a760c16d28e84a5f0b2e2dc6404e06"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:446"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:448"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:448"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:439"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:444"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:442"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:444"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:442"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:439"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:445"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:440"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:445"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:440"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#26a760c16d28e84a5f0b2e2dc6404e06"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq1:440"><span class="id" title="variable">dq1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:442"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:439"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#26a760c16d28e84a5f0b2e2dc6404e06"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:439"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq2:441"><span class="id" title="variable">dq2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:443"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> (<span class="id" title="var">mem</span> <span class="id" title="var">dfracs</span>) "[Hmem [Hif Hif'] ]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ((<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> "Hif'" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> "Hif'" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Not&nbsp;the&nbsp;world's&nbsp;most&nbsp;beautiful&nbsp;lemma,&nbsp;but&nbsp;it&nbsp;does&nbsp;avoid&nbsp;us&nbsp;having&nbsp;to&nbsp;fiddle&nbsp;around&nbsp;with&nbsp;a&nbsp;later&nbsp;under&nbsp;an&nbsp;if&nbsp;in&nbsp;proofs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_clater" class="idref" href="#memMap_resource_2gen_clater"><span class="id" title="lemma">memMap_resource_2gen_clater</span></a> (<a id="la1:450" class="idref" href="#la1:450"><span class="id" title="binder">la1</span></a> <a id="la2:451" class="idref" href="#la2:451"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:452" class="idref" href="#lw1:452"><span class="id" title="binder">lw1</span></a> <a id="lw2:453" class="idref" href="#lw2:453"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="9a53763ceb21cb14a45900b91bec2b18" class="idref" href="#9a53763ceb21cb14a45900b91bec2b18"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#9a53763ceb21cb14a45900b91bec2b18"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:450"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:452"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:451"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:450"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#9a53763ceb21cb14a45900b91bec2b18"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:451"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:453"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> (<span class="id" title="notation">∃</span> <a id="lmem:455" class="idref" href="#lmem:455"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:456" class="idref" href="#la:456"><span class="id" title="binder"><span id="la:457" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:458" class="idref" href="#lw:458"><span class="id" title="binder"><span id="lw:459" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:455"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#9a53763ceb21cb14a45900b91bec2b18"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:456"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:458"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:451"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:450"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:455"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:450"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:452"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:455"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:450"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:452"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hc1 Hc2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iNext</span>. <span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;More&nbsp;general&nbsp;lemmas&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_clater_dq" class="idref" href="#memMap_resource_2gen_clater_dq"><span class="id" title="lemma">memMap_resource_2gen_clater_dq</span></a> (<a id="la1:460" class="idref" href="#la1:460"><span class="id" title="binder">la1</span></a> <a id="la2:461" class="idref" href="#la2:461"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="dq1:462" class="idref" href="#dq1:462"><span class="id" title="binder">dq1</span></a> <a id="dq2:463" class="idref" href="#dq2:463"><span class="id" title="binder">dq2</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="lw1:464" class="idref" href="#lw1:464"><span class="id" title="binder">lw1</span></a> <a id="lw2:465" class="idref" href="#lw2:465"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="ce8b0ccdd306ef41d33a0f2ae7fec60f" class="idref" href="#ce8b0ccdd306ef41d33a0f2ae7fec60f"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#ce8b0ccdd306ef41d33a0f2ae7fec60f"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:460"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq1:462"><span class="id" title="variable">dq1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:464"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:461"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:460"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#ce8b0ccdd306ef41d33a0f2ae7fec60f"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:461"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq2:463"><span class="id" title="variable">dq2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:465"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">∃</span> <a id="lmem:467" class="idref" href="#lmem:467"><span class="id" title="binder">lmem</span></a> <a id="dfracs:468" class="idref" href="#dfracs:468"><span class="id" title="binder">dfracs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:469" class="idref" href="#la:469"><span class="id" title="binder"><span id="la:470" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dlw:471" class="idref" href="#dlw:471"><span class="id" title="binder"><span id="dlw:472" class="id">dlw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:468"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:467"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#ce8b0ccdd306ef41d33a0f2ae7fec60f"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:469"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:471"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:471"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:461"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:460"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:467"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:460"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:464"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:467"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:460"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:464"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:461"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:460"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:468"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:460"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:462"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:468"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:460"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:462"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hc1 Hc2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>),(<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">dq1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>),(<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">dq1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_delete" class="idref" href="#memMap_delete"><span class="id" title="lemma">memMap_delete</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="la:473" class="idref" href="#la:473"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:474" class="idref" href="#lw:474"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <a id="lmem:475" class="idref" href="#lmem:475"><span class="id" title="binder">lmem</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:475"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:473"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:474"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:476" class="idref" href="#la:476"><span class="id" title="binder"><span id="la:477" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:478" class="idref" href="#lw:478"><span class="id" title="binder"><span id="lw:479" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:475"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:476"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:478"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#la:473"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:474"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:480" class="idref" href="#k:480"><span class="id" title="binder"><span id="k:481" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:482" class="idref" href="#y:482"><span class="id" title="binder"><span id="y:483" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">delete</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:473"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:475"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:480"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:482"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">lmem</span> <span class="id" title="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <a id="mem_remove_dq" class="idref" href="#mem_remove_dq"><span class="id" title="lemma">mem_remove_dq</span></a> <a id="lmem:484" class="idref" href="#lmem:484"><span class="id" title="binder">lmem</span></a> <a id="dq:485" class="idref" href="#dq:485"><span class="id" title="binder">dq</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:486" class="idref" href="#la:486"><span class="id" title="binder"><span id="la:487" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:488" class="idref" href="#lw:488"><span class="id" title="binder"><span id="lw:489" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:484"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:486"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:485"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:488"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊣⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:490" class="idref" href="#la:490"><span class="id" title="binder"><span id="la:491" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:492" class="idref" href="#dw:492"><span class="id" title="binder"><span id="dw:493" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:484"><span class="id" title="variable">lmem</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#dq:485"><span class="id" title="variable">dq</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lmem:484"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:490"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:492"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:492"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInduction</span> (<span class="id" title="var">lmem</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">la</span> <span class="id" title="var">k</span> <span class="id" title="var">lmem</span>] "IH" <span class="id" title="keyword">using</span> <span class="id" title="lemma">map_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span> <span class="id" title="lemma">dom_empty_L</span> <span class="id" title="lemma">elements_empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/= /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <span class="id" title="lemma">merge_empty</span> <span class="id" title="lemma">big_sepM_empty</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">dom_insert_L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">elements</span> (<span class="id" title="notation">{[</span><span class="id" title="var">la</span><span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>) <span class="id" title="notation">≡ₚ</span> <span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">elements_union_singleton</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default_permutation"><span class="id" title="axiom">create_gmap_default_permutation</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dq</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hperm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hperm</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Ha Hmem]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_merge</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_op"><span class="id" title="definition">prod_op</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="var">dq</span> <span class="id" title="notation">!!</span> <span class="id" title="var">la</span>);<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "IH". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Ha Hmem]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_merge</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_op"><span class="id" title="definition">prod_op</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="var">dq</span> <span class="id" title="notation">!!</span> <span class="id" title="var">la</span>);<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "IH". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;more&nbsp;general&nbsp;version&nbsp;of&nbsp;load&nbsp;to&nbsp;work&nbsp;also&nbsp;with&nbsp;any&nbsp;fraction&nbsp;and&nbsp;persistent&nbsp;points&nbsp;tos&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_valid_inSepM_general" class="idref" href="#gen_mem_valid_inSepM_general"><span class="id" title="lemma">gen_mem_valid_inSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:494" class="idref" href="#lmem:494"><span class="id" title="binder">lmem</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)) (<a id="lmem':495" class="idref" href="#lmem':495"><span class="id" title="binder">lmem'</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la:496" class="idref" href="#la:496"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:497" class="idref" href="#lw:497"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="dq:498" class="idref" href="#dq:498"><span class="id" title="binder">dq</span></a> : <span class="id" title="inductive">dfrac</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:494"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:496"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:498"><span class="id" title="variable">dq</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:497"><span class="id" title="variable">lw</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':495"><span class="id" title="variable">lmem'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:499" class="idref" href="#a:499"><span class="id" title="binder"><span id="a:500" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="dqw:501" class="idref" href="#dqw:501"><span class="id" title="binder"><span id="dqw:502" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:494"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:499"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:501"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:501"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#lmem':495"><span class="id" title="variable">lmem'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:496"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:497"><span class="id" title="variable">lw</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lmem</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">dq</span> <span class="id" title="var">Hmem_pc</span>) "Hm Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hpc_a Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpc_a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_valid_inSepM" class="idref" href="#gen_mem_valid_inSepM"><span class="id" title="lemma">gen_mem_valid_inSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:503" class="idref" href="#lmem:503"><span class="id" title="binder">lmem</span></a> <a id="lm:504" class="idref" href="#lm:504"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="la:505" class="idref" href="#la:505"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:506" class="idref" href="#lw:506"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:503"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:505"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:506"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:504"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:507" class="idref" href="#la:507"><span class="id" title="binder"><span id="la:508" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:509" class="idref" href="#lw:509"><span class="id" title="binder"><span id="lw:510" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:503"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:507"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:509"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#lm:504"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:505"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:506"><span class="id" title="variable">lw</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">Hmem_pc</span>) "Hm Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#memMap_delete"><span class="id" title="axiom">memMap_delete</span></a> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hpc_a Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpc_a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_update_inSepM" class="idref" href="#gen_mem_update_inSepM"><span class="id" title="lemma">gen_mem_update_inSepM</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="616a46c7ef5d4a32e5be8d319ab1e242" class="idref" href="#616a46c7ef5d4a32e5be8d319ab1e242"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>} {<a id="gen_heapG0:512" class="idref" href="#gen_heapG0:512"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#616a46c7ef5d4a32e5be8d319ab1e242"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="lmem:513" class="idref" href="#lmem:513"><span class="id" title="binder">lmem</span></a> <a id="lmem':514" class="idref" href="#lmem':514"><span class="id" title="binder">lmem'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="la:515" class="idref" href="#la:515"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:516" class="idref" href="#lw:516"><span class="id" title="binder">lw</span></a> <a id="lw':517" class="idref" href="#lw':517"><span class="id" title="binder">lw'</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem':514"><span class="id" title="variable">lmem'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:515"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw':517"><span class="id" title="variable">lw'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:513"><span class="id" title="variable">lmem</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:518" class="idref" href="#la:518"><span class="id" title="binder"><span id="la:519" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:520" class="idref" href="#lw:520"><span class="id" title="binder"><span id="lw:521" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':514"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:518"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:520"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la:515"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:516"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:522" class="idref" href="#a:522"><span class="id" title="binder"><span id="a:523" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:524" class="idref" href="#w:524"><span class="id" title="binder"><span id="w:525" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la:515"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:516"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem'</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:522"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:524"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span>);[|<span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "[$Hmap $Hl]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_delete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">insert_delete_insert</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;FAIL&nbsp;RULES&nbsp;----------------------------------&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Bind&nbsp;Scope&nbsp;expr_scope&nbsp;with&nbsp;language.expr&nbsp;cap_lang.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC" class="idref" href="#wp_notCorrectPC"><span class="id" title="lemma">wp_notCorrectPC</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">forall</span> <a id="E:526" class="idref" href="#E:526"><span class="id" title="binder">E</span></a> (<a id="lw:527" class="idref" href="#lw:527"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:527"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:527"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:526"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:527"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hnpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">ϕ</span>) "HPC Hϕ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">nt</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">ns</span>) "Hσ1 /="; <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr HPC"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">fupd_frame_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">e1</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_fail_inv"><span class="id" title="axiom">step_fail_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> [-&gt; -&gt;]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">intro</span> <span class="id" title="var">contra</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">contra</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hϕ HPC"; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hϕ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Subcases&nbsp;for&nbsp;respecitvely&nbsp;permissions&nbsp;and&nbsp;bounds&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC_perm" class="idref" href="#wp_notCorrectPC_perm"><span class="id" title="lemma">wp_notCorrectPC_perm</span></a> <a id="E:528" class="idref" href="#E:528"><span class="id" title="binder">E</span></a> <a id="pc_p:529" class="idref" href="#pc_p:529"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:530" class="idref" href="#pc_b:530"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:531" class="idref" href="#pc_e:531"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:532" class="idref" href="#pc_a:532"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:533" class="idref" href="#pc_v:533"><span class="id" title="binder">pc_v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#pc_p:529"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.machine_base.html#RX"><span class="id" title="constructor">RX</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:529"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:529"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:530"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:531"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:532"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:533"><span class="id" title="variable">pc_v</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:528"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <span class="id" title="notation">True</span> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hperm</span> φ) "HPC Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_notCorrectPC"><span class="id" title="axiom">wp_notCorrectPC</span></a> <span class="id" title="notation">with</span> "[HPC]"<span class="id" title="notation">)</span> ; [<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#not_isCorrectLPC_perm"><span class="id" title="axiom">not_isCorrectLPC_perm</span></a>; <span class="id" title="tactic">eauto</span>|<span class="id" title="var">iFrame</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "HPC /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC_range" class="idref" href="#wp_notCorrectPC_range"><span class="id" title="lemma">wp_notCorrectPC_range</span></a> <a id="E:534" class="idref" href="#E:534"><span class="id" title="binder">E</span></a> <a id="pc_p:535" class="idref" href="#pc_p:535"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:536" class="idref" href="#pc_b:536"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:537" class="idref" href="#pc_e:537"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:538" class="idref" href="#pc_a:538"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:539" class="idref" href="#pc_v:539"><span class="id" title="binder">pc_v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#pc_b:536"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.addr_reg.html#ecb49afb136c57143f8ddd1e3e9a03fe"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:538"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.addr_reg.html#ecb49afb136c57143f8ddd1e3e9a03fe"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:537"><span class="id" title="variable">pc_e</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:535"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:536"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:537"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:538"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:539"><span class="id" title="variable">pc_v</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:534"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <span class="id" title="notation">True</span> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hperm</span> φ) "HPC Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_notCorrectPC"><span class="id" title="axiom">wp_notCorrectPC</span></a> <span class="id" title="notation">with</span> "[HPC]"<span class="id" title="notation">)</span> ; [<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#not_isCorrectLPC_bounds"><span class="id" title="axiom">not_isCorrectLPC_bounds</span></a>; <span class="id" title="tactic">eauto</span>|<span class="id" title="var">iFrame</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "HPC /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;ATOMIC&nbsp;RULES&nbsp;--------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_halt" class="idref" href="#wp_halt"><span class="id" title="lemma">wp_halt</span></a> <a id="E:540" class="idref" href="#E:540"><span class="id" title="binder">E</span></a> <a id="pc_p:541" class="idref" href="#pc_p:541"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:542" class="idref" href="#pc_b:542"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:543" class="idref" href="#pc_e:543"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:544" class="idref" href="#pc_a:544"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:545" class="idref" href="#pc_v:545"><span class="id" title="binder">pc_v</span></a> <a id="lw:546" class="idref" href="#lw:546"><span class="id" title="binder">lw</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:546"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#Halt"><span class="id" title="constructor">Halt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:541"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:542"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:543"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:544"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:545"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:541"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:542"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:543"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:544"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:545"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:544"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:545"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:546"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:540"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#HaltedV"><span class="id" title="constructor">HaltedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:541"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:542"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:543"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:544"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:545"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:544"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:545"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:546"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinstr</span> <span class="id" title="var">Hvpc</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (φ) "[Hpc Hpca] Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">nt</span>) "Hσ1 /=". <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr Hpc"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpca"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">rewrite</span> -/((<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_correct_PC"><span class="id" title="axiom">state_corresponds_mem_correct_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>. <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hφ Hpc Hpca"; <span class="id" title="var">last</span> (<span class="id" title="var">iApply</span> "Hφ" ; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_fail" class="idref" href="#wp_fail"><span class="id" title="lemma">wp_fail</span></a> <a id="E:547" class="idref" href="#E:547"><span class="id" title="binder">E</span></a> <a id="pc_p:548" class="idref" href="#pc_p:548"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:549" class="idref" href="#pc_b:549"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:550" class="idref" href="#pc_e:550"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:551" class="idref" href="#pc_a:551"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:552" class="idref" href="#pc_v:552"><span class="id" title="binder">pc_v</span></a> <a id="lw:553" class="idref" href="#lw:553"><span class="id" title="binder">lw</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:553"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#Fail"><span class="id" title="constructor">Fail</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:548"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:549"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:550"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:551"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:552"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:548"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:549"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:550"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:551"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:552"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:551"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:552"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:553"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:547"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:548"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:549"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:550"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:551"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:552"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:551"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:552"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:553"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinstr</span> <span class="id" title="var">Hvpc</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (φ) "[Hpc Hpca] Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">nt</span>) "Hσ1 /=". <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr Hpc"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpca"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">rewrite</span> -/((<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_correct_PC"><span class="id" title="axiom">state_corresponds_mem_correct_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>. <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hφ Hpc Hpca"; <span class="id" title="var">last</span> (<span class="id" title="var">iApply</span> "Hφ" ; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;PURE&nbsp;RULES&nbsp;----------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_safe</span> := <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_puredet</span> := <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">inv_head_step</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_pure</span> := <span class="id" title="tactic">intros</span> ?; <span class="id" title="tactic">apply</span> <span class="id" title="lemma">nsteps_once</span>, <span class="id" title="lemma">pure_head_step_pure_step</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; [<span class="id" title="var">solve_exec_safe</span>|]; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="projection">head_step</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_failed" class="idref" href="#pure_seq_failed"><span class="id" title="instance">pure_seq_failed</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_halted" class="idref" href="#pure_seq_halted"><span class="id" title="instance">pure_seq_halted</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_done" class="idref" href="#pure_seq_done"><span class="id" title="instance">pure_seq_done</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules.rules_base.html#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Used&nbsp;to&nbsp;close&nbsp;the&nbsp;failing&nbsp;cases&nbsp;of&nbsp;the&nbsp;ftlr.<br/>
&nbsp;&nbsp;-&nbsp;Hcont&nbsp;is&nbsp;the&nbsp;(iris)&nbsp;name&nbsp;of&nbsp;the&nbsp;closing&nbsp;hypothesis&nbsp;(usually&nbsp;"Hφ")<br/>
&nbsp;&nbsp;-&nbsp;fail_case_name&nbsp;is&nbsp;one&nbsp;constructor&nbsp;of&nbsp;the&nbsp;spec_name,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;indicating&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;case<br/>
&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_case_name</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">fail_case_name</span> ; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailWP</span> <span class="id" title="var">Hcont</span> <span class="id" title="var">fail_case_name</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="var">cbn</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iApply</span> <span class="id" title="var">Hcont</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_case_name</span>).<br/>

<br/>
<span class="comment">(*&nbsp;-----------------&nbsp;useful&nbsp;definitions&nbsp;to&nbsp;factor&nbsp;out&nbsp;the&nbsp;wp&nbsp;specs&nbsp;----------------&nbsp;*)</span><br/>

<br/>
<span class="comment">(*---&nbsp;register&nbsp;equality&nbsp;---*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="addr_ne_reg_ne" class="idref" href="#addr_ne_reg_ne"><span class="id" title="lemma">addr_ne_reg_ne</span></a> {<a id="regs:554" class="idref" href="#regs:554"><span class="id" title="binder">regs</span></a> : <span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>} {<a id="r1:555" class="idref" href="#r1:555"><span class="id" title="binder">r1</span></a> <a id="r2:556" class="idref" href="#r2:556"><span class="id" title="binder">r2</span></a> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="p0:557" class="idref" href="#p0:557"><span class="id" title="binder">p0</span></a> <a id="b0:558" class="idref" href="#b0:558"><span class="id" title="binder">b0</span></a> <a id="e0:559" class="idref" href="#e0:559"><span class="id" title="binder">e0</span></a> <a id="a0:560" class="idref" href="#a0:560"><span class="id" title="binder">a0</span></a> <a id="p:561" class="idref" href="#p:561"><span class="id" title="binder">p</span></a> <a id="b:562" class="idref" href="#b:562"><span class="id" title="binder">b</span></a> <a id="e:563" class="idref" href="#e:563"><span class="id" title="binder">e</span></a> <a id="a:564" class="idref" href="#a:564"><span class="id" title="binder">a</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:554"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:555"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p0:557"><span class="id" title="variable">p0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b0:558"><span class="id" title="variable">b0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e0:559"><span class="id" title="variable">e0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0:560"><span class="id" title="variable">a0</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:554"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:556"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:561"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:562"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:563"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:564"><span class="id" title="variable">a</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0:560"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:564"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:555"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:556"><span class="id" title="variable">r2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hr1</span> <span class="id" title="var">Hr2</span> <span class="id" title="var">Hne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">decide</span> (<span class="id" title="var">r1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">r2</span>)); <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;regs_of&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="regs_of_argument" class="idref" href="#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> (<a id="arg:565" class="idref" href="#arg:565"><span class="id" title="binder">arg</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e03f39daf98516fa530d3f6f5a1b4d92"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>): <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#arg:565"><span class="id" title="variable">arg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#inl"><span class="id" title="constructor">inl</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#inr"><span class="id" title="constructor">inr</span></a> <span class="id" title="var">r</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="regs_of" class="idref" href="#regs_of"><span class="id" title="definition">regs_of</span></a> (<a id="i:567" class="idref" href="#i:567"><span class="id" title="binder">i</span></a>: <a class="idref" href="cap_machine.machine_base.html#instr"><span class="id" title="inductive">instr</span></a>): <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#i:567"><span class="id" title="variable">i</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Lea"><span class="id" title="constructor">Lea</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetP"><span class="id" title="constructor">GetP</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetB"><span class="id" title="constructor">GetB</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetE"><span class="id" title="constructor">GetE</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetA"><span class="id" title="constructor">GetA</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetOType"><span class="id" title="constructor">GetOType</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetWType"><span class="id" title="constructor">GetWType</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Add"><span class="id" title="constructor">Add</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Sub"><span class="id" title="constructor">Sub</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Mod"><span class="id" title="constructor">Mod</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Lt"><span class="id" title="constructor">Lt</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#HashConcat"><span class="id" title="constructor">HashConcat</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Hash"><span class="id" title="constructor">Hash</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Mov"><span class="id" title="constructor">Mov</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Restrict"><span class="id" title="constructor">Restrict</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Subseg"><span class="id" title="constructor">Subseg</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Load"><span class="id" title="constructor">Load</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Store"><span class="id" title="constructor">Store</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Jnz"><span class="id" title="constructor">Jnz</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Seal"><span class="id" title="constructor">Seal</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#UnSeal"><span class="id" title="constructor">UnSeal</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#IsUnique"><span class="id" title="constructor">IsUnique</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#EInit"><span class="id" title="constructor">EInit</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">r1</span><span class="id" title="notation">;</span><span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#EDeInit"><span class="id" title="constructor">EDeInit</span></a> <span class="id" title="var">r</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">r</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#EStoreId"><span class="id" title="constructor">EStoreId</span></a> <span class="id" title="var">rs</span> <span class="id" title="var">rd</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">rs</span><span class="id" title="notation">;</span> <span class="id" title="var">rd</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="indom_regs_incl" class="idref" href="#indom_regs_incl"><span class="id" title="lemma">indom_regs_incl</span></a> <a id="D:569" class="idref" href="#D:569"><span class="id" title="binder">D</span></a> (<a id="regs:570" class="idref" href="#regs:570"><span class="id" title="binder">regs</span></a> <a id="regs':571" class="idref" href="#regs':571"><span class="id" title="binder">regs'</span></a>: <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#D:569"><span class="id" title="variable">D</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:570"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:570"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':571"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="r:572" class="idref" href="#r:572"><span class="id" title="binder">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r:572"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#D:569"><span class="id" title="variable">D</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="w:573" class="idref" href="#w:573"><span class="id" title="binder">w</span></a>:<a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#regs:570"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:572"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:573"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#regs':571"><span class="id" title="variable">regs'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:572"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:573"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">HD</span> <span class="id" title="var">Hincl</span> <span class="id" title="var">rr</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <span class="id" title="var">rr</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> @<span class="id" title="method">elem_of_dom</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">D</span> := <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>). <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">elem_of_subseteq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="indom_lregs_incl" class="idref" href="#indom_lregs_incl"><span class="id" title="lemma">indom_lregs_incl</span></a> <a id="D:574" class="idref" href="#D:574"><span class="id" title="binder">D</span></a> (<a id="lregs:575" class="idref" href="#lregs:575"><span class="id" title="binder">lregs</span></a> <a id="lregs':576" class="idref" href="#lregs':576"><span class="id" title="binder">lregs'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#D:574"><span class="id" title="variable">D</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:575"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:575"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs':576"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="r:577" class="idref" href="#r:577"><span class="id" title="binder">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r:577"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#D:574"><span class="id" title="variable">D</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="w:578" class="idref" href="#w:578"><span class="id" title="binder">w</span></a>:<a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#lregs:575"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:577"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:578"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#lregs':576"><span class="id" title="variable">lregs'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:577"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:578"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">HD</span> <span class="id" title="var">Hincl</span> <span class="id" title="var">rr</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <span class="id" title="var">rr</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> @<span class="id" title="method">elem_of_dom</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">D</span> := <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>). <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">elem_of_subseteq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;incrementPC&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incrementPC" class="idref" href="#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a id="regs:579" class="idref" href="#regs:579"><span class="id" title="binder">regs</span></a>: <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:579"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a'</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_Some_inv" class="idref" href="#incrementPC_Some_inv"><span class="id" title="lemma">incrementPC_Some_inv</span></a> <a id="regs:580" class="idref" href="#regs:580"><span class="id" title="binder">regs</span></a> <a id="regs':581" class="idref" href="#regs':581"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:580"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':581"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:582" class="idref" href="#p:582"><span class="id" title="binder">p</span></a> <a id="b:583" class="idref" href="#b:583"><span class="id" title="binder">b</span></a> <a id="e:584" class="idref" href="#e:584"><span class="id" title="binder">e</span></a> <a id="a:585" class="idref" href="#a:585"><span class="id" title="binder">a</span></a> <a id="a':586" class="idref" href="#a':586"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:580"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:582"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:583"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:584"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:585"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:585"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':586"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':581"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:582"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:583"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:584"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':586"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> | ] | ] | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 5 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_None_inv" class="idref" href="#incrementPC_None_inv"><span class="id" title="lemma">incrementPC_None_inv</span></a> <a id="regs:587" class="idref" href="#regs:587"><span class="id" title="binder">regs</span></a> <a id="pg:588" class="idref" href="#pg:588"><span class="id" title="binder">pg</span></a> <a id="b:589" class="idref" href="#b:589"><span class="id" title="binder">b</span></a> <a id="e:590" class="idref" href="#e:590"><span class="id" title="binder">e</span></a> <a id="a:591" class="idref" href="#a:591"><span class="id" title="binder">a</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:587"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:587"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pg:588"><span class="id" title="variable">pg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:589"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:590"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:591"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:591"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> | ] | ] |];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_overflow_mono" class="idref" href="#incrementPC_overflow_mono"><span class="id" title="lemma">incrementPC_overflow_mono</span></a> <a id="regs:592" class="idref" href="#regs:592"><span class="id" title="binder">regs</span></a> <a id="regs':593" class="idref" href="#regs':593"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:592"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#regs:592"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:592"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':593"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':593"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">HPC</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span> <span class="id" title="var">HPC</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">HPC'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HPC</span> <span class="id" title="var">HPC'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span> |- *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">aa</span> | ] | ]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">aa</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_overflow_antimono" class="idref" href="#incrementPC_overflow_antimono"><span class="id" title="lemma">incrementPC_overflow_antimono</span></a> <a id="regs:594" class="idref" href="#regs:594"><span class="id" title="binder">regs</span></a> <a id="regs':595" class="idref" href="#regs':595"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:594"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':595"><span class="id" title="variable">regs'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:594"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':595"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hincl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs'</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HrpPC</span>; <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HrpPC</span> <span class="id" title="var">Hincl</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*&nbsp;todo:&nbsp;instead,&nbsp;define&nbsp;updatePC&nbsp;on&nbsp;top&nbsp;of&nbsp;incrementPC&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_fail_updatePC" class="idref" href="#incrementPC_fail_updatePC"><span class="id" title="lemma">incrementPC_fail_updatePC</span></a> <a id="regs:596" class="idref" href="#regs:596"><span class="id" title="binder">regs</span></a> <a id="m:597" class="idref" href="#m:597"><span class="id" title="binder">m</span></a> <a id="etbl:598" class="idref" href="#etbl:598"><span class="id" title="binder">etbl</span></a> <a id="ecur:599" class="idref" href="#ecur:599"><span class="id" title="binder">ecur</span></a>:<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:596"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:596"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:597"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:598"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:599"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a'</span> | ] |]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a'</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_success_updatePC" class="idref" href="#incrementPC_success_updatePC"><span class="id" title="lemma">incrementPC_success_updatePC</span></a> <a id="regs:600" class="idref" href="#regs:600"><span class="id" title="binder">regs</span></a> <a id="m:601" class="idref" href="#m:601"><span class="id" title="binder">m</span></a> <a id="etbl:602" class="idref" href="#etbl:602"><span class="id" title="binder">etbl</span></a> <a id="ecur:603" class="idref" href="#ecur:603"><span class="id" title="binder">ecur</span></a> <a id="regs':604" class="idref" href="#regs':604"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:600"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':604"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="p:605" class="idref" href="#p:605"><span class="id" title="binder">p</span></a> <a id="b:606" class="idref" href="#b:606"><span class="id" title="binder">b</span></a> <a id="e:607" class="idref" href="#e:607"><span class="id" title="binder">e</span></a> <a id="a:608" class="idref" href="#a:608"><span class="id" title="binder">a</span></a> <a id="a':609" class="idref" href="#a':609"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:600"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:605"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:606"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:607"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:608"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:608"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':609"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:600"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:601"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:602"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:603"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:605"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:606"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:607"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':609"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:601"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:602"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:603"><span class="id" title="variable">ecur</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':604"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:605"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:606"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:607"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':609"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a'</span>|]|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a'</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:?; [| <span class="id" title="tactic">congruence</span>]. <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span> <span class="id" title="var">regs'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 5 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_success_incl" class="idref" href="#updatePC_success_incl"><span class="id" title="lemma">updatePC_success_incl</span></a> <a id="m:610" class="idref" href="#m:610"><span class="id" title="binder">m</span></a> <a id="m':611" class="idref" href="#m':611"><span class="id" title="binder">m'</span></a> <a id="regs:612" class="idref" href="#regs:612"><span class="id" title="binder">regs</span></a> <a id="regs':613" class="idref" href="#regs':613"><span class="id" title="binder">regs'</span></a> <a id="etbl:614" class="idref" href="#etbl:614"><span class="id" title="binder">etbl</span></a> <a id="etbl':615" class="idref" href="#etbl':615"><span class="id" title="binder">etbl'</span></a> <a id="ecur:616" class="idref" href="#ecur:616"><span class="id" title="binder">ecur</span></a> <a id="ecur':617" class="idref" href="#ecur':617"><span class="id" title="binder">ecur'</span></a> <a id="w:618" class="idref" href="#w:618"><span class="id" title="binder">w</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:612"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':613"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:612"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:610"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:614"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:616"><span class="id" title="variable">ecur</span></a> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:618"><span class="id" title="variable">w</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:610"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:614"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:616"><span class="id" title="variable">ecur</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs':613"><span class="id" title="variable">regs'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':611"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':615"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':617"><span class="id" title="variable">ecur'</span></a> |}<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:618"><span class="id" title="variable">w</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs'</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':611"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':615"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':617"><span class="id" title="variable">ecur'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hincl</span> <span class="id" title="var">Hu</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ <span class="id" title="var">w1</span> |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hrr</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hrr</span> <span class="id" title="var">Hincl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hregs'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hregs'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w1</span> <span class="id" title="keyword">as</span> [|[ ? ? ? <span class="id" title="var">a1</span>|] | ]; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ha1</span>; <span class="id" title="var">simplify_eq</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HH</span>: <span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="reg1:619" class="idref" href="#reg1:619"><span class="id" title="binder"><span id="reg1:621" class="id">reg1</span></span></a> <a id="reg2:620" class="idref" href="#reg2:620"><span class="id" title="binder"><span id="reg2:622" class="id">reg2</span></span></a>:<a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#reg1:619"><span class="id" title="variable">reg1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg2:620"><span class="id" title="variable">reg2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg1:619"><span class="id" title="variable">reg1</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg2:620"><span class="id" title="variable">reg2</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">intros</span> * -&gt;; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">Hu</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HH</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">lookup_insert</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;{  <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hu</span>. }<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_fail_incl" class="idref" href="#updatePC_fail_incl"><span class="id" title="lemma">updatePC_fail_incl</span></a> <a id="m:623" class="idref" href="#m:623"><span class="id" title="binder">m</span></a> <a id="m':624" class="idref" href="#m':624"><span class="id" title="binder">m'</span></a> <a id="regs:625" class="idref" href="#regs:625"><span class="id" title="binder">regs</span></a> <a id="regs':626" class="idref" href="#regs':626"><span class="id" title="binder">regs'</span></a> <a id="etbl:627" class="idref" href="#etbl:627"><span class="id" title="binder">etbl</span></a> <a id="etbl':628" class="idref" href="#etbl':628"><span class="id" title="binder">etbl'</span></a> <a id="ecur:629" class="idref" href="#ecur:629"><span class="id" title="binder">ecur</span></a> <a id="ecur':630" class="idref" href="#ecur':630"><span class="id" title="binder">ecur'</span></a>  :<br/>
&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#regs:625"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:625"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':626"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:625"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:623"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:627"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:629"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs':626"><span class="id" title="variable">regs'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':624"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':628"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':630"><span class="id" title="variable">ecur'</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> <span class="id" title="var">HPC</span>] <span class="id" title="var">Hincl</span> <span class="id" title="var">Hfail</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hfail</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">HPC</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfail</span>. <span class="id" title="var">have</span> -&gt; := <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a1</span> | ] |]; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>;[].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">incrementPC_inv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC_Some_inv"><span class="id" title="axiom">incrementPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC_None_inv"><span class="id" title="axiom">incrementPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_incrementPC" class="idref" href="#updatePC_incrementPC"><span class="id" title="lemma">updatePC_incrementPC</span></a> {<a id="e5ca5d7884148fcf4d6e64202bd45adf" class="idref" href="#e5ca5d7884148fcf4d6e64202bd45adf"><span class="id" title="binder">φ</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e5ca5d7884148fcf4d6e64202bd45adf"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="r':632" class="idref" href="#r':632"><span class="id" title="binder">r'</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e5ca5d7884148fcf4d6e64202bd45adf"><span class="id" title="variable">φ</span></a>) <span class="id" title="notation">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e5ca5d7884148fcf4d6e64202bd45adf"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r':632"><span class="id" title="variable">r'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a>, <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a>, <a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;incrementLPC&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incrementLPC" class="idref" href="#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> (<a id="regs:633" class="idref" href="#regs:633"><span class="id" title="binder">regs</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:633"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a'</span> <span class="id" title="var">v</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementLPC_Some_inv" class="idref" href="#incrementLPC_Some_inv"><span class="id" title="lemma">incrementLPC_Some_inv</span></a> <a id="lregs:634" class="idref" href="#lregs:634"><span class="id" title="binder">lregs</span></a> <a id="lregs':635" class="idref" href="#lregs':635"><span class="id" title="binder">lregs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:634"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs':635"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:636" class="idref" href="#p:636"><span class="id" title="binder">p</span></a> <a id="b:637" class="idref" href="#b:637"><span class="id" title="binder">b</span></a> <a id="e:638" class="idref" href="#e:638"><span class="id" title="binder">e</span></a> <a id="a:639" class="idref" href="#a:639"><span class="id" title="binder">a</span></a> <a id="v:640" class="idref" href="#v:640"><span class="id" title="binder">v</span></a> <a id="a':641" class="idref" href="#a':641"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:634"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:636"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:637"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:638"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:639"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:640"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:639"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':641"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs':635"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:636"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:637"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:638"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':641"><span class="id" title="variable">a'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:640"><span class="id" title="variable">v</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> ? | ] | ] | ]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 6 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementLPC_None_inv" class="idref" href="#incrementLPC_None_inv"><span class="id" title="lemma">incrementLPC_None_inv</span></a> <a id="lregs:642" class="idref" href="#lregs:642"><span class="id" title="binder">lregs</span></a> <a id="pg:643" class="idref" href="#pg:643"><span class="id" title="binder">pg</span></a> <a id="b:644" class="idref" href="#b:644"><span class="id" title="binder">b</span></a> <a id="e:645" class="idref" href="#e:645"><span class="id" title="binder">e</span></a> <a id="a:646" class="idref" href="#a:646"><span class="id" title="binder">a</span></a> <a id="v:647" class="idref" href="#v:647"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:642"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:642"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pg:643"><span class="id" title="variable">pg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:644"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:645"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:646"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:647"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:646"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> ? | ] | ] |]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">incrementLPC_inv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_Some_inv"><span class="id" title="axiom">incrementLPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_None_inv"><span class="id" title="axiom">incrementLPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "incrementLPC_inv" "as" <span class="id" title="var">simple_intropattern</span>(<span class="id" title="var">pat</span>):=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_Some_inv"><span class="id" title="axiom">incrementLPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">pat</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_None_inv"><span class="id" title="axiom">incrementLPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_rules_opt" class="idref" href="#cap_lang_rules_opt"><span class="id" title="section">cap_lang_rules_opt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:648" class="idref" href="#H:648"><span class="id" title="binder">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{ <a id="reservedaddresses:649" class="idref" href="#reservedaddresses:649"><span class="id" title="binder">reservedaddresses</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#ReservedAddresses"><span class="id" title="class">ReservedAddresses</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="ceriseg:651" class="idref" href="#ceriseg:651"><span class="id" title="binder">ceriseg</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#ceriseG"><span class="id" title="class">ceriseG</span></a> <a id="523163161c95e98e19ea9d52d8ec3151" class="idref" href="#523163161c95e98e19ea9d52d8ec3151"><span class="id" title="binder">Σ</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">c</span> : <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">la</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lw</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lregs</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">mem</span> : <a class="idref" href="cap_machine.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lmem</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="wp_opt" class="idref" href="#wp_opt"><span class="id" title="definition">wp_opt</span></a> {<a id="A:652" class="idref" href="#A:652"><span class="id" title="binder">A</span></a>} (<a id="a2c220b107a3d538f4673672a451f434" class="idref" href="#a2c220b107a3d538f4673672a451f434"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:652"><span class="id" title="variable">A</span></a>) (<a id="bb68ed542dba3e6a8c22c22fb3ec5a95" class="idref" href="#bb68ed542dba3e6a8c22c22fb3ec5a95"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="98024075b9d1cd78ceb311949455b86a" class="idref" href="#98024075b9d1cd78ceb311949455b86a"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:652"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#a2c220b107a3d538f4673672a451f434"><span class="id" title="variable">φ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#bb68ed542dba3e6a8c22c22fb3ec5a95"><span class="id" title="variable">Φf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> φ' =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#98024075b9d1cd78ceb311949455b86a"><span class="id" title="variable">Φs</span></a> φ'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_unfold" class="idref" href="#wp_opt_unfold"><span class="id" title="lemma">wp_opt_unfold</span></a> {<a id="A:657" class="idref" href="#A:657"><span class="id" title="binder">A</span></a>} {<a id="235f3d3f33730773e6945dde21629a10" class="idref" href="#235f3d3f33730773e6945dde21629a10"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:657"><span class="id" title="variable">A</span></a>} {<a id="a300200322b5c5372fec7c545cf30db4" class="idref" href="#a300200322b5c5372fec7c545cf30db4"><span class="id" title="binder">Φf</span></a> <a id="05ab8214832efe520340e23466338db6" class="idref" href="#05ab8214832efe520340e23466338db6"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#235f3d3f33730773e6945dde21629a10"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#a300200322b5c5372fec7c545cf30db4"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:661" class="idref" href="#x:661"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#235f3d3f33730773e6945dde21629a10"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:661"><span class="id" title="variable">x</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#05ab8214832efe520340e23466338db6"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:661"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#235f3d3f33730773e6945dde21629a10"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a300200322b5c5372fec7c545cf30db4"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#05ab8214832efe520340e23466338db6"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; [<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>| <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_eqn" class="idref" href="#wp_opt_eqn"><span class="id" title="lemma">wp_opt_eqn</span></a> {<a id="A:662" class="idref" href="#A:662"><span class="id" title="binder">A</span></a>} (<a id="241b49190e4dc16fdb5e61e2b4b419c1" class="idref" href="#241b49190e4dc16fdb5e61e2b4b419c1"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:662"><span class="id" title="variable">A</span></a>) (<a id="e01bc117c7e1b71d66bb3e65c54ce6ea" class="idref" href="#e01bc117c7e1b71d66bb3e65c54ce6ea"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="a871c4550a9f1a966ea84f638a3d2b1c" class="idref" href="#a871c4550a9f1a966ea84f638a3d2b1c"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:662"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#241b49190e4dc16fdb5e61e2b4b419c1"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e01bc117c7e1b71d66bb3e65c54ce6ea"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x:666" class="idref" href="#x:666"><span class="id" title="binder">x</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#241b49190e4dc16fdb5e61e2b4b419c1"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:666"><span class="id" title="variable">x</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#a871c4550a9f1a966ea84f638a3d2b1c"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:666"><span class="id" title="variable">x</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#241b49190e4dc16fdb5e61e2b4b419c1"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e01bc117c7e1b71d66bb3e65c54ce6ea"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a871c4550a9f1a966ea84f638a3d2b1c"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="var">cbn</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_is_Some" class="idref" href="#wp_opt_is_Some"><span class="id" title="lemma">wp_opt_is_Some</span></a> {<a id="A:667" class="idref" href="#A:667"><span class="id" title="binder">A</span></a> <a id="c81e64779db61e7bcf75331331d9ce18" class="idref" href="#c81e64779db61e7bcf75331331d9ce18"><span class="id" title="binder">Φs</span></a> <a id="6912f3ea0406e60afd8b9c0610ac5cea" class="idref" href="#6912f3ea0406e60afd8b9c0610ac5cea"><span class="id" title="binder">Φf</span></a>} {<a id="2b89da3ea59cf701ebbddaf99209d531" class="idref" href="#2b89da3ea59cf701ebbddaf99209d531"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:667"><span class="id" title="variable">A</span></a>} : <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#2b89da3ea59cf701ebbddaf99209d531"><span class="id" title="variable">φ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2b89da3ea59cf701ebbddaf99209d531"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6912f3ea0406e60afd8b9c0610ac5cea"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c81e64779db61e7bcf75331331d9ce18"><span class="id" title="variable">Φs</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2b89da3ea59cf701ebbddaf99209d531"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">False</span> <a class="idref" href="cap_machine.rules.rules_base.html#c81e64779db61e7bcf75331331d9ce18"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_univ" class="idref" href="#wp_opt_univ"><span class="id" title="lemma">wp_opt_univ</span></a> {<a id="A:671" class="idref" href="#A:671"><span class="id" title="binder">A</span></a> <a id="c779cd77469795bd5c46ba22d2b7250a" class="idref" href="#c779cd77469795bd5c46ba22d2b7250a"><span class="id" title="binder">Φs</span></a>} {<a id="47fea677c5a9304e0b9496296924de9a" class="idref" href="#47fea677c5a9304e0b9496296924de9a"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:671"><span class="id" title="variable">A</span></a>} : <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:674" class="idref" href="#x:674"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#c779cd77469795bd5c46ba22d2b7250a"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:674"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#47fea677c5a9304e0b9496296924de9a"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">True</span> <a class="idref" href="cap_machine.rules.rules_base.html#c779cd77469795bd5c46ba22d2b7250a"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> φ.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_bind" class="idref" href="#wp_opt_bind"><span class="id" title="lemma">wp_opt_bind</span></a> {<a id="A:675" class="idref" href="#A:675"><span class="id" title="binder">A</span></a> <a id="B:676" class="idref" href="#B:676"><span class="id" title="binder">B</span></a>} {<a id="33dfd0f6c8c54a088522f45e1abae69b" class="idref" href="#33dfd0f6c8c54a088522f45e1abae69b"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:675"><span class="id" title="variable">A</span></a>} {<a id="K:678" class="idref" href="#K:678"><span class="id" title="binder">K</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:675"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B:676"><span class="id" title="variable">B</span></a>} {<a id="d8a7159f73c0ae3c26d966b193479a71" class="idref" href="#d8a7159f73c0ae3c26d966b193479a71"><span class="id" title="binder">Φf</span></a> <a id="2a78add94d01b238fbb91b7ceab6eb28" class="idref" href="#2a78add94d01b238fbb91b7ceab6eb28"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#33dfd0f6c8c54a088522f45e1abae69b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d8a7159f73c0ae3c26d966b193479a71"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="5556a702756efcc20f958e08d021f3e4" class="idref" href="#5556a702756efcc20f958e08d021f3e4"><span class="id" title="binder">φ'</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#K:678"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5556a702756efcc20f958e08d021f3e4"><span class="id" title="variable">φ'</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#d8a7159f73c0ae3c26d966b193479a71"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2a78add94d01b238fbb91b7ceab6eb28"><span class="id" title="variable">Φs</span></a>) <span class="id" title="notation">⊣⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#33dfd0f6c8c54a088522f45e1abae69b"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">≫=</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:678"><span class="id" title="variable">K</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#d8a7159f73c0ae3c26d966b193479a71"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2a78add94d01b238fbb91b7ceab6eb28"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_mono" class="idref" href="#wp_opt_mono"><span class="id" title="lemma">wp_opt_mono</span></a> {<a id="A:682" class="idref" href="#A:682"><span class="id" title="binder">A</span></a>} {<a id="m:683" class="idref" href="#m:683"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:682"><span class="id" title="variable">A</span></a>} {<a id="80265bcf83b1fc2de03cd4a55540751f" class="idref" href="#80265bcf83b1fc2de03cd4a55540751f"><span class="id" title="binder">Φf</span></a> <a id="eb04d01c104fbbd6ceb6c70a07fac911" class="idref" href="#eb04d01c104fbbd6ceb6c70a07fac911"><span class="id" title="binder">Φs1</span></a> <a id="78a33418b89307f782e2be7de1782a54" class="idref" href="#78a33418b89307f782e2be7de1782a54"><span class="id" title="binder">Φs2</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:687" class="idref" href="#x:687"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#eb04d01c104fbbd6ceb6c70a07fac911"><span class="id" title="variable">Φs1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:687"><span class="id" title="variable">x</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#78a33418b89307f782e2be7de1782a54"><span class="id" title="variable">Φs2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:687"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#m:683"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#80265bcf83b1fc2de03cd4a55540751f"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#eb04d01c104fbbd6ceb6c70a07fac911"><span class="id" title="variable">Φs1</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#m:683"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#80265bcf83b1fc2de03cd4a55540751f"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#78a33418b89307f782e2be7de1782a54"><span class="id" title="variable">Φs2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(HΦs &amp; Hwp)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "HΦs".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="wp_opt2" class="idref" href="#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> {<a id="A1:688" class="idref" href="#A1:688"><span class="id" title="binder">A1</span></a> <a id="A2:689" class="idref" href="#A2:689"><span class="id" title="binder">A2</span></a>} (<a id="7aedf971447ecef646f663767a477fd8" class="idref" href="#7aedf971447ecef646f663767a477fd8"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:688"><span class="id" title="variable">A1</span></a>) (<a id="e68158232f8c6900688e7023fca22ace" class="idref" href="#e68158232f8c6900688e7023fca22ace"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:689"><span class="id" title="variable">A2</span></a>) (<a id="c00de6bd20e5e3937215582fad7993a8" class="idref" href="#c00de6bd20e5e3937215582fad7993a8"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="ac95c2a3c33a2e827ba1ce2a6be181d5" class="idref" href="#ac95c2a3c33a2e827ba1ce2a6be181d5"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:688"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:689"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#7aedf971447ecef646f663767a477fd8"><span class="id" title="variable">φ1</span></a> , <a class="idref" href="cap_machine.rules.rules_base.html#e68158232f8c6900688e7023fca22ace"><span class="id" title="variable">φ2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> , <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#c00de6bd20e5e3937215582fad7993a8"><span class="id" title="variable">Φf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x1</span> , <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x2</span> =&gt; <span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#ac95c2a3c33a2e827ba1ce2a6be181d5"><span class="id" title="variable">Φs</span></a> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_diag_univ" class="idref" href="#wp2_diag_univ"><span class="id" title="lemma">wp2_diag_univ</span></a> {<a id="A:696" class="idref" href="#A:696"><span class="id" title="binder">A</span></a>} {<a id="c4013822baa0c0ec839dd78803ea37a2" class="idref" href="#c4013822baa0c0ec839dd78803ea37a2"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:696"><span class="id" title="variable">A</span></a>} {<a id="0fe3b26f12ad56a0258297d6d006b881" class="idref" href="#0fe3b26f12ad56a0258297d6d006b881"><span class="id" title="binder">Φf</span></a>} {<a id="b83bf7804319db15f8efcd7886bbe5eb" class="idref" href="#b83bf7804319db15f8efcd7886bbe5eb"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:696"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:696"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#0fe3b26f12ad56a0258297d6d006b881"><span class="id" title="variable">Φf</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:700" class="idref" href="#x:700"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#b83bf7804319db15f8efcd7886bbe5eb"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:700"><span class="id" title="variable">x</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:700"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c4013822baa0c0ec839dd78803ea37a2"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c4013822baa0c0ec839dd78803ea37a2"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0fe3b26f12ad56a0258297d6d006b881"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b83bf7804319db15f8efcd7886bbe5eb"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; [<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span> | <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_wp2" class="idref" href="#wp_wp2"><span class="id" title="lemma">wp_wp2</span></a> {<a id="Ep:701" class="idref" href="#Ep:701"><span class="id" title="binder">Ep</span></a>} {<a id="A1:702" class="idref" href="#A1:702"><span class="id" title="binder">A1</span></a> <a id="A2:703" class="idref" href="#A2:703"><span class="id" title="binder">A2</span></a>} {<a id="0144716307b9c9847ef024a46329a2b6" class="idref" href="#0144716307b9c9847ef024a46329a2b6"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:702"><span class="id" title="variable">A1</span></a>} {<a id="4a146554658b17074c5e5b3e411bd197" class="idref" href="#4a146554658b17074c5e5b3e411bd197"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:703"><span class="id" title="variable">A2</span></a>} {<a id="f014e7cbaf4e2aa793016e4f81556841" class="idref" href="#f014e7cbaf4e2aa793016e4f81556841"><span class="id" title="binder">Φf</span></a> <a id="244fff577ac54451fdd1cd6c44d98cb4" class="idref" href="#244fff577ac54451fdd1cd6c44d98cb4"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0144716307b9c9847ef024a46329a2b6"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4a146554658b17074c5e5b3e411bd197"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f014e7cbaf4e2aa793016e4f81556841"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:708" class="idref" href="#x1:708"><span class="id" title="binder">x1</span></a> <a id="x2:709" class="idref" href="#x2:709"><span class="id" title="binder">x2</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#244fff577ac54451fdd1cd6c44d98cb4"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:709"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4a146554658b17074c5e5b3e411bd197"><span class="id" title="variable">φ2</span></a> (<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:701"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#f014e7cbaf4e2aa793016e4f81556841"><span class="id" title="variable">Φf</span></a>) (<span class="id" title="keyword">fun</span> <a id="x:710" class="idref" href="#x:710"><span class="id" title="binder">x</span></a> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:701"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#244fff577ac54451fdd1cd6c44d98cb4"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:710"><span class="id" title="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1 , φ2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> "Hk" <span class="id" title="keyword">as</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> "Hk" <span class="id" title="keyword">as</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_val" class="idref" href="#wp2_val"><span class="id" title="lemma">wp2_val</span></a> {<a id="A1:711" class="idref" href="#A1:711"><span class="id" title="binder">A1</span></a> <a id="A2:712" class="idref" href="#A2:712"><span class="id" title="binder">A2</span></a>} {<a id="x1:713" class="idref" href="#x1:713"><span class="id" title="binder">x1</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:711"><span class="id" title="variable">A1</span></a>} {<a id="x2:714" class="idref" href="#x2:714"><span class="id" title="binder">x2</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A2:712"><span class="id" title="variable">A2</span></a>} {<a id="d92964fd0f16080afa945e6aa604a0a3" class="idref" href="#d92964fd0f16080afa945e6aa604a0a3"><span class="id" title="binder">Φf</span></a> <a id="0f63956048d7e2c1c099a58e5c61e298" class="idref" href="#0f63956048d7e2c1c099a58e5c61e298"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#0f63956048d7e2c1c099a58e5c61e298"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:713"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:714"><span class="id" title="variable">x2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:713"><span class="id" title="variable">x1</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:714"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#d92964fd0f16080afa945e6aa604a0a3"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0f63956048d7e2c1c099a58e5c61e298"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_eqn" class="idref" href="#wp_opt2_eqn"><span class="id" title="lemma">wp_opt2_eqn</span></a> {<a id="A1:717" class="idref" href="#A1:717"><span class="id" title="binder">A1</span></a> <a id="A2:718" class="idref" href="#A2:718"><span class="id" title="binder">A2</span></a>} {<a id="35b5b9d456728227fd9334db08ede5a8" class="idref" href="#35b5b9d456728227fd9334db08ede5a8"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:717"><span class="id" title="variable">A1</span></a>} {<a id="53252fbc50b9a621feb5c2e7e2e8fb35" class="idref" href="#53252fbc50b9a621feb5c2e7e2e8fb35"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:718"><span class="id" title="variable">A2</span></a>} (<a id="c41d8ff9064060b32e5dfa700cbb4ada" class="idref" href="#c41d8ff9064060b32e5dfa700cbb4ada"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="df71862bb4298264b08552e29ad922bb" class="idref" href="#df71862bb4298264b08552e29ad922bb"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:717"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:718"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#35b5b9d456728227fd9334db08ede5a8"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#53252fbc50b9a621feb5c2e7e2e8fb35"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c41d8ff9064060b32e5dfa700cbb4ada"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:723" class="idref" href="#x1:723"><span class="id" title="binder">x1</span></a> <a id="x2:724" class="idref" href="#x2:724"><span class="id" title="binder">x2</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#35b5b9d456728227fd9334db08ede5a8"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:723"><span class="id" title="variable">x1</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#53252fbc50b9a621feb5c2e7e2e8fb35"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:724"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#df71862bb4298264b08552e29ad922bb"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:723"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:724"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#35b5b9d456728227fd9334db08ede5a8"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#53252fbc50b9a621feb5c2e7e2e8fb35"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c41d8ff9064060b32e5dfa700cbb4ada"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df71862bb4298264b08552e29ad922bb"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_eqn_both" class="idref" href="#wp_opt2_eqn_both"><span class="id" title="lemma">wp_opt2_eqn_both</span></a> {<a id="A1:725" class="idref" href="#A1:725"><span class="id" title="binder">A1</span></a> <a id="A2:726" class="idref" href="#A2:726"><span class="id" title="binder">A2</span></a>} {<a id="e833265df39b453237a81281cc10f7de" class="idref" href="#e833265df39b453237a81281cc10f7de"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:725"><span class="id" title="variable">A1</span></a>} {<a id="622cdc8c0dc6bbdda69edbec09253678" class="idref" href="#622cdc8c0dc6bbdda69edbec09253678"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:726"><span class="id" title="variable">A2</span></a>} (<a id="e3c9bf02377fbd6118cd08b8c2b27fef" class="idref" href="#e3c9bf02377fbd6118cd08b8c2b27fef"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="507615542346c16c333045d76bae469b" class="idref" href="#507615542346c16c333045d76bae469b"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:725"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:726"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e833265df39b453237a81281cc10f7de"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#622cdc8c0dc6bbdda69edbec09253678"><span class="id" title="variable">φ2</span></a> (<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#e833265df39b453237a81281cc10f7de"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#622cdc8c0dc6bbdda69edbec09253678"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#e3c9bf02377fbd6118cd08b8c2b27fef"><span class="id" title="variable">Φf</span></a>) (<span class="id" title="keyword">fun</span> <a id="x1:731" class="idref" href="#x1:731"><span class="id" title="binder">x1</span></a> <a id="x2:732" class="idref" href="#x2:732"><span class="id" title="binder">x2</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#e833265df39b453237a81281cc10f7de"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:731"><span class="id" title="variable">x1</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#622cdc8c0dc6bbdda69edbec09253678"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:732"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#507615542346c16c333045d76bae469b"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:731"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:732"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e833265df39b453237a81281cc10f7de"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#622cdc8c0dc6bbdda69edbec09253678"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e3c9bf02377fbd6118cd08b8c2b27fef"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#507615542346c16c333045d76bae469b"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_mod" class="idref" href="#wp_opt2_mod"><span class="id" title="lemma">wp_opt2_mod</span></a> {<a id="A1:733" class="idref" href="#A1:733"><span class="id" title="binder">A1</span></a> <a id="A2:734" class="idref" href="#A2:734"><span class="id" title="binder">A2</span></a>} {<a id="3592633beaf64a64ed89a89d2e097ca6" class="idref" href="#3592633beaf64a64ed89a89d2e097ca6"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:733"><span class="id" title="variable">A1</span></a>} {<a id="44ae6912827cc6f02a80529f2accea93" class="idref" href="#44ae6912827cc6f02a80529f2accea93"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:734"><span class="id" title="variable">A2</span></a>} {<a id="3a22a7103dbbf0d981288b49d58481e5" class="idref" href="#3a22a7103dbbf0d981288b49d58481e5"><span class="id" title="binder">Φf</span></a> <a id="11439f318315556bc6059fb008b6f457" class="idref" href="#11439f318315556bc6059fb008b6f457"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3592633beaf64a64ed89a89d2e097ca6"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#44ae6912827cc6f02a80529f2accea93"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3a22a7103dbbf0d981288b49d58481e5"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#11439f318315556bc6059fb008b6f457"><span class="id" title="variable">Φs</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3592633beaf64a64ed89a89d2e097ca6"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#44ae6912827cc6f02a80529f2accea93"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3a22a7103dbbf0d981288b49d58481e5"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#11439f318315556bc6059fb008b6f457"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "&gt;H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_bind" class="idref" href="#wp_opt2_bind"><span class="id" title="lemma">wp_opt2_bind</span></a> {<a id="A1:739" class="idref" href="#A1:739"><span class="id" title="binder">A1</span></a> <a id="A2:740" class="idref" href="#A2:740"><span class="id" title="binder">A2</span></a>} {<a id="B1:741" class="idref" href="#B1:741"><span class="id" title="binder">B1</span></a> <a id="B2:742" class="idref" href="#B2:742"><span class="id" title="binder">B2</span></a>} {<a id="6d87e145f0d34107a87d368874619cea" class="idref" href="#6d87e145f0d34107a87d368874619cea"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:739"><span class="id" title="variable">A1</span></a>} {<a id="31a6b56f401e3f15edf5becaaaaab8c6" class="idref" href="#31a6b56f401e3f15edf5becaaaaab8c6"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:740"><span class="id" title="variable">A2</span></a>} {<a id="k1:745" class="idref" href="#k1:745"><span class="id" title="binder">k1</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:739"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B1:741"><span class="id" title="variable">B1</span></a>} {<a id="k2:746" class="idref" href="#k2:746"><span class="id" title="binder">k2</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A2:740"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B2:742"><span class="id" title="variable">B2</span></a>} {<a id="a71b11d9f13bb4f26fa8709d89608716" class="idref" href="#a71b11d9f13bb4f26fa8709d89608716"><span class="id" title="binder">Φf</span></a> <a id="6bad096d983ce2b70d1ade549bf1fac8" class="idref" href="#6bad096d983ce2b70d1ade549bf1fac8"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6d87e145f0d34107a87d368874619cea"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#31a6b56f401e3f15edf5becaaaaab8c6"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a71b11d9f13bb4f26fa8709d89608716"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:749" class="idref" href="#x1:749"><span class="id" title="binder">x1</span></a> <a id="x2:750" class="idref" href="#x2:750"><span class="id" title="binder">x2</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#k1:745"><span class="id" title="variable">k1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:749"><span class="id" title="variable">x1</span></a>) (<a class="idref" href="cap_machine.rules.rules_base.html#k2:746"><span class="id" title="variable">k2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:750"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#a71b11d9f13bb4f26fa8709d89608716"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6bad096d983ce2b70d1ade549bf1fac8"><span class="id" title="variable">Φs</span></a>) <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a id="x1:752" class="idref" href="#x1:752"><span class="id" title="binder">x1</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#6d87e145f0d34107a87d368874619cea"><span class="id" title="variable">φ1</span></a> <span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#k1:745"><span class="id" title="variable">k1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:752"><span class="id" title="variable">x1</span></a>) (<a id="x2:751" class="idref" href="#x2:751"><span class="id" title="binder">x2</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#31a6b56f401e3f15edf5becaaaaab8c6"><span class="id" title="variable">φ2</span></a> <span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#k2:746"><span class="id" title="variable">k2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:751"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#a71b11d9f13bb4f26fa8709d89608716"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6bad096d983ce2b70d1ade549bf1fac8"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_mod"><span class="id" title="axiom">wp_opt2_mod</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> "Hk" <span class="id" title="keyword">as</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> "Hk" <span class="id" title="keyword">as</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_mono" class="idref" href="#wp_opt2_mono"><span class="id" title="lemma">wp_opt2_mono</span></a> {<a id="A1:753" class="idref" href="#A1:753"><span class="id" title="binder">A1</span></a> <a id="A2:754" class="idref" href="#A2:754"><span class="id" title="binder">A2</span></a>} {<a id="619adb50a6e5bdc8602bd6f5efe20ec9" class="idref" href="#619adb50a6e5bdc8602bd6f5efe20ec9"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:753"><span class="id" title="variable">A1</span></a>} {<a id="cfa1571f2f7950a49dad98610108ddb7" class="idref" href="#cfa1571f2f7950a49dad98610108ddb7"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:754"><span class="id" title="variable">A2</span></a>} {<a id="58f8ce635c8cad921a5589550ebf46c8" class="idref" href="#58f8ce635c8cad921a5589550ebf46c8"><span class="id" title="binder">Φf</span></a> <a id="2e19a850f5dbdc9d3e35e23ed8d47b99" class="idref" href="#2e19a850f5dbdc9d3e35e23ed8d47b99"><span class="id" title="binder">Φsa</span></a> <a id="7ca70d587d95f8d651ecb83eef1b49ca" class="idref" href="#7ca70d587d95f8d651ecb83eef1b49ca"><span class="id" title="binder">Φsb</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x1:760" class="idref" href="#x1:760"><span class="id" title="binder">x1</span></a> <a id="x2:761" class="idref" href="#x2:761"><span class="id" title="binder">x2</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#2e19a850f5dbdc9d3e35e23ed8d47b99"><span class="id" title="variable">Φsa</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:760"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:761"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#7ca70d587d95f8d651ecb83eef1b49ca"><span class="id" title="variable">Φsb</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:760"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:761"><span class="id" title="variable">x2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#619adb50a6e5bdc8602bd6f5efe20ec9"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cfa1571f2f7950a49dad98610108ddb7"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#58f8ce635c8cad921a5589550ebf46c8"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2e19a850f5dbdc9d3e35e23ed8d47b99"><span class="id" title="variable">Φsa</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#619adb50a6e5bdc8602bd6f5efe20ec9"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cfa1571f2f7950a49dad98610108ddb7"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#58f8ce635c8cad921a5589550ebf46c8"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7ca70d587d95f8d651ecb83eef1b49ca"><span class="id" title="variable">Φsb</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="var">iIntros</span> "(Hab &amp; Hwp)"; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hab".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_frame" class="idref" href="#wp_opt2_frame"><span class="id" title="lemma">wp_opt2_frame</span></a> {<a id="A1:762" class="idref" href="#A1:762"><span class="id" title="binder">A1</span></a> <a id="A2:763" class="idref" href="#A2:763"><span class="id" title="binder">A2</span></a>} {<a id="02db5f865974ad519cf30bb689935b02" class="idref" href="#02db5f865974ad519cf30bb689935b02"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:762"><span class="id" title="variable">A1</span></a>} {<a id="5b1e8c86bb343453c2ded4bba7094ecf" class="idref" href="#5b1e8c86bb343453c2ded4bba7094ecf"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:763"><span class="id" title="variable">A2</span></a>} {<a id="0a07537df177c2ff0742e04849d9ea00" class="idref" href="#0a07537df177c2ff0742e04849d9ea00"><span class="id" title="binder">Φf</span></a> <a id="368b916eb425596e8cec6855836d0678" class="idref" href="#368b916eb425596e8cec6855836d0678"><span class="id" title="binder">Φs</span></a> <a id="R:768" class="idref" href="#R:768"><span class="id" title="binder">R</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#R:768"><span class="id" title="variable">R</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#02db5f865974ad519cf30bb689935b02"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5b1e8c86bb343453c2ded4bba7094ecf"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0a07537df177c2ff0742e04849d9ea00"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#368b916eb425596e8cec6855836d0678"><span class="id" title="variable">Φs</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#02db5f865974ad519cf30bb689935b02"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5b1e8c86bb343453c2ded4bba7094ecf"><span class="id" title="variable">φ2</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#R:768"><span class="id" title="variable">R</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#0a07537df177c2ff0742e04849d9ea00"><span class="id" title="variable">Φf</span></a>) (<span class="id" title="keyword">fun</span> <a id="x1:769" class="idref" href="#x1:769"><span class="id" title="binder">x1</span></a> <a id="x2:770" class="idref" href="#x2:770"><span class="id" title="binder">x2</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#R:768"><span class="id" title="variable">R</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#368b916eb425596e8cec6855836d0678"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:769"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:770"><span class="id" title="variable">x2</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "HR Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_mono2" class="idref" href="#wp_opt2_mono2"><span class="id" title="lemma">wp_opt2_mono2</span></a> {<a id="A1:771" class="idref" href="#A1:771"><span class="id" title="binder">A1</span></a> <a id="A2:772" class="idref" href="#A2:772"><span class="id" title="binder">A2</span></a>} {<a id="d075beb9e73c8fd596c2522c03b8e8a2" class="idref" href="#d075beb9e73c8fd596c2522c03b8e8a2"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:771"><span class="id" title="variable">A1</span></a>} {<a id="7d91652779a0c9de08f726ec954abf74" class="idref" href="#7d91652779a0c9de08f726ec954abf74"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:772"><span class="id" title="variable">A2</span></a>} {<a id="a9a31d6cba44eb1e5d7fc3928e98424c" class="idref" href="#a9a31d6cba44eb1e5d7fc3928e98424c"><span class="id" title="binder">Φfa</span></a> <a id="67e22493f5d4dd21eafe4ae2583b3f2f" class="idref" href="#67e22493f5d4dd21eafe4ae2583b3f2f"><span class="id" title="binder">Φfb</span></a> <a id="8ebc94347cfffb2d64e14e8c68c97c14" class="idref" href="#8ebc94347cfffb2d64e14e8c68c97c14"><span class="id" title="binder">Φsa</span></a> <a id="3d7c3a4e6dcf252f4b8243540a707116" class="idref" href="#3d7c3a4e6dcf252f4b8243540a707116"><span class="id" title="binder">Φsb</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">(</span> <a class="idref" href="cap_machine.rules.rules_base.html#a9a31d6cba44eb1e5d7fc3928e98424c"><span class="id" title="variable">Φfa</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#67e22493f5d4dd21eafe4ae2583b3f2f"><span class="id" title="variable">Φfb</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x1:779" class="idref" href="#x1:779"><span class="id" title="binder">x1</span></a> <a id="x2:780" class="idref" href="#x2:780"><span class="id" title="binder">x2</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#8ebc94347cfffb2d64e14e8c68c97c14"><span class="id" title="variable">Φsa</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:779"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:780"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#3d7c3a4e6dcf252f4b8243540a707116"><span class="id" title="variable">Φsb</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:779"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:780"><span class="id" title="variable">x2</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d075beb9e73c8fd596c2522c03b8e8a2"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7d91652779a0c9de08f726ec954abf74"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a9a31d6cba44eb1e5d7fc3928e98424c"><span class="id" title="variable">Φfa</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8ebc94347cfffb2d64e14e8c68c97c14"><span class="id" title="variable">Φsa</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d075beb9e73c8fd596c2522c03b8e8a2"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7d91652779a0c9de08f726ec954abf74"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#67e22493f5d4dd21eafe4ae2583b3f2f"><span class="id" title="variable">Φfb</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3d7c3a4e6dcf252f4b8243540a707116"><span class="id" title="variable">Φsb</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="var">iIntros</span> "[Hfsab Hwp]"; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hfsab" <span class="id" title="keyword">as</span> "(_ &amp; Hsab)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hsab".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hfsab" <span class="id" title="keyword">as</span> "(Hfab &amp; _)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hfab".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="transiently_wp_opt2" class="idref" href="#transiently_wp_opt2"><span class="id" title="lemma">transiently_wp_opt2</span></a> {<a id="A1:781" class="idref" href="#A1:781"><span class="id" title="binder">A1</span></a> <a id="A2:782" class="idref" href="#A2:782"><span class="id" title="binder">A2</span></a> : <span class="id" title="keyword">Type</span>} {<a id="P:783" class="idref" href="#P:783"><span class="id" title="binder">P</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>} {<a id="0943d0a56c83d69058843938f20475dc" class="idref" href="#0943d0a56c83d69058843938f20475dc"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:781"><span class="id" title="variable">A1</span></a>} {<a id="d151f8373cd4dbb8189f269716c22db6" class="idref" href="#d151f8373cd4dbb8189f269716c22db6"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:782"><span class="id" title="variable">A2</span></a>} {<a id="23a49ede03f4b9690764a24ae83c4307" class="idref" href="#23a49ede03f4b9690764a24ae83c4307"><span class="id" title="binder">Φf</span></a> <a id="d13ba75a0b1effa5646b16d81afb9c22" class="idref" href="#d13ba75a0b1effa5646b16d81afb9c22"><span class="id" title="binder">Φsa</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:783"><span class="id" title="variable">P</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0943d0a56c83d69058843938f20475dc"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d151f8373cd4dbb8189f269716c22db6"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#23a49ede03f4b9690764a24ae83c4307"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d13ba75a0b1effa5646b16d81afb9c22"><span class="id" title="variable">Φsa</span></a>) <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0943d0a56c83d69058843938f20475dc"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d151f8373cd4dbb8189f269716c22db6"><span class="id" title="variable">φ2</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:783"><span class="id" title="variable">P</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#23a49ede03f4b9690764a24ae83c4307"><span class="id" title="variable">Φf</span></a>) (<span class="id" title="keyword">fun</span> <a id="x1:788" class="idref" href="#x1:788"><span class="id" title="binder">x1</span></a> <a id="x2:789" class="idref" href="#x2:789"><span class="id" title="binder">x2</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#transiently"><span class="id" title="definition">transiently</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:783"><span class="id" title="variable">P</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#d13ba75a0b1effa5646b16d81afb9c22"><span class="id" title="variable">Φsa</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:788"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:789"><span class="id" title="variable">x2</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "HPQ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1 <span class="id" title="var">eqn</span>:<span class="id" title="var">H</span>φ1; <span class="id" title="tactic">destruct</span> φ2 <span class="id" title="var">eqn</span>:<span class="id" title="var">H</span>φ2; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#transiently_mono_2"><span class="id" title="axiom">transiently_mono_2</span></a> <span class="id" title="notation">with</span> "[$HPQ]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "&gt;HΦsa".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#transiently_commit"><span class="id" title="lemma">transiently_commit</span></a> <span class="id" title="notation">with</span> "HPQ"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%f".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#transiently_commit"><span class="id" title="lemma">transiently_commit</span></a> <span class="id" title="notation">with</span> "HPQ"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%f".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#transiently_mono_2"><span class="id" title="axiom">transiently_mono_2</span></a> <span class="id" title="notation">with</span> "[$HPQ]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "&gt;HΦsa".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_instr_exec_opt" class="idref" href="#wp_instr_exec_opt"><span class="id" title="lemma">wp_instr_exec_opt</span></a> {<a id="s:790" class="idref" href="#s:790"><span class="id" title="binder">s</span></a> <a id="E:791" class="idref" href="#E:791"><span class="id" title="binder">E</span></a> <a id="aebc705f3cac88e42f1e217deec0b6f2" class="idref" href="#aebc705f3cac88e42f1e217deec0b6f2"><span class="id" title="binder">Φ</span></a> <a id="pc_a:793" class="idref" href="#pc_a:793"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:794" class="idref" href="#pc_v:794"><span class="id" title="binder">pc_v</span></a> <a id="dq:795" class="idref" href="#dq:795"><span class="id" title="binder">dq</span></a> <a id="regs:796" class="idref" href="#regs:796"><span class="id" title="binder">regs</span></a> <a id="lw:797" class="idref" href="#lw:797"><span class="id" title="binder">lw</span></a> <a id="pc_p:798" class="idref" href="#pc_p:798"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:799" class="idref" href="#pc_b:799"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:800" class="idref" href="#pc_e:800"><span class="id" title="binder">pc_e</span></a> <a id="instr:801" class="idref" href="#instr:801"><span class="id" title="binder">instr</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:798"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:799"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:800"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:793"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:794"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:796"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:798"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:799"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:800"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:793"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:794"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:797"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:801"><span class="id" title="variable">instr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of"><span class="id" title="definition">regs_of</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:801"><span class="id" title="variable">instr</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:796"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:793"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:794"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:795"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:797"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:802" class="idref" href="#k:802"><span class="id" title="binder"><span id="k:803" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:804" class="idref" href="#y:804"><span class="id" title="binder"><span id="y:805" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:796"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:802"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:804"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="5f491a742bae02f2fdc9cfd9004d0d27" class="idref" href="#5f491a742bae02f2fdc9cfd9004d0d27"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5f491a742bae02f2fdc9cfd9004d0d27"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:807" class="idref" href="#k:807"><span class="id" title="binder"><span id="k:808" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:809" class="idref" href="#y:809"><span class="id" title="binder"><span id="y:810" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:796"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:807"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:809"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:793"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:794"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:795"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:797"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:791"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="wa:811" class="idref" href="#wa:811"><span class="id" title="binder">wa</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5f491a742bae02f2fdc9cfd9004d0d27"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:798"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:799"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:800"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:793"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5f491a742bae02f2fdc9cfd9004d0d27"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:793"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wa:811"><span class="id" title="variable">wa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#isCorrectPC"><span class="id" title="inductive">isCorrectPC</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:798"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:799"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:800"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:793"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#decodeInstrW"><span class="id" title="definition">decodeInstrW</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wa:811"><span class="id" title="variable">wa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:801"><span class="id" title="variable">instr</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:791"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.cap_lang.html#exec_opt"><span class="id" title="definition">exec_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:801"><span class="id" title="variable">instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5f491a742bae02f2fdc9cfd9004d0d27"><span class="id" title="variable">σ1</span></a>) (<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:791"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5f491a742bae02f2fdc9cfd9004d0d27"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#aebc705f3cac88e42f1e217deec0b6f2"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> (<a id="c2:812" class="idref" href="#c2:812"><span class="id" title="binder">c2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#Conf"><span class="id" title="definition">Conf</span></a>) =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:791"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=&gt;</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c2:812"><span class="id" title="variable">c2</span></a><span class="id" title="notation">.2</span> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#aebc705f3cac88e42f1e217deec0b6f2"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c2:812"><span class="id" title="variable">c2</span></a><span class="id" title="notation">.1</span>))<span class="id" title="notation">)</span>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:790"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:791"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#aebc705f3cac88e42f1e217deec0b6f2"><span class="id" title="variable">Φ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcorrpc</span> <span class="id" title="var">Hregspc</span> <span class="id" title="var">Hdecode</span> <span class="id" title="var">Hregs_incl</span>) "(&gt;Hcode &amp; &gt;Hregs &amp; H)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_instr_exec"><span class="id" title="axiom">wp_instr_exec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1) "Hσ1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregsincl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">Hregs_pc</span> := <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hregspc</span> <span class="id" title="var">Hregsincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hcode"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlcode</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">Hstep</span>) "Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="notation">{|</span> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="var">reg</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <span class="id" title="var">mem</span>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <span class="id" title="var">etable</span>; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <span class="id" title="var">enumcur</span> <span class="id" title="notation">|}</span> <span class="id" title="notation">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"[Hr Hm Htbl_cur Htbl_prev Htbl_all $HEC $Hregs $Hcode]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>. <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;allow&nbsp;changing&nbsp;cur_map?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word_cap"><span class="id" title="axiom">state_corresponds_reg_get_word_cap</span></a> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_correct_PC"><span class="id" title="axiom">state_corresponds_mem_correct_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <span class="id" title="var">lw</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "[%] Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>) <span class="id" title="var">HLinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_get_word"><span class="id" title="axiom">state_corresponds_mem_get_word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span> <span class="id" title="var">lw</span> <span class="id" title="var">HLinv</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a> ; [ <span class="id" title="tactic">apply</span> <span class="id" title="var">HLinv</span> | | | | <span class="id" title="tactic">apply</span> <span class="id" title="var">Hregs_pc</span> | ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.machine_base.html#isCorrectPC_withinBounds"><span class="id" title="axiom">isCorrectPC_withinBounds</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcorrpc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#exec"><span class="id" title="definition">exec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#exec_opt"><span class="id" title="definition">exec_opt</span></a> <span class="id" title="var">instr</span> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="var">reg</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <span class="id" title="var">mem</span>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <span class="id" title="var">etable</span>; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <span class="id" title="var">enumcur</span> |});<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_phys_log_corresponds_update_reg" class="idref" href="#state_phys_log_corresponds_update_reg"><span class="id" title="lemma">state_phys_log_corresponds_update_reg</span></a> {<a id="reg:813" class="idref" href="#reg:813"><span class="id" title="binder">reg</span></a> <a id="mem:814" class="idref" href="#mem:814"><span class="id" title="binder">mem</span></a> <a id="lr:815" class="idref" href="#lr:815"><span class="id" title="binder">lr</span></a> <a id="lm:816" class="idref" href="#lm:816"><span class="id" title="binder">lm</span></a> <a id="cur_map:817" class="idref" href="#cur_map:817"><span class="id" title="binder">cur_map</span></a> <a id="i:818" class="idref" href="#i:818"><span class="id" title="binder">i</span></a> <a id="w:819" class="idref" href="#w:819"><span class="id" title="binder">w</span></a> <a id="lw:820" class="idref" href="#lw:820"><span class="id" title="binder">lw</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:820"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:819"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:820"><span class="id" title="variable">lw</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:817"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg:813"><span class="id" title="variable">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#mem:814"><span class="id" title="variable">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:815"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:816"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:817"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#i:818"><span class="id" title="variable">i</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:819"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">reg</span>) <a class="idref" href="cap_machine.rules.rules_base.html#mem:814"><span class="id" title="variable">mem</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#i:818"><span class="id" title="variable">i</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:820"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:816"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:817"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hlw</span> <span class="id" title="var">Hcw</span> ((<span class="id" title="var">HLreg</span> &amp; <span class="id" title="var">HLcurreg</span>) &amp; <span class="id" title="var">HLmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.logical_mapsto.html#lreg_strip"><span class="id" title="definition">lreg_strip</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fmap_insert</span> <span class="id" title="var">HLreg</span> <span class="id" title="var">Hlw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">map_Forall_insert_2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_phys_log_corresponds_update_mem" class="idref" href="#state_phys_log_corresponds_update_mem"><span class="id" title="lemma">state_phys_log_corresponds_update_mem</span></a> {<a id="reg:821" class="idref" href="#reg:821"><span class="id" title="binder">reg</span></a> <a id="mem:822" class="idref" href="#mem:822"><span class="id" title="binder">mem</span></a> <a id="lr:823" class="idref" href="#lr:823"><span class="id" title="binder">lr</span></a> <a id="lm:824" class="idref" href="#lm:824"><span class="id" title="binder">lm</span></a> <a id="cur_map:825" class="idref" href="#cur_map:825"><span class="id" title="binder">cur_map</span></a> <a id="la:826" class="idref" href="#la:826"><span class="id" title="binder">la</span></a> <a id="lw:827" class="idref" href="#lw:827"><span class="id" title="binder">lw</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:826"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:825"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:827"><span class="id" title="variable">lw</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:825"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg:821"><span class="id" title="variable">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#mem:822"><span class="id" title="variable">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:823"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:824"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:825"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg:821"><span class="id" title="variable">reg</span></a> (<span class="id" title="notation">&lt;[(</span><a class="idref" href="cap_machine.logical_mapsto.html#laddr_get_addr"><span class="id" title="definition">laddr_get_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:826"><span class="id" title="variable">la</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">:=</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:827"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)]&gt;</span> <span class="id" title="notation">mem</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lr:823"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la:826"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:827"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lm</span>) <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:825"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hcurra</span> <span class="id" title="var">Hcurrw</span> (<span class="id" title="var">Hreg</span> &amp; <span class="id" title="var">Hmemcurr</span> &amp; <span class="id" title="var">Hmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lmem_corresponds_insert_respects"><span class="id" title="axiom">lmem_corresponds_insert_respects</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.logical_mapsto.html#mem_phys_log_corresponds"><span class="id" title="definition">mem_phys_log_corresponds</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_insert_dec" class="idref" href="#lookup_insert_dec"><span class="id" title="lemma">lookup_insert_dec</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">forall</span> <span class="id" title="notation">{</span><a id="K:828" class="idref" href="#K:828"><span class="id" title="binder">K</span></a> : <span class="id" title="keyword">Type</span>} {<a id="M:829" class="idref" href="#M:829"><span class="id" title="binder">M</span></a> : <span class="id" title="notation">forall</span> <span class="id" title="var">_</span> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="keyword">Type</span>} {<a id="H:830" class="idref" href="#H:830"><span class="id" title="binder">H</span></a> : <span class="id" title="class">FMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:829"><span class="id" title="variable">M</span></a>} {<a id="H0:832" class="idref" href="#H0:832"><span class="id" title="binder">H0</span></a> : <span class="id" title="notation">forall</span> <a id="A:831" class="idref" href="#A:831"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">Lookup</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:828"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:831"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:829"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:831"><span class="id" title="variable">A</span></a>)}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H1:834" class="idref" href="#H1:834"><span class="id" title="binder">H1</span></a> : <span class="id" title="notation">forall</span> <a id="A:833" class="idref" href="#A:833"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">Empty</span> (<a class="idref" href="cap_machine.rules.rules_base.html#M:829"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:833"><span class="id" title="variable">A</span></a>)} {<a id="H2:836" class="idref" href="#H2:836"><span class="id" title="binder">H2</span></a> : <span class="id" title="notation">forall</span> <a id="A:835" class="idref" href="#A:835"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">PartialAlter</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:828"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:835"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:829"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:835"><span class="id" title="variable">A</span></a>)} {<a id="H3:837" class="idref" href="#H3:837"><span class="id" title="binder">H3</span></a> : <span class="id" title="class">OMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:829"><span class="id" title="variable">M</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H4:838" class="idref" href="#H4:838"><span class="id" title="binder">H4</span></a> : <span class="id" title="class">Merge</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:829"><span class="id" title="variable">M</span></a>} {<a id="H5:840" class="idref" href="#H5:840"><span class="id" title="binder">H5</span></a> : <span class="id" title="notation">forall</span> <a id="A:839" class="idref" href="#A:839"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">MapFold</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:828"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:839"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:829"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:839"><span class="id" title="variable">A</span></a>)} {<a id="EqDecision0:841" class="idref" href="#EqDecision0:841"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="class">RelDecision</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">_</span> : <span class="id" title="class">FinMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:828"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#M:829"><span class="id" title="variable">M</span></a>} {<a id="A:842" class="idref" href="#A:842"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>} {<a id="m:843" class="idref" href="#m:843"><span class="id" title="binder">m</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#M:829"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:842"><span class="id" title="variable">A</span></a>} {<a id="i:844" class="idref" href="#i:844"><span class="id" title="binder">i</span></a> <a id="j:845" class="idref" href="#j:845"><span class="id" title="binder">j</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#K:828"><span class="id" title="variable">K</span></a>} {<a id="x:846" class="idref" href="#x:846"><span class="id" title="binder">x</span></a> <a id="y:847" class="idref" href="#y:847"><span class="id" title="binder">y</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:842"><span class="id" title="variable">A</span></a><span class="id" title="notation">},</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#m:843"><span class="id" title="variable">m</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#j:845"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:847"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#i:844"><span class="id" title="variable">i</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#x:846"><span class="id" title="variable">x</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">m</span><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#j:845"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">(</span></a><span class="id" title="definition">bool_decide</span> (<a class="idref" href="cap_machine.rules.rules_base.html#i:844"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#j:845"><span class="id" title="variable">j</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:846"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:847"><span class="id" title="variable">y</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="lemma">bool_decide_reflect</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">j</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">subst</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_corr" class="idref" href="#state_interp_transient_corr"><span class="id" title="lemma">state_interp_transient_corr</span></a> {<a id="5edd0d6a45002e167a776e11ae7360bb" class="idref" href="#5edd0d6a45002e167a776e11ae7360bb"><span class="id" title="binder">φ</span></a> <a id="676f90e200dfd4bc344f477bc6234843" class="idref" href="#676f90e200dfd4bc344f477bc6234843"><span class="id" title="binder">φ</span></a><a id="676f90e200dfd4bc344f477bc6234843" class="idref" href="#676f90e200dfd4bc344f477bc6234843"><span class="id" title="binder">t</span></a> <a id="lr:850" class="idref" href="#lr:850"><span class="id" title="binder">lr</span></a> <a id="lrt:851" class="idref" href="#lrt:851"><span class="id" title="binder">lrt</span></a> <a id="lm:852" class="idref" href="#lm:852"><span class="id" title="binder">lm</span></a> <a id="lmt:853" class="idref" href="#lmt:853"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5edd0d6a45002e167a776e11ae7360bb"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#676f90e200dfd4bc344f477bc6234843"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#676f90e200dfd4bc344f477bc6234843"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:850"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:851"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:852"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:853"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="lreg_t:854" class="idref" href="#lreg_t:854"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:855" class="idref" href="#lmem_t:855"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:856" class="idref" href="#cur_map:856"><span class="id" title="binder">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lrt:851"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:854"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:853"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:855"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#676f90e200dfd4bc344f477bc6234843"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#676f90e200dfd4bc344f477bc6234843"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#676f90e200dfd4bc344f477bc6234843"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#676f90e200dfd4bc344f477bc6234843"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:854"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:855"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:856"><span class="id" title="variable">cur_map</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Htr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#transiently_commit"><span class="id" title="lemma">transiently_commit</span></a> <span class="id" title="notation">with</span> "Htr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hσrt".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_corr"><span class="id" title="axiom">state_interp_corr</span></a> <span class="id" title="notation">with</span> "Hσrt"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hcor".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lreg_t</span> &amp; <span class="id" title="var">lmem_t</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlreg_t</span> &amp; <span class="id" title="var">Hlmem_t</span> &amp; <span class="id" title="var">Hsplc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iExists</span> <span class="id" title="var">lreg_t</span>, <span class="id" title="var">lmem_t</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup5" class="idref" href="#wp2_reg_lookup5"><span class="id" title="lemma">wp2_reg_lookup5</span></a> {<a id="lrt:857" class="idref" href="#lrt:857"><span class="id" title="binder">lrt</span></a> <a id="lreg_t:858" class="idref" href="#lreg_t:858"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:859" class="idref" href="#lmem_t:859"><span class="id" title="binder">lmem_t</span></a> <a id="r:860" class="idref" href="#r:860"><span class="id" title="binder">r</span></a> <a id="6f049694b9691fd132f6a66402a2b53e" class="idref" href="#6f049694b9691fd132f6a66402a2b53e"><span class="id" title="binder">σ</span></a><a id="6f049694b9691fd132f6a66402a2b53e" class="idref" href="#6f049694b9691fd132f6a66402a2b53e"><span class="id" title="binder">r</span></a> <a id="a93451c015272be0060155692d173c5d" class="idref" href="#a93451c015272be0060155692d173c5d"><span class="id" title="binder">σ</span></a><a id="a93451c015272be0060155692d173c5d" class="idref" href="#a93451c015272be0060155692d173c5d"><span class="id" title="binder">m</span></a> <a id="vmap:863" class="idref" href="#vmap:863"><span class="id" title="binder">vmap</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:860"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:857"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lrt:857"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:858"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6f049694b9691fd132f6a66402a2b53e"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#6f049694b9691fd132f6a66402a2b53e"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a93451c015272be0060155692d173c5d"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a93451c015272be0060155692d173c5d"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:858"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:859"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:863"><span class="id" title="variable">vmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#lrt:857"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:860"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.rules.rules_base.html#6f049694b9691fd132f6a66402a2b53e"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#6f049694b9691fd132f6a66402a2b53e"><span class="id" title="variable">r</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:860"><span class="id" title="variable">r</span></a>) (<span class="id" title="notation">False</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<span class="id" title="keyword">fun</span> <a id="lrw:864" class="idref" href="#lrw:864"><span class="id" title="binder">lrw</span></a> <a id="rw:865" class="idref" href="#rw:865"><span class="id" title="binder">rw</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#rw:865"><span class="id" title="variable">rw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrw:864"><span class="id" title="variable">lrw</span></a> <span class="id" title="notation">⌝</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hregs_incl</span> <span class="id" title="var">HInv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="method">elem_of_dom</span> <span class="id" title="var">lrt</span> <span class="id" title="var">r</span>) <span class="id" title="var">Hdom</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">lrw</span> &amp; <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_subseteq_spec</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hregs_incl</span> <span class="id" title="var">r</span> <span class="id" title="var">lrw</span> <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hregs_incl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup4" class="idref" href="#wp2_reg_lookup4"><span class="id" title="lemma">wp2_reg_lookup4</span></a> {<a id="lrt:866" class="idref" href="#lrt:866"><span class="id" title="binder">lrt</span></a> <a id="lmt:867" class="idref" href="#lmt:867"><span class="id" title="binder">lmt</span></a> <a id="r:868" class="idref" href="#r:868"><span class="id" title="binder">r</span></a> <a id="205a2dd8b4f9f2e5e7aa46b8bf36c8e9" class="idref" href="#205a2dd8b4f9f2e5e7aa46b8bf36c8e9"><span class="id" title="binder">φ</span></a><a id="205a2dd8b4f9f2e5e7aa46b8bf36c8e9" class="idref" href="#205a2dd8b4f9f2e5e7aa46b8bf36c8e9"><span class="id" title="binder">t</span></a> <a id="981f39187e00aeaf82f9551c24fc84ba" class="idref" href="#981f39187e00aeaf82f9551c24fc84ba"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:868"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:866"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#205a2dd8b4f9f2e5e7aa46b8bf36c8e9"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#205a2dd8b4f9f2e5e7aa46b8bf36c8e9"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:866"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:867"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#lrt:866"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:868"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#205a2dd8b4f9f2e5e7aa46b8bf36c8e9"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#205a2dd8b4f9f2e5e7aa46b8bf36c8e9"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:868"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#981f39187e00aeaf82f9551c24fc84ba"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="lrw:871" class="idref" href="#lrw:871"><span class="id" title="binder">lrw</span></a> <a id="rw:872" class="idref" href="#rw:872"><span class="id" title="binder">rw</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#rw:872"><span class="id" title="variable">rw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrw:871"><span class="id" title="variable">lrw</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#205a2dd8b4f9f2e5e7aa46b8bf36c8e9"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#205a2dd8b4f9f2e5e7aa46b8bf36c8e9"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:866"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:867"><span class="id" title="variable">lmt</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "Hσ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_corr"><span class="id" title="axiom">state_interp_corr</span></a> <span class="id" title="notation">with</span> "Hσ"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%HInv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HInv</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lregs_t</span> &amp; <span class="id" title="var">lmem_t</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hregs_incl</span> &amp; <span class="id" title="var">Hmem_incl</span> &amp; <span class="id" title="var">HInv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="method">elem_of_dom</span> <span class="id" title="var">lrt</span> <span class="id" title="var">r</span>) <span class="id" title="var">Hdom</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">lrw</span> &amp; <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_subseteq_spec</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hregs_incl</span> <span class="id" title="var">r</span> <span class="id" title="var">lrw</span> <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hregs_incl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup3" class="idref" href="#wp2_reg_lookup3"><span class="id" title="lemma">wp2_reg_lookup3</span></a> {<a id="lrt:873" class="idref" href="#lrt:873"><span class="id" title="binder">lrt</span></a> <a id="lmt:874" class="idref" href="#lmt:874"><span class="id" title="binder">lmt</span></a> <a id="r:875" class="idref" href="#r:875"><span class="id" title="binder">r</span></a> <a id="73c0696a82696ac9ef13425efb6a0819" class="idref" href="#73c0696a82696ac9ef13425efb6a0819"><span class="id" title="binder">φ</span></a><a id="73c0696a82696ac9ef13425efb6a0819" class="idref" href="#73c0696a82696ac9ef13425efb6a0819"><span class="id" title="binder">t</span></a> <a id="877769a54b901c66b8a766d961bd1774" class="idref" href="#877769a54b901c66b8a766d961bd1774"><span class="id" title="binder">Φs</span></a> <a id="602c55357685da48c6d926e75667f6e3" class="idref" href="#602c55357685da48c6d926e75667f6e3"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:875"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:873"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#73c0696a82696ac9ef13425efb6a0819"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#73c0696a82696ac9ef13425efb6a0819"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:873"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:874"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lwr:879" class="idref" href="#lwr:879"><span class="id" title="binder">lwr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#73c0696a82696ac9ef13425efb6a0819"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#73c0696a82696ac9ef13425efb6a0819"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:873"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:874"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#877769a54b901c66b8a766d961bd1774"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwr:879"><span class="id" title="variable">lwr</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwr:879"><span class="id" title="variable">lwr</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#lrt:873"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:875"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#73c0696a82696ac9ef13425efb6a0819"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#73c0696a82696ac9ef13425efb6a0819"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:875"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#602c55357685da48c6d926e75667f6e3"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#877769a54b901c66b8a766d961bd1774"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσ &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup4"><span class="id" title="axiom">wp2_reg_lookup4</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="notation">with</span> "Hσ"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_mono"><span class="id" title="axiom">wp_opt2_mono</span></a> <span class="id" title="notation">with</span> "[Hk $Hwp]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span> <span class="id" title="var">wr</span>) "(-&gt; &amp; Hσ)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"Hk" <span class="id" title="notation">with</span> "Hσ"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup2" class="idref" href="#wp2_reg_lookup2"><span class="id" title="lemma">wp2_reg_lookup2</span></a> {<a id="lrt:880" class="idref" href="#lrt:880"><span class="id" title="binder">lrt</span></a> <a id="lmt:881" class="idref" href="#lmt:881"><span class="id" title="binder">lmt</span></a> <a id="r:882" class="idref" href="#r:882"><span class="id" title="binder">r</span></a> <a id="d3138ab39fbae22c14c17fe49f9e49ee" class="idref" href="#d3138ab39fbae22c14c17fe49f9e49ee"><span class="id" title="binder">φ</span></a> <a id="ae464f95ab8bcbc2f472ffbc8f2e69c6" class="idref" href="#ae464f95ab8bcbc2f472ffbc8f2e69c6"><span class="id" title="binder">φ</span></a><a id="ae464f95ab8bcbc2f472ffbc8f2e69c6" class="idref" href="#ae464f95ab8bcbc2f472ffbc8f2e69c6"><span class="id" title="binder">t</span></a> <a id="lr:885" class="idref" href="#lr:885"><span class="id" title="binder">lr</span></a> <a id="lm:886" class="idref" href="#lm:886"><span class="id" title="binder">lm</span></a> <a id="3a8d109bcd9791f73b024352c9a9c910" class="idref" href="#3a8d109bcd9791f73b024352c9a9c910"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:882"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:880"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d3138ab39fbae22c14c17fe49f9e49ee"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ae464f95ab8bcbc2f472ffbc8f2e69c6"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#ae464f95ab8bcbc2f472ffbc8f2e69c6"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:885"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:880"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:886"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:881"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#lrt:880"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:882"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ae464f95ab8bcbc2f472ffbc8f2e69c6"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#ae464f95ab8bcbc2f472ffbc8f2e69c6"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:882"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#3a8d109bcd9791f73b024352c9a9c910"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="lrw:888" class="idref" href="#lrw:888"><span class="id" title="binder">lrw</span></a> <a id="rw:889" class="idref" href="#rw:889"><span class="id" title="binder">rw</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#rw:889"><span class="id" title="variable">rw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrw:888"><span class="id" title="variable">lrw</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d3138ab39fbae22c14c17fe49f9e49ee"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ae464f95ab8bcbc2f472ffbc8f2e69c6"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#ae464f95ab8bcbc2f472ffbc8f2e69c6"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:885"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:880"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:886"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:881"><span class="id" title="variable">lmt</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "Htr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient_corr"><span class="id" title="axiom">state_interp_transient_corr</span></a> <span class="id" title="notation">with</span> "Htr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%HInv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HInv</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lregs_t</span> &amp; <span class="id" title="var">lmem_t</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hregs_incl</span> &amp; <span class="id" title="var">Hmem_incl</span> &amp; <span class="id" title="var">HInv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="method">elem_of_dom</span> <span class="id" title="var">lrt</span> <span class="id" title="var">r</span>) <span class="id" title="var">Hdom</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">lrw</span> &amp; <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_subseteq_spec</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hregs_incl</span> <span class="id" title="var">r</span> <span class="id" title="var">lrw</span> <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hregs_incl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup" class="idref" href="#wp2_reg_lookup"><span class="id" title="lemma">wp2_reg_lookup</span></a> {<a id="lrt:890" class="idref" href="#lrt:890"><span class="id" title="binder">lrt</span></a> <a id="lmt:891" class="idref" href="#lmt:891"><span class="id" title="binder">lmt</span></a> <a id="r:892" class="idref" href="#r:892"><span class="id" title="binder">r</span></a> <a id="0eb070efc5f635d4169610973fb59c7a" class="idref" href="#0eb070efc5f635d4169610973fb59c7a"><span class="id" title="binder">φ</span></a> <a id="19d68ffe7c790349b501878b47ed53a2" class="idref" href="#19d68ffe7c790349b501878b47ed53a2"><span class="id" title="binder">φ</span></a><a id="19d68ffe7c790349b501878b47ed53a2" class="idref" href="#19d68ffe7c790349b501878b47ed53a2"><span class="id" title="binder">t</span></a> <a id="lr:895" class="idref" href="#lr:895"><span class="id" title="binder">lr</span></a> <a id="lm:896" class="idref" href="#lm:896"><span class="id" title="binder">lm</span></a> <a id="3ed9871f7aeb4b5af3a69f94d1f9bff0" class="idref" href="#3ed9871f7aeb4b5af3a69f94d1f9bff0"><span class="id" title="binder">Φs</span></a> <a id="b37e5df0cc0f16e36ecb0cdafc6333ed" class="idref" href="#b37e5df0cc0f16e36ecb0cdafc6333ed"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:892"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:890"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0eb070efc5f635d4169610973fb59c7a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#19d68ffe7c790349b501878b47ed53a2"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#19d68ffe7c790349b501878b47ed53a2"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:895"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:890"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:896"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:891"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lwr:899" class="idref" href="#lwr:899"><span class="id" title="binder">lwr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0eb070efc5f635d4169610973fb59c7a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#19d68ffe7c790349b501878b47ed53a2"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#19d68ffe7c790349b501878b47ed53a2"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:895"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:890"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:896"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:891"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#3ed9871f7aeb4b5af3a69f94d1f9bff0"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwr:899"><span class="id" title="variable">lwr</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwr:899"><span class="id" title="variable">lwr</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#lrt:890"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:892"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#19d68ffe7c790349b501878b47ed53a2"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#19d68ffe7c790349b501878b47ed53a2"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:892"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#b37e5df0cc0f16e36ecb0cdafc6333ed"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3ed9871f7aeb4b5af3a69f94d1f9bff0"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "[Htr Hk]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup2"><span class="id" title="axiom">wp2_reg_lookup2</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="notation">with</span> "Htr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_mono"><span class="id" title="axiom">wp_opt2_mono</span></a> <span class="id" title="notation">with</span> "[$Hwp Hk]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span> <span class="id" title="var">wr</span>) "(-&gt; &amp; H)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_word_of_argument" class="idref" href="#wp2_word_of_argument"><span class="id" title="lemma">wp2_word_of_argument</span></a> {<a id="src:900" class="idref" href="#src:900"><span class="id" title="binder">src</span></a> <a id="lw:901" class="idref" href="#lw:901"><span class="id" title="binder">lw</span></a> <a id="aa51cb3c26e8e60c969001def3e93ee3" class="idref" href="#aa51cb3c26e8e60c969001def3e93ee3"><span class="id" title="binder">Φf</span></a> <a id="3ebe9ea12d8d296fda36a11f7f8cee7a" class="idref" href="#3ebe9ea12d8d296fda36a11f7f8cee7a"><span class="id" title="binder">Φs</span></a> <a id="0ba5f6fa12b39e71535d14ae718c4b51" class="idref" href="#0ba5f6fa12b39e71535d14ae718c4b51"><span class="id" title="binder">φ</span></a> <a id="1730bf7441456e8440f797b9ec736c9a" class="idref" href="#1730bf7441456e8440f797b9ec736c9a"><span class="id" title="binder">φ</span></a><a id="1730bf7441456e8440f797b9ec736c9a" class="idref" href="#1730bf7441456e8440f797b9ec736c9a"><span class="id" title="binder">t</span></a> <a id="lr:906" class="idref" href="#lr:906"><span class="id" title="binder">lr</span></a> <a id="lrt:907" class="idref" href="#lrt:907"><span class="id" title="binder">lrt</span></a> <a id="lm:908" class="idref" href="#lm:908"><span class="id" title="binder">lm</span></a> <a id="lmt:909" class="idref" href="#lmt:909"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:900"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:907"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0ba5f6fa12b39e71535d14ae718c4b51"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1730bf7441456e8440f797b9ec736c9a"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#1730bf7441456e8440f797b9ec736c9a"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:906"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:907"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:908"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:909"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lw:910" class="idref" href="#lw:910"><span class="id" title="binder">lw</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0ba5f6fa12b39e71535d14ae718c4b51"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1730bf7441456e8440f797b9ec736c9a"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#1730bf7441456e8440f797b9ec736c9a"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:906"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:907"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:908"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:909"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#3ebe9ea12d8d296fda36a11f7f8cee7a"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:910"><span class="id" title="variable">lw</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:910"><span class="id" title="variable">lw</span></a>)<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:907"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:900"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#word_of_argument"><span class="id" title="definition">word_of_argument</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1730bf7441456e8440f797b9ec736c9a"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#1730bf7441456e8440f797b9ec736c9a"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:900"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#aa51cb3c26e8e60c969001def3e93ee3"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3ebe9ea12d8d296fda36a11f7f8cee7a"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσr &amp; HΦs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span>|<span class="id" title="var">r</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"HΦs" <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> (<span class="id" title="var">r</span> := <span class="id" title="var">r</span>) <span class="id" title="notation">with</span> "[$Hσr $HΦs]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_addr_of_argument" class="idref" href="#wp2_addr_of_argument"><span class="id" title="lemma">wp2_addr_of_argument</span></a> {<a id="src:911" class="idref" href="#src:911"><span class="id" title="binder">src</span></a> <a id="4e3999a18812513910c2cd4574c2e149" class="idref" href="#4e3999a18812513910c2cd4574c2e149"><span class="id" title="binder">Φf</span></a> <a id="18294a871b26e19f59ca07cb341d6b1d" class="idref" href="#18294a871b26e19f59ca07cb341d6b1d"><span class="id" title="binder">Φs</span></a> <a id="420abeacb015c94959b736eef64a85f1" class="idref" href="#420abeacb015c94959b736eef64a85f1"><span class="id" title="binder">φ</span></a> <a id="0d6e7018e6e105fcac0fb99dda7a2d31" class="idref" href="#0d6e7018e6e105fcac0fb99dda7a2d31"><span class="id" title="binder">φ</span></a><a id="0d6e7018e6e105fcac0fb99dda7a2d31" class="idref" href="#0d6e7018e6e105fcac0fb99dda7a2d31"><span class="id" title="binder">t</span></a> <a id="lr:916" class="idref" href="#lr:916"><span class="id" title="binder">lr</span></a> <a id="lrt:917" class="idref" href="#lrt:917"><span class="id" title="binder">lrt</span></a> <a id="lm:918" class="idref" href="#lm:918"><span class="id" title="binder">lm</span></a> <a id="lmt:919" class="idref" href="#lmt:919"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:911"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:917"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#420abeacb015c94959b736eef64a85f1"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0d6e7018e6e105fcac0fb99dda7a2d31"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#0d6e7018e6e105fcac0fb99dda7a2d31"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:916"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:917"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:918"><span class="id" title="variable">lm</span></a>  <a class="idref" href="cap_machine.rules.rules_base.html#lmt:919"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#420abeacb015c94959b736eef64a85f1"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0d6e7018e6e105fcac0fb99dda7a2d31"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#0d6e7018e6e105fcac0fb99dda7a2d31"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:916"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:917"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:918"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:919"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#4e3999a18812513910c2cd4574c2e149"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">((</span><span class="id" title="notation">∀</span> <a id="z:920" class="idref" href="#z:920"><span class="id" title="binder">z</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#420abeacb015c94959b736eef64a85f1"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0d6e7018e6e105fcac0fb99dda7a2d31"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#0d6e7018e6e105fcac0fb99dda7a2d31"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:916"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:917"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:918"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:919"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#18294a871b26e19f59ca07cb341d6b1d"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:920"><span class="id" title="variable">z</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:920"><span class="id" title="variable">z</span></a><span class="id" title="notation">))</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#addr_of_argumentL"><span class="id" title="definition">addr_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:917"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:911"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#addr_of_argument"><span class="id" title="definition">addr_of_argument</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0d6e7018e6e105fcac0fb99dda7a2d31"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#0d6e7018e6e105fcac0fb99dda7a2d31"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:911"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#4e3999a18812513910c2cd4574c2e149"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#18294a871b26e19f59ca07cb341d6b1d"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hregs</span>) "(Hφ &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.addr_reg.html#z_to_addr"><span class="id" title="abbreviation">z_to_addr</span></a> <span class="id" title="var">z</span>); <span class="id" title="var">cbn</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><span class="id" title="var">lrt</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:925" class="idref" href="#y:925"><span class="id" title="binder"><span id="y:931" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:925"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.logical_mapsto.html#LInt"><span class="id" title="abbreviation">LInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">≫=</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:924" class="idref" href="#n:924"><span class="id" title="binder"><span id="n:930" class="id">n</span></span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.addr_reg.html#z_to_addr"><span class="id" title="abbreviation">z_to_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#n:924"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ<span class="id" title="var">t</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:922" class="idref" href="#y:922"><span class="id" title="binder"><span id="y:928" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:922"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">≫=</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:921" class="idref" href="#n:921"><span class="id" title="binder"><span id="n:927" class="id">n</span></span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.addr_reg.html#z_to_addr"><span class="id" title="abbreviation">z_to_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#n:921"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Φf</span> <span class="id" title="var">Φs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφ Hk]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span> ; [<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.addr_reg.html#z_to_addr"><span class="id" title="abbreviation">z_to_addr</span></a> <span class="id" title="var">z</span>)| |] ; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_otype_of_argument" class="idref" href="#wp2_otype_of_argument"><span class="id" title="lemma">wp2_otype_of_argument</span></a> {<a id="src:933" class="idref" href="#src:933"><span class="id" title="binder">src</span></a> <a id="57e0e7e22fbc9a9d7f0b5347376d58d7" class="idref" href="#57e0e7e22fbc9a9d7f0b5347376d58d7"><span class="id" title="binder">Φf</span></a> <a id="a2755e7ccbbed395a3d4c35997cc4ec0" class="idref" href="#a2755e7ccbbed395a3d4c35997cc4ec0"><span class="id" title="binder">Φs</span></a> <a id="c34124d133ebf76c039fe35bd98bad5b" class="idref" href="#c34124d133ebf76c039fe35bd98bad5b"><span class="id" title="binder">φ</span></a> <a id="bc40b1f08520fc428f5a9e6f6ebc8259" class="idref" href="#bc40b1f08520fc428f5a9e6f6ebc8259"><span class="id" title="binder">φ</span></a><a id="bc40b1f08520fc428f5a9e6f6ebc8259" class="idref" href="#bc40b1f08520fc428f5a9e6f6ebc8259"><span class="id" title="binder">t</span></a> <a id="lr:938" class="idref" href="#lr:938"><span class="id" title="binder">lr</span></a> <a id="lrt:939" class="idref" href="#lrt:939"><span class="id" title="binder">lrt</span></a> <a id="lm:940" class="idref" href="#lm:940"><span class="id" title="binder">lm</span></a> <a id="lmt:941" class="idref" href="#lmt:941"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:933"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:939"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c34124d133ebf76c039fe35bd98bad5b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bc40b1f08520fc428f5a9e6f6ebc8259"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#bc40b1f08520fc428f5a9e6f6ebc8259"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:938"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:939"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:940"><span class="id" title="variable">lm</span></a>  <a class="idref" href="cap_machine.rules.rules_base.html#lmt:941"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c34124d133ebf76c039fe35bd98bad5b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bc40b1f08520fc428f5a9e6f6ebc8259"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#bc40b1f08520fc428f5a9e6f6ebc8259"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:938"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:939"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:940"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:941"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#57e0e7e22fbc9a9d7f0b5347376d58d7"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">((</span><span class="id" title="notation">∀</span> <a id="z:942" class="idref" href="#z:942"><span class="id" title="binder">z</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c34124d133ebf76c039fe35bd98bad5b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bc40b1f08520fc428f5a9e6f6ebc8259"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#bc40b1f08520fc428f5a9e6f6ebc8259"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:938"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:939"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:940"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:941"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#a2755e7ccbbed395a3d4c35997cc4ec0"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:942"><span class="id" title="variable">z</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:942"><span class="id" title="variable">z</span></a><span class="id" title="notation">))</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#otype_of_argumentL"><span class="id" title="definition">otype_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:939"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:933"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#otype_of_argument"><span class="id" title="definition">otype_of_argument</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bc40b1f08520fc428f5a9e6f6ebc8259"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#bc40b1f08520fc428f5a9e6f6ebc8259"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:933"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#57e0e7e22fbc9a9d7f0b5347376d58d7"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a2755e7ccbbed395a3d4c35997cc4ec0"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hregs</span>) "(Hφ &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.addr_reg.html#z_to_otype"><span class="id" title="abbreviation">z_to_otype</span></a> <span class="id" title="var">z</span>); <span class="id" title="var">cbn</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><span class="id" title="var">lrt</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:947" class="idref" href="#y:947"><span class="id" title="binder"><span id="y:953" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:947"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.logical_mapsto.html#LInt"><span class="id" title="abbreviation">LInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">≫=</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:946" class="idref" href="#n:946"><span class="id" title="binder"><span id="n:952" class="id">n</span></span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.addr_reg.html#z_to_otype"><span class="id" title="abbreviation">z_to_otype</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#n:946"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ<span class="id" title="var">t</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:944" class="idref" href="#y:944"><span class="id" title="binder"><span id="y:950" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:944"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">≫=</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:943" class="idref" href="#n:943"><span class="id" title="binder"><span id="n:949" class="id">n</span></span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.addr_reg.html#z_to_otype"><span class="id" title="abbreviation">z_to_otype</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#n:943"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Φf</span> <span class="id" title="var">Φs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφ Hk]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span> ; [<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.addr_reg.html#z_to_otype"><span class="id" title="abbreviation">z_to_otype</span></a> <span class="id" title="var">z</span>)| |] ; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_word_get_cap" class="idref" href="#wp2_word_get_cap"><span class="id" title="lemma">wp2_word_get_cap</span></a> {<a id="w:955" class="idref" href="#w:955"><span class="id" title="binder">w</span></a> <a id="cd00c874a2902ba705c714f007143b3d" class="idref" href="#cd00c874a2902ba705c714f007143b3d"><span class="id" title="binder">Φf</span></a> <a id="79db6c35e90e7797b98af4a7b1449df2" class="idref" href="#79db6c35e90e7797b98af4a7b1449df2"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#cd00c874a2902ba705c714f007143b3d"><span class="id" title="variable">Φf</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="p:958" class="idref" href="#p:958"><span class="id" title="binder">p</span></a> <a id="b:959" class="idref" href="#b:959"><span class="id" title="binder">b</span></a> <a id="e:960" class="idref" href="#e:960"><span class="id" title="binder">e</span></a> <a id="a:961" class="idref" href="#a:961"><span class="id" title="binder">a</span></a> <a id="v:962" class="idref" href="#v:962"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#79db6c35e90e7797b98af4a7b1449df2"><span class="id" title="variable">Φs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#p:958"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:959"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:960"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:961"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:962"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#p:958"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:959"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:960"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:961"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_cap"><span class="id" title="definition">lword_get_cap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:955"><span class="id" title="variable">w</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#get_wcap"><span class="id" title="definition">get_wcap</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:955"><span class="id" title="variable">w</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#cd00c874a2902ba705c714f007143b3d"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#79db6c35e90e7797b98af4a7b1449df2"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span> | [<span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span> | <span class="id" title="var">x</span>] | <span class="id" title="var">w</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_mem_lookup" class="idref" href="#wp2_mem_lookup"><span class="id" title="lemma">wp2_mem_lookup</span></a> {<a id="lrt:963" class="idref" href="#lrt:963"><span class="id" title="binder">lrt</span></a> <a id="lmt:964" class="idref" href="#lmt:964"><span class="id" title="binder">lmt</span></a> <a id="ae2e2882353903c136da56168c62957d" class="idref" href="#ae2e2882353903c136da56168c62957d"><span class="id" title="binder">φ</span></a> <a id="526f114b23c79d0ddcb8db13b5250144" class="idref" href="#526f114b23c79d0ddcb8db13b5250144"><span class="id" title="binder">φ</span></a><a id="526f114b23c79d0ddcb8db13b5250144" class="idref" href="#526f114b23c79d0ddcb8db13b5250144"><span class="id" title="binder">t</span></a> <a id="lr:967" class="idref" href="#lr:967"><span class="id" title="binder">lr</span></a> <a id="lm:968" class="idref" href="#lm:968"><span class="id" title="binder">lm</span></a> <a id="177a658b4a577c68b0f61de2e0dadcad" class="idref" href="#177a658b4a577c68b0f61de2e0dadcad"><span class="id" title="binder">Φs</span></a> <a id="f9a58f82b1290b876c6c0bf58e494387" class="idref" href="#f9a58f82b1290b876c6c0bf58e494387"><span class="id" title="binder">Φf</span></a> <a id="r:971" class="idref" href="#r:971"><span class="id" title="binder">r</span></a> <a id="p:972" class="idref" href="#p:972"><span class="id" title="binder">p</span></a> <a id="b:973" class="idref" href="#b:973"><span class="id" title="binder">b</span></a> <a id="e:974" class="idref" href="#e:974"><span class="id" title="binder">e</span></a> <a id="a:975" class="idref" href="#a:975"><span class="id" title="binder">a</span></a> <a id="v:976" class="idref" href="#v:976"><span class="id" title="binder">v</span></a> <a id="lwa:977" class="idref" href="#lwa:977"><span class="id" title="binder">lwa</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:973"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:974"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:975"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lrt:963"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:971"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:972"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:973"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:974"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:975"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:976"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:964"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:975"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules.rules_base.html#v:976"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwa:977"><span class="id" title="variable">lwa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ae2e2882353903c136da56168c62957d"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#526f114b23c79d0ddcb8db13b5250144"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#526f114b23c79d0ddcb8db13b5250144"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:967"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:963"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:968"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:964"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ae2e2882353903c136da56168c62957d"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#526f114b23c79d0ddcb8db13b5250144"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#526f114b23c79d0ddcb8db13b5250144"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:967"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:963"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:968"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:964"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#177a658b4a577c68b0f61de2e0dadcad"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwa:977"><span class="id" title="variable">lwa</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwa:977"><span class="id" title="variable">lwa</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:964"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:975"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules.rules_base.html#v:976"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#526f114b23c79d0ddcb8db13b5250144"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#526f114b23c79d0ddcb8db13b5250144"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:975"><span class="id" title="variable">a</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#f9a58f82b1290b876c6c0bf58e494387"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#177a658b4a577c68b0f61de2e0dadcad"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hin_bounds</span> <span class="id" title="var">Hlrt_r</span> <span class="id" title="var">Hlmt_a</span>) "(Hσr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient_corr"><span class="id" title="axiom">state_interp_transient_corr</span></a> <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hcor".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> &amp; <span class="id" title="var">lm'</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlrt_incl</span> &amp; <span class="id" title="var">Hlmt_incl</span> &amp; <span class="id" title="var">Hinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>, <span class="id" title="var">Hlrt_r</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_get_word"><span class="id" title="axiom">state_corresponds_mem_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_z_of_argument" class="idref" href="#wp2_z_of_argument"><span class="id" title="lemma">wp2_z_of_argument</span></a> {<a id="src:978" class="idref" href="#src:978"><span class="id" title="binder">src</span></a> <a id="220ae5ddd8964fa69d73426623987fe6" class="idref" href="#220ae5ddd8964fa69d73426623987fe6"><span class="id" title="binder">Φf</span></a> <a id="3093a859e7f9fdd327a66bd572442f8e" class="idref" href="#3093a859e7f9fdd327a66bd572442f8e"><span class="id" title="binder">Φs</span></a> <a id="5bacd530e433749db9ee0acfd47ee05c" class="idref" href="#5bacd530e433749db9ee0acfd47ee05c"><span class="id" title="binder">φ</span></a> <a id="1f6d8e5acf161dd1aa4ebdaa8660c400" class="idref" href="#1f6d8e5acf161dd1aa4ebdaa8660c400"><span class="id" title="binder">φ</span></a><a id="1f6d8e5acf161dd1aa4ebdaa8660c400" class="idref" href="#1f6d8e5acf161dd1aa4ebdaa8660c400"><span class="id" title="binder">t</span></a> <a id="lr:983" class="idref" href="#lr:983"><span class="id" title="binder">lr</span></a> <a id="lrt:984" class="idref" href="#lrt:984"><span class="id" title="binder">lrt</span></a> <a id="lm:985" class="idref" href="#lm:985"><span class="id" title="binder">lm</span></a> <a id="lmt:986" class="idref" href="#lmt:986"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:978"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:984"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5bacd530e433749db9ee0acfd47ee05c"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1f6d8e5acf161dd1aa4ebdaa8660c400"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#1f6d8e5acf161dd1aa4ebdaa8660c400"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:983"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:984"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:985"><span class="id" title="variable">lm</span></a>  <a class="idref" href="cap_machine.rules.rules_base.html#lmt:986"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5bacd530e433749db9ee0acfd47ee05c"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1f6d8e5acf161dd1aa4ebdaa8660c400"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#1f6d8e5acf161dd1aa4ebdaa8660c400"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:983"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:984"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:985"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:986"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#220ae5ddd8964fa69d73426623987fe6"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">((</span><span class="id" title="notation">∀</span> <a id="z:987" class="idref" href="#z:987"><span class="id" title="binder">z</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5bacd530e433749db9ee0acfd47ee05c"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1f6d8e5acf161dd1aa4ebdaa8660c400"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#1f6d8e5acf161dd1aa4ebdaa8660c400"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:983"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:984"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:985"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:986"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#3093a859e7f9fdd327a66bd572442f8e"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:987"><span class="id" title="variable">z</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:987"><span class="id" title="variable">z</span></a><span class="id" title="notation">))</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#z_of_argumentL"><span class="id" title="definition">z_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:984"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:978"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#z_of_argument"><span class="id" title="definition">z_of_argument</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1f6d8e5acf161dd1aa4ebdaa8660c400"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#1f6d8e5acf161dd1aa4ebdaa8660c400"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:978"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#220ae5ddd8964fa69d73426623987fe6"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3093a859e7f9fdd327a66bd572442f8e"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hregs</span>) "(Hφ &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<span class="id" title="var">lrt</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:990" class="idref" href="#y:990"><span class="id" title="binder"><span id="y:994" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:990"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.logical_mapsto.html#LInt"><span class="id" title="abbreviation">LInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ<span class="id" title="var">t</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:988" class="idref" href="#y:988"><span class="id" title="binder"><span id="y:992" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:988"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Φf</span> <span class="id" title="var">Φs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφ Hk]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;More&nbsp;expressive&nbsp;version&nbsp;of&nbsp;update_state_interp_from_reg_nomod.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;needed&nbsp;for&nbsp;operations&nbsp;that&nbsp;edit&nbsp;a&nbsp;current&nbsp;(in&nbsp;terms&nbsp;of&nbsp;version)&nbsp;word,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requiring&nbsp;us&nbsp;to&nbsp;re-prove&nbsp;"currentness"&nbsp;of&nbsp;the&nbsp;edited&nbsp;word.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Think&nbsp;e.g.&nbsp;shrinking&nbsp;the&nbsp;bounds&nbsp;of&nbsp;a&nbsp;capability&nbsp;read&nbsp;from&nbsp;a&nbsp;register.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_regs_mod" class="idref" href="#update_state_interp_from_regs_mod"><span class="id" title="lemma">update_state_interp_from_regs_mod</span></a> {<a id="e43c01058b4ddf4803419bd335d9bcc2" class="idref" href="#e43c01058b4ddf4803419bd335d9bcc2"><span class="id" title="binder">σ</span></a> <a id="dst:997" class="idref" href="#dst:997"><span class="id" title="binder">dst</span></a> <a id="lw2:998" class="idref" href="#lw2:998"><span class="id" title="binder">lw2</span></a> <a id="lregs:999" class="idref" href="#lregs:999"><span class="id" title="binder">lregs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:997"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:999"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1000" class="idref" href="#cur_map:1000"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:999"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1000"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:998"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1000"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e43c01058b4ddf4803419bd335d9bcc2"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1001" class="idref" href="#k:1001"><span class="id" title="binder"><span id="k:1002" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1003" class="idref" href="#y:1003"><span class="id" title="binder"><span id="y:1004" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:999"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1001"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1003"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e43c01058b4ddf4803419bd335d9bcc2"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:997"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:998"><span class="id" title="variable">lw2</span></a>)) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1005" class="idref" href="#k:1005"><span class="id" title="binder"><span id="k:1006" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1007" class="idref" href="#y:1007"><span class="id" title="binder"><span id="y:1008" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:997"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:998"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1005"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1007"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdst</span> <span class="id" title="var">Hcur</span>) "(Hσ &amp; Hregs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dst</span> <span class="id" title="var">lw2</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">vmap</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">Hcur</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="var">Hregs_incl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> <span class="id" title="var">HLinv</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_regs_mod" class="idref" href="#update_state_interp_transient_from_regs_mod"><span class="id" title="lemma">update_state_interp_transient_from_regs_mod</span></a> {<a id="611b5cb9e9e68841d73f0bc21a0c3fbc" class="idref" href="#611b5cb9e9e68841d73f0bc21a0c3fbc"><span class="id" title="binder">σ</span></a> <a id="e08d7bfa73f34549866c5bbf38cb40c3" class="idref" href="#e08d7bfa73f34549866c5bbf38cb40c3"><span class="id" title="binder">σ</span></a><a id="e08d7bfa73f34549866c5bbf38cb40c3" class="idref" href="#e08d7bfa73f34549866c5bbf38cb40c3"><span class="id" title="binder">t</span></a> <a id="lr:1011" class="idref" href="#lr:1011"><span class="id" title="binder">lr</span></a> <a id="lrt:1012" class="idref" href="#lrt:1012"><span class="id" title="binder">lrt</span></a> <a id="lm:1013" class="idref" href="#lm:1013"><span class="id" title="binder">lm</span></a> <a id="lmt:1014" class="idref" href="#lmt:1014"><span class="id" title="binder">lmt</span></a> <a id="dst:1015" class="idref" href="#dst:1015"><span class="id" title="binder">dst</span></a> <a id="lw2:1016" class="idref" href="#lw2:1016"><span class="id" title="binder">lw2</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:1015"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1012"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1017" class="idref" href="#cur_map:1017"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1012"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1017"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1016"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1017"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#611b5cb9e9e68841d73f0bc21a0c3fbc"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e08d7bfa73f34549866c5bbf38cb40c3"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e08d7bfa73f34549866c5bbf38cb40c3"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1011"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1012"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1013"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1014"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#611b5cb9e9e68841d73f0bc21a0c3fbc"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e08d7bfa73f34549866c5bbf38cb40c3"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e08d7bfa73f34549866c5bbf38cb40c3"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1015"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1016"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:1011"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1015"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1016"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:1013"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1014"><span class="id" title="variable">lmt</span></a> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hcur</span>) "&gt;(Hσ &amp; Hregs &amp; $)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hcur</span> <span class="id" title="notation">with</span> "[$Hσ $Hregs]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;lemma&nbsp;updates&nbsp;the&nbsp;state&nbsp;for&nbsp;operations&nbsp;where&nbsp;a&nbsp;current&nbsp;word&nbsp;is<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;immediately&nbsp;moved&nbsp;(to&nbsp;another&nbsp;register).&nbsp;Since&nbsp;the&nbsp;word&nbsp;was&nbsp;not&nbsp;edited,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;it&nbsp;was&nbsp;read&nbsp;from&nbsp;a&nbsp;register,&nbsp;it&nbsp;is&nbsp;obviously&nbsp;already&nbsp;"current"&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_reg_nomod" class="idref" href="#update_state_interp_from_reg_nomod"><span class="id" title="lemma">update_state_interp_from_reg_nomod</span></a> {<a id="8fc7b32ef4ec3ae2afe28fc28d6a5569" class="idref" href="#8fc7b32ef4ec3ae2afe28fc28d6a5569"><span class="id" title="binder">σ</span></a> <a id="src:1019" class="idref" href="#src:1019"><span class="id" title="binder">src</span></a> <a id="dst:1020" class="idref" href="#dst:1020"><span class="id" title="binder">dst</span></a> <a id="lw:1021" class="idref" href="#lw:1021"><span class="id" title="binder">lw</span></a> <a id="regs:1022" class="idref" href="#regs:1022"><span class="id" title="binder">regs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:1020"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:1022"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:1022"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#src:1019"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1021"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8fc7b32ef4ec3ae2afe28fc28d6a5569"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1023" class="idref" href="#k:1023"><span class="id" title="binder"><span id="k:1024" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1025" class="idref" href="#y:1025"><span class="id" title="binder"><span id="y:1026" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:1022"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1023"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1025"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8fc7b32ef4ec3ae2afe28fc28d6a5569"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1020"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1021"><span class="id" title="variable">lw</span></a>)) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1027" class="idref" href="#k:1027"><span class="id" title="binder"><span id="k:1028" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1029" class="idref" href="#y:1029"><span class="id" title="binder"><span id="y:1030" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1020"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1021"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1027"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1029"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdst</span> <span class="id" title="var">Hsrc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a>; <span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_int" class="idref" href="#update_state_interp_int"><span class="id" title="lemma">update_state_interp_int</span></a> {<a id="36dfc35dc144b49c9396779bb5f0c0e1" class="idref" href="#36dfc35dc144b49c9396779bb5f0c0e1"><span class="id" title="binder">σ</span></a> <a id="dst:1032" class="idref" href="#dst:1032"><span class="id" title="binder">dst</span></a> <a id="z:1033" class="idref" href="#z:1033"><span class="id" title="binder">z</span></a> <a id="regs:1034" class="idref" href="#regs:1034"><span class="id" title="binder">regs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:1032"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:1034"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#36dfc35dc144b49c9396779bb5f0c0e1"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1035" class="idref" href="#k:1035"><span class="id" title="binder"><span id="k:1036" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1037" class="idref" href="#y:1037"><span class="id" title="binder"><span id="y:1038" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:1034"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1035"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1037"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#36dfc35dc144b49c9396779bb5f0c0e1"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1032"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:1033"><span class="id" title="variable">z</span></a>)) <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1039" class="idref" href="#k:1039"><span class="id" title="binder"><span id="k:1040" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1041" class="idref" href="#y:1041"><span class="id" title="binder"><span id="y:1042" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1032"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:1033"><span class="id" title="variable">z</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1039"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1041"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <span class="id" title="var">z</span>)); <span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_int" class="idref" href="#update_state_interp_transient_int"><span class="id" title="lemma">update_state_interp_transient_int</span></a> {<a id="47c6f60708d27e0cfc9acad24916658b" class="idref" href="#47c6f60708d27e0cfc9acad24916658b"><span class="id" title="binder">σ</span></a> <a id="f2f5bc2799f9d03664a626f6537d561b" class="idref" href="#f2f5bc2799f9d03664a626f6537d561b"><span class="id" title="binder">σ</span></a><a id="f2f5bc2799f9d03664a626f6537d561b" class="idref" href="#f2f5bc2799f9d03664a626f6537d561b"><span class="id" title="binder">t</span></a> <a id="lr:1045" class="idref" href="#lr:1045"><span class="id" title="binder">lr</span></a> <a id="lrt:1046" class="idref" href="#lrt:1046"><span class="id" title="binder">lrt</span></a> <a id="lm:1047" class="idref" href="#lm:1047"><span class="id" title="binder">lm</span></a> <a id="lmt:1048" class="idref" href="#lmt:1048"><span class="id" title="binder">lmt</span></a> <a id="dst:1049" class="idref" href="#dst:1049"><span class="id" title="binder">dst</span></a> <a id="z:1050" class="idref" href="#z:1050"><span class="id" title="binder">z</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:1049"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1046"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#47c6f60708d27e0cfc9acad24916658b"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f2f5bc2799f9d03664a626f6537d561b"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#f2f5bc2799f9d03664a626f6537d561b"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1045"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1046"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1047"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1048"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#47c6f60708d27e0cfc9acad24916658b"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f2f5bc2799f9d03664a626f6537d561b"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#f2f5bc2799f9d03664a626f6537d561b"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1049"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:1050"><span class="id" title="variable">z</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:1045"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1049"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:1050"><span class="id" title="variable">z</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:1047"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1048"><span class="id" title="variable">lmt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_transient_from_regs_mod"><span class="id" title="axiom">update_state_interp_transient_from_regs_mod</span></a> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <span class="id" title="var">z</span>) <span class="id" title="var">Hdom</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_cap_mod" class="idref" href="#update_state_interp_from_cap_mod"><span class="id" title="lemma">update_state_interp_from_cap_mod</span></a> {<a id="24ae191e6160a0260f5e4f14306d5a5c" class="idref" href="#24ae191e6160a0260f5e4f14306d5a5c"><span class="id" title="binder">σ</span></a> <a id="dst:1052" class="idref" href="#dst:1052"><span class="id" title="binder">dst</span></a> <a id="lw2:1053" class="idref" href="#lw2:1053"><span class="id" title="binder">lw2</span></a> <a id="lregs:1054" class="idref" href="#lregs:1054"><span class="id" title="binder">lregs</span></a>} {<a id="lmem:1055" class="idref" href="#lmem:1055"><span class="id" title="binder">lmem</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} {<a id="p:1056" class="idref" href="#p:1056"><span class="id" title="binder">p</span></a> <a id="b:1057" class="idref" href="#b:1057"><span class="id" title="binder">b</span></a> <a id="e:1058" class="idref" href="#e:1058"><span class="id" title="binder">e</span></a> <a id="a:1059" class="idref" href="#a:1059"><span class="id" title="binder">a</span></a> <a id="v:1060" class="idref" href="#v:1060"><span class="id" title="binder">v</span></a> <a id="r:1061" class="idref" href="#r:1061"><span class="id" title="binder">r</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:1052"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1054"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:1054"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:1061"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:1056"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1057"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1058"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1059"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1060"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1057"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1058"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1059"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:1055"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:1059"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1060"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1053"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#24ae191e6160a0260f5e4f14306d5a5c"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1062" class="idref" href="#k:1062"><span class="id" title="binder"><span id="k:1063" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1064" class="idref" href="#y:1064"><span class="id" title="binder"><span id="y:1065" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1054"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1062"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1064"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:1066" class="idref" href="#la:1066"><span class="id" title="binder"><span id="la:1067" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:1068" class="idref" href="#dw:1068"><span class="id" title="binder"><span id="dw:1069" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:1055"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1066"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:1068"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:1068"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|==&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#24ae191e6160a0260f5e4f14306d5a5c"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1052"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1053"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1070" class="idref" href="#k:1070"><span class="id" title="binder"><span id="k:1071" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1072" class="idref" href="#y:1072"><span class="id" title="binder"><span id="y:1073" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1052"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1053"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1070"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1072"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:1074" class="idref" href="#la:1074"><span class="id" title="binder"><span id="la:1075" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:1076" class="idref" href="#dw:1076"><span class="id" title="binder"><span id="dw:1077" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:1055"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1074"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:1076"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:1076"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdst</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span>) "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dst</span> <span class="id" title="var">lw2</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">vmap</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HLinv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hinv_reg</span> <span class="id" title="var">Hinv_mem</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lmem_corresponds_read_iscur"><span class="id" title="axiom">lmem_corresponds_read_iscur</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_cap_mod" class="idref" href="#update_state_interp_transient_from_cap_mod"><span class="id" title="lemma">update_state_interp_transient_from_cap_mod</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="364c4a446bbb47c6415280afce11e6c9" class="idref" href="#364c4a446bbb47c6415280afce11e6c9"><span class="id" title="binder">σ</span></a> <a id="fff5fa6836d6230d56bd111797cd7139" class="idref" href="#fff5fa6836d6230d56bd111797cd7139"><span class="id" title="binder">σ</span></a><a id="fff5fa6836d6230d56bd111797cd7139" class="idref" href="#fff5fa6836d6230d56bd111797cd7139"><span class="id" title="binder">t</span></a> <a id="lr:1080" class="idref" href="#lr:1080"><span class="id" title="binder">lr</span></a> <a id="lrt:1081" class="idref" href="#lrt:1081"><span class="id" title="binder">lrt</span></a> <a id="lm:1082" class="idref" href="#lm:1082"><span class="id" title="binder">lm</span></a> <a id="lmt:1083" class="idref" href="#lmt:1083"><span class="id" title="binder">lmt</span></a> <a id="dst:1084" class="idref" href="#dst:1084"><span class="id" title="binder">dst</span></a> <a id="lw2:1085" class="idref" href="#lw2:1085"><span class="id" title="binder">lw2</span></a> <a id="r:1086" class="idref" href="#r:1086"><span class="id" title="binder">r</span></a> <a id="p:1087" class="idref" href="#p:1087"><span class="id" title="binder">p</span></a> <a id="b:1088" class="idref" href="#b:1088"><span class="id" title="binder">b</span></a> <a id="e:1089" class="idref" href="#e:1089"><span class="id" title="binder">e</span></a> <a id="a:1090" class="idref" href="#a:1090"><span class="id" title="binder">a</span></a> <a id="v:1091" class="idref" href="#v:1091"><span class="id" title="binder">v</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:1084"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1081"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lrt:1081"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:1086"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:1087"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1088"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1089"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1090"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1091"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1088"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1089"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1090"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1083"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:1090"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1091"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1085"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#364c4a446bbb47c6415280afce11e6c9"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fff5fa6836d6230d56bd111797cd7139"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#fff5fa6836d6230d56bd111797cd7139"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1080"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1081"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1082"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1083"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#364c4a446bbb47c6415280afce11e6c9"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fff5fa6836d6230d56bd111797cd7139"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#fff5fa6836d6230d56bd111797cd7139"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1084"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1085"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:1080"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1084"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1085"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:1082"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1083"><span class="id" title="variable">lmt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span>) "&gt;(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_cap_mod"><span class="id" title="axiom">update_state_interp_from_cap_mod</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span> <span class="id" title="notation">with</span> "[$Hσ $Hregs $Hmem]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_mem_mod" class="idref" href="#update_state_interp_from_mem_mod"><span class="id" title="lemma">update_state_interp_from_mem_mod</span></a> {<a id="ec525ff9b674d23b8b0f4bac19fe71fd" class="idref" href="#ec525ff9b674d23b8b0f4bac19fe71fd"><span class="id" title="binder">σ</span></a> <a id="lregs:1093" class="idref" href="#lregs:1093"><span class="id" title="binder">lregs</span></a>} {<a id="lmem:1094" class="idref" href="#lmem:1094"><span class="id" title="binder">lmem</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} <a id="laddr:1095" class="idref" href="#laddr:1095"><span class="id" title="binder">laddr</span></a> <a id="lwold:1096" class="idref" href="#lwold:1096"><span class="id" title="binder">lwold</span></a> <a id="lwnew:1097" class="idref" href="#lwnew:1097"><span class="id" title="binder">lwnew</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1098" class="idref" href="#cur_map:1098"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1093"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1098"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwnew:1097"><span class="id" title="variable">lwnew</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1098"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1099" class="idref" href="#cur_map:1099"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1093"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1099"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#laddr:1095"><span class="id" title="variable">laddr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1099"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:1094"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#laddr:1095"><span class="id" title="variable">laddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwold:1096"><span class="id" title="variable">lwold</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ec525ff9b674d23b8b0f4bac19fe71fd"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1100" class="idref" href="#k:1100"><span class="id" title="binder"><span id="k:1101" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1102" class="idref" href="#y:1102"><span class="id" title="binder"><span id="y:1103" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1093"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1100"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1102"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:1104" class="idref" href="#la:1104"><span class="id" title="binder"><span id="la:1105" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:1106" class="idref" href="#dw:1106"><span class="id" title="binder"><span id="dw:1107" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:1094"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1104"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:1106"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:1106"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|==&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_mem"><span class="id" title="definition">update_mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ec525ff9b674d23b8b0f4bac19fe71fd"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#laddr_get_addr"><span class="id" title="definition">laddr_get_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#laddr:1095"><span class="id" title="variable">laddr</span></a>) (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwnew:1097"><span class="id" title="variable">lwnew</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1108" class="idref" href="#k:1108"><span class="id" title="binder"><span id="k:1109" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1110" class="idref" href="#y:1110"><span class="id" title="binder"><span id="y:1111" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1093"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1108"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1110"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:1112" class="idref" href="#la:1112"><span class="id" title="binder"><span id="la:1113" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:1114" class="idref" href="#dw:1114"><span class="id" title="binder"><span id="dw:1115" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#laddr:1095"><span class="id" title="variable">laddr</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwnew:1097"><span class="id" title="variable">lwnew</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1112"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:1114"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:1114"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcurw</span> <span class="id" title="var">Hcura</span> <span class="id" title="var">Hladdr</span>) "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_update_inSepM_general"><span class="id" title="axiom">gen_heap_update_inSepM_general</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">laddr</span> <span class="id" title="var">lwnew</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hm Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">vmap</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HLinv</span> <span class="id" title="keyword">as</span> [[? <span class="id" title="var">Hregscur</span>] <span class="id" title="var">Hinv_mem</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_mem"><span class="id" title="axiom">state_phys_log_corresponds_update_mem</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">Hcura</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">Hcurw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="var">Hlregs_incl</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_mem_mod" class="idref" href="#update_state_interp_transient_from_mem_mod"><span class="id" title="lemma">update_state_interp_transient_from_mem_mod</span></a> {<a id="d53c22274b2b4a3273c0513690bc3980" class="idref" href="#d53c22274b2b4a3273c0513690bc3980"><span class="id" title="binder">σ</span></a> <a id="c36f63dce09f75bd81b8613489212837" class="idref" href="#c36f63dce09f75bd81b8613489212837"><span class="id" title="binder">σ</span></a><a id="c36f63dce09f75bd81b8613489212837" class="idref" href="#c36f63dce09f75bd81b8613489212837"><span class="id" title="binder">t</span></a> <a id="lr:1118" class="idref" href="#lr:1118"><span class="id" title="binder">lr</span></a> <a id="lrt:1119" class="idref" href="#lrt:1119"><span class="id" title="binder">lrt</span></a>} {<a id="lm:1120" class="idref" href="#lm:1120"><span class="id" title="binder">lm</span></a> <a id="lmt:1121" class="idref" href="#lmt:1121"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} <a id="la:1122" class="idref" href="#la:1122"><span class="id" title="binder">la</span></a> <a id="lw:1123" class="idref" href="#lw:1123"><span class="id" title="binder">lw</span></a> <a id="lw':1124" class="idref" href="#lw':1124"><span class="id" title="binder">lw'</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1125" class="idref" href="#cur_map:1125"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1119"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1125"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1123"><span class="id" title="variable">lw</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1125"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1126" class="idref" href="#cur_map:1126"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1119"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1126"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:1122"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1126"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmt:1121"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1122"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw':1124"><span class="id" title="variable">lw'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d53c22274b2b4a3273c0513690bc3980"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c36f63dce09f75bd81b8613489212837"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#c36f63dce09f75bd81b8613489212837"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1118"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1119"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1120"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1121"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d53c22274b2b4a3273c0513690bc3980"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_mem"><span class="id" title="definition">update_mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c36f63dce09f75bd81b8613489212837"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#c36f63dce09f75bd81b8613489212837"><span class="id" title="variable">t</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#laddr_get_addr"><span class="id" title="definition">laddr_get_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:1122"><span class="id" title="variable">la</span></a>) (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1123"><span class="id" title="variable">lw</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:1118"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1119"><span class="id" title="variable">lrt</span></a> <span class="comment">(*&nbsp;registers&nbsp;remain&nbsp;unchanged&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lm:1120"><span class="id" title="variable">lm</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1122"><span class="id" title="variable">la</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1123"><span class="id" title="variable">lw</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmt</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcurw</span> <span class="id" title="var">Hcura</span> <span class="id" title="var">Hla</span>) "&gt;Hσ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_mem_mod"><span class="id" title="axiom">update_state_interp_from_mem_mod</span></a> <span class="id" title="var">la</span> <span class="id" title="var">lw'</span> <span class="id" title="var">lw</span> <span class="id" title="var">Hcurw</span> <span class="id" title="var">Hcura</span> <span class="id" title="var">Hla</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="word_of_argumentL_cur" class="idref" href="#word_of_argumentL_cur"><span class="id" title="lemma">word_of_argumentL_cur</span></a> {<a id="lregs:1127" class="idref" href="#lregs:1127"><span class="id" title="binder">lregs</span></a> <a id="src:1128" class="idref" href="#src:1128"><span class="id" title="binder">src</span></a> <a id="lw2:1129" class="idref" href="#lw2:1129"><span class="id" title="binder">lw2</span></a> <a id="cur_map:1130" class="idref" href="#cur_map:1130"><span class="id" title="binder">cur_map</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1127"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:1128"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1129"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1127"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1130"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1129"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1130"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hreg</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span> <span class="id" title="var">Hreg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="cap_of_argumentL_cur" class="idref" href="#cap_of_argumentL_cur"><span class="id" title="lemma">cap_of_argumentL_cur</span></a> {<a id="lregs:1131" class="idref" href="#lregs:1131"><span class="id" title="binder">lregs</span></a> <a id="rsrc:1132" class="idref" href="#rsrc:1132"><span class="id" title="binder">rsrc</span></a> <a id="p:1133" class="idref" href="#p:1133"><span class="id" title="binder">p</span></a> <a id="b:1134" class="idref" href="#b:1134"><span class="id" title="binder">b</span></a> <a id="e:1135" class="idref" href="#e:1135"><span class="id" title="binder">e</span></a> <a id="a:1136" class="idref" href="#a:1136"><span class="id" title="binder">a</span></a> <a id="v:1137" class="idref" href="#v:1137"><span class="id" title="binder">v</span></a> <a id="cur_map:1138" class="idref" href="#cur_map:1138"><span class="id" title="binder">cur_map</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1131"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rsrc:1132"><span class="id" title="variable">rsrc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:1133"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1134"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1135"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1136"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1137"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1134"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1135"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1136"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1131"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1138"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:1136"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1137"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1138"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#cur_lword_cur_addr"><span class="id" title="axiom">cur_lword_cur_addr</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>) <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span>). <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_lword_version"><span class="id" title="definition">is_lword_version</span></a>. <span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#word_of_argumentL_cur"><span class="id" title="axiom">word_of_argumentL_cur</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Is_true_true_1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="seal_from_argumentL" class="idref" href="#seal_from_argumentL"><span class="id" title="lemma">seal_from_argumentL</span></a> {<a id="lregs:1139" class="idref" href="#lregs:1139"><span class="id" title="binder">lregs</span></a> <a id="src:1140" class="idref" href="#src:1140"><span class="id" title="binder">src</span></a> <a id="sb:1141" class="idref" href="#sb:1141"><span class="id" title="binder">sb</span></a> <a id="ot:1142" class="idref" href="#ot:1142"><span class="id" title="binder">ot</span></a> <a id="cur_map:1143" class="idref" href="#cur_map:1143"><span class="id" title="binder">cur_map</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:1139"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#src:1140"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LWSealable"><span class="id" title="constructor">LWSealable</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#sb:1141"><span class="id" title="variable">sb</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1139"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1143"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LWSealed"><span class="id" title="constructor">LWSealed</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ot:1142"><span class="id" title="variable">ot</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#sb:1141"><span class="id" title="variable">sb</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1143"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hreg</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span> <span class="id" title="var">Hreg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="unseal_from_argumentL" class="idref" href="#unseal_from_argumentL"><span class="id" title="lemma">unseal_from_argumentL</span></a> {<a id="lregs:1144" class="idref" href="#lregs:1144"><span class="id" title="binder">lregs</span></a> <a id="src:1145" class="idref" href="#src:1145"><span class="id" title="binder">src</span></a> <a id="sb:1146" class="idref" href="#sb:1146"><span class="id" title="binder">sb</span></a> <a id="ot:1147" class="idref" href="#ot:1147"><span class="id" title="binder">ot</span></a> <a id="cur_map:1148" class="idref" href="#cur_map:1148"><span class="id" title="binder">cur_map</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:1144"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#src:1145"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LWSealed"><span class="id" title="constructor">LWSealed</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ot:1147"><span class="id" title="variable">ot</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#sb:1146"><span class="id" title="variable">sb</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1144"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1148"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LWSealable"><span class="id" title="constructor">LWSealable</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#sb:1146"><span class="id" title="variable">sb</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1148"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hreg</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span> <span class="id" title="var">Hreg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_opt_incrementPC2" class="idref" href="#wp2_opt_incrementPC2"><span class="id" title="lemma">wp2_opt_incrementPC2</span></a> {<a id="lregs:1149" class="idref" href="#lregs:1149"><span class="id" title="binder">lregs</span></a> <a id="6798ee9642d5e53c18706b3fdb82f6e8" class="idref" href="#6798ee9642d5e53c18706b3fdb82f6e8"><span class="id" title="binder">σ</span></a><a id="6798ee9642d5e53c18706b3fdb82f6e8" class="idref" href="#6798ee9642d5e53c18706b3fdb82f6e8"><span class="id" title="binder">r</span></a> <a id="7ebd723aa2463c61568b821bcc59f679" class="idref" href="#7ebd723aa2463c61568b821bcc59f679"><span class="id" title="binder">σ</span></a><a id="7ebd723aa2463c61568b821bcc59f679" class="idref" href="#7ebd723aa2463c61568b821bcc59f679"><span class="id" title="binder">m</span></a> <a id="lmem:1152" class="idref" href="#lmem:1152"><span class="id" title="binder">lmem</span></a> <a id="vmap:1153" class="idref" href="#vmap:1153"><span class="id" title="binder">vmap</span></a> <a id="lrt:1154" class="idref" href="#lrt:1154"><span class="id" title="binder">lrt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1154"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lrt:1154"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1149"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6798ee9642d5e53c18706b3fdb82f6e8"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#6798ee9642d5e53c18706b3fdb82f6e8"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7ebd723aa2463c61568b821bcc59f679"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#7ebd723aa2463c61568b821bcc59f679"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1149"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:1152"><span class="id" title="variable">lmem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:1153"><span class="id" title="variable">vmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1149"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1155" class="idref" href="#k:1155"><span class="id" title="binder"><span id="k:1156" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1157" class="idref" href="#y:1157"><span class="id" title="binder"><span id="y:1158" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1154"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1155"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1157"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1154"><span class="id" title="variable">lrt</span></a>) (<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6798ee9642d5e53c18706b3fdb82f6e8"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#6798ee9642d5e53c18706b3fdb82f6e8"><span class="id" title="variable">r</span></a>) (<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1149"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1166" class="idref" href="#k:1166"><span class="id" title="binder"><span id="k:1167" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1168" class="idref" href="#y:1168"><span class="id" title="binder"><span id="y:1169" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1154"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1166"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1168"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="lrt2:1159" class="idref" href="#lrt2:1159"><span class="id" title="binder">lrt2</span></a> <a id="rs2:1160" class="idref" href="#rs2:1160"><span class="id" title="binder">rs2</span></a> =&gt; <span class="id" title="notation">∃</span> <a id="lregs2:1161" class="idref" href="#lregs2:1161"><span class="id" title="binder">lregs2</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs2:1161"><span class="id" title="variable">lregs2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rs2:1160"><span class="id" title="variable">rs2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7ebd723aa2463c61568b821bcc59f679"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#7ebd723aa2463c61568b821bcc59f679"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs2:1161"><span class="id" title="variable">lregs2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:1152"><span class="id" title="variable">lmem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:1153"><span class="id" title="variable">vmap</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1162" class="idref" href="#k:1162"><span class="id" title="binder"><span id="k:1163" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1164" class="idref" href="#y:1164"><span class="id" title="binder"><span id="y:1165" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt2:1159"><span class="id" title="variable">lrt2</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1162"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1164"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hlrt</span> <span class="id" title="var">Hcorr</span>) "(Hσr &amp; Hregs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>; <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_eqn_both"><span class="id" title="axiom">wp_opt2_eqn_both</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_mono2"><span class="id" title="axiom">wp_opt2_mono2</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup5"><span class="id" title="axiom">wp2_reg_lookup5</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iIntros</span> "%f".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lw</span> <span class="id" title="var">w</span>) "-&gt; %Heq1 %Heq2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lw</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f2</span> <span class="id" title="var">v</span>)<span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hσr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_lword_lea"><span class="id" title="axiom">is_cur_lword_lea</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">lw</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f1</span> <span class="id" title="var">v</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_base.html#isWithin_refl"><span class="id" title="axiom">isWithin_refl</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="var">Hlrt</span> <span class="id" title="var">_</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcorr</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span>] <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_opt_incrementPC" class="idref" href="#wp2_opt_incrementPC"><span class="id" title="lemma">wp2_opt_incrementPC</span></a> {<a id="c9429c8c045968f43b516e07b26df532" class="idref" href="#c9429c8c045968f43b516e07b26df532"><span class="id" title="binder">φ</span></a> <a id="9b0297f2210bb14156445507cb193f73" class="idref" href="#9b0297f2210bb14156445507cb193f73"><span class="id" title="binder">φ</span></a><a id="9b0297f2210bb14156445507cb193f73" class="idref" href="#9b0297f2210bb14156445507cb193f73"><span class="id" title="binder">t</span></a> <a id="lr:1172" class="idref" href="#lr:1172"><span class="id" title="binder">lr</span></a> <a id="lrt:1173" class="idref" href="#lrt:1173"><span class="id" title="binder">lrt</span></a> <a id="lm:1174" class="idref" href="#lm:1174"><span class="id" title="binder">lm</span></a> <a id="lmt:1175" class="idref" href="#lmt:1175"><span class="id" title="binder">lmt</span></a> <a id="986b6ac27dac0cb1819dd050c78bb9b8" class="idref" href="#986b6ac27dac0cb1819dd050c78bb9b8"><span class="id" title="binder">Φs</span></a> <a id="afb1f2c48fb6f07a2d477da2c0f05c60" class="idref" href="#afb1f2c48fb6f07a2d477da2c0f05c60"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1173"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c9429c8c045968f43b516e07b26df532"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9b0297f2210bb14156445507cb193f73"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#9b0297f2210bb14156445507cb193f73"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1172"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1173"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1174"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1175"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c9429c8c045968f43b516e07b26df532"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9b0297f2210bb14156445507cb193f73"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#9b0297f2210bb14156445507cb193f73"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1172"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1173"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1174"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1175"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#afb1f2c48fb6f07a2d477da2c0f05c60"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lrt':1178" class="idref" href="#lrt':1178"><span class="id" title="binder">lrt'</span></a> <a id="rs':1179" class="idref" href="#rs':1179"><span class="id" title="binder">rs'</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c9429c8c045968f43b516e07b26df532"><span class="id" title="variable">φ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9b0297f2210bb14156445507cb193f73"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#9b0297f2210bb14156445507cb193f73"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rs':1179"><span class="id" title="variable">rs'</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lr:1172"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':1178"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1174"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1175"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#986b6ac27dac0cb1819dd050c78bb9b8"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':1178"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rs':1179"><span class="id" title="variable">rs'</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1173"><span class="id" title="variable">lrt</span></a>) (<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9b0297f2210bb14156445507cb193f73"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#9b0297f2210bb14156445507cb193f73"><span class="id" title="variable">t</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#afb1f2c48fb6f07a2d477da2c0f05c60"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#986b6ac27dac0cb1819dd050c78bb9b8"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hφr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_eqn"><span class="id" title="axiom">wp_opt2_eqn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφr Hk]"<span class="id" title="notation">)</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφr %Heq1 %Heq2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"Hk" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <span class="id" title="var">_</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(</span><span class="id" title="notation">reg</span> <span class="id" title="notation">φ</span><span class="id" title="notation">t</span><span class="id" title="notation">)</span><span class="id" title="notation">))</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_transient_from_regs_mod"><span class="id" title="axiom">update_state_interp_transient_from_regs_mod</span></a> <span class="id" title="var">Hdom</span> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f2</span> <span class="id" title="var">v</span>) <span class="id" title="notation">with</span> "Hφr"<span class="id" title="notation">)</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cur_map</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_lword_lea"><span class="id" title="axiom">is_cur_lword_lea</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">lw</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f1</span> <span class="id" title="var">v</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_base.html#isWithin_refl"><span class="id" title="axiom">isWithin_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_get_wcap_scap" class="idref" href="#wp2_get_wcap_scap"><span class="id" title="lemma">wp2_get_wcap_scap</span></a> {<a id="fb7bcd1d6f1c11f3c324ce38929c356c" class="idref" href="#fb7bcd1d6f1c11f3c324ce38929c356c"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>} {<a id="w:1181" class="idref" href="#w:1181"><span class="id" title="binder">w</span></a> <a id="332f48551aa5caaf5a7f293cf1e3dcb3" class="idref" href="#332f48551aa5caaf5a7f293cf1e3dcb3"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#fb7bcd1d6f1c11f3c324ce38929c356c"><span class="id" title="variable">Φf</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="p:1183" class="idref" href="#p:1183"><span class="id" title="binder">p</span></a> <a id="b:1184" class="idref" href="#b:1184"><span class="id" title="binder">b</span></a> <a id="e:1185" class="idref" href="#e:1185"><span class="id" title="binder">e</span></a> <a id="a:1186" class="idref" href="#a:1186"><span class="id" title="binder">a</span></a> <a id="v:1187" class="idref" href="#v:1187"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#332f48551aa5caaf5a7f293cf1e3dcb3"><span class="id" title="variable">Φs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#p:1183"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1184"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1185"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1186"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1187"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#p:1183"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1184"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1185"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1186"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#get_wlcap_slcap"><span class="id" title="definition">get_wlcap_slcap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:1181"><span class="id" title="variable">w</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#get_wcap_scap"><span class="id" title="definition">get_wcap_scap</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:1181"><span class="id" title="variable">w</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#fb7bcd1d6f1c11f3c324ce38929c356c"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#332f48551aa5caaf5a7f293cf1e3dcb3"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [ | [ | ] | [] [ | ] ]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_unique_in_lregs" class="idref" href="#state_interp_transient_unique_in_lregs"><span class="id" title="lemma">state_interp_transient_unique_in_lregs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="8703b0f4162ca549491ecd1e24bfe5a3" class="idref" href="#8703b0f4162ca549491ecd1e24bfe5a3"><span class="id" title="binder">σ</span></a> <a id="2aa3397e524bca32412338d51c638685" class="idref" href="#2aa3397e524bca32412338d51c638685"><span class="id" title="binder">σ</span></a><a id="2aa3397e524bca32412338d51c638685" class="idref" href="#2aa3397e524bca32412338d51c638685"><span class="id" title="binder">t</span></a> <a id="lreg:1190" class="idref" href="#lreg:1190"><span class="id" title="binder">lreg</span></a> <a id="lrt:1191" class="idref" href="#lrt:1191"><span class="id" title="binder">lrt</span></a> <a id="lmemf:1192" class="idref" href="#lmemf:1192"><span class="id" title="binder">lmemf</span></a> <a id="lmt:1193" class="idref" href="#lmt:1193"><span class="id" title="binder">lmt</span></a> <a id="src:1194" class="idref" href="#src:1194"><span class="id" title="binder">src</span></a> <a id="lwsrc:1195" class="idref" href="#lwsrc:1195"><span class="id" title="binder">lwsrc</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#sweep_reg"><span class="id" title="definition">sweep_reg</span></a> (<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8703b0f4162ca549491ecd1e24bfe5a3"><span class="id" title="variable">σ</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8703b0f4162ca549491ecd1e24bfe5a3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:1194"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lreg:1190"><span class="id" title="variable">lreg</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#src:1194"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwsrc:1195"><span class="id" title="variable">lwsrc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8703b0f4162ca549491ecd1e24bfe5a3"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2aa3397e524bca32412338d51c638685"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#2aa3397e524bca32412338d51c638685"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lreg:1190"><span class="id" title="variable">lreg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1191"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmemf:1192"><span class="id" title="variable">lmemf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1193"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.logical_mapsto.html#unique_in_registersL"><span class="id" title="definition">unique_in_registersL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lreg:1190"><span class="id" title="variable">lreg</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:1194"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lwsrc:1195"><span class="id" title="variable">lwsrc</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hsweep</span> <span class="id" title="var">Hsrc</span>) "Hσrm".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#transiently_abort"><span class="id" title="lemma">transiently_abort</span></a> <span class="id" title="notation">with</span> "Hσrm"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">cur_tb</span> <span class="id" title="var">prev_tb</span> <span class="id" title="var">all_tb</span>) "(Hr &amp; Hm &amp; %Hcurtbeq &amp; Hcurtb &amp; Hprevtb &amp; Halltb &amp; Hecauth &amp; %Hcurprevdisj &amp; %Hcompl &amp; %Hcurprevdisj2 &amp; %Hcompl2 &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#unique_in_registersL_mono"><span class="id" title="axiom">unique_in_registersL_mono</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsrc</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_unique_in_registers"><span class="id" title="axiom">state_corresponds_unique_in_registers</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.cap_lang.html#sweep_reg_spec"><span class="id" title="axiom">sweep_reg_spec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hsweep</span>) ; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_derive" class="idref" href="#state_interp_derive"><span class="id" title="lemma">state_interp_derive</span></a> (<a id="E:1196" class="idref" href="#E:1196"><span class="id" title="binder">E</span></a> : <span class="id" title="definition">coPset</span>) (<a id="s:1197" class="idref" href="#s:1197"><span class="id" title="binder">s</span></a> : <span class="id" title="inductive">stuckness</span>) (<a id="R:1198" class="idref" href="#R:1198"><span class="id" title="binder">R</span></a> <a id="P:1199" class="idref" href="#P:1199"><span class="id" title="binder">P</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="HPers:1200" class="idref" href="#HPers:1200"><span class="id" title="binder">HPers</span></a> : <span class="id" title="class">Persistent</span> <a class="idref" href="cap_machine.rules.rules_base.html#P:1199"><span class="id" title="variable">P</span></a>) <a id="8a5b2b1235d4eadd03ffb780fee4af16" class="idref" href="#8a5b2b1235d4eadd03ffb780fee4af16"><span class="id" title="binder">Φ</span></a> <a id="e:1202" class="idref" href="#e:1202"><span class="id" title="binder">e</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1202"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="78f1f578af732a2b49fc1272ebf27e3f" class="idref" href="#78f1f578af732a2b49fc1272ebf27e3f"><span class="id" title="binder">σ</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#R:1198"><span class="id" title="variable">R</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#78f1f578af732a2b49fc1272ebf27e3f"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#P:1199"><span class="id" title="variable">P</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#R:1198"><span class="id" title="variable">R</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#P:1199"><span class="id" title="variable">P</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:1197"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:1196"><span class="id" title="variable">E</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1202"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8a5b2b1235d4eadd03ffb780fee4af16"><span class="id" title="variable">Φ</span></a><span class="id" title="notation">))</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#R:1198"><span class="id" title="variable">R</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:1197"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:1196"><span class="id" title="variable">E</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1202"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8a5b2b1235d4eadd03ffb780fee4af16"><span class="id" title="variable">Φ</span></a><span class="id" title="notation">))</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">He</span>) "HRP Hwp HR".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">wp_unfold</span> /<span class="id" title="definition">wp_pre</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">He</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>) "Hσ /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>"HRP" <span class="id" title="notation">with</span> "[$HR $Hσ]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#HP".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>"Hwp" <span class="id" title="notation">with</span> "[$HR $HP]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSpecialize</span> <span class="id" title="notation">(</span>"Hwp" <span class="id" title="notation">$!</span> σ <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span> <span class="id" title="notation">with</span> "Hσ"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> ("Hwp") <span class="id" title="keyword">as</span> "[%Hred H]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? ? ?) "%Hstep Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span> <span class="id" title="notation">with</span> "Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="ec_bounds_etable" class="idref" href="#ec_bounds_etable"><span class="id" title="lemma">ec_bounds_etable</span></a> <a id="4f8759240aad36b0989679cb402e754e" class="idref" href="#4f8759240aad36b0989679cb402e754e"><span class="id" title="binder">σ</span></a> `{<a id="H0:1205" class="idref" href="#H0:1205"><span class="id" title="binder">ReservedAddresses</span></a>} `{<a id="ceriseG0:1206" class="idref" href="#ceriseG0:1206"><span class="id" title="binder">!</span></a><a id="ceriseG0:1206" class="idref" href="#ceriseG0:1206"><span class="id" title="binder">ceriseG</span></a> <a id="ceriseG0:1206" class="idref" href="#ceriseG0:1206"><span class="id" title="binder">Σ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4f8759240aad36b0989679cb402e754e"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <a id="i:1207" class="idref" href="#i:1207"><span class="id" title="binder">i</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#i:1207"><span class="id" title="variable">i</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#4f8759240aad36b0989679cb402e754e"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#i:1207"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4f8759240aad36b0989679cb402e754e"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a>)<span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "σ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "σ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vm</span> <span class="id" title="var">cur_tb</span> <span class="id" title="var">prev_tb</span> <span class="id" title="var">all_tb</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hlr &amp; Hlm &amp; %Hetable &amp; Hcur_tb &amp; Hprev_tb &amp; Hall_tb &amp; Hecauth &amp; %Hdomcurtb &amp; %Hdomtbcompl &amp; %Htbdisj &amp; %Htbcompl &amp; %Hcorr0)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hetable</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">elem_of_weaken</span> <span class="id" title="var">i</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">cur_tb</span>) (<span class="id" title="definition">dom</span> (<span class="id" title="var">cur_tb</span> <span class="id" title="notation">∪</span> <span class="id" title="var">prev_tb</span>))) <span class="id" title="tactic">in</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">list_to_set_seq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hdomtbcompl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_derive_instr_exec" class="idref" href="#state_interp_derive_instr_exec"><span class="id" title="lemma">state_interp_derive_instr_exec</span></a> (<a id="E:1208" class="idref" href="#E:1208"><span class="id" title="binder">E</span></a> : <span class="id" title="definition">coPset</span>) (<a id="s:1209" class="idref" href="#s:1209"><span class="id" title="binder">s</span></a> : <span class="id" title="inductive">stuckness</span>) (<a id="R:1210" class="idref" href="#R:1210"><span class="id" title="binder">R</span></a> <a id="P:1211" class="idref" href="#P:1211"><span class="id" title="binder">P</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="HPers:1212" class="idref" href="#HPers:1212"><span class="id" title="binder">HPers</span></a> : <span class="id" title="class">Persistent</span> <a class="idref" href="cap_machine.rules.rules_base.html#P:1211"><span class="id" title="variable">P</span></a>) <a id="911930cd065b6378e8762a39cc93706f" class="idref" href="#911930cd065b6378e8762a39cc93706f"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="797306caee025d12dbfafcdaf6ca2c13" class="idref" href="#797306caee025d12dbfafcdaf6ca2c13"><span class="id" title="binder">σ</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#R:1210"><span class="id" title="variable">R</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#797306caee025d12dbfafcdaf6ca2c13"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#P:1211"><span class="id" title="variable">P</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#R:1210"><span class="id" title="variable">R</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#P:1211"><span class="id" title="variable">P</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:1209"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:1208"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#911930cd065b6378e8762a39cc93706f"><span class="id" title="variable">Φ</span></a><span class="id" title="notation">))</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#R:1210"><span class="id" title="variable">R</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:1209"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:1208"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#911930cd065b6378e8762a39cc93706f"><span class="id" title="variable">Φ</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "HRP Hwp HR".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_derive"><span class="id" title="axiom">state_interp_derive</span></a> <span class="id" title="notation">with</span> "[$HRP] [$Hwp] [$HR]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_max_tidx" class="idref" href="#state_interp_max_tidx"><span class="id" title="lemma">state_interp_max_tidx</span></a> <a id="99d8f2e849cd7b5f00771e0dc93f7fcc" class="idref" href="#99d8f2e849cd7b5f00771e0dc93f7fcc"><span class="id" title="binder">σ</span></a> <a id="ecn:1216" class="idref" href="#ecn:1216"><span class="id" title="binder">ecn</span></a> <a id="tidx:1217" class="idref" href="#tidx:1217"><span class="id" title="binder">tidx</span></a> <a id="I:1218" class="idref" href="#I:1218"><span class="id" title="binder">I</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#99d8f2e849cd7b5f00771e0dc93f7fcc"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#d699e1eac025f99265fa61d377dbfa74"><span class="id" title="notation">EC</span></a><a class="idref" href="cap_machine.logical_mapsto.html#d699e1eac025f99265fa61d377dbfa74"><span class="id" title="notation">⤇</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ecn:1216"><span class="id" title="variable">ecn</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#enclave_all"><span class="id" title="definition">enclave_all</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#tidx:1217"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#I:1218"><span class="id" title="variable">I</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#tidx:1217"><span class="id" title="variable">tidx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ecn:1216"><span class="id" title="variable">ecn</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hinterp HEC Henclave".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#ec_bounds_etable"><span class="id" title="axiom">ec_bounds_etable</span></a> <span class="id" title="notation">with</span> "Hinterp"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hbound".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hinterp" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vm</span> <span class="id" title="var">cur_tb</span> <span class="id" title="var">prev_tb</span> <span class="id" title="var">all_tb</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hlr &amp; Hlm &amp; %Hetable &amp; Hcur_tb &amp; Hprev_tb &amp; Hall_tb &amp; Hecauth &amp; %Hdomcurtb &amp; %Hdomtbcompl &amp; %Htbdisj &amp; %Htbcompl &amp; %Hcorr0)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "Hecauth HEC" <span class="id" title="keyword">as</span> "Henumcur".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid</span> <span class="id" title="notation">with</span> "Henumcur"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hvalid_ec".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">excl_auth_agree_L</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvalid_ec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hvalid_ec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<span class="id" title="notation">⌜</span><span class="id" title="var">tidx</span> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <span class="id" title="var">all_tb</span><span class="id" title="notation">⌝</span>%<span class="id" title="var">I</span>) <span class="id" title="keyword">as</span> "%Hin".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "Hall_tb" "Henclave" <span class="id" title="keyword">as</span> "Hall".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid</span> <span class="id" title="notation">with</span> "Hall"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hvalid_all".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">auth_both_valid_discrete</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvalid_all</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hlt_all</span> <span class="id" title="var">Hvalid_all</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">gmap.dom_included</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlt_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">dom_singleton</span> <span class="id" title="lemma">dom_fmap</span> <span class="id" title="lemma">singleton_subseteq_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlt_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Htbcompl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hdomtbcompl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">list_to_set_seq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_solver</span> +<span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="valid_enclave_ec" class="idref" href="#valid_enclave_ec"><span class="id" title="lemma">valid_enclave_ec</span></a> <a id="ecn:1219" class="idref" href="#ecn:1219"><span class="id" title="binder">ecn</span></a> <a id="tidx:1220" class="idref" href="#tidx:1220"><span class="id" title="binder">tidx</span></a> <a id="I:1221" class="idref" href="#I:1221"><span class="id" title="binder">I</span></a> <a id="s:1222" class="idref" href="#s:1222"><span class="id" title="binder">s</span></a> <a id="E:1223" class="idref" href="#E:1223"><span class="id" title="binder">E</span></a> <a id="5cc12d00b3be0ba17f34a8a6a42f95c0" class="idref" href="#5cc12d00b3be0ba17f34a8a6a42f95c0"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">(</span> <a class="idref" href="cap_machine.logical_mapsto.html#d699e1eac025f99265fa61d377dbfa74"><span class="id" title="notation">EC</span></a><a class="idref" href="cap_machine.logical_mapsto.html#d699e1eac025f99265fa61d377dbfa74"><span class="id" title="notation">⤇</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ecn:1219"><span class="id" title="variable">ecn</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#enclave_all"><span class="id" title="definition">enclave_all</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#tidx:1220"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#I:1221"><span class="id" title="variable">I</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#tidx:1220"><span class="id" title="variable">tidx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ecn:1219"><span class="id" title="variable">ecn</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:1222"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:1223"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#5cc12d00b3be0ba17f34a8a6a42f95c0"><span class="id" title="variable">Φ</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">(</span> <a class="idref" href="cap_machine.logical_mapsto.html#d699e1eac025f99265fa61d377dbfa74"><span class="id" title="notation">EC</span></a><a class="idref" href="cap_machine.logical_mapsto.html#d699e1eac025f99265fa61d377dbfa74"><span class="id" title="notation">⤇</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ecn:1219"><span class="id" title="variable">ecn</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#enclave_all"><span class="id" title="definition">enclave_all</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#tidx:1220"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#I:1221"><span class="id" title="variable">I</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:1222"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:1223"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#5cc12d00b3be0ba17f34a8a6a42f95c0"><span class="id" title="variable">Φ</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hwp HR".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_derive_instr_exec"><span class="id" title="axiom">state_interp_derive_instr_exec</span></a> <span class="id" title="notation">with</span> "[] [$Hwp] [$HR]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ) "( (HEC &amp; Henclave) &amp; Hσ)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_max_tidx"><span class="id" title="axiom">state_interp_max_tidx</span></a> <span class="id" title="notation">with</span> "[$] [$] [$]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules.rules_base.html#cap_lang_rules_opt"><span class="id" title="section">cap_lang_rules_opt</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
