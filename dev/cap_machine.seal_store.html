<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">cap_machine.seal_store</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">gmap</span> <span class="id" title="library">auth</span> <span class="id" title="library">excl</span> <span class="id" title="library">csum</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">lib.own</span> <span class="id" title="library">saved_prop</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">proofmode</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.cap_lang.html#"><span class="id" title="library">cap_lang</span></a> <a class="idref" href="cap_machine.stdpp_extra.html#"><span class="id" title="library">stdpp_extra</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;No&nbsp;Excl'&nbsp;here:&nbsp;do&nbsp;not&nbsp;want&nbsp;the&nbsp;valid&nbsp;option&nbsp;element,&nbsp;as&nbsp;this&nbsp;disallows&nbsp;us&nbsp;from&nbsp;changing&nbsp;the&nbsp;branch&nbsp;in&nbsp;the&nbsp;sum&nbsp;type&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="csum_alter_l_r" class="idref" href="#csum_alter_l_r"><span class="id" title="lemma">csum_alter_l_r</span></a> {<a id="A:1" class="idref" href="#A:1"><span class="id" title="binder">A</span></a> : <span class="id" title="record">cmra</span>} {<a id="C:2" class="idref" href="#C:2"><span class="id" title="binder">C</span></a> : <span class="id" title="record">ofe</span>} (<a id="a:3" class="idref" href="#a:3"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.seal_store.html#A:1"><span class="id" title="variable">A</span></a>) (<a id="c:4" class="idref" href="#c:4"><span class="id" title="binder">c</span></a> : <a class="idref" href="cap_machine.seal_store.html#C:2"><span class="id" title="variable">C</span></a>) : <span class="id" title="notation">✓</span> <a class="idref" href="cap_machine.seal_store.html#a:3"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="constructor">Cinl</span> (<span class="id" title="constructor">Excl</span> <a class="idref" href="cap_machine.seal_store.html#c:4"><span class="id" title="variable">c</span></a>) <span class="id" title="notation">~~&gt;</span> <span class="id" title="constructor">Cinr</span> <a class="idref" href="cap_machine.seal_store.html#a:3"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hv</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">cmra_update_exclusive</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Excl_included_false" class="idref" href="#Excl_included_false"><span class="id" title="lemma">Excl_included_false</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="A:5" class="idref" href="#A:5"><span class="id" title="binder">A</span></a> : <span class="id" title="record">ofe</span>} {<a id="a:6" class="idref" href="#a:6"><span class="id" title="binder">a</span></a> <a id="b:7" class="idref" href="#b:7"><span class="id" title="binder">b</span></a> : <a class="idref" href="cap_machine.seal_store.html#A:5"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">},</span></a> <span class="id" title="constructor">Excl</span> <a class="idref" href="cap_machine.seal_store.html#a:6"><span class="id" title="variable">a</span></a> <span class="id" title="notation">≼</span> <span class="id" title="constructor">Excl</span> <a class="idref" href="cap_machine.seal_store.html#b:7"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="notation">False</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hi</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<span class="id" title="lemma">exclusive_included</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hi</span>).<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*&nbsp;resources&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="sealStoreG" class="idref" href="#sealStoreG"><span class="id" title="record">sealStoreG</span></a> <a id="cb3edd5393c7bbdf625595792a237037" class="idref" href="#cb3edd5393c7bbdf625595792a237037"><span class="id" title="binder">Σ</span></a> := <span class="id" title="var">SealStoreG</span> { <span class="comment">(*&nbsp;Create&nbsp;record&nbsp;constructor&nbsp;for&nbsp;typeclass&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="SG_sealStore" class="idref" href="#SG_sealStore"><span class="id" title="projection">SG_sealStore</span></a> ::  <span class="id" title="class">inG</span> <a class="idref" href="cap_machine.seal_store.html#cb3edd5393c7bbdf625595792a237037"><span class="id" title="variable">Σ</span></a> (<span class="id" title="definition">gmapUR</span> <a class="idref" href="cap_machine.addr_reg.html#OType"><span class="id" title="abbreviation">OType</span></a> (<span class="id" title="definition">csumR</span> (<span class="id" title="definition">exclR</span> <span class="id" title="definition">unitO</span>) (<span class="id" title="definition">agreeR</span> <span class="id" title="definition">gnameO</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="SG_storedPreds" class="idref" href="#SG_storedPreds"><span class="id" title="projection">SG_storedPreds</span></a> ::  <span class="id" title="abbreviation">savedPredG</span> <a class="idref" href="cap_machine.seal_store.html#cb3edd5393c7bbdf625595792a237037"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="SG_sealN" class="idref" href="#SG_sealN"><span class="id" title="projection">SG_sealN</span></a> : <span class="id" title="definition">gname</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="59cc5baffa0c84d83a39c0cde6bba64e" class="idref" href="#59cc5baffa0c84d83a39c0cde6bba64e"><span class="id" title="definition">sealStorePreΣ</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="notation">#[</span> <span class="id" title="constructor">GFunctor</span> (<span class="id" title="definition">gmapUR</span> <a class="idref" href="cap_machine.addr_reg.html#OType"><span class="id" title="abbreviation">OType</span></a> (<span class="id" title="definition">csumR</span> (<span class="id" title="definition">exclR</span> <span class="id" title="definition">unitO</span>) (<span class="id" title="definition">agreeR</span> <span class="id" title="definition">gnameO</span>)))<span class="id" title="notation">;</span> <span class="id" title="abbreviation">savedPredΣ</span> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a><span class="id" title="notation">]</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="sealStorePreG" class="idref" href="#sealStorePreG"><span class="id" title="record">sealStorePreG</span></a> <a id="475f6c17bae93ed6b0d4829862030679" class="idref" href="#475f6c17bae93ed6b0d4829862030679"><span class="id" title="binder">Σ</span></a> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="SG_sealStorePre" class="idref" href="#SG_sealStorePre"><span class="id" title="projection">SG_sealStorePre</span></a> ::  <span class="id" title="class">inG</span> <a class="idref" href="cap_machine.seal_store.html#475f6c17bae93ed6b0d4829862030679"><span class="id" title="variable">Σ</span></a> (<span class="id" title="definition">gmapUR</span> <a class="idref" href="cap_machine.addr_reg.html#OType"><span class="id" title="abbreviation">OType</span></a> (<span class="id" title="definition">csumR</span> (<span class="id" title="definition">exclR</span> <span class="id" title="definition">unitO</span>) (<span class="id" title="definition">agreeR</span> <span class="id" title="definition">gnameO</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="SG_storedPredsPre" class="idref" href="#SG_storedPredsPre"><span class="id" title="projection">SG_storedPredsPre</span></a> ::  <span class="id" title="abbreviation">savedPredG</span> <a class="idref" href="cap_machine.seal_store.html#475f6c17bae93ed6b0d4829862030679"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <a id="sealStoreG_preG" class="idref" href="#sealStoreG_preG"><span class="id" title="instance">sealStoreG_preG</span></a> `{<a id="H:18" class="idref" href="#H:18"><span class="id" title="binder">sealStoreG</span></a> <a id="9e57768f7d1333d5d23f870b726fb0dd" class="idref" href="#9e57768f7d1333d5d23f870b726fb0dd"><span class="id" title="binder"><span id="H:18" class="id">Σ</span></span></a>} : <a class="idref" href="cap_machine.seal_store.html#sealStorePreG"><span class="id" title="class">sealStorePreG</span></a> <a class="idref" href="cap_machine.seal_store.html#9e57768f7d1333d5d23f870b726fb0dd"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="var">all</span>: <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="86b93b198b2039977bdf909750a3e767" class="idref" href="#86b93b198b2039977bdf909750a3e767"><span class="id" title="instance">subG_sealStorePreΣ</span></a> {<a id="957e39afe9f7f3b3133a35f49f47db88" class="idref" href="#957e39afe9f7f3b3133a35f49f47db88"><span class="id" title="binder">Σ</span></a>}:<br/>
&nbsp;&nbsp;<span class="id" title="class">subG</span> <a class="idref" href="cap_machine.seal_store.html#59cc5baffa0c84d83a39c0cde6bba64e"><span class="id" title="definition">sealStorePreΣ</span></a> <a class="idref" href="cap_machine.seal_store.html#957e39afe9f7f3b3133a35f49f47db88"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.seal_store.html#sealStorePreG"><span class="id" title="class">sealStorePreG</span></a> <a class="idref" href="cap_machine.seal_store.html#957e39afe9f7f3b3133a35f49f47db88"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">solve_inG</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Auxiliary&nbsp;lemma's&nbsp;about&nbsp;gmap&nbsp;domains&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="gmap_none_convert" class="idref" href="#gmap_none_convert"><span class="id" title="lemma">gmap_none_convert</span></a> `{<a id="H:22" class="idref" href="#H:22"><span class="id" title="binder">Countable</span></a> <a id="K:20" class="idref" href="#K:20"><span class="id" title="binder"><span id="H:22" class="id">K</span></span></a>} {<a id="A:23" class="idref" href="#A:23"><span class="id" title="binder">A</span></a> <a id="B:24" class="idref" href="#B:24"><span class="id" title="binder">B</span></a>: <span class="id" title="keyword">Type</span>} (<a id="g1:25" class="idref" href="#g1:25"><span class="id" title="binder">g1</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.seal_store.html#K:20"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.seal_store.html#A:23"><span class="id" title="variable">A</span></a>) (<a id="g2:26" class="idref" href="#g2:26"><span class="id" title="binder">g2</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.seal_store.html#K:20"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.seal_store.html#B:24"><span class="id" title="variable">B</span></a>) (<a id="i:27" class="idref" href="#i:27"><span class="id" title="binder">i</span></a> : <a class="idref" href="cap_machine.seal_store.html#K:20"><span class="id" title="variable">K</span></a>): <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.seal_store.html#g1:25"><span class="id" title="variable">g1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.seal_store.html#g2:26"><span class="id" title="variable">g2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.seal_store.html#g1:25"><span class="id" title="variable">g1</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.seal_store.html#i:27"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.seal_store.html#g2:26"><span class="id" title="variable">g2</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.seal_store.html#i:27"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hnon</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hnon</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hdom</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hnon</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="gmap_isSome_convert" class="idref" href="#gmap_isSome_convert"><span class="id" title="lemma">gmap_isSome_convert</span></a> `{<a id="H:30" class="idref" href="#H:30"><span class="id" title="binder">Countable</span></a> <a id="K:28" class="idref" href="#K:28"><span class="id" title="binder"><span id="H:30" class="id">K</span></span></a>} {<a id="A:31" class="idref" href="#A:31"><span class="id" title="binder">A</span></a> <a id="B:32" class="idref" href="#B:32"><span class="id" title="binder">B</span></a>: <span class="id" title="keyword">Type</span>} (<a id="g1:33" class="idref" href="#g1:33"><span class="id" title="binder">g1</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.seal_store.html#K:28"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.seal_store.html#A:31"><span class="id" title="variable">A</span></a>) (<a id="g2:34" class="idref" href="#g2:34"><span class="id" title="binder">g2</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.seal_store.html#K:28"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.seal_store.html#B:32"><span class="id" title="variable">B</span></a>) (<a id="i:35" class="idref" href="#i:35"><span class="id" title="binder">i</span></a> : <a class="idref" href="cap_machine.seal_store.html#K:28"><span class="id" title="variable">K</span></a>): <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.seal_store.html#g1:33"><span class="id" title="variable">g1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.seal_store.html#g2:34"><span class="id" title="variable">g2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.seal_store.html#g1:33"><span class="id" title="variable">g1</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.seal_store.html#i:35"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.seal_store.html#g2:34"><span class="id" title="variable">g2</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.seal_store.html#i:35"><span class="id" title="variable">i</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hnon</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hnon</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hdom</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hnon</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Store" class="idref" href="#Store"><span class="id" title="section">Store</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="sealStoreG0:37" class="idref" href="#sealStoreG0:37"><span class="id" title="binder">!</span></a><a id="sealStoreG0:37" class="idref" href="#sealStoreG0:37"><span class="id" title="binder">sealStoreG</span></a> <a id="06f02a2e1ae1dbc558fdd78ca814765d" class="idref" href="#06f02a2e1ae1dbc558fdd78ca814765d"><span class="id" title="binder"><span id="sealStoreG0:37" class="id">Σ</span></span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="seal_pred" class="idref" href="#seal_pred"><span class="id" title="definition">seal_pred</span></a> (<a id="o:38" class="idref" href="#o:38"><span class="id" title="binder">o</span></a> : <a class="idref" href="cap_machine.addr_reg.html#OType"><span class="id" title="abbreviation">OType</span></a>) (<a id="P:39" class="idref" href="#P:39"><span class="id" title="binder">P</span></a> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.seal_store.html#437ead16bbe2f4e451feaffaf37d17a8"><span class="id" title="variable">Σ</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">∃</span> <a id="1a0472e0d4bfedf8d17c61641bd0f3c1" class="idref" href="#1a0472e0d4bfedf8d17c61641bd0f3c1"><span class="id" title="binder">γpred</span></a>: <span class="id" title="definition">gname</span><span class="id" title="notation">,</span> <span class="id" title="definition">own</span> <a class="idref" href="cap_machine.seal_store.html#SG_sealN"><span class="id" title="method">SG_sealN</span></a> (<span class="id" title="notation">{[</span><a class="idref" href="cap_machine.seal_store.html#o:38"><span class="id" title="variable">o</span></a> <span class="id" title="notation">:=</span> <span class="id" title="constructor">Cinr</span> (<span class="id" title="definition">to_agree</span> <a class="idref" href="cap_machine.seal_store.html#1a0472e0d4bfedf8d17c61641bd0f3c1"><span class="id" title="variable">γpred</span></a>)<span class="id" title="notation">]}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="definition">saved_pred_own</span> <a class="idref" href="cap_machine.seal_store.html#1a0472e0d4bfedf8d17c61641bd0f3c1"><span class="id" title="variable">γpred</span></a> <span class="id" title="constructor">DfracDiscarded</span> <a class="idref" href="cap_machine.seal_store.html#P:39"><span class="id" title="variable">P</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="seal_pred_persistent" class="idref" href="#seal_pred_persistent"><span class="id" title="instance">seal_pred_persistent</span></a> <a id="i:41" class="idref" href="#i:41"><span class="id" title="binder">i</span></a> <a id="P:42" class="idref" href="#P:42"><span class="id" title="binder">P</span></a> : <span class="id" title="class">Persistent</span> (<a class="idref" href="cap_machine.seal_store.html#seal_pred"><span class="id" title="definition">seal_pred</span></a> <a class="idref" href="cap_machine.seal_store.html#i:41"><span class="id" title="variable">i</span></a> <a class="idref" href="cap_machine.seal_store.html#P:42"><span class="id" title="variable">P</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="can_alloc_pred" class="idref" href="#can_alloc_pred"><span class="id" title="definition">can_alloc_pred</span></a> (<a id="o:43" class="idref" href="#o:43"><span class="id" title="binder">o</span></a> : <a class="idref" href="cap_machine.addr_reg.html#OType"><span class="id" title="abbreviation">OType</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">own</span> <a class="idref" href="cap_machine.seal_store.html#SG_sealN"><span class="id" title="method">SG_sealN</span></a> (<span class="id" title="notation">{[</span><a class="idref" href="cap_machine.seal_store.html#o:43"><span class="id" title="variable">o</span></a> <span class="id" title="notation">:=</span> <span class="id" title="constructor">Cinl</span> (<span class="id" title="constructor">Excl</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Program.Syntax.html#f5cb26d96fc0400fc3c881290947e554"><span class="id" title="notation">()</span></a>)<span class="id" title="notation">]}</span>))%<span class="id" title="var">I</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="seal_pred_agree" class="idref" href="#seal_pred_agree"><span class="id" title="lemma">seal_pred_agree</span></a> <a id="o:44" class="idref" href="#o:44"><span class="id" title="binder">o</span></a> <a id="P:45" class="idref" href="#P:45"><span class="id" title="binder">P</span></a> <a id="P':46" class="idref" href="#P':46"><span class="id" title="binder">P'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.seal_store.html#seal_pred"><span class="id" title="definition">seal_pred</span></a> <a class="idref" href="cap_machine.seal_store.html#o:44"><span class="id" title="variable">o</span></a> <a class="idref" href="cap_machine.seal_store.html#P:45"><span class="id" title="variable">P</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.seal_store.html#seal_pred"><span class="id" title="definition">seal_pred</span></a> <a class="idref" href="cap_machine.seal_store.html#o:44"><span class="id" title="variable">o</span></a> <a class="idref" href="cap_machine.seal_store.html#P':46"><span class="id" title="variable">P'</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:47" class="idref" href="#x:47"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.seal_store.html#P:45"><span class="id" title="variable">P</span></a> <a class="idref" href="cap_machine.seal_store.html#x:47"><span class="id" title="variable">x</span></a> <span class="id" title="notation">≡</span> <a class="idref" href="cap_machine.seal_store.html#P':46"><span class="id" title="variable">P'</span></a> <a class="idref" href="cap_machine.seal_store.html#x:47"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.seal_store.html#seal_pred"><span class="id" title="definition">seal_pred</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hr1" <span class="id" title="keyword">as</span> (<span class="id" title="var">γ1</span>) "[Hown1 Hpred1]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hr2" <span class="id" title="keyword">as</span> (<span class="id" title="var">γ2</span>) "[Hown2 Hpred2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid_2</span> <span class="id" title="notation">with</span> "Hown1 Hown2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">singleton_op</span> <span class="id" title="lemma">singleton_valid</span> -<span class="id" title="lemma">Cinr_op</span> <span class="id" title="lemma">Cinr_valid</span>  <span class="id" title="lemma">to_agree_op_valid_L</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">x</span>). <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">saved_pred_agree</span> <span class="id" title="notation">with</span> "Hpred1 Hpred2"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="seal_store_update_alloc" class="idref" href="#seal_store_update_alloc"><span class="id" title="lemma">seal_store_update_alloc</span></a> (<a id="o:48" class="idref" href="#o:48"><span class="id" title="binder">o</span></a> : <a class="idref" href="cap_machine.addr_reg.html#OType"><span class="id" title="abbreviation">OType</span></a>) (<a id="P:49" class="idref" href="#P:49"><span class="id" title="binder">P</span></a> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.seal_store.html#437ead16bbe2f4e451feaffaf37d17a8"><span class="id" title="variable">Σ</span></a>):<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.seal_store.html#can_alloc_pred"><span class="id" title="definition">can_alloc_pred</span></a> <a class="idref" href="cap_machine.seal_store.html#o:48"><span class="id" title="variable">o</span></a> <span class="id" title="notation">==∗</span> <a class="idref" href="cap_machine.seal_store.html#seal_pred"><span class="id" title="definition">seal_pred</span></a> <a class="idref" href="cap_machine.seal_store.html#o:48"><span class="id" title="variable">o</span></a> <a class="idref" href="cap_machine.seal_store.html#P:49"><span class="id" title="variable">P</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.seal_store.html#seal_pred"><span class="id" title="definition">seal_pred</span></a> /<a class="idref" href="cap_machine.seal_store.html#can_alloc_pred"><span class="id" title="definition">can_alloc_pred</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hown".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> (<span class="id" title="lemma">saved_pred_alloc</span> <span class="id" title="var">P</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">γalloc</span>) "#HsaveP"; <span class="id" title="tactic">first</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">dfrac_valid_discarded</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_update</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="notation">{[</span><span class="id" title="var">o</span> <span class="id" title="notation">:=</span> <span class="id" title="constructor">Cinr</span> (<span class="id" title="definition">to_agree</span> <span class="id" title="var">γalloc</span>)<span class="id" title="notation">]}</span>) <span class="id" title="notation">with</span> "Hown"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">singleton_update</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.seal_store.html#csum_alter_l_r"><span class="id" title="axiom">csum_alter_l_r</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.seal_store.html#Store"><span class="id" title="section">Store</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Initialize&nbsp;the&nbsp;seal&nbsp;store&nbsp;under&nbsp;an&nbsp;arbitrary&nbsp;name&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="seal_store_init" class="idref" href="#seal_store_init"><span class="id" title="lemma">seal_store_init</span></a> `{<a id="H:51" class="idref" href="#H:51"><span class="id" title="binder">sealStorePreG</span></a> <a id="5e7c4b3dd4ea648743d1e7a49f2d7bf6" class="idref" href="#5e7c4b3dd4ea648743d1e7a49f2d7bf6"><span class="id" title="binder"><span id="H:51" class="id">Σ'</span></span></a>} <a id="oset:52" class="idref" href="#oset:52"><span class="id" title="binder">oset</span></a>:<br/>
&nbsp;<span class="id" title="notation">⊢</span> (<span class="id" title="notation">|==&gt;</span> <span class="id" title="notation">∃</span> <span class="id" title="notation">(</span><span class="id" title="var">_</span> : <a class="idref" href="cap_machine.seal_store.html#sealStoreG"><span class="id" title="class">sealStoreG</span></a> <a class="idref" href="cap_machine.seal_store.html#5e7c4b3dd4ea648743d1e7a49f2d7bf6"><span class="id" title="variable">Σ'</span></a><span class="id" title="notation">),</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">[∗</span> <span class="id" title="notation">set</span><span class="id" title="notation">]</span> <a id="o:53" class="idref" href="#o:53"><span class="id" title="binder"><span id="o:54" class="id">o</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.seal_store.html#oset:52"><span class="id" title="variable">oset</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.seal_store.html#can_alloc_pred"><span class="id" title="definition">can_alloc_pred</span></a> <a class="idref" href="cap_machine.seal_store.html#o:53"><span class="id" title="variable">o</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.seal_store.html#5e7c4b3dd4ea648743d1e7a49f2d7bf6"><span class="id" title="variable">Σ'</span></a>)%<span class="id" title="var">I</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iMod</span> (<span class="id" title="lemma">own_alloc</span> (<span class="id" title="var">A</span>:= (<span class="id" title="definition">gmapUR</span> <a class="idref" href="cap_machine.addr_reg.html#OType"><span class="id" title="abbreviation">OType</span></a> (<span class="id" title="definition">csumR</span> (<span class="id" title="definition">exclR</span> <span class="id" title="definition">unitO</span>) (<span class="id" title="definition">agreeR</span> <span class="id" title="definition">gnameO</span>)))) (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">(</span></a><span class="id" title="definition">gset_to_gmap</span> (<span class="id" title="constructor">Cinl</span> (<span class="id" title="constructor">Excl</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Program.Syntax.html#f5cb26d96fc0400fc3c881290947e554"><span class="id" title="notation">()</span></a>)) <span class="id" title="var">oset</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">):</span></a> <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#OType"><span class="id" title="abbreviation">OType</span></a> (<span class="id" title="definition">csumR</span> (<span class="id" title="definition">exclR</span> <span class="id" title="definition">unitO</span>) (<span class="id" title="definition">agreeR</span> <span class="id" title="definition">gnameO</span>)))) <span class="id" title="keyword">as</span> (<span class="id" title="var">γ</span>) "H".<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="definition">gset_to_gmap</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="notation">!!</span> <span class="id" title="var">i</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_gset_to_gmap_Some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> &lt;-]. }<br/>
&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iExists</span> (<a class="idref" href="cap_machine.seal_store.html#SealStoreG"><span class="id" title="constructor">SealStoreG</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">γ</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">iInduction</span> <span class="id" title="var">oset</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">x</span> <span class="id" title="var">oset</span> <span class="id" title="var">Hni</span>] "IH" <span class="id" title="keyword">using</span> <span class="id" title="lemma">set_ind_L</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepS_union</span>. <span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">gset_to_gmap_union_singleton</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">insert_singleton_op</span>. 2: <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_gset_to_gmap_None</span>; <span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_op</span> <span class="id" title="notation">with</span> "H"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hx H]".<br/>
&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hx".<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepS_singleton</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "IH".<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
