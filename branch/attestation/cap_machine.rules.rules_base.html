<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">cap_machine.rules.rules_base</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">proofmode</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">invariants</span> <span class="id" title="library">gen_heap</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">weakestpre</span> <span class="id" title="library">ectx_lifting</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">frac</span> <span class="id" title="library">auth</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.logical_mapsto.html#"><span class="id" title="library">logical_mapsto</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.cap_lang.html#"><span class="id" title="library">cap_lang</span></a> <a class="idref" href="cap_machine.iris_extra.html#"><span class="id" title="library">iris_extra</span></a> <a class="idref" href="cap_machine.stdpp_extra.html#"><span class="id" title="library">stdpp_extra</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;---------------------------&nbsp;LTAC&nbsp;DEFINITIONS&nbsp;-----------------------------------&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv_head_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">progress</span> <span class="id" title="var">simplify_map_eq</span>/= <span class="comment">(*&nbsp;simplify&nbsp;memory&nbsp;stuff&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#of_to_val"><span class="id" title="axiom">of_to_val</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.cap_lang.html#of_val"><span class="id" title="definition">of_val</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_var</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">first</span>[<span class="id" title="tactic">discriminate</span> <span class="id" title="var">H</span>|<span class="id" title="tactic">injection</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">cap_lang.prim_step</span></a> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">is_var</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">fail</span> 1); <span class="comment">(*&nbsp;inversion&nbsp;yields&nbsp;many&nbsp;goals&nbsp;if&nbsp;<span class="inlinecode"><span class="id" title="var">e</span></span>&nbsp;is&nbsp;a&nbsp;variable&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;can&nbsp;thus&nbsp;better&nbsp;be&nbsp;avoided.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> φ := <span class="id" title="tactic">fresh</span> "φ" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [| φ]; <span class="id" title="tactic">subst</span> φ; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_rules" class="idref" href="#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:1" class="idref" href="#H:1"><span class="id" title="binder">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H0:3" class="idref" href="#H0:3"><span class="id" title="binder">memG</span></a> <a id="ebf069dbc779b42a15c441a6d39d5f83" class="idref" href="#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="binder"><span id="H0:3" class="id">Σ</span></span></a>, <a id="H1:4" class="idref" href="#H1:4"><span class="id" title="binder">regG</span></a> <a id="H1:4" class="idref" href="#H1:4"><span class="id" title="binder">Σ</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">c</span> : <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">la</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lw</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lregs</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">mem</span> : <a class="idref" href="cap_machine.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lmem</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Conditionally&nbsp;unify&nbsp;on&nbsp;the&nbsp;read&nbsp;register&nbsp;value&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="read_reg_inr" class="idref" href="#read_reg_inr"><span class="id" title="definition">read_reg_inr</span></a> (<a id="lregs:5" class="idref" href="#lregs:5"><span class="id" title="binder">lregs</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="r:6" class="idref" href="#r:6"><span class="id" title="binder">r</span></a> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) <a id="p:7" class="idref" href="#p:7"><span class="id" title="binder">p</span></a> <a id="b:8" class="idref" href="#b:8"><span class="id" title="binder">b</span></a> <a id="e:9" class="idref" href="#e:9"><span class="id" title="binder">e</span></a> <a id="a:10" class="idref" href="#a:10"><span class="id" title="binder">a</span></a> <a id="v:11" class="idref" href="#v:11"><span class="id" title="binder">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:5"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:6"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">b'</span> <span class="id" title="var">e'</span> <span class="id" title="var">a'</span> <span class="id" title="var">v'</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">b'</span> <span class="id" title="var">e'</span> <span class="id" title="var">a'</span> <span class="id" title="var">v'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:7"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:8"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:9"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:10"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:11"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="notation">False</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;registers&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_dupl_false" class="idref" href="#regname_dupl_false"><span class="id" title="lemma">regname_dupl_false</span></a> <a id="r:12" class="idref" href="#r:12"><span class="id" title="binder">r</span></a> <a id="lw1:13" class="idref" href="#lw1:13"><span class="id" title="binder">lw1</span></a> <a id="lw2:14" class="idref" href="#lw2:14"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:12"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:13"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:12"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:14"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">mapsto_valid_2</span> <span class="id" title="notation">with</span> "Hr1 Hr2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">dfrac_full_exclusive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_neq" class="idref" href="#regname_neq"><span class="id" title="lemma">regname_neq</span></a> <a id="r1:15" class="idref" href="#r1:15"><span class="id" title="binder">r1</span></a> <a id="r2:16" class="idref" href="#r2:16"><span class="id" title="binder">r2</span></a> <a id="lw1:17" class="idref" href="#lw1:17"><span class="id" title="binder">lw1</span></a> <a id="lw2:18" class="idref" href="#lw2:18"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:15"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:17"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:16"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:18"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:15"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:16"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2" (?). <span class="id" title="tactic">subst</span> <span class="id" title="var">r1</span>. <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_dupl_false"><span class="id" title="axiom">regname_dupl_false</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_1" class="idref" href="#regs_of_map_1"><span class="id" title="lemma">regs_of_map_1</span></a> (<a id="r1:19" class="idref" href="#r1:19"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:20" class="idref" href="#lw1:20"><span class="id" title="binder">lw1</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:21" class="idref" href="#k:21"><span class="id" title="binder"><span id="k:22" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:23" class="idref" href="#y:23"><span class="id" title="binder"><span id="y:24" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:19"><span class="id" title="variable">r1</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:20"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]}</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:21"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:23"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:19"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:20"><span class="id" title="variable">lw1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_singleton</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_2" class="idref" href="#map_of_regs_2"><span class="id" title="lemma">map_of_regs_2</span></a> (<a id="r1:25" class="idref" href="#r1:25"><span class="id" title="binder">r1</span></a> <a id="r2:26" class="idref" href="#r2:26"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:27" class="idref" href="#lw1:27"><span class="id" title="binder">lw1</span></a> <a id="lw2:28" class="idref" href="#lw2:28"><span class="id" title="binder">lw2</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:25"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:27"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:26"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:28"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:29" class="idref" href="#k:29"><span class="id" title="binder"><span id="k:30" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:31" class="idref" href="#y:31"><span class="id" title="binder"><span id="y:32" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:25"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:27"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:29"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:31"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:25"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:26"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2". <span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_2" class="idref" href="#regs_of_map_2"><span class="id" title="lemma">regs_of_map_2</span></a> (<a id="r1:33" class="idref" href="#r1:33"><span class="id" title="binder">r1</span></a> <a id="r2:34" class="idref" href="#r2:34"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:35" class="idref" href="#lw1:35"><span class="id" title="binder">lw1</span></a> <a id="lw2:36" class="idref" href="#lw2:36"><span class="id" title="binder">lw2</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:33"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:34"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:37" class="idref" href="#k:37"><span class="id" title="binder"><span id="k:38" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:39" class="idref" href="#y:39"><span class="id" title="binder"><span id="y:40" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:33"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:35"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:37"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:39"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:33"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:35"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:34"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:36"><span class="id" title="variable">lw2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_3" class="idref" href="#map_of_regs_3"><span class="id" title="lemma">map_of_regs_3</span></a> (<a id="r1:41" class="idref" href="#r1:41"><span class="id" title="binder">r1</span></a> <a id="r2:42" class="idref" href="#r2:42"><span class="id" title="binder">r2</span></a> <a id="r3:43" class="idref" href="#r3:43"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:44" class="idref" href="#w1:44"><span class="id" title="binder">w1</span></a> <a id="w2:45" class="idref" href="#w2:45"><span class="id" title="binder">w2</span></a> <a id="w3:46" class="idref" href="#w3:46"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:41"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:44"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:42"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:45"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:43"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:46"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:47" class="idref" href="#k:47"><span class="id" title="binder"><span id="k:48" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:49" class="idref" href="#y:49"><span class="id" title="binder"><span id="y:50" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:41"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:44"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:47"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:49"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:41"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:42"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:41"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:43"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:42"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:43"><span class="id" title="variable">r3</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_3" class="idref" href="#regs_of_map_3"><span class="id" title="lemma">regs_of_map_3</span></a> (<a id="r1:51" class="idref" href="#r1:51"><span class="id" title="binder">r1</span></a> <a id="r2:52" class="idref" href="#r2:52"><span class="id" title="binder">r2</span></a> <a id="r3:53" class="idref" href="#r3:53"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:54" class="idref" href="#w1:54"><span class="id" title="binder">w1</span></a> <a id="w2:55" class="idref" href="#w2:55"><span class="id" title="binder">w2</span></a> <a id="w3:56" class="idref" href="#w3:56"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:51"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:52"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:51"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:53"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:52"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:53"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:57" class="idref" href="#k:57"><span class="id" title="binder"><span id="k:58" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:59" class="idref" href="#y:59"><span class="id" title="binder"><span id="y:60" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:51"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:54"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:57"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:59"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:51"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:54"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:52"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:55"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:53"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:56"><span class="id" title="variable">w3</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? ? ?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_4" class="idref" href="#map_of_regs_4"><span class="id" title="lemma">map_of_regs_4</span></a> (<a id="r1:61" class="idref" href="#r1:61"><span class="id" title="binder">r1</span></a> <a id="r2:62" class="idref" href="#r2:62"><span class="id" title="binder">r2</span></a> <a id="r3:63" class="idref" href="#r3:63"><span class="id" title="binder">r3</span></a> <a id="r4:64" class="idref" href="#r4:64"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:65" class="idref" href="#w1:65"><span class="id" title="binder">w1</span></a> <a id="w2:66" class="idref" href="#w2:66"><span class="id" title="binder">w2</span></a> <a id="w3:67" class="idref" href="#w3:67"><span class="id" title="binder">w3</span></a> <a id="w4:68" class="idref" href="#w4:68"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:61"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:65"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:62"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:66"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:63"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:67"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r4:64"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w4:68"><span class="id" title="variable">w4</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:69" class="idref" href="#k:69"><span class="id" title="binder"><span id="k:70" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:71" class="idref" href="#y:71"><span class="id" title="binder"><span id="y:72" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:61"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:65"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:69"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:71"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:61"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:62"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:61"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:63"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:61"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:64"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:62"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:63"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:62"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:64"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:63"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:64"><span class="id" title="variable">r4</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3 H4".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H3 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_4" class="idref" href="#regs_of_map_4"><span class="id" title="lemma">regs_of_map_4</span></a> (<a id="r1:73" class="idref" href="#r1:73"><span class="id" title="binder">r1</span></a> <a id="r2:74" class="idref" href="#r2:74"><span class="id" title="binder">r2</span></a> <a id="r3:75" class="idref" href="#r3:75"><span class="id" title="binder">r3</span></a> <a id="r4:76" class="idref" href="#r4:76"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:77" class="idref" href="#w1:77"><span class="id" title="binder">w1</span></a> <a id="w2:78" class="idref" href="#w2:78"><span class="id" title="binder">w2</span></a> <a id="w3:79" class="idref" href="#w3:79"><span class="id" title="binder">w3</span></a> <a id="w4:80" class="idref" href="#w4:80"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:73"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:74"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:73"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:75"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:73"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:76"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:74"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:75"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:74"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:76"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:75"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:76"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:81" class="idref" href="#k:81"><span class="id" title="binder"><span id="k:82" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:83" class="idref" href="#y:83"><span class="id" title="binder"><span id="y:84" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:73"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:77"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:81"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:83"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:73"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:77"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:74"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:78"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:75"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:79"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r4:76"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w4:80"><span class="id" title="variable">w4</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;memory&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="addr_dupl_false" class="idref" href="#addr_dupl_false"><span class="id" title="lemma">addr_dupl_false</span></a> <a id="la:85" class="idref" href="#la:85"><span class="id" title="binder">la</span></a> <a id="lw1:86" class="idref" href="#lw1:86"><span class="id" title="binder">lw1</span></a> <a id="lw2:87" class="idref" href="#lw2:87"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la:85"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:86"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:85"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:87"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ha1 Ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">mapsto_valid_2</span> <span class="id" title="notation">with</span> "Ha1 Ha2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">dfrac_full_exclusive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;semantic&nbsp;heap&nbsp;+&nbsp;a&nbsp;map&nbsp;of&nbsp;pointsto&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM_general" class="idref" href="#gen_heap_valid_inSepM_general"><span class="id" title="lemma">gen_heap_valid_inSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:88" class="idref" href="#L:88"><span class="id" title="binder">L</span></a> <a id="V:89" class="idref" href="#V:89"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:90" class="idref" href="#EqDecision0:90"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:88"><span class="id" title="variable">L</span></a>) (<a id="H:91" class="idref" href="#H:91"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:88"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ad55bb628a30602c3defc5575918601a" class="idref" href="#ad55bb628a30602c3defc5575918601a"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:93" class="idref" href="#gen_heapG0:93"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:88"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:89"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ad55bb628a30602c3defc5575918601a"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="59be68275f41c0f673348557133ed470" class="idref" href="#59be68275f41c0f673348557133ed470"><span class="id" title="binder">d</span></a><a id="59be68275f41c0f673348557133ed470" class="idref" href="#59be68275f41c0f673348557133ed470"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:88"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:89"><span class="id" title="variable">V</span></a>)) (<a id="781cc6ac800ff5ee4132feeb1e847894" class="idref" href="#781cc6ac800ff5ee4132feeb1e847894"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:88"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:89"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:96" class="idref" href="#l:96"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:88"><span class="id" title="variable">L</span></a>) (<a id="dq:97" class="idref" href="#dq:97"><span class="id" title="binder">dq</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="v:98" class="idref" href="#v:98"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:89"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#59be68275f41c0f673348557133ed470"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#59be68275f41c0f673348557133ed470"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:96"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:97"><span class="id" title="variable">dq</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:98"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#781cc6ac800ff5ee4132feeb1e847894"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:99" class="idref" href="#k:99"><span class="id" title="binder"><span id="k:100" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:101" class="idref" href="#dqw:101"><span class="id" title="binder"><span id="dqw:102" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#59be68275f41c0f673348557133ed470"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#59be68275f41c0f673348557133ed470"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:99"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:101"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:101"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#781cc6ac800ff5ee4132feeb1e847894"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:96"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:98"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>σ <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM" class="idref" href="#gen_heap_valid_inSepM"><span class="id" title="lemma">gen_heap_valid_inSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:103" class="idref" href="#L:103"><span class="id" title="binder">L</span></a> <a id="V:104" class="idref" href="#V:104"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:105" class="idref" href="#EqDecision0:105"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:103"><span class="id" title="variable">L</span></a>) (<a id="H:106" class="idref" href="#H:106"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:103"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="3cedca6701e55d274b90a4066ad3c858" class="idref" href="#3cedca6701e55d274b90a4066ad3c858"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:108" class="idref" href="#gen_heapG0:108"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:103"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:104"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3cedca6701e55d274b90a4066ad3c858"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="66bb6311431535f3cc79de09667e185f" class="idref" href="#66bb6311431535f3cc79de09667e185f"><span class="id" title="binder">σ</span></a> <a id="0c6ae36d4a6cab72d2d870250764035a" class="idref" href="#0c6ae36d4a6cab72d2d870250764035a"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:103"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:104"><span class="id" title="variable">V</span></a>) (<a id="l:111" class="idref" href="#l:111"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:103"><span class="id" title="variable">L</span></a>) (<a id="q:112" class="idref" href="#q:112"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span>) (<a id="v:113" class="idref" href="#v:113"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:104"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#0c6ae36d4a6cab72d2d870250764035a"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:111"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:113"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#66bb6311431535f3cc79de09667e185f"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:114" class="idref" href="#k:114"><span class="id" title="binder"><span id="k:115" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:116" class="idref" href="#y:116"><span class="id" title="binder"><span id="y:117" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#0c6ae36d4a6cab72d2d870250764035a"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:114"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:112"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:116"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#66bb6311431535f3cc79de09667e185f"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:111"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:113"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM'" class="idref" href="#gen_heap_valid_inSepM'"><span class="id" title="lemma">gen_heap_valid_inSepM'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:118" class="idref" href="#L:118"><span class="id" title="binder">L</span></a> <a id="V:119" class="idref" href="#V:119"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:120" class="idref" href="#EqDecision0:120"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:118"><span class="id" title="variable">L</span></a>) (<a id="H:121" class="idref" href="#H:121"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:118"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="89c991e573d576d4ce9b4ce8f6af8d89" class="idref" href="#89c991e573d576d4ce9b4ce8f6af8d89"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:123" class="idref" href="#gen_heapG0:123"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:118"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:119"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#89c991e573d576d4ce9b4ce8f6af8d89"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="95270db9d09194b606d8cb9477013c9d" class="idref" href="#95270db9d09194b606d8cb9477013c9d"><span class="id" title="binder">σ</span></a> <a id="73d6f9d55cf287e331abf9c6d4c1ac68" class="idref" href="#73d6f9d55cf287e331abf9c6d4c1ac68"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:118"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:119"><span class="id" title="variable">V</span></a>) (<a id="q:126" class="idref" href="#q:126"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#95270db9d09194b606d8cb9477013c9d"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:127" class="idref" href="#k:127"><span class="id" title="binder"><span id="k:128" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:129" class="idref" href="#y:129"><span class="id" title="binder"><span id="y:130" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#73d6f9d55cf287e331abf9c6d4c1ac68"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:127"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:126"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:129"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:131" class="idref" href="#l:131"><span class="id" title="binder">l</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#L:118"><span class="id" title="variable">L</span></a>) (<a id="v:132" class="idref" href="#v:132"><span class="id" title="binder">v</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#V:119"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#73d6f9d55cf287e331abf9c6d4c1ac68"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:131"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:132"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#95270db9d09194b606d8cb9477013c9d"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:131"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:132"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM'_general" class="idref" href="#gen_heap_valid_inSepM'_general"><span class="id" title="lemma">gen_heap_valid_inSepM'_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:133" class="idref" href="#L:133"><span class="id" title="binder">L</span></a> <a id="V:134" class="idref" href="#V:134"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:135" class="idref" href="#EqDecision0:135"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:133"><span class="id" title="variable">L</span></a>) (<a id="H:136" class="idref" href="#H:136"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:133"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="9e9733f8cc0a39ebf7cdff4c63de12e8" class="idref" href="#9e9733f8cc0a39ebf7cdff4c63de12e8"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:138" class="idref" href="#gen_heapG0:138"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:133"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:134"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9e9733f8cc0a39ebf7cdff4c63de12e8"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="36a154b77c8d116c163132eeb34a6b9d" class="idref" href="#36a154b77c8d116c163132eeb34a6b9d"><span class="id" title="binder">d</span></a><a id="36a154b77c8d116c163132eeb34a6b9d" class="idref" href="#36a154b77c8d116c163132eeb34a6b9d"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:133"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:134"><span class="id" title="variable">V</span></a>)) (<a id="8e78b00a890ae7b98d81e3dd364b7c0d" class="idref" href="#8e78b00a890ae7b98d81e3dd364b7c0d"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:133"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:134"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#8e78b00a890ae7b98d81e3dd364b7c0d"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:141" class="idref" href="#k:141"><span class="id" title="binder"><span id="k:142" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:143" class="idref" href="#dqw:143"><span class="id" title="binder"><span id="dqw:144" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#36a154b77c8d116c163132eeb34a6b9d"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#36a154b77c8d116c163132eeb34a6b9d"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:141"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:143"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:143"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:145" class="idref" href="#l:145"><span class="id" title="binder">l</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#L:133"><span class="id" title="variable">L</span></a>) (<a id="d:146" class="idref" href="#d:146"><span class="id" title="binder">d</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="v:147" class="idref" href="#v:147"><span class="id" title="binder">v</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#V:134"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#36a154b77c8d116c163132eeb34a6b9d"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#36a154b77c8d116c163132eeb34a6b9d"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:145"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#d:146"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:147"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8e78b00a890ae7b98d81e3dd364b7c0d"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:145"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:147"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">d</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>σ <span class="id" title="var">l</span>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]". <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inclSepM_general" class="idref" href="#gen_heap_valid_inclSepM_general"><span class="id" title="lemma">gen_heap_valid_inclSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:148" class="idref" href="#L:148"><span class="id" title="binder">L</span></a> <a id="V:149" class="idref" href="#V:149"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:150" class="idref" href="#EqDecision0:150"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:148"><span class="id" title="variable">L</span></a>) (<a id="H:151" class="idref" href="#H:151"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:148"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="18b3bad72da93e7ecd0c75efd41cf5f3" class="idref" href="#18b3bad72da93e7ecd0c75efd41cf5f3"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:153" class="idref" href="#gen_heapG0:153"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:148"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:149"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#18b3bad72da93e7ecd0c75efd41cf5f3"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="7f444fc52dd66c089d8463083c4b8e9a" class="idref" href="#7f444fc52dd66c089d8463083c4b8e9a"><span class="id" title="binder">d</span></a><a id="7f444fc52dd66c089d8463083c4b8e9a" class="idref" href="#7f444fc52dd66c089d8463083c4b8e9a"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:148"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:149"><span class="id" title="variable">V</span></a>)) (<a id="72e905fcacb0fd5f0cf129d2a7138522" class="idref" href="#72e905fcacb0fd5f0cf129d2a7138522"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:148"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:149"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#72e905fcacb0fd5f0cf129d2a7138522"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:156" class="idref" href="#k:156"><span class="id" title="binder"><span id="k:157" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:158" class="idref" href="#dqw:158"><span class="id" title="binder"><span id="dqw:159" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#7f444fc52dd66c089d8463083c4b8e9a"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#7f444fc52dd66c089d8463083c4b8e9a"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:156"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:158"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:158"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><span class="id" title="notation">(</span><span class="id" title="definition">fmap</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7f444fc52dd66c089d8463083c4b8e9a"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#7f444fc52dd66c089d8463083c4b8e9a"><span class="id" title="variable">σ</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#72e905fcacb0fd5f0cf129d2a7138522"><span class="id" title="variable">σ</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM'_general"><span class="id" title="axiom">gen_heap_valid_inSepM'_general</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H". <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">d</span>σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="var">HH'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hincl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HH'</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hincl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HH'</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;+&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inclSepM" class="idref" href="#gen_heap_valid_inclSepM"><span class="id" title="lemma">gen_heap_valid_inclSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:160" class="idref" href="#L:160"><span class="id" title="binder">L</span></a> <a id="V:161" class="idref" href="#V:161"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:162" class="idref" href="#EqDecision0:162"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:160"><span class="id" title="variable">L</span></a>) (<a id="H:163" class="idref" href="#H:163"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:160"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="9ff56a46be872711c9a28bdf9007a0f1" class="idref" href="#9ff56a46be872711c9a28bdf9007a0f1"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:165" class="idref" href="#gen_heapG0:165"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:160"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:161"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9ff56a46be872711c9a28bdf9007a0f1"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="a761a1b4e13a4eea960c98e205c18811" class="idref" href="#a761a1b4e13a4eea960c98e205c18811"><span class="id" title="binder">σ</span></a> <a id="39a245ff3836941f08509abc8237eb6e" class="idref" href="#39a245ff3836941f08509abc8237eb6e"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:160"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:161"><span class="id" title="variable">V</span></a>) (<a id="q:168" class="idref" href="#q:168"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#a761a1b4e13a4eea960c98e205c18811"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:169" class="idref" href="#k:169"><span class="id" title="binder"><span id="k:170" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:171" class="idref" href="#y:171"><span class="id" title="binder"><span id="y:172" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#39a245ff3836941f08509abc8237eb6e"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:169"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:168"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:171"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#39a245ff3836941f08509abc8237eb6e"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#a761a1b4e13a4eea960c98e205c18811"><span class="id" title="variable">σ</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM'"><span class="id" title="axiom">gen_heap_valid_inSepM'</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (σ' <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span>; <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_allSepM" class="idref" href="#gen_heap_valid_allSepM"><span class="id" title="lemma">gen_heap_valid_allSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:173" class="idref" href="#L:173"><span class="id" title="binder">L</span></a> <a id="V:174" class="idref" href="#V:174"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:175" class="idref" href="#EqDecision0:175"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:173"><span class="id" title="variable">L</span></a>) (<a id="H:176" class="idref" href="#H:176"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:173"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="EV:177" class="idref" href="#EV:177"><span class="id" title="binder">EV</span></a>: <span class="id" title="class">Equiv</span> <a class="idref" href="cap_machine.rules.rules_base.html#V:174"><span class="id" title="variable">V</span></a>) (<a id="REV:178" class="idref" href="#REV:178"><span class="id" title="binder">REV</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#Reflexive"><span class="id" title="class">Reflexive</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#EV:177"><span class="id" title="variable">EV</span></a>) (<a id="LEV:179" class="idref" href="#LEV:179"><span class="id" title="binder">LEV</span></a>: @<span class="id" title="class">LeibnizEquiv</span> <a class="idref" href="cap_machine.rules.rules_base.html#V:174"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#EV:177"><span class="id" title="variable">EV</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="84da3a9c901eb870edcd4f4528af00ed" class="idref" href="#84da3a9c901eb870edcd4f4528af00ed"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:181" class="idref" href="#gen_heapG0:181"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:173"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:174"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#84da3a9c901eb870edcd4f4528af00ed"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="c4328d2d235e6e0d7c0a12c793e0568e" class="idref" href="#c4328d2d235e6e0d7c0a12c793e0568e"><span class="id" title="binder">σ</span></a> <a id="fc314f57fe9b6f7c8eda8e4522d54f75" class="idref" href="#fc314f57fe9b6f7c8eda8e4522d54f75"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:173"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:174"><span class="id" title="variable">V</span></a>) (<a id="q:184" class="idref" href="#q:184"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:185" class="idref" href="#l:185"><span class="id" title="binder">l</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#L:173"><span class="id" title="variable">L</span></a><span class="id" title="notation">),</span> <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#fc314f57fe9b6f7c8eda8e4522d54f75"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:185"><span class="id" title="variable">l</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c4328d2d235e6e0d7c0a12c793e0568e"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:186" class="idref" href="#k:186"><span class="id" title="binder"><span id="k:187" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:188" class="idref" href="#y:188"><span class="id" title="binder"><span id="y:189" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#fc314f57fe9b6f7c8eda8e4522d54f75"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:186"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:184"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:188"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#c4328d2d235e6e0d7c0a12c793e0568e"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fc314f57fe9b6f7c8eda8e4522d54f75"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * ? ? * <span class="id" title="var">H</span>σ'. <span class="id" title="var">iIntros</span> "A B".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<span class="id" title="notation">⌜</span> <span class="id" title="notation">forall</span> <a id="l:190" class="idref" href="#l:190"><span class="id" title="binder"><span id="l:191" class="id">l</span></span></a><span class="id" title="notation">,</span> σ <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:190"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> σ' <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:190"><span class="id" title="variable">l</span></a> <span class="id" title="notation">⌝</span>)%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[A B]" <span class="id" title="keyword">as</span> %<span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> (<span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span>σ' <span class="id" title="var">l</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="definition">is_Some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ' <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> <span class="id" title="var">H</span>σ'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM"><span class="id" title="axiom">gen_heap_valid_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> σ σ') <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">H</span>σ' <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">map_leibniz</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">leibniz_equiv_iff</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">equiv</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#Reflexive"><span class="id" title="class">Reflexive</span></a>. <span class="id" title="tactic">intros</span> [ <span class="id" title="var">x</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="instance">option_equiv</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">REV</span>. } <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_update_inSepM" class="idref" href="#gen_heap_update_inSepM"><span class="id" title="lemma">gen_heap_update_inSepM</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="L:192" class="idref" href="#L:192"><span class="id" title="binder">L</span></a> <a id="V:193" class="idref" href="#V:193"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>} {<a id="EqDecision0:194" class="idref" href="#EqDecision0:194"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:192"><span class="id" title="variable">L</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H:195" class="idref" href="#H:195"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:192"><span class="id" title="variable">L</span></a>} {<a id="0d82cc8b7f207b2b18c7ca2bdebdd1ca" class="idref" href="#0d82cc8b7f207b2b18c7ca2bdebdd1ca"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="gen_heapG0:197" class="idref" href="#gen_heapG0:197"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:192"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:193"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0d82cc8b7f207b2b18c7ca2bdebdd1ca"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ea3d6ce634a82c9dae2ac65ed279a1e5" class="idref" href="#ea3d6ce634a82c9dae2ac65ed279a1e5"><span class="id" title="binder">σ</span></a> <a id="c49e668aa25975c2eb4abf515febcea9" class="idref" href="#c49e668aa25975c2eb4abf515febcea9"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:192"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:193"><span class="id" title="variable">V</span></a>) (<a id="l:200" class="idref" href="#l:200"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:192"><span class="id" title="variable">L</span></a>) (<a id="v:201" class="idref" href="#v:201"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:193"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#c49e668aa25975c2eb4abf515febcea9"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:200"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#ea3d6ce634a82c9dae2ac65ed279a1e5"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:202" class="idref" href="#k:202"><span class="id" title="binder"><span id="k:203" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:204" class="idref" href="#y:204"><span class="id" title="binder"><span id="y:205" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#c49e668aa25975c2eb4abf515febcea9"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:202"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:204"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:200"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#v:201"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:206" class="idref" href="#k:206"><span class="id" title="binder"><span id="k:207" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:208" class="idref" href="#y:208"><span class="id" title="binder"><span id="y:209" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:200"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#v:201"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span><span class="id" title="notation">),</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:206"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:208"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]". <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><span class="id" title="var">v</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span>) <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_delete</span>. <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prim_step_no_kappa" class="idref" href="#prim_step_no_kappa"><span class="id" title="lemma">prim_step_no_kappa</span></a> {<a id="e1:210" class="idref" href="#e1:210"><span class="id" title="binder">e1</span></a> <a id="b3c4214f746aec9dfc7bef017bc5901f" class="idref" href="#b3c4214f746aec9dfc7bef017bc5901f"><span class="id" title="binder">σ1</span></a> <a id="b5eb185878454bf41caae558550fb30a" class="idref" href="#b5eb185878454bf41caae558550fb30a"><span class="id" title="binder">κ</span></a> <a id="e2:213" class="idref" href="#e2:213"><span class="id" title="binder">e2</span></a> <a id="bd0278c83c20ca7482a0a8dd604e6c4a" class="idref" href="#bd0278c83c20ca7482a0a8dd604e6c4a"><span class="id" title="binder">σ2</span></a> <a id="efs:215" class="idref" href="#efs:215"><span class="id" title="binder">efs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:210"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b3c4214f746aec9dfc7bef017bc5901f"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b5eb185878454bf41caae558550fb30a"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:213"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bd0278c83c20ca7482a0a8dd604e6c4a"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:215"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b5eb185878454bf41caae558550fb30a"><span class="id" title="variable">κ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prim_step_no_efs" class="idref" href="#prim_step_no_efs"><span class="id" title="lemma">prim_step_no_efs</span></a> {<a id="e1:216" class="idref" href="#e1:216"><span class="id" title="binder">e1</span></a> <a id="fe0573001477ca14205c41158d6a6657" class="idref" href="#fe0573001477ca14205c41158d6a6657"><span class="id" title="binder">σ1</span></a> <a id="1ee9cc2088b3fe1dfd018583040d717a" class="idref" href="#1ee9cc2088b3fe1dfd018583040d717a"><span class="id" title="binder">κ</span></a> <a id="e2:219" class="idref" href="#e2:219"><span class="id" title="binder">e2</span></a> <a id="164c603a58fa9fd2cd973a657332ff95" class="idref" href="#164c603a58fa9fd2cd973a657332ff95"><span class="id" title="binder">σ2</span></a> <a id="efs:221" class="idref" href="#efs:221"><span class="id" title="binder">efs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:216"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fe0573001477ca14205c41158d6a6657"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1ee9cc2088b3fe1dfd018583040d717a"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:219"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#164c603a58fa9fd2cd973a657332ff95"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:221"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:221"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="state_interp_transient" class="idref" href="#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> (<a id="8b9cfde4740719c5cf7ecbc9a5ab35eb" class="idref" href="#8b9cfde4740719c5cf7ecbc9a5ab35eb"><span class="id" title="binder">φ</span></a> <a id="ef91b38a97431e23793206246cc1aa2b" class="idref" href="#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="binder">φ</span></a><a id="ef91b38a97431e23793206246cc1aa2b" class="idref" href="#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="binder">t</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>) (<a id="lr:224" class="idref" href="#lr:224"><span class="id" title="binder">lr</span></a> <a id="lrt:225" class="idref" href="#lrt:225"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="lm:226" class="idref" href="#lm:226"><span class="id" title="binder">lm</span></a> <a id="lmt:227" class="idref" href="#lmt:227"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="df:228" class="idref" href="#df:228"><span class="id" title="binder">df</span></a> <a id="dft:229" class="idref" href="#dft:229"><span class="id" title="binder">dft</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="cap_machine.logical_mapsto.html#LDFrac"><span class="id" title="definition">LDFrac</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8b9cfde4740719c5cf7ecbc9a5ab35eb"><span class="id" title="variable">φ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:230" class="idref" href="#k:230"><span class="id" title="binder"><span id="k:231" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:232" class="idref" href="#y:232"><span class="id" title="binder"><span id="y:233" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:224"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:230"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:232"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;∗&nbsp;⌜&nbsp;lreg_strip&nbsp;lrt&nbsp;⊆&nbsp;reg&nbsp;φt&nbsp;⌝&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:234" class="idref" href="#k:234"><span class="id" title="binder"><span id="k:235" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:236" class="idref" href="#y:236"><span class="id" title="binder"><span id="y:237" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:228"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:226"><span class="id" title="variable">lm</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:234"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:236"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:236"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">∃</span> <a id="lreg_t:238" class="idref" href="#lreg_t:238"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:239" class="idref" href="#lmem_t:239"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:240" class="idref" href="#cur_map:240"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:225"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:238"><span class="id" title="variable">lreg_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:227"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:239"><span class="id" title="variable">lmem_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:238"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:239"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:240"><span class="id" title="variable">cur_map</span></a><span class="id" title="notation">⌝</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#df:228"><span class="id" title="variable">df</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:226"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#dft:229"><span class="id" title="variable">dft</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:227"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⌝</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="Ep:241" class="idref" href="#Ep:241"><span class="id" title="binder">Ep</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8b9cfde4740719c5cf7ecbc9a5ab35eb"><span class="id" title="variable">φ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:242" class="idref" href="#k:242"><span class="id" title="binder"><span id="k:243" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:244" class="idref" href="#y:244"><span class="id" title="binder"><span id="y:245" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:224"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:242"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:244"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:246" class="idref" href="#k:246"><span class="id" title="binder"><span id="k:247" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:248" class="idref" href="#y:248"><span class="id" title="binder"><span id="y:249" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:228"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:226"><span class="id" title="variable">lm</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:246"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:248"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:248"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:241"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:250" class="idref" href="#k:250"><span class="id" title="binder"><span id="k:251" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:252" class="idref" href="#y:252"><span class="id" title="binder"><span id="y:253" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:225"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:250"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:252"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:254" class="idref" href="#k:254"><span class="id" title="binder"><span id="k:255" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:256" class="idref" href="#y:256"><span class="id" title="binder"><span id="y:257" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:229"><span class="id" title="variable">dft</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:227"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:254"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:256"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:256"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">))</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_corr" class="idref" href="#state_interp_corr"><span class="id" title="lemma">state_interp_corr</span></a> {<a id="cdc78c7746476fcfa5c38d12c422b6d3" class="idref" href="#cdc78c7746476fcfa5c38d12c422b6d3"><span class="id" title="binder">σ</span></a> <a id="lregs:259" class="idref" href="#lregs:259"><span class="id" title="binder">lregs</span></a> <a id="lmem:260" class="idref" href="#lmem:260"><span class="id" title="binder">lmem</span></a> <a id="df:261" class="idref" href="#df:261"><span class="id" title="binder">df</span></a> <a id="Ep:262" class="idref" href="#Ep:262"><span class="id" title="binder">Ep</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#df:261"><span class="id" title="variable">df</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:260"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cdc78c7746476fcfa5c38d12c422b6d3"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:263" class="idref" href="#k:263"><span class="id" title="binder"><span id="k:264" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:265" class="idref" href="#y:265"><span class="id" title="binder"><span id="y:266" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:259"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:263"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:265"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:267" class="idref" href="#k:267"><span class="id" title="binder"><span id="k:268" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:269" class="idref" href="#y:269"><span class="id" title="binder"><span id="y:270" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:261"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:260"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:267"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:269"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:269"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:262"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cdc78c7746476fcfa5c38d12c422b6d3"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:271" class="idref" href="#k:271"><span class="id" title="binder"><span id="k:272" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:273" class="idref" href="#y:273"><span class="id" title="binder"><span id="y:274" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:259"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:271"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:273"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:275" class="idref" href="#k:275"><span class="id" title="binder"><span id="k:276" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:277" class="idref" href="#y:277"><span class="id" title="binder"><span id="y:278" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:261"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:260"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:275"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:277"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:277"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">∃</span> <a id="lreg_t:279" class="idref" href="#lreg_t:279"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:280" class="idref" href="#lmem_t:280"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:281" class="idref" href="#cur_map:281"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:259"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:279"><span class="id" title="variable">lreg_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:260"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:280"><span class="id" title="variable">lmem_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cdc78c7746476fcfa5c38d12c422b6d3"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#cdc78c7746476fcfa5c38d12c422b6d3"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:279"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:280"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:281"><span class="id" title="variable">cur_map</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;∗&nbsp;⌜&nbsp;lreg_strip&nbsp;regs&nbsp;⊆&nbsp;reg&nbsp;σ&nbsp;⌝.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hr Hm".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>. <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 (<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.stdpp_extra.html#snd_prod_merge_subseteq"><span class="id" title="axiom">snd_prod_merge_subseteq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmem_incl</span>; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_intro" class="idref" href="#state_interp_transient_intro"><span class="id" title="lemma">state_interp_transient_intro</span></a> {<a id="Ep:282" class="idref" href="#Ep:282"><span class="id" title="binder">Ep</span></a>} {<a id="29ec1fa5375f6d8f7092213ae8fb6c2a" class="idref" href="#29ec1fa5375f6d8f7092213ae8fb6c2a"><span class="id" title="binder">φ</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:284" class="idref" href="#lr:284"><span class="id" title="binder">lr</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:285" class="idref" href="#lm:285"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} {<a id="df:286" class="idref" href="#df:286"><span class="id" title="binder">df</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LDFrac"><span class="id" title="definition">LDFrac</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#df:286"><span class="id" title="variable">df</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:285"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#29ec1fa5375f6d8f7092213ae8fb6c2a"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:287" class="idref" href="#k:287"><span class="id" title="binder"><span id="k:288" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:289" class="idref" href="#y:289"><span class="id" title="binder"><span id="y:290" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:284"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:287"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:289"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:291" class="idref" href="#k:291"><span class="id" title="binder"><span id="k:292" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:293" class="idref" href="#y:293"><span class="id" title="binder"><span id="y:294" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:286"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:285"><span class="id" title="variable">lm</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:291"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:293"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:293"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:282"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#29ec1fa5375f6d8f7092213ae8fb6c2a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#29ec1fa5375f6d8f7092213ae8fb6c2a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:284"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:284"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:285"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:285"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:286"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:286"><span class="id" title="variable">df</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(%Hdom &amp; Hφ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_corr"><span class="id" title="axiom">state_interp_corr</span></a> <span class="id" title="notation">with</span> "[$Hφ $Hregs $Hmem]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hφ &amp; Hregs &amp; Hmem &amp; Hcorr)"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hcorr" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">cur_map</span>) "(%Hlr_incl &amp; %Hlm_incl &amp; %Hcorr)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span> ; [|<span class="id" title="var">iSplit</span> ; [<span class="id" title="var">iPureIntro</span> ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">assumption</span> | <span class="id" title="var">now</span> <span class="id" title="var">iIntros</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr'</span>, <span class="id" title="var">lm'</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span> "%".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_elim_abort" class="idref" href="#state_interp_transient_elim_abort"><span class="id" title="lemma">state_interp_transient_elim_abort</span></a> {<a id="19949a60266cbf480c1117cc9d7f27cd" class="idref" href="#19949a60266cbf480c1117cc9d7f27cd"><span class="id" title="binder">φ</span></a> <a id="26d24c14b22d6fc8f631d39bf804ff5f" class="idref" href="#26d24c14b22d6fc8f631d39bf804ff5f"><span class="id" title="binder">φ</span></a><a id="26d24c14b22d6fc8f631d39bf804ff5f" class="idref" href="#26d24c14b22d6fc8f631d39bf804ff5f"><span class="id" title="binder">t</span></a>: <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:297" class="idref" href="#lr:297"><span class="id" title="binder">lr</span></a> <a id="lrt:298" class="idref" href="#lrt:298"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:299" class="idref" href="#lm:299"><span class="id" title="binder">lm</span></a> <a id="lmt:300" class="idref" href="#lmt:300"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} {<a id="df:301" class="idref" href="#df:301"><span class="id" title="binder">df</span></a> <a id="dft:302" class="idref" href="#dft:302"><span class="id" title="binder">dft</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#19949a60266cbf480c1117cc9d7f27cd"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#26d24c14b22d6fc8f631d39bf804ff5f"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#26d24c14b22d6fc8f631d39bf804ff5f"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:297"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:298"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:299"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:300"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:301"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:302"><span class="id" title="variable">dft</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#19949a60266cbf480c1117cc9d7f27cd"><span class="id" title="variable">φ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:303" class="idref" href="#k:303"><span class="id" title="binder"><span id="k:304" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:305" class="idref" href="#y:305"><span class="id" title="binder"><span id="y:306" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:297"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:303"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:305"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:307" class="idref" href="#k:307"><span class="id" title="binder"><span id="k:308" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:309" class="idref" href="#y:309"><span class="id" title="binder"><span id="y:310" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:301"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:299"><span class="id" title="variable">lm</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:307"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:309"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:309"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hφ &amp; Hregs &amp; Hmem &amp; _)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_elim_commit" class="idref" href="#state_interp_transient_elim_commit"><span class="id" title="lemma">state_interp_transient_elim_commit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Ep:311" class="idref" href="#Ep:311"><span class="id" title="binder">Ep</span></a>} {<a id="03190e5e628219fc1ad1852181195063" class="idref" href="#03190e5e628219fc1ad1852181195063"><span class="id" title="binder">φ</span></a> <a id="e1485700e1f3005a7d9bc293fb477b43" class="idref" href="#e1485700e1f3005a7d9bc293fb477b43"><span class="id" title="binder">φ</span></a><a id="e1485700e1f3005a7d9bc293fb477b43" class="idref" href="#e1485700e1f3005a7d9bc293fb477b43"><span class="id" title="binder">t</span></a>: <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:314" class="idref" href="#lr:314"><span class="id" title="binder">lr</span></a> <a id="lrt:315" class="idref" href="#lrt:315"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:316" class="idref" href="#lm:316"><span class="id" title="binder">lm</span></a> <a id="lmt:317" class="idref" href="#lmt:317"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} {<a id="df:318" class="idref" href="#df:318"><span class="id" title="binder">df</span></a> <a id="dft:319" class="idref" href="#dft:319"><span class="id" title="binder">dft</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LDFrac"><span class="id" title="definition">LDFrac</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#03190e5e628219fc1ad1852181195063"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1485700e1f3005a7d9bc293fb477b43"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e1485700e1f3005a7d9bc293fb477b43"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:314"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:315"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:316"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:317"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:318"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:319"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:311"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1485700e1f3005a7d9bc293fb477b43"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e1485700e1f3005a7d9bc293fb477b43"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:320" class="idref" href="#k:320"><span class="id" title="binder"><span id="k:321" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:322" class="idref" href="#y:322"><span class="id" title="binder"><span id="y:323" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:315"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:320"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:322"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:324" class="idref" href="#k:324"><span class="id" title="binder"><span id="k:325" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:326" class="idref" href="#y:326"><span class="id" title="binder"><span id="y:327" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:319"><span class="id" title="variable">dft</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:317"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:324"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:326"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:326"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hφ &amp; Hregs &amp; Hmem &amp; _ &amp; _ &amp; Hupd)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hupd" <span class="id" title="notation">with</span> "[$Hφ $Hregs $Hmem]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hφ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_cap_lang" class="idref" href="#wp_cap_lang"><span class="id" title="lemma">wp_cap_lang</span></a> {<a id="s:328" class="idref" href="#s:328"><span class="id" title="binder">s</span></a> <a id="E:329" class="idref" href="#E:329"><span class="id" title="binder">E</span></a>} {<a id="3450d8ce1b01000ee9564681170c56cb" class="idref" href="#3450d8ce1b01000ee9564681170c56cb"><span class="id" title="binder">Φ</span></a>} : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="e1:331" class="idref" href="#e1:331"><span class="id" title="binder">e1</span></a> : <span class="id" title="projection">language.expr</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:331"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="b1e2b01d931ae1d9741c86e55a22f676" class="idref" href="#b1e2b01d931ae1d9741c86e55a22f676"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b1e2b01d931ae1d9741c86e55a22f676"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:329"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="definition">head_reducible</span> <a class="idref" href="cap_machine.rules.rules_base.html#e1:331"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b1e2b01d931ae1d9741c86e55a22f676"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e2:333" class="idref" href="#e2:333"><span class="id" title="binder">e2</span></a> : <span class="id" title="projection">language.expr</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="1d234b0d9f3c15fee11ed432767cff43" class="idref" href="#1d234b0d9f3c15fee11ed432767cff43"><span class="id" title="binder">σ2</span></a> : <span class="id" title="projection">ectx_language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:331"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b1e2b01d931ae1d9741c86e55a22f676"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:333"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1d234b0d9f3c15fee11ed432767cff43"><span class="id" title="variable">σ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:329"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1d234b0d9f3c15fee11ed432767cff43"><span class="id" title="variable">σ2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#3450d8ce1b01000ee9564681170c56cb"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> <a class="idref" href="cap_machine.rules.rules_base.html#e2:333"><span class="id" title="variable">e2</span></a>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:328"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:329"><span class="id" title="variable">E</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:331"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3450d8ce1b01000ee9564681170c56cb"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? <span class="id" title="var">Hnoval</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>) "Hσ1 /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> σ1 <span class="id" title="notation">with</span> "[$Hσ1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[%Hred H]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iIntros</span> (? ? ?) "%Hstep Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.rules.rules_base.html#prim_step_no_efs"><span class="id" title="axiom">prim_step_no_efs</span></a> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.rules.rules_base.html#prim_step_no_kappa"><span class="id" title="axiom">prim_step_no_kappa</span></a> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">Hstep</span> <span class="id" title="notation">with</span> "Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_instr_exec" class="idref" href="#wp_instr_exec"><span class="id" title="lemma">wp_instr_exec</span></a> {<a id="s:335" class="idref" href="#s:335"><span class="id" title="binder">s</span></a> <a id="E:336" class="idref" href="#E:336"><span class="id" title="binder">E</span></a>} {<a id="01ebb9190c118f6d259d6f0c18c4a40b" class="idref" href="#01ebb9190c118f6d259d6f0c18c4a40b"><span class="id" title="binder">Φ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="786bd29a18f9d82f2cac327627fe1734" class="idref" href="#786bd29a18f9d82f2cac327627fe1734"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#786bd29a18f9d82f2cac327627fe1734"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:336"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e2:339" class="idref" href="#e2:339"><span class="id" title="binder">e2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ConfFlag"><span class="id" title="inductive">ConfFlag</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="f426d03159f38599fae3bd574af3590b" class="idref" href="#f426d03159f38599fae3bd574af3590b"><span class="id" title="binder">σ2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#786bd29a18f9d82f2cac327627fe1734"><span class="id" title="variable">σ1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e2:339"><span class="id" title="variable">e2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f426d03159f38599fae3bd574af3590b"><span class="id" title="variable">σ2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:336"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f426d03159f38599fae3bd574af3590b"><span class="id" title="variable">σ2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#01ebb9190c118f6d259d6f0c18c4a40b"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:339"><span class="id" title="variable">e2</span></a>))<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:335"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:336"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#01ebb9190c118f6d259d6f0c18c4a40b"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_cap_lang"><span class="id" title="axiom">wp_cap_lang</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1) "Hσ1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">with</span> "Hσ1"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2) "%Hstep".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hstep</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Program Definition</span> <a id="wp_lift_atomic_head_step_no_fork_determ" class="idref" href="#wp_lift_atomic_head_step_no_fork_determ"><span class="id" title="definition">wp_lift_atomic_head_step_no_fork_determ</span></a> {<a id="s:341" class="idref" href="#s:341"><span class="id" title="binder">s</span></a> <a id="E:342" class="idref" href="#E:342"><span class="id" title="binder">E</span></a> <a id="bed839da97a40e15a168707a4af9090c" class="idref" href="#bed839da97a40e15a168707a4af9090c"><span class="id" title="binder">Φ</span></a>} <a id="e1:344" class="idref" href="#e1:344"><span class="id" title="binder">e1</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:344"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e64627dbc421045bc0f3568f96b7f470" class="idref" href="#e64627dbc421045bc0f3568f96b7f470"><span class="id" title="binder">σ1</span></a>:<a class="idref" href="cap_machine.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) <a id="ns:346" class="idref" href="#ns:346"><span class="id" title="binder">ns</span></a> <a id="8d04b69c8da2eee9070e24c3ae0051e8" class="idref" href="#8d04b69c8da2eee9070e24c3ae0051e8"><span class="id" title="binder">κ</span></a> <a id="60d9a086f503ea68dccdb70867a0f808" class="idref" href="#60d9a086f503ea68dccdb70867a0f808"><span class="id" title="binder">κs</span></a> <a id="nt:349" class="idref" href="#nt:349"><span class="id" title="binder">nt</span></a><span class="id" title="notation">,</span> <span class="id" title="method">state_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#e64627dbc421045bc0f3568f96b7f470"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ns:346"><span class="id" title="variable">ns</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#8d04b69c8da2eee9070e24c3ae0051e8"><span class="id" title="variable">κ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#60d9a086f503ea68dccdb70867a0f808"><span class="id" title="variable">κs</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#nt:349"><span class="id" title="variable">nt</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:342"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="665bb3c1bc23568df734bf04ed1103ca" class="idref" href="#665bb3c1bc23568df734bf04ed1103ca"><span class="id" title="binder">κ</span></a> <a id="e2:351" class="idref" href="#e2:351"><span class="id" title="binder">e2</span></a> (<a id="d46d90e20dad05639b261716dcb084d8" class="idref" href="#d46d90e20dad05639b261716dcb084d8"><span class="id" title="binder">σ2</span></a>:<a class="idref" href="cap_machine.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) <a id="efs:353" class="idref" href="#efs:353"><span class="id" title="binder">efs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">cap_lang.prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:344"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e64627dbc421045bc0f3568f96b7f470"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#665bb3c1bc23568df734bf04ed1103ca"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:351"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d46d90e20dad05639b261716dcb084d8"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:353"><span class="id" title="variable">efs</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <span class="id" title="notation">|==&gt;</span> <span class="id" title="notation">(</span><span class="id" title="method">state_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#d46d90e20dad05639b261716dcb084d8"><span class="id" title="variable">σ2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ns:346"><span class="id" title="variable">ns</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#60d9a086f503ea68dccdb70867a0f808"><span class="id" title="variable">κs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#nt:349"><span class="id" title="variable">nt</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#bed839da97a40e15a168707a4af9090c"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:351"><span class="id" title="variable">e2</span></a>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.rules.rules_base.html#e1:344"><span class="id" title="variable">e1</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:341"><span class="id" title="variable">s</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:342"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="cap_machine.rules.rules_base.html#bed839da97a40e15a168707a4af9090c"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "H". <span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>)  "Hσ1 /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span> <span class="id" title="notation">with</span> "[Hσ1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> (<span class="id" title="var">κ'</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span>) "[H1 H2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<span class="id" title="definition">head_reducible</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">κ'</span>, <span class="id" title="var">e2</span>, σ2, <span class="id" title="var">efs</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> (? ? ?) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H1" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#cap_lang_determ"><span class="id" title="axiom">cap_lang_determ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hs1</span> <span class="id" title="var">Hs2</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq1</span> [<span class="id" title="var">Heq2</span> [<span class="id" title="var">Heq3</span> <span class="id" title="var">Heq4</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">iMod</span> "H2". <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">inv</span> <span class="id" title="var">Hs1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;predicates&nbsp;on&nbsp;memory&nbsp;maps&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="extract_sep_if_split" class="idref" href="#extract_sep_if_split"><span class="id" title="lemma">extract_sep_if_split</span></a> (<a id="a:354" class="idref" href="#a:354"><span class="id" title="binder">a</span></a> <a id="pc_a:355" class="idref" href="#pc_a:355"><span class="id" title="binder">pc_a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) <a id="P:356" class="idref" href="#P:356"><span class="id" title="binder">P</span></a> <a id="Q:357" class="idref" href="#Q:357"><span class="id" title="binder">Q</span></a> <a id="R:358" class="idref" href="#R:358"><span class="id" title="binder">R</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:354"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:355"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:356"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Q:357"><span class="id" title="variable">Q</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#R:358"><span class="id" title="variable">R</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">≡</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:354"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:355"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:356"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Q:357"><span class="id" title="variable">Q</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:354"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:355"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#R:358"><span class="id" title="variable">R</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">pc_a</span>)%<span class="id" title="var">la</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iIntros</span> "[H1 H2]"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_0" class="idref" href="#memMap_resource_0"><span class="id" title="lemma">memMap_resource_0</span></a>  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">True</span> <span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:359" class="idref" href="#la:359"><span class="id" title="binder"><span id="la:360" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:361" class="idref" href="#w:361"><span class="id" title="binder"><span id="w:362" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:359"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:361"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_1" class="idref" href="#memMap_resource_1"><span class="id" title="lemma">memMap_resource_1</span></a> (<a id="a:363" class="idref" href="#a:363"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w:364" class="idref" href="#w:364"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a:363"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:364"><span class="id" title="variable">w</span></a>  <span class="id" title="notation">⊣⊢</span> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:365" class="idref" href="#la:365"><span class="id" title="binder"><span id="la:366" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:367" class="idref" href="#w:367"><span class="id" title="binder"><span id="w:368" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a:363"><span class="id" title="variable">a</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w:364"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:365"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:367"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_0"><span class="id" title="axiom">memMap_resource_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[HH _]".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_1_dq" class="idref" href="#memMap_resource_1_dq"><span class="id" title="lemma">memMap_resource_1_dq</span></a> (<a id="a:369" class="idref" href="#a:369"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w:370" class="idref" href="#w:370"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <a id="dq:371" class="idref" href="#dq:371"><span class="id" title="binder">dq</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a:369"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:371"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:370"><span class="id" title="variable">w</span></a>  <span class="id" title="notation">⊣⊢</span> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:372" class="idref" href="#la:372"><span class="id" title="binder"><span id="la:373" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:374" class="idref" href="#w:374"><span class="id" title="binder"><span id="w:375" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a:369"><span class="id" title="variable">a</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w:370"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:372"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:371"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:374"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[HH _]".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne" class="idref" href="#memMap_resource_2ne"><span class="id" title="lemma">memMap_resource_2ne</span></a> (<a id="a1:376" class="idref" href="#a1:376"><span class="id" title="binder">a1</span></a> <a id="a2:377" class="idref" href="#a2:377"><span class="id" title="binder">a2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w1:378" class="idref" href="#w1:378"><span class="id" title="binder">w1</span></a> <a id="w2:379" class="idref" href="#w2:379"><span class="id" title="binder">w2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a1:376"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a2:377"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:380" class="idref" href="#a:380"><span class="id" title="binder"><span id="a:381" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:382" class="idref" href="#w:382"><span class="id" title="binder"><span id="w:383" class="id">w</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a1:376"><span class="id" title="variable">a1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:378"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">a2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:380"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:382"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#a1:376"><span class="id" title="variable">a1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:378"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#a2:377"><span class="id" title="variable">a2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:379"><span class="id" title="variable">w2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a2</span> <span class="id" title="var">w2</span>); <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>. 2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_0"><span class="id" title="axiom">memMap_resource_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 [H2 _ ] ]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 H2]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="address_neq" class="idref" href="#address_neq"><span class="id" title="lemma">address_neq</span></a> <a id="la1:384" class="idref" href="#la1:384"><span class="id" title="binder">la1</span></a> <a id="la2:385" class="idref" href="#la2:385"><span class="id" title="binder">la2</span></a> <a id="lw1:386" class="idref" href="#lw1:386"><span class="id" title="binder">lw1</span></a> <a id="lw2:387" class="idref" href="#lw2:387"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la1:384"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:386"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la2:385"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:387"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:384"><span class="id" title="variable">la1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:385"><span class="id" title="variable">la2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ha1 Ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="machine_utils.finz_base.html#finz_eq_dec"><span class="id" title="instance">finz_eq_dec</span></a> <span class="id" title="var">la1</span><span class="id" title="notation">.1</span> <span class="id" title="var">la2</span><span class="id" title="notation">.1</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="instance">Nat.eq_dec</span> <span class="id" title="var">la1</span><span class="id" title="notation">.2</span> <span class="id" title="var">la2</span><span class="id" title="notation">.2</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExFalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">la1</span> <span class="id" title="keyword">with</span> <span class="id" title="var">la2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#addr_dupl_false"><span class="id" title="axiom">addr_dupl_false</span></a> <span class="id" title="notation">with</span> "[$Ha1] [$Ha2]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#injective_projections"><span class="id" title="lemma">injective_projections</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne_apply" class="idref" href="#memMap_resource_2ne_apply"><span class="id" title="lemma">memMap_resource_2ne_apply</span></a> (<a id="la1:388" class="idref" href="#la1:388"><span class="id" title="binder">la1</span></a> <a id="la2:389" class="idref" href="#la2:389"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:390" class="idref" href="#lw1:390"><span class="id" title="binder">lw1</span></a> <a id="lw2:391" class="idref" href="#lw2:391"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la1:388"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:390"><span class="id" title="variable">lw1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la2:389"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:391"><span class="id" title="variable">lw2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:392" class="idref" href="#la:392"><span class="id" title="binder"><span id="la:393" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:394" class="idref" href="#lw:394"><span class="id" title="binder"><span id="lw:395" class="id">lw</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:388"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:390"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:392"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:394"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:388"><span class="id" title="variable">la1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:389"><span class="id" title="variable">la2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hi Hr2a".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#address_neq"><span class="id" title="axiom">address_neq</span></a>  <span class="id" title="notation">with</span> "Hi Hr2a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hne</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iSplitL</span> "Hi"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen" class="idref" href="#memMap_resource_2gen"><span class="id" title="lemma">memMap_resource_2gen</span></a> (<a id="la1:396" class="idref" href="#la1:396"><span class="id" title="binder">la1</span></a> <a id="la2:397" class="idref" href="#la2:397"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:398" class="idref" href="#lw1:398"><span class="id" title="binder">lw1</span></a> <a id="lw2:399" class="idref" href="#lw2:399"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="notation">∃</span> <a id="lmem:400" class="idref" href="#lmem:400"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:401" class="idref" href="#la:401"><span class="id" title="binder"><span id="la:402" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:403" class="idref" href="#lw:403"><span class="id" title="binder"><span id="lw:404" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:400"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:401"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:403"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:397"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:396"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:400"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:396"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:398"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:400"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:396"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:398"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:396"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:398"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:397"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:396"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:397"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:399"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HeqZ</span> <span class="id" title="var">HeqV</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#Z.eqb_eq"><span class="id" title="lemma">Z.eqb_eq</span></a>, <a class="idref" href="machine_utils.finz_base.html#finz_to_z_eq"><span class="id" title="lemma">finz_to_z_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqZ</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.eqb_eq"><span class="id" title="lemma">Nat.eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">la2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">la1</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#injective_projections"><span class="id" title="lemma">injective_projections</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_1"><span class="id" title="axiom">memMap_resource_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (<span class="id" title="var">lmem</span>) "[HH -&gt;]". <span class="id" title="tactic">by</span> <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> "[Hmap _]". <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (<span class="id" title="var">mem</span>) "[HH -&gt;]" ; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> "Hmap"; <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_d" class="idref" href="#memMap_resource_2gen_d"><span class="id" title="lemma">memMap_resource_2gen_d</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="898e6cedc2bab2f31a1d24a7e57f9c33" class="idref" href="#898e6cedc2bab2f31a1d24a7e57f9c33"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la1:406" class="idref" href="#la1:406"><span class="id" title="binder">la1</span></a> <a id="la2:407" class="idref" href="#la2:407"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:408" class="idref" href="#lw1:408"><span class="id" title="binder">lw1</span></a> <a id="lw2:409" class="idref" href="#lw2:409"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">∃</span> <a id="lmem:410" class="idref" href="#lmem:410"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:411" class="idref" href="#la:411"><span class="id" title="binder"><span id="la:412" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:413" class="idref" href="#lw:413"><span class="id" title="binder"><span id="lw:414" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:410"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#898e6cedc2bab2f31a1d24a7e57f9c33"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:411"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:413"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:407"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:406"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:410"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:406"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:408"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:410"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:406"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:408"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#898e6cedc2bab2f31a1d24a7e57f9c33"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:406"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:408"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:407"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:406"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#898e6cedc2bab2f31a1d24a7e57f9c33"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:407"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:409"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> (<span class="id" title="var">lmem</span>) "[Hmem Hif]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ((<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_d_dq" class="idref" href="#memMap_resource_2gen_d_dq"><span class="id" title="lemma">memMap_resource_2gen_d_dq</span></a> (<a id="11bab4454da6f0dcd9f4cec959d449f0" class="idref" href="#11bab4454da6f0dcd9f4cec959d449f0"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la1:416" class="idref" href="#la1:416"><span class="id" title="binder">la1</span></a> <a id="la2:417" class="idref" href="#la2:417"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="dq1:418" class="idref" href="#dq1:418"><span class="id" title="binder">dq1</span></a> <a id="dq2:419" class="idref" href="#dq2:419"><span class="id" title="binder">dq2</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="lw1:420" class="idref" href="#lw1:420"><span class="id" title="binder">lw1</span></a> <a id="lw2:421" class="idref" href="#lw2:421"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">∃</span> <a id="lmem:422" class="idref" href="#lmem:422"><span class="id" title="binder">lmem</span></a> <a id="dfracs:423" class="idref" href="#dfracs:423"><span class="id" title="binder">dfracs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:424" class="idref" href="#la:424"><span class="id" title="binder"><span id="la:425" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dlw:426" class="idref" href="#dlw:426"><span class="id" title="binder"><span id="dlw:427" class="id">dlw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:423"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:422"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#11bab4454da6f0dcd9f4cec959d449f0"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:424"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:426"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:426"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:417"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:416"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:422"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:416"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:420"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:422"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:416"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:420"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:417"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:416"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:423"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:416"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:418"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:423"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:416"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:418"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#11bab4454da6f0dcd9f4cec959d449f0"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:416"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq1:418"><span class="id" title="variable">dq1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:420"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:417"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:416"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#11bab4454da6f0dcd9f4cec959d449f0"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:417"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq2:419"><span class="id" title="variable">dq2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:421"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> (<span class="id" title="var">mem</span> <span class="id" title="var">dfracs</span>) "[Hmem [Hif Hif'] ]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ((<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> "Hif'" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> "Hif'" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Not&nbsp;the&nbsp;world's&nbsp;most&nbsp;beautiful&nbsp;lemma,&nbsp;but&nbsp;it&nbsp;does&nbsp;avoid&nbsp;us&nbsp;having&nbsp;to&nbsp;fiddle&nbsp;around&nbsp;with&nbsp;a&nbsp;later&nbsp;under&nbsp;an&nbsp;if&nbsp;in&nbsp;proofs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_clater" class="idref" href="#memMap_resource_2gen_clater"><span class="id" title="lemma">memMap_resource_2gen_clater</span></a> (<a id="la1:428" class="idref" href="#la1:428"><span class="id" title="binder">la1</span></a> <a id="la2:429" class="idref" href="#la2:429"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:430" class="idref" href="#lw1:430"><span class="id" title="binder">lw1</span></a> <a id="lw2:431" class="idref" href="#lw2:431"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="9d55bd9bec29d5e365d2fb97a8d221ed" class="idref" href="#9d55bd9bec29d5e365d2fb97a8d221ed"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#9d55bd9bec29d5e365d2fb97a8d221ed"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:428"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:430"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:429"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:428"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#9d55bd9bec29d5e365d2fb97a8d221ed"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:429"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:431"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> (<span class="id" title="notation">∃</span> <a id="lmem:433" class="idref" href="#lmem:433"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:434" class="idref" href="#la:434"><span class="id" title="binder"><span id="la:435" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:436" class="idref" href="#lw:436"><span class="id" title="binder"><span id="lw:437" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:433"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#9d55bd9bec29d5e365d2fb97a8d221ed"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:434"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:436"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:429"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:428"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:433"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:428"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:430"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:433"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:428"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:430"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hc1 Hc2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iNext</span>. <span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;More&nbsp;general&nbsp;lemmas&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_clater_dq" class="idref" href="#memMap_resource_2gen_clater_dq"><span class="id" title="lemma">memMap_resource_2gen_clater_dq</span></a> (<a id="la1:438" class="idref" href="#la1:438"><span class="id" title="binder">la1</span></a> <a id="la2:439" class="idref" href="#la2:439"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="dq1:440" class="idref" href="#dq1:440"><span class="id" title="binder">dq1</span></a> <a id="dq2:441" class="idref" href="#dq2:441"><span class="id" title="binder">dq2</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="lw1:442" class="idref" href="#lw1:442"><span class="id" title="binder">lw1</span></a> <a id="lw2:443" class="idref" href="#lw2:443"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="228ca217f5faf4bf923008562e31e535" class="idref" href="#228ca217f5faf4bf923008562e31e535"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#228ca217f5faf4bf923008562e31e535"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq1:440"><span class="id" title="variable">dq1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:442"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:439"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#228ca217f5faf4bf923008562e31e535"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:439"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq2:441"><span class="id" title="variable">dq2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:443"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">∃</span> <a id="lmem:445" class="idref" href="#lmem:445"><span class="id" title="binder">lmem</span></a> <a id="dfracs:446" class="idref" href="#dfracs:446"><span class="id" title="binder">dfracs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:447" class="idref" href="#la:447"><span class="id" title="binder"><span id="la:448" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dlw:449" class="idref" href="#dlw:449"><span class="id" title="binder"><span id="dlw:450" class="id">dlw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:446"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:445"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#228ca217f5faf4bf923008562e31e535"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:447"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:449"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:449"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:439"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:445"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:442"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:445"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:442"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:439"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:446"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:440"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:446"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:438"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:440"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hc1 Hc2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>),(<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">dq1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>),(<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">dq1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_delete" class="idref" href="#memMap_delete"><span class="id" title="lemma">memMap_delete</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="la:451" class="idref" href="#la:451"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:452" class="idref" href="#lw:452"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <a id="lmem:453" class="idref" href="#lmem:453"><span class="id" title="binder">lmem</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:453"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:451"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:452"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:454" class="idref" href="#la:454"><span class="id" title="binder"><span id="la:455" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:456" class="idref" href="#lw:456"><span class="id" title="binder"><span id="lw:457" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:453"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:454"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:456"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#la:451"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:452"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:458" class="idref" href="#k:458"><span class="id" title="binder"><span id="k:459" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:460" class="idref" href="#y:460"><span class="id" title="binder"><span id="y:461" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">delete</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:451"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:453"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:458"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:460"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">lmem</span> <span class="id" title="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <a id="mem_remove_dq" class="idref" href="#mem_remove_dq"><span class="id" title="lemma">mem_remove_dq</span></a> <a id="lmem:462" class="idref" href="#lmem:462"><span class="id" title="binder">lmem</span></a> <a id="dq:463" class="idref" href="#dq:463"><span class="id" title="binder">dq</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:464" class="idref" href="#la:464"><span class="id" title="binder"><span id="la:465" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:466" class="idref" href="#lw:466"><span class="id" title="binder"><span id="lw:467" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:462"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:464"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:463"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:466"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊣⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:468" class="idref" href="#la:468"><span class="id" title="binder"><span id="la:469" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:470" class="idref" href="#dw:470"><span class="id" title="binder"><span id="dw:471" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:462"><span class="id" title="variable">lmem</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#dq:463"><span class="id" title="variable">dq</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lmem:462"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:468"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:470"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:470"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInduction</span> (<span class="id" title="var">lmem</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">la</span> <span class="id" title="var">k</span> <span class="id" title="var">lmem</span>] "IH" <span class="id" title="keyword">using</span> <span class="id" title="lemma">map_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span> <span class="id" title="lemma">dom_empty_L</span> <span class="id" title="lemma">elements_empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/= /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <span class="id" title="lemma">merge_empty</span> <span class="id" title="lemma">big_sepM_empty</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">dom_insert_L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">elements</span> (<span class="id" title="notation">{[</span><span class="id" title="var">la</span><span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>) <span class="id" title="notation">≡ₚ</span> <span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">elements_union_singleton</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default_permutation"><span class="id" title="axiom">create_gmap_default_permutation</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dq</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hperm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hperm</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Ha Hmem]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_merge</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_op"><span class="id" title="definition">prod_op</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="var">dq</span> <span class="id" title="notation">!!</span> <span class="id" title="var">la</span>);<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "IH". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Ha Hmem]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_merge</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_op"><span class="id" title="definition">prod_op</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="var">dq</span> <span class="id" title="notation">!!</span> <span class="id" title="var">la</span>);<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "IH". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;more&nbsp;general&nbsp;version&nbsp;of&nbsp;load&nbsp;to&nbsp;work&nbsp;also&nbsp;with&nbsp;any&nbsp;fraction&nbsp;and&nbsp;persistent&nbsp;points&nbsp;tos&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_valid_inSepM_general" class="idref" href="#gen_mem_valid_inSepM_general"><span class="id" title="lemma">gen_mem_valid_inSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:472" class="idref" href="#lmem:472"><span class="id" title="binder">lmem</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)) (<a id="lmem':473" class="idref" href="#lmem':473"><span class="id" title="binder">lmem'</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la:474" class="idref" href="#la:474"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:475" class="idref" href="#lw:475"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="dq:476" class="idref" href="#dq:476"><span class="id" title="binder">dq</span></a> : <span class="id" title="inductive">dfrac</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:472"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:474"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:476"><span class="id" title="variable">dq</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:475"><span class="id" title="variable">lw</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':473"><span class="id" title="variable">lmem'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:477" class="idref" href="#a:477"><span class="id" title="binder"><span id="a:478" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="dqw:479" class="idref" href="#dqw:479"><span class="id" title="binder"><span id="dqw:480" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:472"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:477"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:479"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:479"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#lmem':473"><span class="id" title="variable">lmem'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:474"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:475"><span class="id" title="variable">lw</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lmem</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">dq</span> <span class="id" title="var">Hmem_pc</span>) "Hm Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hpc_a Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpc_a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_valid_inSepM" class="idref" href="#gen_mem_valid_inSepM"><span class="id" title="lemma">gen_mem_valid_inSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:481" class="idref" href="#lmem:481"><span class="id" title="binder">lmem</span></a> <a id="lm:482" class="idref" href="#lm:482"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="la:483" class="idref" href="#la:483"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:484" class="idref" href="#lw:484"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:481"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:483"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:484"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:482"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:485" class="idref" href="#la:485"><span class="id" title="binder"><span id="la:486" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:487" class="idref" href="#lw:487"><span class="id" title="binder"><span id="lw:488" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:481"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:485"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:487"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#lm:482"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:483"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:484"><span class="id" title="variable">lw</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">Hmem_pc</span>) "Hm Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#memMap_delete"><span class="id" title="axiom">memMap_delete</span></a> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hpc_a Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpc_a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_update_inSepM" class="idref" href="#gen_mem_update_inSepM"><span class="id" title="lemma">gen_mem_update_inSepM</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="034eaac0095b294e052684a582248eb3" class="idref" href="#034eaac0095b294e052684a582248eb3"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>} {<a id="gen_heapG0:490" class="idref" href="#gen_heapG0:490"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#034eaac0095b294e052684a582248eb3"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="lmem:491" class="idref" href="#lmem:491"><span class="id" title="binder">lmem</span></a> <a id="lmem':492" class="idref" href="#lmem':492"><span class="id" title="binder">lmem'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="la:493" class="idref" href="#la:493"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:494" class="idref" href="#lw:494"><span class="id" title="binder">lw</span></a> <a id="lw':495" class="idref" href="#lw':495"><span class="id" title="binder">lw'</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem':492"><span class="id" title="variable">lmem'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:493"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw':495"><span class="id" title="variable">lw'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:491"><span class="id" title="variable">lmem</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:496" class="idref" href="#la:496"><span class="id" title="binder"><span id="la:497" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:498" class="idref" href="#lw:498"><span class="id" title="binder"><span id="lw:499" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':492"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:496"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:498"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la:493"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:494"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:500" class="idref" href="#a:500"><span class="id" title="binder"><span id="a:501" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:502" class="idref" href="#w:502"><span class="id" title="binder"><span id="w:503" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la:493"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:494"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem'</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:500"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:502"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span>);[|<span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "[$Hmap $Hl]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_delete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">insert_delete_insert</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;FAIL&nbsp;RULES&nbsp;----------------------------------&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Bind&nbsp;Scope&nbsp;expr_scope&nbsp;with&nbsp;language.expr&nbsp;cap_lang.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC" class="idref" href="#wp_notCorrectPC"><span class="id" title="lemma">wp_notCorrectPC</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">forall</span> <a id="E:504" class="idref" href="#E:504"><span class="id" title="binder">E</span></a> (<a id="lw:505" class="idref" href="#lw:505"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:505"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:505"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:504"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:505"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hnpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">ϕ</span>) "HPC Hϕ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">nt</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">ns</span>) "Hσ1 /="; <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr HPC"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">fupd_frame_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">e1</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_fail_inv"><span class="id" title="axiom">step_fail_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> [-&gt; -&gt;]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_phys_corresponds_reg"><span class="id" title="axiom">state_phys_corresponds_reg</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">intro</span> <span class="id" title="var">contra</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">contra</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hϕ HPC"; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hϕ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Subcases&nbsp;for&nbsp;respecitvely&nbsp;permissions&nbsp;and&nbsp;bounds&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC_perm" class="idref" href="#wp_notCorrectPC_perm"><span class="id" title="lemma">wp_notCorrectPC_perm</span></a> <a id="E:506" class="idref" href="#E:506"><span class="id" title="binder">E</span></a> <a id="pc_p:507" class="idref" href="#pc_p:507"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:508" class="idref" href="#pc_b:508"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:509" class="idref" href="#pc_e:509"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:510" class="idref" href="#pc_a:510"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:511" class="idref" href="#pc_v:511"><span class="id" title="binder">pc_v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#pc_p:507"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.machine_base.html#RX"><span class="id" title="constructor">RX</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:507"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:507"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:508"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:509"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:510"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:511"><span class="id" title="variable">pc_v</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:506"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <span class="id" title="notation">True</span> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hperm</span> φ) "HPC Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_notCorrectPC"><span class="id" title="axiom">wp_notCorrectPC</span></a> <span class="id" title="notation">with</span> "[HPC]"<span class="id" title="notation">)</span> ; [<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#not_isCorrectLPC_perm"><span class="id" title="axiom">not_isCorrectLPC_perm</span></a>; <span class="id" title="tactic">eauto</span>|<span class="id" title="var">iFrame</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "HPC /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC_range" class="idref" href="#wp_notCorrectPC_range"><span class="id" title="lemma">wp_notCorrectPC_range</span></a> <a id="E:512" class="idref" href="#E:512"><span class="id" title="binder">E</span></a> <a id="pc_p:513" class="idref" href="#pc_p:513"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:514" class="idref" href="#pc_b:514"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:515" class="idref" href="#pc_e:515"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:516" class="idref" href="#pc_a:516"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:517" class="idref" href="#pc_v:517"><span class="id" title="binder">pc_v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#pc_b:514"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.addr_reg.html#ecb49afb136c57143f8ddd1e3e9a03fe"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:516"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.addr_reg.html#ecb49afb136c57143f8ddd1e3e9a03fe"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:515"><span class="id" title="variable">pc_e</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:513"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:514"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:515"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:516"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:517"><span class="id" title="variable">pc_v</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:512"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <span class="id" title="notation">True</span> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hperm</span> φ) "HPC Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_notCorrectPC"><span class="id" title="axiom">wp_notCorrectPC</span></a> <span class="id" title="notation">with</span> "[HPC]"<span class="id" title="notation">)</span> ; [<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#not_isCorrectLPC_bounds"><span class="id" title="axiom">not_isCorrectLPC_bounds</span></a>; <span class="id" title="tactic">eauto</span>|<span class="id" title="var">iFrame</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "HPC /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;ATOMIC&nbsp;RULES&nbsp;--------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_halt" class="idref" href="#wp_halt"><span class="id" title="lemma">wp_halt</span></a> <a id="E:518" class="idref" href="#E:518"><span class="id" title="binder">E</span></a> <a id="pc_p:519" class="idref" href="#pc_p:519"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:520" class="idref" href="#pc_b:520"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:521" class="idref" href="#pc_e:521"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:522" class="idref" href="#pc_a:522"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:523" class="idref" href="#pc_v:523"><span class="id" title="binder">pc_v</span></a> <a id="lw:524" class="idref" href="#lw:524"><span class="id" title="binder">lw</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:524"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#Halt"><span class="id" title="constructor">Halt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:519"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:520"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:521"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:522"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:523"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:519"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:520"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:521"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:522"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:523"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:522"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:523"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:524"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:518"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#HaltedV"><span class="id" title="constructor">HaltedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:519"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:520"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:521"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:522"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:523"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:522"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:523"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:524"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinstr</span> <span class="id" title="var">Hvpc</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (φ) "[Hpc Hpca] Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">nt</span>) "Hσ1 /=". <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr Hpc"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpca"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_phys_corresponds_reg"><span class="id" title="axiom">state_phys_corresponds_reg</span></a> ; <span class="id" title="tactic">eauto</span> ; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_phys_corresponds_mem_PC"><span class="id" title="axiom">state_phys_corresponds_mem_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>. <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hφ Hpc Hpca"; <span class="id" title="var">last</span> (<span class="id" title="var">iApply</span> "Hφ" ; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_fail" class="idref" href="#wp_fail"><span class="id" title="lemma">wp_fail</span></a> <a id="E:525" class="idref" href="#E:525"><span class="id" title="binder">E</span></a> <a id="pc_p:526" class="idref" href="#pc_p:526"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:527" class="idref" href="#pc_b:527"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:528" class="idref" href="#pc_e:528"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:529" class="idref" href="#pc_a:529"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:530" class="idref" href="#pc_v:530"><span class="id" title="binder">pc_v</span></a> <a id="lw:531" class="idref" href="#lw:531"><span class="id" title="binder">lw</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:531"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#Fail"><span class="id" title="constructor">Fail</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:526"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:527"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:528"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:529"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:530"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:526"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:527"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:528"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:529"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:530"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:529"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:530"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:531"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:525"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:526"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:527"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:528"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:529"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:530"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:529"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:530"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:531"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinstr</span> <span class="id" title="var">Hvpc</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (φ) "[Hpc Hpca] Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">nt</span>) "Hσ1 /=". <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr Hpc"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpca"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_phys_corresponds_reg"><span class="id" title="axiom">state_phys_corresponds_reg</span></a> ; <span class="id" title="tactic">eauto</span> ; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_phys_corresponds_mem_PC"><span class="id" title="axiom">state_phys_corresponds_mem_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>. <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hφ Hpc Hpca"; <span class="id" title="var">last</span> (<span class="id" title="var">iApply</span> "Hφ" ; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;PURE&nbsp;RULES&nbsp;----------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_safe</span> := <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_puredet</span> := <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">inv_head_step</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_pure</span> := <span class="id" title="tactic">intros</span> ?; <span class="id" title="tactic">apply</span> <span class="id" title="lemma">nsteps_once</span>, <span class="id" title="lemma">pure_head_step_pure_step</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; [<span class="id" title="var">solve_exec_safe</span>|]; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="projection">head_step</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_failed" class="idref" href="#pure_seq_failed"><span class="id" title="instance">pure_seq_failed</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_halted" class="idref" href="#pure_seq_halted"><span class="id" title="instance">pure_seq_halted</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_done" class="idref" href="#pure_seq_done"><span class="id" title="instance">pure_seq_done</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules.rules_base.html#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Used&nbsp;to&nbsp;close&nbsp;the&nbsp;failing&nbsp;cases&nbsp;of&nbsp;the&nbsp;ftlr.<br/>
&nbsp;&nbsp;-&nbsp;Hcont&nbsp;is&nbsp;the&nbsp;(iris)&nbsp;name&nbsp;of&nbsp;the&nbsp;closing&nbsp;hypothesis&nbsp;(usually&nbsp;"Hφ")<br/>
&nbsp;&nbsp;-&nbsp;fail_case_name&nbsp;is&nbsp;one&nbsp;constructor&nbsp;of&nbsp;the&nbsp;spec_name,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;indicating&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;case<br/>
&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_case_name</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">fail_case_name</span> ; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailWP</span> <span class="id" title="var">Hcont</span> <span class="id" title="var">fail_case_name</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="var">cbn</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iApply</span> <span class="id" title="var">Hcont</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_case_name</span>).<br/>

<br/>
<span class="comment">(*&nbsp;-----------------&nbsp;useful&nbsp;definitions&nbsp;to&nbsp;factor&nbsp;out&nbsp;the&nbsp;wp&nbsp;specs&nbsp;----------------&nbsp;*)</span><br/>

<br/>
<span class="comment">(*---&nbsp;register&nbsp;equality&nbsp;---*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="addr_ne_reg_ne" class="idref" href="#addr_ne_reg_ne"><span class="id" title="lemma">addr_ne_reg_ne</span></a> {<a id="regs:532" class="idref" href="#regs:532"><span class="id" title="binder">regs</span></a> : <span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>} {<a id="r1:533" class="idref" href="#r1:533"><span class="id" title="binder">r1</span></a> <a id="r2:534" class="idref" href="#r2:534"><span class="id" title="binder">r2</span></a> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="p0:535" class="idref" href="#p0:535"><span class="id" title="binder">p0</span></a> <a id="b0:536" class="idref" href="#b0:536"><span class="id" title="binder">b0</span></a> <a id="e0:537" class="idref" href="#e0:537"><span class="id" title="binder">e0</span></a> <a id="a0:538" class="idref" href="#a0:538"><span class="id" title="binder">a0</span></a> <a id="p:539" class="idref" href="#p:539"><span class="id" title="binder">p</span></a> <a id="b:540" class="idref" href="#b:540"><span class="id" title="binder">b</span></a> <a id="e:541" class="idref" href="#e:541"><span class="id" title="binder">e</span></a> <a id="a:542" class="idref" href="#a:542"><span class="id" title="binder">a</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:532"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:533"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p0:535"><span class="id" title="variable">p0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b0:536"><span class="id" title="variable">b0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e0:537"><span class="id" title="variable">e0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0:538"><span class="id" title="variable">a0</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:532"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:534"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:539"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:540"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:541"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:542"><span class="id" title="variable">a</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0:538"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:542"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:533"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:534"><span class="id" title="variable">r2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hr1</span> <span class="id" title="var">Hr2</span> <span class="id" title="var">Hne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">decide</span> (<span class="id" title="var">r1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">r2</span>)); <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;regs_of&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="regs_of_argument" class="idref" href="#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> (<a id="arg:543" class="idref" href="#arg:543"><span class="id" title="binder">arg</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e03f39daf98516fa530d3f6f5a1b4d92"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>): <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#arg:543"><span class="id" title="variable">arg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#inl"><span class="id" title="constructor">inl</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#inr"><span class="id" title="constructor">inr</span></a> <span class="id" title="var">r</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="regs_of" class="idref" href="#regs_of"><span class="id" title="definition">regs_of</span></a> (<a id="i:545" class="idref" href="#i:545"><span class="id" title="binder">i</span></a>: <a class="idref" href="cap_machine.machine_base.html#instr"><span class="id" title="inductive">instr</span></a>): <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#i:545"><span class="id" title="variable">i</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Lea"><span class="id" title="constructor">Lea</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetP"><span class="id" title="constructor">GetP</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetB"><span class="id" title="constructor">GetB</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetE"><span class="id" title="constructor">GetE</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetA"><span class="id" title="constructor">GetA</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetOType"><span class="id" title="constructor">GetOType</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetWType"><span class="id" title="constructor">GetWType</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Add"><span class="id" title="constructor">Add</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Sub"><span class="id" title="constructor">Sub</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Lt"><span class="id" title="constructor">Lt</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Mov"><span class="id" title="constructor">Mov</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Restrict"><span class="id" title="constructor">Restrict</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Subseg"><span class="id" title="constructor">Subseg</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Load"><span class="id" title="constructor">Load</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Store"><span class="id" title="constructor">Store</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Jnz"><span class="id" title="constructor">Jnz</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Seal"><span class="id" title="constructor">Seal</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#UnSeal"><span class="id" title="constructor">UnSeal</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#IsUnique"><span class="id" title="constructor">IsUnique</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;@Denis&nbsp;add&nbsp;enclaves&nbsp;instructions&nbsp;here&nbsp;*)</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="indom_regs_incl" class="idref" href="#indom_regs_incl"><span class="id" title="lemma">indom_regs_incl</span></a> <a id="D:547" class="idref" href="#D:547"><span class="id" title="binder">D</span></a> (<a id="regs:548" class="idref" href="#regs:548"><span class="id" title="binder">regs</span></a> <a id="regs':549" class="idref" href="#regs':549"><span class="id" title="binder">regs'</span></a>: <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#D:547"><span class="id" title="variable">D</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:548"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:548"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':549"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="r:550" class="idref" href="#r:550"><span class="id" title="binder">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r:550"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#D:547"><span class="id" title="variable">D</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="w:551" class="idref" href="#w:551"><span class="id" title="binder">w</span></a>:<a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#regs:548"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:550"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:551"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#regs':549"><span class="id" title="variable">regs'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:550"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:551"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">HD</span> <span class="id" title="var">Hincl</span> <span class="id" title="var">rr</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <span class="id" title="var">rr</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> @<span class="id" title="method">elem_of_dom</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">D</span> := <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>). <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">elem_of_subseteq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="indom_lregs_incl" class="idref" href="#indom_lregs_incl"><span class="id" title="lemma">indom_lregs_incl</span></a> <a id="D:552" class="idref" href="#D:552"><span class="id" title="binder">D</span></a> (<a id="lregs:553" class="idref" href="#lregs:553"><span class="id" title="binder">lregs</span></a> <a id="lregs':554" class="idref" href="#lregs':554"><span class="id" title="binder">lregs'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#D:552"><span class="id" title="variable">D</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:553"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:553"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs':554"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="r:555" class="idref" href="#r:555"><span class="id" title="binder">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r:555"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#D:552"><span class="id" title="variable">D</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="w:556" class="idref" href="#w:556"><span class="id" title="binder">w</span></a>:<a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#lregs:553"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:555"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:556"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#lregs':554"><span class="id" title="variable">lregs'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:555"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:556"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">HD</span> <span class="id" title="var">Hincl</span> <span class="id" title="var">rr</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <span class="id" title="var">rr</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> @<span class="id" title="method">elem_of_dom</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">D</span> := <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>). <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">elem_of_subseteq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;incrementPC&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incrementPC" class="idref" href="#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a id="regs:557" class="idref" href="#regs:557"><span class="id" title="binder">regs</span></a>: <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:557"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a'</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_Some_inv" class="idref" href="#incrementPC_Some_inv"><span class="id" title="lemma">incrementPC_Some_inv</span></a> <a id="regs:558" class="idref" href="#regs:558"><span class="id" title="binder">regs</span></a> <a id="regs':559" class="idref" href="#regs':559"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:558"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':559"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:560" class="idref" href="#p:560"><span class="id" title="binder">p</span></a> <a id="b:561" class="idref" href="#b:561"><span class="id" title="binder">b</span></a> <a id="e:562" class="idref" href="#e:562"><span class="id" title="binder">e</span></a> <a id="a:563" class="idref" href="#a:563"><span class="id" title="binder">a</span></a> <a id="a':564" class="idref" href="#a':564"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:558"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:560"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:561"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:562"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:563"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:563"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':564"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':559"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:560"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:561"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:562"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':564"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> | ] | ] | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 5 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_None_inv" class="idref" href="#incrementPC_None_inv"><span class="id" title="lemma">incrementPC_None_inv</span></a> <a id="regs:565" class="idref" href="#regs:565"><span class="id" title="binder">regs</span></a> <a id="pg:566" class="idref" href="#pg:566"><span class="id" title="binder">pg</span></a> <a id="b:567" class="idref" href="#b:567"><span class="id" title="binder">b</span></a> <a id="e:568" class="idref" href="#e:568"><span class="id" title="binder">e</span></a> <a id="a:569" class="idref" href="#a:569"><span class="id" title="binder">a</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:565"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:565"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pg:566"><span class="id" title="variable">pg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:567"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:568"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:569"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:569"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> | ] | ] |];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_overflow_mono" class="idref" href="#incrementPC_overflow_mono"><span class="id" title="lemma">incrementPC_overflow_mono</span></a> <a id="regs:570" class="idref" href="#regs:570"><span class="id" title="binder">regs</span></a> <a id="regs':571" class="idref" href="#regs':571"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:570"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#regs:570"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:570"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':571"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':571"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">HPC</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span> <span class="id" title="var">HPC</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">HPC'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HPC</span> <span class="id" title="var">HPC'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span> |- *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">aa</span> | ] | ]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">aa</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_overflow_antimono" class="idref" href="#incrementPC_overflow_antimono"><span class="id" title="lemma">incrementPC_overflow_antimono</span></a> <a id="regs:572" class="idref" href="#regs:572"><span class="id" title="binder">regs</span></a> <a id="regs':573" class="idref" href="#regs':573"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:572"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':573"><span class="id" title="variable">regs'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:572"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':573"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hincl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs'</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HrpPC</span>; <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HrpPC</span> <span class="id" title="var">Hincl</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*&nbsp;todo:&nbsp;instead,&nbsp;define&nbsp;updatePC&nbsp;on&nbsp;top&nbsp;of&nbsp;incrementPC&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_fail_updatePC" class="idref" href="#incrementPC_fail_updatePC"><span class="id" title="lemma">incrementPC_fail_updatePC</span></a> <a id="regs:574" class="idref" href="#regs:574"><span class="id" title="binder">regs</span></a> <a id="m:575" class="idref" href="#m:575"><span class="id" title="binder">m</span></a> <a id="etbl:576" class="idref" href="#etbl:576"><span class="id" title="binder">etbl</span></a> <a id="ecur:577" class="idref" href="#ecur:577"><span class="id" title="binder">ecur</span></a>:<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:574"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:574"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:575"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:576"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:577"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a'</span> | ] |]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a'</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_success_updatePC" class="idref" href="#incrementPC_success_updatePC"><span class="id" title="lemma">incrementPC_success_updatePC</span></a> <a id="regs:578" class="idref" href="#regs:578"><span class="id" title="binder">regs</span></a> <a id="m:579" class="idref" href="#m:579"><span class="id" title="binder">m</span></a> <a id="etbl:580" class="idref" href="#etbl:580"><span class="id" title="binder">etbl</span></a> <a id="ecur:581" class="idref" href="#ecur:581"><span class="id" title="binder">ecur</span></a> <a id="regs':582" class="idref" href="#regs':582"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:578"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':582"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="p:583" class="idref" href="#p:583"><span class="id" title="binder">p</span></a> <a id="b:584" class="idref" href="#b:584"><span class="id" title="binder">b</span></a> <a id="e:585" class="idref" href="#e:585"><span class="id" title="binder">e</span></a> <a id="a:586" class="idref" href="#a:586"><span class="id" title="binder">a</span></a> <a id="a':587" class="idref" href="#a':587"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:578"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:583"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:584"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:585"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:586"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:586"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':587"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:578"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:579"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:580"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:581"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:583"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:584"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:585"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':587"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:579"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:580"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:581"><span class="id" title="variable">ecur</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':582"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:583"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:584"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:585"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':587"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a'</span>|]|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a'</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:?; [| <span class="id" title="tactic">congruence</span>]. <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span> <span class="id" title="var">regs'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 5 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_success_incl" class="idref" href="#updatePC_success_incl"><span class="id" title="lemma">updatePC_success_incl</span></a> <a id="m:588" class="idref" href="#m:588"><span class="id" title="binder">m</span></a> <a id="m':589" class="idref" href="#m':589"><span class="id" title="binder">m'</span></a> <a id="regs:590" class="idref" href="#regs:590"><span class="id" title="binder">regs</span></a> <a id="regs':591" class="idref" href="#regs':591"><span class="id" title="binder">regs'</span></a> <a id="etbl:592" class="idref" href="#etbl:592"><span class="id" title="binder">etbl</span></a> <a id="etbl':593" class="idref" href="#etbl':593"><span class="id" title="binder">etbl'</span></a> <a id="ecur:594" class="idref" href="#ecur:594"><span class="id" title="binder">ecur</span></a> <a id="ecur':595" class="idref" href="#ecur':595"><span class="id" title="binder">ecur'</span></a> <a id="w:596" class="idref" href="#w:596"><span class="id" title="binder">w</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:590"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':591"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:590"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:588"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:592"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:594"><span class="id" title="variable">ecur</span></a> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:596"><span class="id" title="variable">w</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:588"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:592"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:594"><span class="id" title="variable">ecur</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs':591"><span class="id" title="variable">regs'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':589"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':593"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':595"><span class="id" title="variable">ecur'</span></a> |}<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:596"><span class="id" title="variable">w</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs'</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':589"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':593"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':595"><span class="id" title="variable">ecur'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hincl</span> <span class="id" title="var">Hu</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ <span class="id" title="var">w1</span> |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hrr</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hrr</span> <span class="id" title="var">Hincl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hregs'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hregs'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w1</span> <span class="id" title="keyword">as</span> [|[ ? ? ? <span class="id" title="var">a1</span>|] | ]; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ha1</span>; <span class="id" title="var">simplify_eq</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HH</span>: <span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="reg1:597" class="idref" href="#reg1:597"><span class="id" title="binder"><span id="reg1:599" class="id">reg1</span></span></a> <a id="reg2:598" class="idref" href="#reg2:598"><span class="id" title="binder"><span id="reg2:600" class="id">reg2</span></span></a>:<a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#reg1:597"><span class="id" title="variable">reg1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg2:598"><span class="id" title="variable">reg2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg1:597"><span class="id" title="variable">reg1</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg2:598"><span class="id" title="variable">reg2</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">intros</span> * -&gt;; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">Hu</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HH</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">lookup_insert</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;{  <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hu</span>. }<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_fail_incl" class="idref" href="#updatePC_fail_incl"><span class="id" title="lemma">updatePC_fail_incl</span></a> <a id="m:601" class="idref" href="#m:601"><span class="id" title="binder">m</span></a> <a id="m':602" class="idref" href="#m':602"><span class="id" title="binder">m'</span></a> <a id="regs:603" class="idref" href="#regs:603"><span class="id" title="binder">regs</span></a> <a id="regs':604" class="idref" href="#regs':604"><span class="id" title="binder">regs'</span></a> <a id="etbl:605" class="idref" href="#etbl:605"><span class="id" title="binder">etbl</span></a> <a id="etbl':606" class="idref" href="#etbl':606"><span class="id" title="binder">etbl'</span></a> <a id="ecur:607" class="idref" href="#ecur:607"><span class="id" title="binder">ecur</span></a> <a id="ecur':608" class="idref" href="#ecur':608"><span class="id" title="binder">ecur'</span></a>  :<br/>
&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#regs:603"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:603"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':604"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:603"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:601"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:605"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:607"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs':604"><span class="id" title="variable">regs'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':602"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':606"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':608"><span class="id" title="variable">ecur'</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> <span class="id" title="var">HPC</span>] <span class="id" title="var">Hincl</span> <span class="id" title="var">Hfail</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hfail</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">HPC</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfail</span>. <span class="id" title="var">have</span> -&gt; := <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a1</span> | ] |]; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>;[].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">incrementPC_inv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC_Some_inv"><span class="id" title="axiom">incrementPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC_None_inv"><span class="id" title="axiom">incrementPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_incrementPC" class="idref" href="#updatePC_incrementPC"><span class="id" title="lemma">updatePC_incrementPC</span></a> {<a id="9bf33e78d96fe017a271bda91da42a6e" class="idref" href="#9bf33e78d96fe017a271bda91da42a6e"><span class="id" title="binder">φ</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9bf33e78d96fe017a271bda91da42a6e"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="r':610" class="idref" href="#r':610"><span class="id" title="binder">r'</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9bf33e78d96fe017a271bda91da42a6e"><span class="id" title="variable">φ</span></a>) <span class="id" title="notation">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9bf33e78d96fe017a271bda91da42a6e"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r':610"><span class="id" title="variable">r'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a>, <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a>, <a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;incrementLPC&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incrementLPC" class="idref" href="#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> (<a id="regs:611" class="idref" href="#regs:611"><span class="id" title="binder">regs</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:611"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a'</span> <span class="id" title="var">v</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_incrementPC_some&nbsp;regs&nbsp;regs'&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;Some&nbsp;regs'&nbsp;-&gt;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementPC&nbsp;(lreg_strip&nbsp;regs)&nbsp;=&nbsp;Some&nbsp;(lreg_strip&nbsp;regs').&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/incrementPC&nbsp;/incrementLPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intros&nbsp;Hlpc.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/lreg_strip&nbsp;lookup_fmap;&nbsp;cbn.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(regs&nbsp;!!&nbsp;PC)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">lw</span>|</span>&nbsp;eqn:Heq&nbsp;;&nbsp;rewrite&nbsp;Heq;&nbsp;cbn&nbsp;in&nbsp;*;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct_lword&nbsp;lw;&nbsp;cbn&nbsp;in&nbsp;*;&nbsp;try&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;simplify_eq.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;rewrite&nbsp;fmap_insert.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_incrementPC_none&nbsp;regs&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;None&nbsp;&lt;-&gt;&nbsp;incrementPC&nbsp;(lreg_strip&nbsp;regs)&nbsp;=&nbsp;None.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intros.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/incrementPC&nbsp;/incrementLPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/lreg_strip&nbsp;lookup_fmap;&nbsp;cbn.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(regs&nbsp;!!&nbsp;PC)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">LX</span>|</span>&nbsp;eqn:Heq&nbsp;;&nbsp;rewrite&nbsp;Heq;&nbsp;cbn;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;LX&nbsp;;&nbsp;cbn&nbsp;;&nbsp;<span class="inlinecode">(<span class="id" title="tactic">clear</span>;</span> <span class="inlinecode"><span class="id" title="tactic">firstorder</span>)</span> <span class="inlinecode">|</span> <span class="inlinecode">|</span> <span class="inlinecode">(<span class="id" title="tactic">clear</span>;</span> <span class="inlinecode"><span class="id" title="tactic">firstorder</span>)</span>.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;sb&nbsp;as&nbsp;<span class="inlinecode">?</span> <span class="inlinecode">?</span> <span class="inlinecode">?</span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode">|</span> <span class="inlinecode"></span>&nbsp;;&nbsp;eauto;&nbsp;cbn;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(a'&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_fail_updatePC&nbsp;regs&nbsp;m&nbsp;etbl&nbsp;ecur:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;None&nbsp;-&gt;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;updatePC&nbsp;{|&nbsp;reg&nbsp;:=&nbsp;(lreg_strip&nbsp;regs);&nbsp;mem&nbsp;:=&nbsp;m;&nbsp;etable&nbsp;:=&nbsp;etbl&nbsp;;&nbsp;enumcur&nbsp;:=&nbsp;ecur&nbsp;|}&nbsp;=&nbsp;None.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intro&nbsp;Hincr.&nbsp;apply&nbsp;incrementLPC_incrementPC_none&nbsp;in&nbsp;Hincr.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;apply&nbsp;incrementPC_fail_updatePC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementLPC_Some_inv" class="idref" href="#incrementLPC_Some_inv"><span class="id" title="lemma">incrementLPC_Some_inv</span></a> <a id="lregs:612" class="idref" href="#lregs:612"><span class="id" title="binder">lregs</span></a> <a id="lregs':613" class="idref" href="#lregs':613"><span class="id" title="binder">lregs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:612"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs':613"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:614" class="idref" href="#p:614"><span class="id" title="binder">p</span></a> <a id="b:615" class="idref" href="#b:615"><span class="id" title="binder">b</span></a> <a id="e:616" class="idref" href="#e:616"><span class="id" title="binder">e</span></a> <a id="a:617" class="idref" href="#a:617"><span class="id" title="binder">a</span></a> <a id="v:618" class="idref" href="#v:618"><span class="id" title="binder">v</span></a> <a id="a':619" class="idref" href="#a':619"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:612"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:614"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:615"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:616"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:617"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:618"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:617"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':619"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs':613"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:614"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:615"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:616"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':619"><span class="id" title="variable">a'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:618"><span class="id" title="variable">v</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> ? | ] | ] | ]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 6 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementLPC_None_inv" class="idref" href="#incrementLPC_None_inv"><span class="id" title="lemma">incrementLPC_None_inv</span></a> <a id="lregs:620" class="idref" href="#lregs:620"><span class="id" title="binder">lregs</span></a> <a id="pg:621" class="idref" href="#pg:621"><span class="id" title="binder">pg</span></a> <a id="b:622" class="idref" href="#b:622"><span class="id" title="binder">b</span></a> <a id="e:623" class="idref" href="#e:623"><span class="id" title="binder">e</span></a> <a id="a:624" class="idref" href="#a:624"><span class="id" title="binder">a</span></a> <a id="v:625" class="idref" href="#v:625"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:620"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:620"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pg:621"><span class="id" title="variable">pg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:622"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:623"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:624"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:625"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:624"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> ? | ] | ] |]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_success_updatePC&nbsp;regs&nbsp;m&nbsp;etbl&nbsp;ecur&nbsp;regs'&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;Some&nbsp;regs'&nbsp;-&gt;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;∃&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;a'&nbsp;(v&nbsp;:&nbsp;Version),&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regs&nbsp;!!&nbsp;PC&nbsp;=&nbsp;Some&nbsp;(LCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;v)&nbsp;∧&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updatePC&nbsp;{|&nbsp;reg&nbsp;:=&nbsp;(lreg_strip&nbsp;regs);&nbsp;mem&nbsp;:=&nbsp;m;&nbsp;etable&nbsp;:=&nbsp;etbl&nbsp;;&nbsp;enumcur&nbsp;:=&nbsp;ecur&nbsp;|}&nbsp;=&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;(NextI,&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|&nbsp;reg&nbsp;:=&nbsp;(&lt;<span class="inlinecode"><span class="id" title="var">PC</span>:=<span class="id" title="var">WCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span>&gt;&nbsp;(lreg_strip&nbsp;regs));&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mem&nbsp;:=&nbsp;m;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;etable&nbsp;:=&nbsp;etbl&nbsp;;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enumcur&nbsp;:=&nbsp;ecur&nbsp;|})&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧&nbsp;regs'&nbsp;=&nbsp;&lt;<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">PC</span></span> <span class="inlinecode">:=</span> <span class="inlinecode">(<span class="id" title="var">LCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">v</span>)</span> <span class="inlinecode"></span>&gt;&nbsp;regs.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intro&nbsp;Hincr.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;opose&nbsp;proof&nbsp;(incrementLPC_incrementPC_some&nbsp;_&nbsp;_&nbsp;Hincr)&nbsp;as&nbsp;HincrPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;eapply&nbsp;(incrementPC_success_updatePC&nbsp;_&nbsp;m&nbsp;etbl&nbsp;ecur)&nbsp;in&nbsp;HincrPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;HincrPC&nbsp;as&nbsp;(p'&amp;b'&amp;e'&amp;a''&amp;a'''&amp;Hregs&amp;Heq&amp;Hupd&amp;Hregseq).&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/incrementLPC&nbsp;in&nbsp;Hincr.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(regs&nbsp;!!&nbsp;PC)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">wpc</span></span> <span class="inlinecode">|</span>;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct_lword&nbsp;wpc;&nbsp;try&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/lreg_strip&nbsp;fmap_insert&nbsp;//=&nbsp;-/(lreg_strip&nbsp;regs)&nbsp;&nbsp;in&nbsp;Hregseq.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;exists&nbsp;p,&nbsp;b,&nbsp;e,&nbsp;a,&nbsp;a',&nbsp;v.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;repeat&nbsp;(split;&nbsp;try&nbsp;done).&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;rewrite&nbsp;Hupd&nbsp;Hregseq.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">incrementLPC_inv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_Some_inv"><span class="id" title="axiom">incrementLPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_None_inv"><span class="id" title="axiom">incrementLPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "incrementLPC_inv" "as" <span class="id" title="var">simple_intropattern</span>(<span class="id" title="var">pat</span>):=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_Some_inv"><span class="id" title="axiom">incrementLPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">pat</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_None_inv"><span class="id" title="axiom">incrementLPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_rules_opt" class="idref" href="#cap_lang_rules_opt"><span class="id" title="section">cap_lang_rules_opt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:626" class="idref" href="#H:626"><span class="id" title="binder">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H0:628" class="idref" href="#H0:628"><span class="id" title="binder">memG</span></a> <a id="7e2f00d9b830ec01a1a8a1e8e08b2213" class="idref" href="#7e2f00d9b830ec01a1a8a1e8e08b2213"><span class="id" title="binder"><span id="H0:628" class="id">Σ</span></span></a>, <a id="H1:629" class="idref" href="#H1:629"><span class="id" title="binder">regG</span></a> <a id="H1:629" class="idref" href="#H1:629"><span class="id" title="binder">Σ</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">c</span> : <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">la</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lw</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lregs</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">mem</span> : <a class="idref" href="cap_machine.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lmem</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="wp_opt" class="idref" href="#wp_opt"><span class="id" title="definition">wp_opt</span></a> {<a id="A:630" class="idref" href="#A:630"><span class="id" title="binder">A</span></a>} (<a id="e5ca5d7884148fcf4d6e64202bd45adf" class="idref" href="#e5ca5d7884148fcf4d6e64202bd45adf"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:630"><span class="id" title="variable">A</span></a>) (<a id="246f565a09fc8aa2a90fada1f9d804fd" class="idref" href="#246f565a09fc8aa2a90fada1f9d804fd"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="5c4450cb53da8372e13ce849de490c1b" class="idref" href="#5c4450cb53da8372e13ce849de490c1b"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:630"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#e5ca5d7884148fcf4d6e64202bd45adf"><span class="id" title="variable">φ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#246f565a09fc8aa2a90fada1f9d804fd"><span class="id" title="variable">Φf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> φ' =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#5c4450cb53da8372e13ce849de490c1b"><span class="id" title="variable">Φs</span></a> φ'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_unfold" class="idref" href="#wp_opt_unfold"><span class="id" title="lemma">wp_opt_unfold</span></a> {<a id="A:635" class="idref" href="#A:635"><span class="id" title="binder">A</span></a>} {<a id="eba535542130110d0b79235dfcc3c050" class="idref" href="#eba535542130110d0b79235dfcc3c050"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:635"><span class="id" title="variable">A</span></a>} {<a id="bbaf873fc8ea003aacf369a07781b789" class="idref" href="#bbaf873fc8ea003aacf369a07781b789"><span class="id" title="binder">Φf</span></a> <a id="c7ede28e829d5818c82ed93181337498" class="idref" href="#c7ede28e829d5818c82ed93181337498"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#eba535542130110d0b79235dfcc3c050"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#bbaf873fc8ea003aacf369a07781b789"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:639" class="idref" href="#x:639"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#eba535542130110d0b79235dfcc3c050"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:639"><span class="id" title="variable">x</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#c7ede28e829d5818c82ed93181337498"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:639"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#eba535542130110d0b79235dfcc3c050"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bbaf873fc8ea003aacf369a07781b789"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c7ede28e829d5818c82ed93181337498"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; [<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>| <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_eqn" class="idref" href="#wp_opt_eqn"><span class="id" title="lemma">wp_opt_eqn</span></a> {<a id="A:640" class="idref" href="#A:640"><span class="id" title="binder">A</span></a>} (<a id="dd267cf4f2728d8f38de10c290b02453" class="idref" href="#dd267cf4f2728d8f38de10c290b02453"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:640"><span class="id" title="variable">A</span></a>) (<a id="6fb3bf674b4e0ebe7995d920fa2cc0b6" class="idref" href="#6fb3bf674b4e0ebe7995d920fa2cc0b6"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="f616a3829056c3e7eeb5121585845156" class="idref" href="#f616a3829056c3e7eeb5121585845156"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:640"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dd267cf4f2728d8f38de10c290b02453"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6fb3bf674b4e0ebe7995d920fa2cc0b6"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x:644" class="idref" href="#x:644"><span class="id" title="binder">x</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#dd267cf4f2728d8f38de10c290b02453"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:644"><span class="id" title="variable">x</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#f616a3829056c3e7eeb5121585845156"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:644"><span class="id" title="variable">x</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dd267cf4f2728d8f38de10c290b02453"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6fb3bf674b4e0ebe7995d920fa2cc0b6"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f616a3829056c3e7eeb5121585845156"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="var">cbn</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_is_Some" class="idref" href="#wp_opt_is_Some"><span class="id" title="lemma">wp_opt_is_Some</span></a> {<a id="A:645" class="idref" href="#A:645"><span class="id" title="binder">A</span></a> <a id="1fe2bf73d24773b325d31a1de0cadb3d" class="idref" href="#1fe2bf73d24773b325d31a1de0cadb3d"><span class="id" title="binder">Φs</span></a> <a id="75f6fdc509a5504b1b8c4fbbcc7f69b0" class="idref" href="#75f6fdc509a5504b1b8c4fbbcc7f69b0"><span class="id" title="binder">Φf</span></a>} {<a id="e7f5ef2c8d106203c6795d3cd4dff894" class="idref" href="#e7f5ef2c8d106203c6795d3cd4dff894"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:645"><span class="id" title="variable">A</span></a>} : <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#e7f5ef2c8d106203c6795d3cd4dff894"><span class="id" title="variable">φ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e7f5ef2c8d106203c6795d3cd4dff894"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#75f6fdc509a5504b1b8c4fbbcc7f69b0"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1fe2bf73d24773b325d31a1de0cadb3d"><span class="id" title="variable">Φs</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e7f5ef2c8d106203c6795d3cd4dff894"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">False</span> <a class="idref" href="cap_machine.rules.rules_base.html#1fe2bf73d24773b325d31a1de0cadb3d"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_univ" class="idref" href="#wp_opt_univ"><span class="id" title="lemma">wp_opt_univ</span></a> {<a id="A:649" class="idref" href="#A:649"><span class="id" title="binder">A</span></a> <a id="bde656682a463f1f89b38c023eb790ce" class="idref" href="#bde656682a463f1f89b38c023eb790ce"><span class="id" title="binder">Φs</span></a>} {<a id="f60935546ce3a5c37b03409d8a590697" class="idref" href="#f60935546ce3a5c37b03409d8a590697"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:649"><span class="id" title="variable">A</span></a>} : <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:652" class="idref" href="#x:652"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#bde656682a463f1f89b38c023eb790ce"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:652"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f60935546ce3a5c37b03409d8a590697"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">True</span> <a class="idref" href="cap_machine.rules.rules_base.html#bde656682a463f1f89b38c023eb790ce"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> φ.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_bind" class="idref" href="#wp_opt_bind"><span class="id" title="lemma">wp_opt_bind</span></a> {<a id="A:653" class="idref" href="#A:653"><span class="id" title="binder">A</span></a> <a id="B:654" class="idref" href="#B:654"><span class="id" title="binder">B</span></a>} {<a id="bbd4113ddf4f40cd61b2e7fbfc8da08a" class="idref" href="#bbd4113ddf4f40cd61b2e7fbfc8da08a"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:653"><span class="id" title="variable">A</span></a>} {<a id="K:656" class="idref" href="#K:656"><span class="id" title="binder">K</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:653"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B:654"><span class="id" title="variable">B</span></a>} {<a id="5f7aabfa8b0381661fdeb3c78bc77359" class="idref" href="#5f7aabfa8b0381661fdeb3c78bc77359"><span class="id" title="binder">Φf</span></a> <a id="9b33bd8ea651710014271ee5a27b8341" class="idref" href="#9b33bd8ea651710014271ee5a27b8341"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bbd4113ddf4f40cd61b2e7fbfc8da08a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5f7aabfa8b0381661fdeb3c78bc77359"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="c355e95168f520a418ea9f13632b576f" class="idref" href="#c355e95168f520a418ea9f13632b576f"><span class="id" title="binder">φ'</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#K:656"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c355e95168f520a418ea9f13632b576f"><span class="id" title="variable">φ'</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#5f7aabfa8b0381661fdeb3c78bc77359"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9b33bd8ea651710014271ee5a27b8341"><span class="id" title="variable">Φs</span></a>) <span class="id" title="notation">⊣⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#bbd4113ddf4f40cd61b2e7fbfc8da08a"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">≫=</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:656"><span class="id" title="variable">K</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#5f7aabfa8b0381661fdeb3c78bc77359"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9b33bd8ea651710014271ee5a27b8341"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_mono" class="idref" href="#wp_opt_mono"><span class="id" title="lemma">wp_opt_mono</span></a> {<a id="A:660" class="idref" href="#A:660"><span class="id" title="binder">A</span></a>} {<a id="m:661" class="idref" href="#m:661"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:660"><span class="id" title="variable">A</span></a>} {<a id="d35dc23704abc357a3a3ce244bde0311" class="idref" href="#d35dc23704abc357a3a3ce244bde0311"><span class="id" title="binder">Φf</span></a> <a id="5ea7b0ef6233237b68cb67e7bc085286" class="idref" href="#5ea7b0ef6233237b68cb67e7bc085286"><span class="id" title="binder">Φs1</span></a> <a id="835e34f5cd68ba92031e7c3c00891350" class="idref" href="#835e34f5cd68ba92031e7c3c00891350"><span class="id" title="binder">Φs2</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:665" class="idref" href="#x:665"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#5ea7b0ef6233237b68cb67e7bc085286"><span class="id" title="variable">Φs1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:665"><span class="id" title="variable">x</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#835e34f5cd68ba92031e7c3c00891350"><span class="id" title="variable">Φs2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:665"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#m:661"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d35dc23704abc357a3a3ce244bde0311"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5ea7b0ef6233237b68cb67e7bc085286"><span class="id" title="variable">Φs1</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#m:661"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d35dc23704abc357a3a3ce244bde0311"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#835e34f5cd68ba92031e7c3c00891350"><span class="id" title="variable">Φs2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(HΦs &amp; Hwp)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "HΦs".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="wp_opt2" class="idref" href="#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> {<a id="A1:666" class="idref" href="#A1:666"><span class="id" title="binder">A1</span></a> <a id="A2:667" class="idref" href="#A2:667"><span class="id" title="binder">A2</span></a>} <a id="Ep:668" class="idref" href="#Ep:668"><span class="id" title="binder">Ep</span></a> (<a id="0d33de9a76376f02a690b09173c0daa3" class="idref" href="#0d33de9a76376f02a690b09173c0daa3"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:666"><span class="id" title="variable">A1</span></a>) (<a id="3c5b0597e49cd429ac3a0ec088072dbd" class="idref" href="#3c5b0597e49cd429ac3a0ec088072dbd"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:667"><span class="id" title="variable">A2</span></a>) (<a id="15d42f39755b3eb8964955fc5d86ec9e" class="idref" href="#15d42f39755b3eb8964955fc5d86ec9e"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="c779cd77469795bd5c46ba22d2b7250a" class="idref" href="#c779cd77469795bd5c46ba22d2b7250a"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:666"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:667"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#0d33de9a76376f02a690b09173c0daa3"><span class="id" title="variable">φ1</span></a> , <a class="idref" href="cap_machine.rules.rules_base.html#3c5b0597e49cd429ac3a0ec088072dbd"><span class="id" title="variable">φ2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> , <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:668"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#15d42f39755b3eb8964955fc5d86ec9e"><span class="id" title="variable">Φf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x1</span> , <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x2</span> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:668"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#c779cd77469795bd5c46ba22d2b7250a"><span class="id" title="variable">Φs</span></a> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:668"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <span class="id" title="notation">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_diag_univ" class="idref" href="#wp2_diag_univ"><span class="id" title="lemma">wp2_diag_univ</span></a> {<a id="A:675" class="idref" href="#A:675"><span class="id" title="binder">A</span></a>} {<a id="fea538c0f3e38bd56fd246a2e8e6e3ff" class="idref" href="#fea538c0f3e38bd56fd246a2e8e6e3ff"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:675"><span class="id" title="variable">A</span></a>} {<a id="Ep:677" class="idref" href="#Ep:677"><span class="id" title="binder">Ep</span></a> <a id="a7d7b3386d298998043602916138a2c8" class="idref" href="#a7d7b3386d298998043602916138a2c8"><span class="id" title="binder">Φf</span></a>} {<a id="d5d296ee20578bb5f42438ead6f8b8ac" class="idref" href="#d5d296ee20578bb5f42438ead6f8b8ac"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:675"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:675"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#a7d7b3386d298998043602916138a2c8"><span class="id" title="variable">Φf</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:680" class="idref" href="#x:680"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#d5d296ee20578bb5f42438ead6f8b8ac"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:680"><span class="id" title="variable">x</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:680"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:677"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fea538c0f3e38bd56fd246a2e8e6e3ff"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fea538c0f3e38bd56fd246a2e8e6e3ff"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a7d7b3386d298998043602916138a2c8"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d5d296ee20578bb5f42438ead6f8b8ac"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; [<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span> | <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_wp2" class="idref" href="#wp_wp2"><span class="id" title="lemma">wp_wp2</span></a> {<a id="Ep:681" class="idref" href="#Ep:681"><span class="id" title="binder">Ep</span></a> <a id="A1:682" class="idref" href="#A1:682"><span class="id" title="binder">A1</span></a> <a id="A2:683" class="idref" href="#A2:683"><span class="id" title="binder">A2</span></a>} {<a id="c70532733b9ff5a3a348fa2befc89e5b" class="idref" href="#c70532733b9ff5a3a348fa2befc89e5b"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:682"><span class="id" title="variable">A1</span></a>} {<a id="c915d6d67cdb6382b9485789c5afb0c4" class="idref" href="#c915d6d67cdb6382b9485789c5afb0c4"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:683"><span class="id" title="variable">A2</span></a>} {<a id="70570743dada754ed2280c1b58752252" class="idref" href="#70570743dada754ed2280c1b58752252"><span class="id" title="binder">Φf</span></a> <a id="93db51dcd621a77c7b49706f0f3bd10a" class="idref" href="#93db51dcd621a77c7b49706f0f3bd10a"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:681"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c70532733b9ff5a3a348fa2befc89e5b"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c915d6d67cdb6382b9485789c5afb0c4"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#70570743dada754ed2280c1b58752252"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:688" class="idref" href="#x1:688"><span class="id" title="binder">x1</span></a> <a id="x2:689" class="idref" href="#x2:689"><span class="id" title="binder">x2</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#93db51dcd621a77c7b49706f0f3bd10a"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:689"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c915d6d67cdb6382b9485789c5afb0c4"><span class="id" title="variable">φ2</span></a> (<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:681"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#70570743dada754ed2280c1b58752252"><span class="id" title="variable">Φf</span></a>) (<span class="id" title="keyword">fun</span> <a id="x:690" class="idref" href="#x:690"><span class="id" title="binder">x</span></a> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:681"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#93db51dcd621a77c7b49706f0f3bd10a"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:690"><span class="id" title="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1 , φ2; <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> "Hk" <span class="id" title="keyword">as</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_val" class="idref" href="#wp2_val"><span class="id" title="lemma">wp2_val</span></a> {<a id="A1:691" class="idref" href="#A1:691"><span class="id" title="binder">A1</span></a> <a id="A2:692" class="idref" href="#A2:692"><span class="id" title="binder">A2</span></a>} {<a id="x1:693" class="idref" href="#x1:693"><span class="id" title="binder">x1</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:691"><span class="id" title="variable">A1</span></a>} {<a id="x2:694" class="idref" href="#x2:694"><span class="id" title="binder">x2</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A2:692"><span class="id" title="variable">A2</span></a>} {<a id="bf2c9dc637acee6d46586c918101b881" class="idref" href="#bf2c9dc637acee6d46586c918101b881"><span class="id" title="binder">Φf</span></a> <a id="0e1264efd2da6b60f3335e058bbdcccd" class="idref" href="#0e1264efd2da6b60f3335e058bbdcccd"><span class="id" title="binder">Φs</span></a> <a id="Ep:697" class="idref" href="#Ep:697"><span class="id" title="binder">Ep</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:697"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#0e1264efd2da6b60f3335e058bbdcccd"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:693"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:694"><span class="id" title="variable">x2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:697"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:693"><span class="id" title="variable">x1</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:694"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#bf2c9dc637acee6d46586c918101b881"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0e1264efd2da6b60f3335e058bbdcccd"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_eqn" class="idref" href="#wp_opt2_eqn"><span class="id" title="lemma">wp_opt2_eqn</span></a> {<a id="Ep:698" class="idref" href="#Ep:698"><span class="id" title="binder">Ep</span></a>} {<a id="A1:699" class="idref" href="#A1:699"><span class="id" title="binder">A1</span></a> <a id="A2:700" class="idref" href="#A2:700"><span class="id" title="binder">A2</span></a>} {<a id="36b6ad66bf61651ff8bfc89d07db5dda" class="idref" href="#36b6ad66bf61651ff8bfc89d07db5dda"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:699"><span class="id" title="variable">A1</span></a>} {<a id="5e3b0f1944b19364d4ea68b432326f75" class="idref" href="#5e3b0f1944b19364d4ea68b432326f75"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:700"><span class="id" title="variable">A2</span></a>} (<a id="aa94bb4e9fd4f97ce3b8e3a3b959fafa" class="idref" href="#aa94bb4e9fd4f97ce3b8e3a3b959fafa"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="26b2f262cc8a7a37f844032230972e04" class="idref" href="#26b2f262cc8a7a37f844032230972e04"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:699"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:700"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:698"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#36b6ad66bf61651ff8bfc89d07db5dda"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5e3b0f1944b19364d4ea68b432326f75"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#aa94bb4e9fd4f97ce3b8e3a3b959fafa"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:705" class="idref" href="#x1:705"><span class="id" title="binder">x1</span></a> <a id="x2:706" class="idref" href="#x2:706"><span class="id" title="binder">x2</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#36b6ad66bf61651ff8bfc89d07db5dda"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:705"><span class="id" title="variable">x1</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#5e3b0f1944b19364d4ea68b432326f75"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:706"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#26b2f262cc8a7a37f844032230972e04"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:705"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:706"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:698"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#36b6ad66bf61651ff8bfc89d07db5dda"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5e3b0f1944b19364d4ea68b432326f75"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#aa94bb4e9fd4f97ce3b8e3a3b959fafa"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#26b2f262cc8a7a37f844032230972e04"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_eqn_both" class="idref" href="#wp_opt2_eqn_both"><span class="id" title="lemma">wp_opt2_eqn_both</span></a> {<a id="Ep:707" class="idref" href="#Ep:707"><span class="id" title="binder">Ep</span></a>} {<a id="A1:708" class="idref" href="#A1:708"><span class="id" title="binder">A1</span></a> <a id="A2:709" class="idref" href="#A2:709"><span class="id" title="binder">A2</span></a>} {<a id="f975a4cb217e1f5da4a5abb885cdb927" class="idref" href="#f975a4cb217e1f5da4a5abb885cdb927"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:708"><span class="id" title="variable">A1</span></a>} {<a id="8062c29160075c35e29f1ffc8ea4f475" class="idref" href="#8062c29160075c35e29f1ffc8ea4f475"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:709"><span class="id" title="variable">A2</span></a>} (<a id="66dc0e15df735d509f6b34b9ba602adc" class="idref" href="#66dc0e15df735d509f6b34b9ba602adc"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="fae2f6f8a63c85ba195ed00c2c3ab9ee" class="idref" href="#fae2f6f8a63c85ba195ed00c2c3ab9ee"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:708"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:709"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:707"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f975a4cb217e1f5da4a5abb885cdb927"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8062c29160075c35e29f1ffc8ea4f475"><span class="id" title="variable">φ2</span></a> (<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#f975a4cb217e1f5da4a5abb885cdb927"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#8062c29160075c35e29f1ffc8ea4f475"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#66dc0e15df735d509f6b34b9ba602adc"><span class="id" title="variable">Φf</span></a>) (<span class="id" title="keyword">fun</span> <a id="x1:714" class="idref" href="#x1:714"><span class="id" title="binder">x1</span></a> <a id="x2:715" class="idref" href="#x2:715"><span class="id" title="binder">x2</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#f975a4cb217e1f5da4a5abb885cdb927"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:714"><span class="id" title="variable">x1</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#8062c29160075c35e29f1ffc8ea4f475"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:715"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#fae2f6f8a63c85ba195ed00c2c3ab9ee"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:714"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:715"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:707"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f975a4cb217e1f5da4a5abb885cdb927"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8062c29160075c35e29f1ffc8ea4f475"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#66dc0e15df735d509f6b34b9ba602adc"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fae2f6f8a63c85ba195ed00c2c3ab9ee"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_mod" class="idref" href="#wp_opt2_mod"><span class="id" title="lemma">wp_opt2_mod</span></a> {<a id="Ep:716" class="idref" href="#Ep:716"><span class="id" title="binder">Ep</span></a>} {<a id="A1:717" class="idref" href="#A1:717"><span class="id" title="binder">A1</span></a> <a id="A2:718" class="idref" href="#A2:718"><span class="id" title="binder">A2</span></a>} {<a id="35b5b9d456728227fd9334db08ede5a8" class="idref" href="#35b5b9d456728227fd9334db08ede5a8"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:717"><span class="id" title="variable">A1</span></a>} {<a id="53252fbc50b9a621feb5c2e7e2e8fb35" class="idref" href="#53252fbc50b9a621feb5c2e7e2e8fb35"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:718"><span class="id" title="variable">A2</span></a>} {<a id="c41d8ff9064060b32e5dfa700cbb4ada" class="idref" href="#c41d8ff9064060b32e5dfa700cbb4ada"><span class="id" title="binder">Φf</span></a> <a id="df71862bb4298264b08552e29ad922bb" class="idref" href="#df71862bb4298264b08552e29ad922bb"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:716"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:716"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#35b5b9d456728227fd9334db08ede5a8"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#53252fbc50b9a621feb5c2e7e2e8fb35"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c41d8ff9064060b32e5dfa700cbb4ada"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df71862bb4298264b08552e29ad922bb"><span class="id" title="variable">Φs</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:716"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#35b5b9d456728227fd9334db08ede5a8"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#53252fbc50b9a621feb5c2e7e2e8fb35"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c41d8ff9064060b32e5dfa700cbb4ada"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df71862bb4298264b08552e29ad922bb"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "&gt;H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_bind" class="idref" href="#wp_opt2_bind"><span class="id" title="lemma">wp_opt2_bind</span></a> {<a id="Ep:723" class="idref" href="#Ep:723"><span class="id" title="binder">Ep</span></a>} {<a id="A1:724" class="idref" href="#A1:724"><span class="id" title="binder">A1</span></a> <a id="A2:725" class="idref" href="#A2:725"><span class="id" title="binder">A2</span></a>} {<a id="B1:726" class="idref" href="#B1:726"><span class="id" title="binder">B1</span></a> <a id="B2:727" class="idref" href="#B2:727"><span class="id" title="binder">B2</span></a>} {<a id="77ec66061b9a8e20e7002f3a194be1a3" class="idref" href="#77ec66061b9a8e20e7002f3a194be1a3"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:724"><span class="id" title="variable">A1</span></a>} {<a id="ebb791d23401117d09461ae8fa209664" class="idref" href="#ebb791d23401117d09461ae8fa209664"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:725"><span class="id" title="variable">A2</span></a>} {<a id="k1:730" class="idref" href="#k1:730"><span class="id" title="binder">k1</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:724"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B1:726"><span class="id" title="variable">B1</span></a>} {<a id="k2:731" class="idref" href="#k2:731"><span class="id" title="binder">k2</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A2:725"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B2:727"><span class="id" title="variable">B2</span></a>} {<a id="f67f9ad0d727a88291dfd8b4e95af714" class="idref" href="#f67f9ad0d727a88291dfd8b4e95af714"><span class="id" title="binder">Φf</span></a> <a id="f7d3d6563ad606acf40c0dd438e2c197" class="idref" href="#f7d3d6563ad606acf40c0dd438e2c197"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:723"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#77ec66061b9a8e20e7002f3a194be1a3"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ebb791d23401117d09461ae8fa209664"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f67f9ad0d727a88291dfd8b4e95af714"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:734" class="idref" href="#x1:734"><span class="id" title="binder">x1</span></a> <a id="x2:735" class="idref" href="#x2:735"><span class="id" title="binder">x2</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:723"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#k1:730"><span class="id" title="variable">k1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:734"><span class="id" title="variable">x1</span></a>) (<a class="idref" href="cap_machine.rules.rules_base.html#k2:731"><span class="id" title="variable">k2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:735"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#f67f9ad0d727a88291dfd8b4e95af714"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f7d3d6563ad606acf40c0dd438e2c197"><span class="id" title="variable">Φs</span></a>) <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:723"><span class="id" title="variable">Ep</span></a> (<a id="x1:737" class="idref" href="#x1:737"><span class="id" title="binder">x1</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#77ec66061b9a8e20e7002f3a194be1a3"><span class="id" title="variable">φ1</span></a> <span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#k1:730"><span class="id" title="variable">k1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:737"><span class="id" title="variable">x1</span></a>) (<a id="x2:736" class="idref" href="#x2:736"><span class="id" title="binder">x2</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#ebb791d23401117d09461ae8fa209664"><span class="id" title="variable">φ2</span></a> <span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#k2:731"><span class="id" title="variable">k2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:736"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#f67f9ad0d727a88291dfd8b4e95af714"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f7d3d6563ad606acf40c0dd438e2c197"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_mod"><span class="id" title="axiom">wp_opt2_mod</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> "Hk" <span class="id" title="keyword">as</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_mono" class="idref" href="#wp_opt2_mono"><span class="id" title="lemma">wp_opt2_mono</span></a> {<a id="Ep:738" class="idref" href="#Ep:738"><span class="id" title="binder">Ep</span></a>} {<a id="A1:739" class="idref" href="#A1:739"><span class="id" title="binder">A1</span></a> <a id="A2:740" class="idref" href="#A2:740"><span class="id" title="binder">A2</span></a>} {<a id="70368542c29c0f2ad3d6c78dfac76599" class="idref" href="#70368542c29c0f2ad3d6c78dfac76599"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:739"><span class="id" title="variable">A1</span></a>} {<a id="4d21a87939974d6f929c148444d548bf" class="idref" href="#4d21a87939974d6f929c148444d548bf"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:740"><span class="id" title="variable">A2</span></a>} {<a id="d5c79917649c410cf5c8f77a1f4aca65" class="idref" href="#d5c79917649c410cf5c8f77a1f4aca65"><span class="id" title="binder">Φf</span></a> <a id="e8c13ab04c849881629f93d5b9151aa8" class="idref" href="#e8c13ab04c849881629f93d5b9151aa8"><span class="id" title="binder">Φsa</span></a> <a id="cd2903b2da6c804c839006921b3ac2f5" class="idref" href="#cd2903b2da6c804c839006921b3ac2f5"><span class="id" title="binder">Φsb</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x1:746" class="idref" href="#x1:746"><span class="id" title="binder">x1</span></a> <a id="x2:747" class="idref" href="#x2:747"><span class="id" title="binder">x2</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#e8c13ab04c849881629f93d5b9151aa8"><span class="id" title="variable">Φsa</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:746"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:747"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#cd2903b2da6c804c839006921b3ac2f5"><span class="id" title="variable">Φsb</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:746"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:747"><span class="id" title="variable">x2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:738"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#70368542c29c0f2ad3d6c78dfac76599"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4d21a87939974d6f929c148444d548bf"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d5c79917649c410cf5c8f77a1f4aca65"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e8c13ab04c849881629f93d5b9151aa8"><span class="id" title="variable">Φsa</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:738"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#70368542c29c0f2ad3d6c78dfac76599"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4d21a87939974d6f929c148444d548bf"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d5c79917649c410cf5c8f77a1f4aca65"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cd2903b2da6c804c839006921b3ac2f5"><span class="id" title="variable">Φsb</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="var">iIntros</span> "(Hab &amp; Hwp)"; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hab".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_instr_exec_opt" class="idref" href="#wp_instr_exec_opt"><span class="id" title="lemma">wp_instr_exec_opt</span></a> {<a id="s:748" class="idref" href="#s:748"><span class="id" title="binder">s</span></a> <a id="E:749" class="idref" href="#E:749"><span class="id" title="binder">E</span></a> <a id="e2a5b905eb9bbe1584add2aa792ff2c4" class="idref" href="#e2a5b905eb9bbe1584add2aa792ff2c4"><span class="id" title="binder">Φ</span></a> <a id="pc_a:751" class="idref" href="#pc_a:751"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:752" class="idref" href="#pc_v:752"><span class="id" title="binder">pc_v</span></a> <a id="dq:753" class="idref" href="#dq:753"><span class="id" title="binder">dq</span></a> <a id="regs:754" class="idref" href="#regs:754"><span class="id" title="binder">regs</span></a> <a id="lw:755" class="idref" href="#lw:755"><span class="id" title="binder">lw</span></a> <a id="pc_p:756" class="idref" href="#pc_p:756"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:757" class="idref" href="#pc_b:757"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:758" class="idref" href="#pc_e:758"><span class="id" title="binder">pc_e</span></a> <a id="instr:759" class="idref" href="#instr:759"><span class="id" title="binder">instr</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:756"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:757"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:758"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:751"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:752"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:754"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:756"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:757"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:758"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:751"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:752"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:755"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:759"><span class="id" title="variable">instr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of"><span class="id" title="definition">regs_of</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:759"><span class="id" title="variable">instr</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:754"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:751"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:752"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:753"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:755"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:760" class="idref" href="#k:760"><span class="id" title="binder"><span id="k:761" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:762" class="idref" href="#y:762"><span class="id" title="binder"><span id="y:763" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:754"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:760"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:762"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="72081705b64a0db8b45974bdf9513032" class="idref" href="#72081705b64a0db8b45974bdf9513032"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#72081705b64a0db8b45974bdf9513032"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:765" class="idref" href="#k:765"><span class="id" title="binder"><span id="k:766" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:767" class="idref" href="#y:767"><span class="id" title="binder"><span id="y:768" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:754"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:765"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:767"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:751"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:752"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:753"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:755"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:749"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="wa:769" class="idref" href="#wa:769"><span class="id" title="binder">wa</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#72081705b64a0db8b45974bdf9513032"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:756"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:757"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:758"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:751"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#72081705b64a0db8b45974bdf9513032"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:751"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wa:769"><span class="id" title="variable">wa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#isCorrectPC"><span class="id" title="inductive">isCorrectPC</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:756"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:757"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:758"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:751"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#decodeInstrW"><span class="id" title="definition">decodeInstrW</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wa:769"><span class="id" title="variable">wa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:759"><span class="id" title="variable">instr</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:749"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.cap_lang.html#exec_opt"><span class="id" title="definition">exec_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:759"><span class="id" title="variable">instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#72081705b64a0db8b45974bdf9513032"><span class="id" title="variable">σ1</span></a>) (<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:749"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#72081705b64a0db8b45974bdf9513032"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#e2a5b905eb9bbe1584add2aa792ff2c4"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> (<a id="c2:770" class="idref" href="#c2:770"><span class="id" title="binder">c2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#Conf"><span class="id" title="definition">Conf</span></a>) =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:749"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=&gt;</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c2:770"><span class="id" title="variable">c2</span></a><span class="id" title="notation">.2</span> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#e2a5b905eb9bbe1584add2aa792ff2c4"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c2:770"><span class="id" title="variable">c2</span></a><span class="id" title="notation">.1</span>))<span class="id" title="notation">)</span>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:748"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:749"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#e2a5b905eb9bbe1584add2aa792ff2c4"><span class="id" title="variable">Φ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcorrpc</span> <span class="id" title="var">Hregspc</span> <span class="id" title="var">Hdecode</span> <span class="id" title="var">Hregs_incl</span>) "(&gt;Hcode &amp; &gt;Hregs &amp; H)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_instr_exec"><span class="id" title="axiom">wp_instr_exec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1) "Hσ1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregsincl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">Hregs_pc</span> := <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hregspc</span> <span class="id" title="var">Hregsincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hcode"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlcode</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">Hstep</span>) "Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="notation">{|</span> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="var">reg</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <span class="id" title="var">mem</span>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <span class="id" title="var">etable</span>; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <span class="id" title="var">enumcur</span> <span class="id" title="notation">|}</span> <span class="id" title="notation">with</span> "[Hr Hm $Hregs $Hcode]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;allow&nbsp;changing&nbsp;cur_map?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_phys_corresponds_reg"><span class="id" title="axiom">state_phys_corresponds_reg</span></a> ; <span class="id" title="tactic">eauto</span> ; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_phys_corresponds_mem_PC"><span class="id" title="axiom">state_phys_corresponds_mem_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <span class="id" title="var">lw</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "[%] Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_corresponds_reg"><span class="id" title="axiom">state_phys_corresponds_reg</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> <span class="id" title="var">HLinv</span>) .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_corresponds_mem"><span class="id" title="axiom">state_phys_corresponds_mem</span></a> <span class="id" title="var">lw</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">pc_a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">pc_v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> <span class="id" title="var">HLinv</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_addr"><span class="id" title="axiom">state_corresponds_cap_cur_addr</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HLinv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hregs_pc</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.machine_base.html#isCorrectPC_withinBounds"><span class="id" title="axiom">isCorrectPC_withinBounds</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcorrpc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#exec"><span class="id" title="definition">exec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#exec_opt"><span class="id" title="definition">exec_opt</span></a> <span class="id" title="var">instr</span> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="var">reg</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <span class="id" title="var">mem</span>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <span class="id" title="var">etable</span>; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <span class="id" title="var">enumcur</span> |});<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_opt_updatePC&nbsp;{φ&nbsp;Φs&nbsp;Φf&nbsp;w&nbsp;E}:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;reg&nbsp;φ&nbsp;!!&nbsp;PC&nbsp;=&nbsp;Some&nbsp;w&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;a',&nbsp;⌜&nbsp;w&nbsp;=&nbsp;WCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;⌝&nbsp;-∗&nbsp;⌜&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(⌜&nbsp;incrementPC&nbsp;(reg&nbsp;φ)&nbsp;=&nbsp;None&nbsp;⌝&nbsp;-∗&nbsp;Φf)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⊢&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;|={E}=&gt;&nbsp;wp_opt&nbsp;(updatePC&nbsp;φ)&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;updatePC,&nbsp;incrementPC.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(-&gt;)&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;w&nbsp;eqn:Heqw;&nbsp;iFrame;&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;destruct&nbsp;sb&nbsp;eqn:Heqsb;&nbsp;iFrame;&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;destruct&nbsp;(f1&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{rewrite&nbsp;bi.and_elim_l.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;}&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_phys_log_corresponds_update_reg" class="idref" href="#state_phys_log_corresponds_update_reg"><span class="id" title="lemma">state_phys_log_corresponds_update_reg</span></a> {<a id="reg:771" class="idref" href="#reg:771"><span class="id" title="binder">reg</span></a> <a id="mem:772" class="idref" href="#mem:772"><span class="id" title="binder">mem</span></a> <a id="lr:773" class="idref" href="#lr:773"><span class="id" title="binder">lr</span></a> <a id="lm:774" class="idref" href="#lm:774"><span class="id" title="binder">lm</span></a> <a id="cur_map:775" class="idref" href="#cur_map:775"><span class="id" title="binder">cur_map</span></a> <a id="i:776" class="idref" href="#i:776"><span class="id" title="binder">i</span></a> <a id="w:777" class="idref" href="#w:777"><span class="id" title="binder">w</span></a> <a id="lw:778" class="idref" href="#lw:778"><span class="id" title="binder">lw</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:778"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:777"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:778"><span class="id" title="variable">lw</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:775"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg:771"><span class="id" title="variable">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#mem:772"><span class="id" title="variable">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:773"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:774"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:775"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#i:776"><span class="id" title="variable">i</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:777"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">reg</span>) <a class="idref" href="cap_machine.rules.rules_base.html#mem:772"><span class="id" title="variable">mem</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#i:776"><span class="id" title="variable">i</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:778"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:774"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:775"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hlw</span> <span class="id" title="var">Hcw</span> ((<span class="id" title="var">HLreg</span> &amp; <span class="id" title="var">HLcurreg</span>) &amp; <span class="id" title="var">HLmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.logical_mapsto.html#lreg_strip"><span class="id" title="definition">lreg_strip</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fmap_insert</span> <span class="id" title="var">HLreg</span> <span class="id" title="var">Hlw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">map_Forall_insert_2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_insert_dec" class="idref" href="#lookup_insert_dec"><span class="id" title="lemma">lookup_insert_dec</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">forall</span> <span class="id" title="notation">{</span><a id="K:779" class="idref" href="#K:779"><span class="id" title="binder">K</span></a> : <span class="id" title="keyword">Type</span>} {<a id="M:780" class="idref" href="#M:780"><span class="id" title="binder">M</span></a> : <span class="id" title="notation">forall</span> <span class="id" title="var">_</span> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="keyword">Type</span>} {<a id="H:781" class="idref" href="#H:781"><span class="id" title="binder">H</span></a> : <span class="id" title="class">FMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:780"><span class="id" title="variable">M</span></a>} {<a id="H0:783" class="idref" href="#H0:783"><span class="id" title="binder">H0</span></a> : <span class="id" title="notation">forall</span> <a id="A:782" class="idref" href="#A:782"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">Lookup</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:779"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:782"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:780"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:782"><span class="id" title="variable">A</span></a>)}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H1:785" class="idref" href="#H1:785"><span class="id" title="binder">H1</span></a> : <span class="id" title="notation">forall</span> <a id="A:784" class="idref" href="#A:784"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">Empty</span> (<a class="idref" href="cap_machine.rules.rules_base.html#M:780"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:784"><span class="id" title="variable">A</span></a>)} {<a id="H2:787" class="idref" href="#H2:787"><span class="id" title="binder">H2</span></a> : <span class="id" title="notation">forall</span> <a id="A:786" class="idref" href="#A:786"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">PartialAlter</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:779"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:786"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:780"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:786"><span class="id" title="variable">A</span></a>)} {<a id="H3:788" class="idref" href="#H3:788"><span class="id" title="binder">H3</span></a> : <span class="id" title="class">OMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:780"><span class="id" title="variable">M</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H4:789" class="idref" href="#H4:789"><span class="id" title="binder">H4</span></a> : <span class="id" title="class">Merge</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:780"><span class="id" title="variable">M</span></a>} {<a id="H5:791" class="idref" href="#H5:791"><span class="id" title="binder">H5</span></a> : <span class="id" title="notation">forall</span> <a id="A:790" class="idref" href="#A:790"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">MapFold</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:779"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:790"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:780"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:790"><span class="id" title="variable">A</span></a>)} {<a id="EqDecision0:792" class="idref" href="#EqDecision0:792"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="class">RelDecision</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">_</span> : <span class="id" title="class">FinMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:779"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#M:780"><span class="id" title="variable">M</span></a>} {<a id="A:793" class="idref" href="#A:793"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>} {<a id="m:794" class="idref" href="#m:794"><span class="id" title="binder">m</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#M:780"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:793"><span class="id" title="variable">A</span></a>} {<a id="i:795" class="idref" href="#i:795"><span class="id" title="binder">i</span></a> <a id="j:796" class="idref" href="#j:796"><span class="id" title="binder">j</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#K:779"><span class="id" title="variable">K</span></a>} {<a id="x:797" class="idref" href="#x:797"><span class="id" title="binder">x</span></a> <a id="y:798" class="idref" href="#y:798"><span class="id" title="binder">y</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:793"><span class="id" title="variable">A</span></a><span class="id" title="notation">},</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#m:794"><span class="id" title="variable">m</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#j:796"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:798"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#i:795"><span class="id" title="variable">i</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#x:797"><span class="id" title="variable">x</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">m</span><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#j:796"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">(</span></a><span class="id" title="definition">bool_decide</span> (<a class="idref" href="cap_machine.rules.rules_base.html#i:795"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#j:796"><span class="id" title="variable">j</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:797"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:798"><span class="id" title="variable">y</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="lemma">bool_decide_reflect</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">j</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">subst</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_corr" class="idref" href="#state_interp_transient_corr"><span class="id" title="lemma">state_interp_transient_corr</span></a> {<a id="45f292d16bde59baf2f26a84cb75b820" class="idref" href="#45f292d16bde59baf2f26a84cb75b820"><span class="id" title="binder">φ</span></a> <a id="c1fb3d628346fdcb31f89434b41ebf5b" class="idref" href="#c1fb3d628346fdcb31f89434b41ebf5b"><span class="id" title="binder">φ</span></a><a id="c1fb3d628346fdcb31f89434b41ebf5b" class="idref" href="#c1fb3d628346fdcb31f89434b41ebf5b"><span class="id" title="binder">t</span></a> <a id="lr:801" class="idref" href="#lr:801"><span class="id" title="binder">lr</span></a> <a id="lrt:802" class="idref" href="#lrt:802"><span class="id" title="binder">lrt</span></a> <a id="lm:803" class="idref" href="#lm:803"><span class="id" title="binder">lm</span></a> <a id="lmt:804" class="idref" href="#lmt:804"><span class="id" title="binder">lmt</span></a> <a id="df:805" class="idref" href="#df:805"><span class="id" title="binder">df</span></a> <a id="dft:806" class="idref" href="#dft:806"><span class="id" title="binder">dft</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#45f292d16bde59baf2f26a84cb75b820"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c1fb3d628346fdcb31f89434b41ebf5b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#c1fb3d628346fdcb31f89434b41ebf5b"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:801"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:802"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:803"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:804"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:805"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:806"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="lreg_t:807" class="idref" href="#lreg_t:807"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:808" class="idref" href="#lmem_t:808"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:809" class="idref" href="#cur_map:809"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:802"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:807"><span class="id" title="variable">lreg_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:804"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:808"><span class="id" title="variable">lmem_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c1fb3d628346fdcb31f89434b41ebf5b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#c1fb3d628346fdcb31f89434b41ebf5b"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#c1fb3d628346fdcb31f89434b41ebf5b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#c1fb3d628346fdcb31f89434b41ebf5b"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:807"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:808"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:809"><span class="id" title="variable">cur_map</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "(Hσ &amp; Hregs &amp; Hmem &amp; %Hres &amp; Hcommit)".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_reg_lookup&nbsp;lrt&nbsp;{r&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;Φs&nbsp;Φf}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(lrt&nbsp;!!&nbsp;r)&nbsp;False&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;lwr&nbsp;=&gt;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;-∗&nbsp;Φs&nbsp;(lword_get_word&nbsp;lwr)))&nbsp;⊢&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(reg&nbsp;φt&nbsp;!!&nbsp;r)&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;"(Hσr&nbsp;&amp;&nbsp;Hk)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iPoseProof&nbsp;(state_interp_regs_transient_corr&nbsp;with&nbsp;"Hσr")&nbsp;as&nbsp;"*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(lrt&nbsp;!!&nbsp;r)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">lwr</span>|</span>&nbsp;eqn:Heqr&nbsp;;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;map_subseteq_spec&nbsp;in&nbsp;Hregs_incl.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;erewrite&nbsp;Hregs_incl.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;iApply&nbsp;"Hk".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;rewrite&nbsp;lookup_fmap&nbsp;Heqr.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup" class="idref" href="#wp2_reg_lookup"><span class="id" title="lemma">wp2_reg_lookup</span></a> {<a id="Ep:810" class="idref" href="#Ep:810"><span class="id" title="binder">Ep</span></a>} {<a id="lrt:811" class="idref" href="#lrt:811"><span class="id" title="binder">lrt</span></a> <a id="lmt:812" class="idref" href="#lmt:812"><span class="id" title="binder">lmt</span></a> <a id="dft:813" class="idref" href="#dft:813"><span class="id" title="binder">dft</span></a> <a id="r:814" class="idref" href="#r:814"><span class="id" title="binder">r</span></a> <a id="c72b6fa711589a5ffe9b5ff50a70b6a5" class="idref" href="#c72b6fa711589a5ffe9b5ff50a70b6a5"><span class="id" title="binder">φ</span></a> <a id="fedafef7ed2674745a0c6f714d78658f" class="idref" href="#fedafef7ed2674745a0c6f714d78658f"><span class="id" title="binder">φ</span></a><a id="fedafef7ed2674745a0c6f714d78658f" class="idref" href="#fedafef7ed2674745a0c6f714d78658f"><span class="id" title="binder">t</span></a> <a id="lr:817" class="idref" href="#lr:817"><span class="id" title="binder">lr</span></a> <a id="lm:818" class="idref" href="#lm:818"><span class="id" title="binder">lm</span></a> <a id="df:819" class="idref" href="#df:819"><span class="id" title="binder">df</span></a> <a id="814ff492948714047076838927db0304" class="idref" href="#814ff492948714047076838927db0304"><span class="id" title="binder">Φs</span></a> <a id="d02bf5cb39150a2af3642f34602787bb" class="idref" href="#d02bf5cb39150a2af3642f34602787bb"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:814"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:811"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c72b6fa711589a5ffe9b5ff50a70b6a5"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fedafef7ed2674745a0c6f714d78658f"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#fedafef7ed2674745a0c6f714d78658f"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:817"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:811"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:818"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:812"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:819"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:813"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lwr:822" class="idref" href="#lwr:822"><span class="id" title="binder">lwr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c72b6fa711589a5ffe9b5ff50a70b6a5"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fedafef7ed2674745a0c6f714d78658f"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#fedafef7ed2674745a0c6f714d78658f"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:817"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:811"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:818"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:812"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:819"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:813"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#814ff492948714047076838927db0304"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwr:822"><span class="id" title="variable">lwr</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwr:822"><span class="id" title="variable">lwr</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:810"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#lrt:811"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:814"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fedafef7ed2674745a0c6f714d78658f"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#fedafef7ed2674745a0c6f714d78658f"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:814"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#d02bf5cb39150a2af3642f34602787bb"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#814ff492948714047076838927db0304"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient_corr"><span class="id" title="axiom">state_interp_transient_corr</span></a> <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%HInv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HInv</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lregs_t</span> &amp; <span class="id" title="var">lmem_t</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hregs_incl</span> &amp; <span class="id" title="var">Hmem_incl</span> &amp; <span class="id" title="var">HInv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="method">elem_of_dom</span> <span class="id" title="var">lrt</span> <span class="id" title="var">r</span>) <span class="id" title="var">Hdom</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">lrw</span> &amp; <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_subseteq_spec</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hregs_incl</span> <span class="id" title="var">r</span> <span class="id" title="var">lrw</span> <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_reg_get_word"><span class="id" title="axiom">state_phys_log_reg_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hregs_incl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">Hregs_incl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_word_of_argument&nbsp;{src&nbsp;lw&nbsp;Φf&nbsp;Φs&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;regs_of_argument&nbsp;src&nbsp;⊆&nbsp;dom&nbsp;lrt&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(word_of_argumentL&nbsp;lrt&nbsp;src)&nbsp;False&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;lw&nbsp;=&gt;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;-∗&nbsp;Φs&nbsp;(lword_get_word&nbsp;lw))&nbsp;⊢&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(word_of_argument&nbsp;(reg&nbsp;φt)&nbsp;src)&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(Hdom)&nbsp;"(Hσr&nbsp;&amp;&nbsp;HΦs)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;src&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">z</span>|<span class="id" title="var">r</span></span>;&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;iApply&nbsp;("HΦs"&nbsp;with&nbsp;"Hσr").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;iApply&nbsp;(wp_reg_lookup&nbsp;lrt&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">H</span>σ<span class="id" title="var">r</span></span> <span class="inlinecode">$<span class="id" title="var">HΦs</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_word_of_argument" class="idref" href="#wp2_word_of_argument"><span class="id" title="lemma">wp2_word_of_argument</span></a> {<a id="Ep:823" class="idref" href="#Ep:823"><span class="id" title="binder">Ep</span></a>} {<a id="src:824" class="idref" href="#src:824"><span class="id" title="binder">src</span></a> <a id="lw:825" class="idref" href="#lw:825"><span class="id" title="binder">lw</span></a> <a id="b32a938a04b59d362ff827ba6faa6fdc" class="idref" href="#b32a938a04b59d362ff827ba6faa6fdc"><span class="id" title="binder">Φf</span></a> <a id="06c3560504d912c583bd20dcf8634e93" class="idref" href="#06c3560504d912c583bd20dcf8634e93"><span class="id" title="binder">Φs</span></a> <a id="8e15e3b9406bf5f56ecec0fee0edad4a" class="idref" href="#8e15e3b9406bf5f56ecec0fee0edad4a"><span class="id" title="binder">φ</span></a> <a id="51b0f85e60f6c4c9ddb7b6a14001bdb5" class="idref" href="#51b0f85e60f6c4c9ddb7b6a14001bdb5"><span class="id" title="binder">φ</span></a><a id="51b0f85e60f6c4c9ddb7b6a14001bdb5" class="idref" href="#51b0f85e60f6c4c9ddb7b6a14001bdb5"><span class="id" title="binder">t</span></a> <a id="lr:830" class="idref" href="#lr:830"><span class="id" title="binder">lr</span></a> <a id="lrt:831" class="idref" href="#lrt:831"><span class="id" title="binder">lrt</span></a> <a id="lm:832" class="idref" href="#lm:832"><span class="id" title="binder">lm</span></a> <a id="lmt:833" class="idref" href="#lmt:833"><span class="id" title="binder">lmt</span></a> <a id="df:834" class="idref" href="#df:834"><span class="id" title="binder">df</span></a> <a id="dft:835" class="idref" href="#dft:835"><span class="id" title="binder">dft</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:824"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:831"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8e15e3b9406bf5f56ecec0fee0edad4a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#51b0f85e60f6c4c9ddb7b6a14001bdb5"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#51b0f85e60f6c4c9ddb7b6a14001bdb5"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:830"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:831"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:832"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:833"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:834"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:835"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lw:836" class="idref" href="#lw:836"><span class="id" title="binder">lw</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8e15e3b9406bf5f56ecec0fee0edad4a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#51b0f85e60f6c4c9ddb7b6a14001bdb5"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#51b0f85e60f6c4c9ddb7b6a14001bdb5"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:830"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:831"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:832"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:833"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:834"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:835"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#06c3560504d912c583bd20dcf8634e93"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:836"><span class="id" title="variable">lw</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:836"><span class="id" title="variable">lw</span></a>)<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:823"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:831"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:824"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#word_of_argument"><span class="id" title="definition">word_of_argument</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#51b0f85e60f6c4c9ddb7b6a14001bdb5"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#51b0f85e60f6c4c9ddb7b6a14001bdb5"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:824"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#b32a938a04b59d362ff827ba6faa6fdc"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#06c3560504d912c583bd20dcf8634e93"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσr &amp; HΦs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span>|<span class="id" title="var">r</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"HΦs" <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hσr $HΦs]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_z_of_argument" class="idref" href="#wp2_z_of_argument"><span class="id" title="lemma">wp2_z_of_argument</span></a> {<a id="Ep:837" class="idref" href="#Ep:837"><span class="id" title="binder">Ep</span></a>} {<a id="src:838" class="idref" href="#src:838"><span class="id" title="binder">src</span></a> <a id="ce83c2659bb15897016cfdac473cbd2d" class="idref" href="#ce83c2659bb15897016cfdac473cbd2d"><span class="id" title="binder">Φf</span></a> <a id="8807739b0e7409b027851ff145f0dffb" class="idref" href="#8807739b0e7409b027851ff145f0dffb"><span class="id" title="binder">Φs</span></a> <a id="a0881b830a8da9e42d938ae296e98c0b" class="idref" href="#a0881b830a8da9e42d938ae296e98c0b"><span class="id" title="binder">φ</span></a> <a id="8386074204ed99348db2e593422628a9" class="idref" href="#8386074204ed99348db2e593422628a9"><span class="id" title="binder">φ</span></a><a id="8386074204ed99348db2e593422628a9" class="idref" href="#8386074204ed99348db2e593422628a9"><span class="id" title="binder">t</span></a> <a id="lr:843" class="idref" href="#lr:843"><span class="id" title="binder">lr</span></a> <a id="lrt:844" class="idref" href="#lrt:844"><span class="id" title="binder">lrt</span></a> <a id="lm:845" class="idref" href="#lm:845"><span class="id" title="binder">lm</span></a> <a id="lmt:846" class="idref" href="#lmt:846"><span class="id" title="binder">lmt</span></a> <a id="df:847" class="idref" href="#df:847"><span class="id" title="binder">df</span></a> <a id="dft:848" class="idref" href="#dft:848"><span class="id" title="binder">dft</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:838"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:844"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0881b830a8da9e42d938ae296e98c0b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:843"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:844"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:845"><span class="id" title="variable">lm</span></a>  <a class="idref" href="cap_machine.rules.rules_base.html#lmt:846"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:847"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:848"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="z:849" class="idref" href="#z:849"><span class="id" title="binder">z</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0881b830a8da9e42d938ae296e98c0b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:843"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:844"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:845"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:846"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:847"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:848"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#8807739b0e7409b027851ff145f0dffb"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:849"><span class="id" title="variable">z</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:849"><span class="id" title="variable">z</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:837"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#z_of_argumentL"><span class="id" title="definition">z_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:844"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:838"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#z_of_argument"><span class="id" title="definition">z_of_argument</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:838"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#ce83c2659bb15897016cfdac473cbd2d"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8807739b0e7409b027851ff145f0dffb"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_regs_mod" class="idref" href="#update_state_interp_from_regs_mod"><span class="id" title="lemma">update_state_interp_from_regs_mod</span></a> {<a id="7e9fb66b5f970f404425b90a501b7d02" class="idref" href="#7e9fb66b5f970f404425b90a501b7d02"><span class="id" title="binder">σ</span></a> <a id="dst:851" class="idref" href="#dst:851"><span class="id" title="binder">dst</span></a> <a id="lw2:852" class="idref" href="#lw2:852"><span class="id" title="binder">lw2</span></a> <a id="Ep:853" class="idref" href="#Ep:853"><span class="id" title="binder">Ep</span></a> <a id="lregs:854" class="idref" href="#lregs:854"><span class="id" title="binder">lregs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:851"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:854"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:855" class="idref" href="#cur_map:855"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:854"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:855"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:852"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:855"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7e9fb66b5f970f404425b90a501b7d02"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:856" class="idref" href="#k:856"><span class="id" title="binder"><span id="k:857" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:858" class="idref" href="#y:858"><span class="id" title="binder"><span id="y:859" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:854"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:856"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:858"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:853"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7e9fb66b5f970f404425b90a501b7d02"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:851"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:852"><span class="id" title="variable">lw2</span></a>)) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:860" class="idref" href="#k:860"><span class="id" title="binder"><span id="k:861" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:862" class="idref" href="#y:862"><span class="id" title="binder"><span id="y:863" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:851"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:852"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:860"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:862"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdst</span> <span class="id" title="var">Hcur</span>) "(Hσ &amp; Hregs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dst</span> <span class="id" title="var">lw2</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">cur_map</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">Hcur</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="var">Hregs_incl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> <span class="id" title="var">HLinv</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_regs_mod" class="idref" href="#update_state_interp_transient_from_regs_mod"><span class="id" title="lemma">update_state_interp_transient_from_regs_mod</span></a> {<a id="68237d4c27e9571ec65bd4dc3d78b99d" class="idref" href="#68237d4c27e9571ec65bd4dc3d78b99d"><span class="id" title="binder">σ</span></a> <a id="85ed24c983767d48c35cb605b5c4dde0" class="idref" href="#85ed24c983767d48c35cb605b5c4dde0"><span class="id" title="binder">σ</span></a><a id="85ed24c983767d48c35cb605b5c4dde0" class="idref" href="#85ed24c983767d48c35cb605b5c4dde0"><span class="id" title="binder">t</span></a> <a id="lr:866" class="idref" href="#lr:866"><span class="id" title="binder">lr</span></a> <a id="lrt:867" class="idref" href="#lrt:867"><span class="id" title="binder">lrt</span></a> <a id="lm:868" class="idref" href="#lm:868"><span class="id" title="binder">lm</span></a> <a id="lmt:869" class="idref" href="#lmt:869"><span class="id" title="binder">lmt</span></a> <a id="df:870" class="idref" href="#df:870"><span class="id" title="binder">df</span></a> <a id="dft:871" class="idref" href="#dft:871"><span class="id" title="binder">dft</span></a> <a id="dst:872" class="idref" href="#dst:872"><span class="id" title="binder">dst</span></a> <a id="lw2:873" class="idref" href="#lw2:873"><span class="id" title="binder">lw2</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:872"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:867"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:874" class="idref" href="#cur_map:874"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:867"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:874"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:873"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:874"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#68237d4c27e9571ec65bd4dc3d78b99d"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#85ed24c983767d48c35cb605b5c4dde0"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#85ed24c983767d48c35cb605b5c4dde0"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:866"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:867"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:868"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:869"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:870"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:871"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#68237d4c27e9571ec65bd4dc3d78b99d"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#85ed24c983767d48c35cb605b5c4dde0"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#85ed24c983767d48c35cb605b5c4dde0"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:872"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:873"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:866"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:872"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:873"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:868"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:869"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:870"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:871"><span class="id" title="variable">dft</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hcur</span>) "(Hσ &amp; Hregs &amp; Hmem &amp; %Hcor &amp; %Hdom_eq &amp; Hcommit)"; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span> "Hσ Hregs Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iPureIntro</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> &amp; <span class="id" title="var">lm'</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlrt_incl</span> &amp; <span class="id" title="var">Hlmt_incl</span> &amp; <span class="id" title="var">Hinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">dst</span><span class="id" title="notation">:=</span><span class="id" title="var">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr'</span>), <span class="id" title="var">lm'</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">insert_mono</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <span class="id" title="var">lr'</span> <span class="id" title="var">cur_map</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hcur_lr'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">_</span> <span class="id" title="var">Hcur'</span>] <span class="id" title="var">_</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lr'</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hcur</span> <span class="id" title="var">cur_map</span> <span class="id" title="var">Hcur_lr'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hregs</span> ?] ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lreg_insert_respects_corresponds"><span class="id" title="axiom">lreg_insert_respects_corresponds</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iSplit</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Ep</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcommit" <span class="id" title="notation">with</span> "H"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hcur</span> <span class="id" title="notation">with</span> "[$Hσ $Hregs]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_reg_nomod" class="idref" href="#update_state_interp_from_reg_nomod"><span class="id" title="lemma">update_state_interp_from_reg_nomod</span></a> {<a id="539d16c8103868856900b87fbb41271c" class="idref" href="#539d16c8103868856900b87fbb41271c"><span class="id" title="binder">σ</span></a> <a id="src:876" class="idref" href="#src:876"><span class="id" title="binder">src</span></a> <a id="dst:877" class="idref" href="#dst:877"><span class="id" title="binder">dst</span></a> <a id="lw:878" class="idref" href="#lw:878"><span class="id" title="binder">lw</span></a> <a id="Ep:879" class="idref" href="#Ep:879"><span class="id" title="binder">Ep</span></a> <a id="regs:880" class="idref" href="#regs:880"><span class="id" title="binder">regs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:877"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:880"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:880"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#src:876"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:878"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#539d16c8103868856900b87fbb41271c"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:881" class="idref" href="#k:881"><span class="id" title="binder"><span id="k:882" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:883" class="idref" href="#y:883"><span class="id" title="binder"><span id="y:884" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:880"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:881"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:883"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:879"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#539d16c8103868856900b87fbb41271c"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:877"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:878"><span class="id" title="variable">lw</span></a>)) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:885" class="idref" href="#k:885"><span class="id" title="binder"><span id="k:886" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:887" class="idref" href="#y:887"><span class="id" title="binder"><span id="y:888" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:877"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw:878"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:885"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:887"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdst</span> <span class="id" title="var">Hsrc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a>; <span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_int" class="idref" href="#update_state_interp_int"><span class="id" title="lemma">update_state_interp_int</span></a> {<a id="3be25ef811ef373b6e2f86a97f2e4f70" class="idref" href="#3be25ef811ef373b6e2f86a97f2e4f70"><span class="id" title="binder">σ</span></a> <a id="dst:890" class="idref" href="#dst:890"><span class="id" title="binder">dst</span></a> <a id="z:891" class="idref" href="#z:891"><span class="id" title="binder">z</span></a> <a id="Ep:892" class="idref" href="#Ep:892"><span class="id" title="binder">Ep</span></a> <a id="regs:893" class="idref" href="#regs:893"><span class="id" title="binder">regs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:890"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:893"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3be25ef811ef373b6e2f86a97f2e4f70"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:894" class="idref" href="#k:894"><span class="id" title="binder"><span id="k:895" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:896" class="idref" href="#y:896"><span class="id" title="binder"><span id="y:897" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:893"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:894"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:896"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:892"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3be25ef811ef373b6e2f86a97f2e4f70"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:890"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:891"><span class="id" title="variable">z</span></a>)) <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:898" class="idref" href="#k:898"><span class="id" title="binder"><span id="k:899" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:900" class="idref" href="#y:900"><span class="id" title="binder"><span id="y:901" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:890"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:891"><span class="id" title="variable">z</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:898"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:900"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <span class="id" title="var">z</span>)); <span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_int" class="idref" href="#update_state_interp_transient_int"><span class="id" title="lemma">update_state_interp_transient_int</span></a> {<a id="08add335f015334ac052281d37b5ee72" class="idref" href="#08add335f015334ac052281d37b5ee72"><span class="id" title="binder">σ</span></a> <a id="0b5e1f1f02e22000924e89eabc92cadc" class="idref" href="#0b5e1f1f02e22000924e89eabc92cadc"><span class="id" title="binder">σ</span></a><a id="0b5e1f1f02e22000924e89eabc92cadc" class="idref" href="#0b5e1f1f02e22000924e89eabc92cadc"><span class="id" title="binder">t</span></a> <a id="lr:904" class="idref" href="#lr:904"><span class="id" title="binder">lr</span></a> <a id="lrt:905" class="idref" href="#lrt:905"><span class="id" title="binder">lrt</span></a> <a id="lm:906" class="idref" href="#lm:906"><span class="id" title="binder">lm</span></a> <a id="lmt:907" class="idref" href="#lmt:907"><span class="id" title="binder">lmt</span></a> <a id="df:908" class="idref" href="#df:908"><span class="id" title="binder">df</span></a> <a id="dft:909" class="idref" href="#dft:909"><span class="id" title="binder">dft</span></a> <a id="dst:910" class="idref" href="#dst:910"><span class="id" title="binder">dst</span></a> <a id="z:911" class="idref" href="#z:911"><span class="id" title="binder">z</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:910"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:905"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#08add335f015334ac052281d37b5ee72"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0b5e1f1f02e22000924e89eabc92cadc"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#0b5e1f1f02e22000924e89eabc92cadc"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:904"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:905"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:906"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:907"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:908"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:909"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#08add335f015334ac052281d37b5ee72"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0b5e1f1f02e22000924e89eabc92cadc"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#0b5e1f1f02e22000924e89eabc92cadc"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:910"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:911"><span class="id" title="variable">z</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:904"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:910"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:911"><span class="id" title="variable">z</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:906"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:907"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:908"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:909"><span class="id" title="variable">dft</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_transient_from_regs_mod"><span class="id" title="axiom">update_state_interp_transient_from_regs_mod</span></a> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <span class="id" title="var">z</span>) <span class="id" title="var">Hdom</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="word_of_argumentL_cur" class="idref" href="#word_of_argumentL_cur"><span class="id" title="lemma">word_of_argumentL_cur</span></a> {<a id="lregs:912" class="idref" href="#lregs:912"><span class="id" title="binder">lregs</span></a> <a id="src:913" class="idref" href="#src:913"><span class="id" title="binder">src</span></a> <a id="lw2:914" class="idref" href="#lw2:914"><span class="id" title="binder">lw2</span></a> <a id="cur_map:915" class="idref" href="#cur_map:915"><span class="id" title="binder">cur_map</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:912"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:913"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:914"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:912"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:915"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:914"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:915"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hreg</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span> <span class="id" title="var">Hreg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;updatePC_impl&nbsp;{φ}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;updatePC&nbsp;φ&nbsp;=&nbsp;(reg'&nbsp;←&nbsp;incrementPC&nbsp;(reg&nbsp;φ);&nbsp;Some&nbsp;(NextI&nbsp;,&nbsp;update_regs&nbsp;φ&nbsp;reg')).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;updatePC,&nbsp;incrementPC.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(reg&nbsp;φ&nbsp;!!&nbsp;PC);&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;w;&nbsp;try&nbsp;done.&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;sb;&nbsp;try&nbsp;done.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;now&nbsp;destruct&nbsp;(f1&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_opt_incrementPC&nbsp;{φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;Φs&nbsp;Φf}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;PC&nbsp;∈&nbsp;dom&nbsp;lrt&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(wp_opt&nbsp;(incrementLPC&nbsp;lrt)&nbsp;(∀&nbsp;φt'&nbsp;lrt',&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt'&nbsp;lr&nbsp;lrt'&nbsp;-∗&nbsp;Φf)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;lrt'&nbsp;=&gt;&nbsp;∀&nbsp;φt',&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt'&nbsp;lr&nbsp;lrt'&nbsp;-∗&nbsp;Φs&nbsp;(reg&nbsp;φt')))&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;⊢&nbsp;wp_opt&nbsp;(incrementPC&nbsp;(reg&nbsp;φt))&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(Hdom)&nbsp;"(Hφr&nbsp;&amp;&nbsp;Hk)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;wp_opt_bind.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;incrementLPC,&nbsp;incrementPC.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;change&nbsp;(wp_opt&nbsp;match&nbsp;lrt&nbsp;!!&nbsp;PC&nbsp;with&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;(LCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;v)&nbsp;=&gt;&nbsp;match&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;a'&nbsp;=&gt;&nbsp;Some&nbsp;(&lt;<span class="inlinecode"><span class="id" title="var">PC</span>:=<span class="id" title="var">LCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>&gt;&nbsp;lrt)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;?Φf&nbsp;?Φs)&nbsp;with&nbsp;(wp_opt&nbsp;((lrt&nbsp;!!&nbsp;PC)&nbsp;≫=&nbsp;(fun&nbsp;w&nbsp;=&gt;&nbsp;match&nbsp;w&nbsp;with&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(LCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;v)&nbsp;=&gt;&nbsp;match&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;a'&nbsp;=&gt;&nbsp;Some&nbsp;(&lt;<span class="inlinecode"><span class="id" title="var">PC</span>:=<span class="id" title="var">LCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>&gt;&nbsp;lrt)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end)&nbsp;)&nbsp;Φf&nbsp;Φs).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;&lt;-wp_opt_bind.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;((wp_reg_lookup&nbsp;lrt&nbsp;(r&nbsp;:=&nbsp;PC)&nbsp;(φt&nbsp;:=&nbsp;φt))&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">H</span>φ<span class="id" title="var">r</span></span> <span class="inlinecode"><span class="id" title="var">Hk</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;wp_opt_eqn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;wp_opt_is_Some;&nbsp;last&nbsp;by&nbsp;apply&nbsp;elem_of_dom.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;(wp_opt_mono&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">Hk</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(x)&nbsp;"Hk&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;x&nbsp;eqn:Heqx;&nbsp;try&nbsp;(now&nbsp;iApply&nbsp;"Hk");&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;sb;&nbsp;try&nbsp;(now&nbsp;iApply&nbsp;"Hk");&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(f1&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;("Hk"&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;(update_state_interp_transient_from_regs_mod&nbsp;Hdom&nbsp;with&nbsp;"Hφr").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;intros&nbsp;cur_map&nbsp;Hcurregs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;eapply&nbsp;is_cur_word_cap_change,&nbsp;(map_Forall_lookup_1&nbsp;_&nbsp;_&nbsp;_&nbsp;_&nbsp;Hcurregs).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_opt_incrementPC" class="idref" href="#wp2_opt_incrementPC"><span class="id" title="lemma">wp2_opt_incrementPC</span></a> {<a id="Ep:916" class="idref" href="#Ep:916"><span class="id" title="binder">Ep</span></a>} {<a id="ca7bcb19f05b39be317dd4a6666aacfc" class="idref" href="#ca7bcb19f05b39be317dd4a6666aacfc"><span class="id" title="binder">φ</span></a> <a id="53f184e8b917a6173eb94b47f468445b" class="idref" href="#53f184e8b917a6173eb94b47f468445b"><span class="id" title="binder">φ</span></a><a id="53f184e8b917a6173eb94b47f468445b" class="idref" href="#53f184e8b917a6173eb94b47f468445b"><span class="id" title="binder">t</span></a> <a id="lr:919" class="idref" href="#lr:919"><span class="id" title="binder">lr</span></a> <a id="lrt:920" class="idref" href="#lrt:920"><span class="id" title="binder">lrt</span></a> <a id="lm:921" class="idref" href="#lm:921"><span class="id" title="binder">lm</span></a> <a id="lmt:922" class="idref" href="#lmt:922"><span class="id" title="binder">lmt</span></a> <a id="df:923" class="idref" href="#df:923"><span class="id" title="binder">df</span></a> <a id="dft:924" class="idref" href="#dft:924"><span class="id" title="binder">dft</span></a> <a id="1953feb27f61d9c7b0660a0a026a15ee" class="idref" href="#1953feb27f61d9c7b0660a0a026a15ee"><span class="id" title="binder">Φs</span></a> <a id="5910ab829a821818992b4dcca1c6669a" class="idref" href="#5910ab829a821818992b4dcca1c6669a"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:920"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ca7bcb19f05b39be317dd4a6666aacfc"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#53f184e8b917a6173eb94b47f468445b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#53f184e8b917a6173eb94b47f468445b"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:919"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:920"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:921"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:922"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:923"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:924"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="c9838ced9ec82e186f4f58fb2dbf2d5b" class="idref" href="#c9838ced9ec82e186f4f58fb2dbf2d5b"><span class="id" title="binder">φ</span></a><a id="c9838ced9ec82e186f4f58fb2dbf2d5b" class="idref" href="#c9838ced9ec82e186f4f58fb2dbf2d5b"><span class="id" title="binder">t'</span></a> <a id="lrt':928" class="idref" href="#lrt':928"><span class="id" title="binder">lrt'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ca7bcb19f05b39be317dd4a6666aacfc"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c9838ced9ec82e186f4f58fb2dbf2d5b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#c9838ced9ec82e186f4f58fb2dbf2d5b"><span class="id" title="variable">t'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:919"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':928"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:921"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:922"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:923"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:924"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#5910ab829a821818992b4dcca1c6669a"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lrt':929" class="idref" href="#lrt':929"><span class="id" title="binder">lrt'</span></a> <a id="rs':930" class="idref" href="#rs':930"><span class="id" title="binder">rs'</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ca7bcb19f05b39be317dd4a6666aacfc"><span class="id" title="variable">φ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#53f184e8b917a6173eb94b47f468445b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#53f184e8b917a6173eb94b47f468445b"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rs':930"><span class="id" title="variable">rs'</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lr:919"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':929"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:921"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:922"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:923"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:924"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#1953feb27f61d9c7b0660a0a026a15ee"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':929"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rs':930"><span class="id" title="variable">rs'</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:916"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:920"><span class="id" title="variable">lrt</span></a>) (<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#53f184e8b917a6173eb94b47f468445b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#53f184e8b917a6173eb94b47f468445b"><span class="id" title="variable">t</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#5910ab829a821818992b4dcca1c6669a"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1953feb27f61d9c7b0660a0a026a15ee"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hφr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_eqn"><span class="id" title="axiom">wp_opt2_eqn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφr Hk]"<span class="id" title="notation">)</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφr %Heq1 %Heq2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"Hk" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <span class="id" title="var">_</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(</span><span class="id" title="notation">reg</span> <span class="id" title="notation">φ</span><span class="id" title="notation">t</span><span class="id" title="notation">)</span><span class="id" title="notation">))</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_transient_from_regs_mod"><span class="id" title="axiom">update_state_interp_transient_from_regs_mod</span></a> <span class="id" title="var">Hdom</span> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f2</span> <span class="id" title="var">v</span>) <span class="id" title="notation">with</span> "Hφr"<span class="id" title="notation">)</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cur_map</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word_cap_change"><span class="id" title="axiom">is_cur_word_cap_change</span></a>, (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules.rules_base.html#cap_lang_rules_opt"><span class="id" title="section">cap_lang_rules_opt</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
