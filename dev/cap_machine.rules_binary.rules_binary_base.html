<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">cap_machine.rules_binary.rules_binary_base</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">invariants</span> <span class="id" title="library">gen_heap</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">weakestpre</span> <span class="id" title="library">ectx_lifting</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">proofmode</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">frac</span> <span class="id" title="library">auth</span> <span class="id" title="library">gmap</span> <span class="id" title="library">excl</span> <span class="id" title="library">list</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.cap_lang.html#"><span class="id" title="library">cap_lang</span></a> <a class="idref" href="cap_machine.iris_extra.html#"><span class="id" title="library">iris_extra</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#"><span class="id" title="library">rules_base</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="specN" class="idref" href="#specN"><span class="id" title="definition">specN</span></a> := <span class="id" title="definition">nroot</span> <span class="id" title="notation">.@</span> "spec".<br/>

<br/>
<span class="comment">(*&nbsp;heap&nbsp;and&nbsp;register&nbsp;CMRA&nbsp;for&nbsp;the&nbsp;specification&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;These&nbsp;need&nbsp;to&nbsp;be&nbsp;notations&nbsp;rather&nbsp;than&nbsp;definitions,&nbsp;as&nbsp;it&nbsp;otherwise&nbsp;causes&nbsp;performance&nbsp;issues&nbsp;*)</span><br/>
<span class="id" title="keyword">Notation</span> <a id="memspecUR" class="idref" href="#memspecUR"><span class="id" title="abbreviation">memspecUR</span></a> :=<br/>
&nbsp;&nbsp;(<span class="id" title="definition">gmapUR</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> (<span class="id" title="definition">prodR</span> <span class="id" title="definition">fracR</span> (<span class="id" title="definition">agreeR</span> (<span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>)))).<br/>
<span class="id" title="keyword">Notation</span> <a id="regspecUR" class="idref" href="#regspecUR"><span class="id" title="abbreviation">regspecUR</span></a> :=<br/>
&nbsp;&nbsp;(<span class="id" title="definition">gmapUR</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> (<span class="id" title="definition">prodR</span> <span class="id" title="definition">fracR</span> (<span class="id" title="definition">agreeR</span> (<span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>)))).<br/>
<span class="id" title="keyword">Notation</span> <a id="memreg_specUR" class="idref" href="#memreg_specUR"><span class="id" title="abbreviation">memreg_specUR</span></a> := (<span class="id" title="definition">prodUR</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspecUR"><span class="id" title="abbreviation">regspecUR</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspecUR"><span class="id" title="abbreviation">memspecUR</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;CMRA&nbsp;for&nbsp;the&nbsp;specification&nbsp;*)</span><br/>
<span class="id" title="keyword">Notation</span> <a id="exprR" class="idref" href="#exprR"><span class="id" title="abbreviation">exprR</span></a> := (<span class="id" title="definition">exclR</span> (<span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">expr</span></a>)).<br/>
<span class="id" title="keyword">Notation</span> <a id="cfgUR" class="idref" href="#cfgUR"><span class="id" title="abbreviation">cfgUR</span></a> := (<span class="id" title="definition">prodUR</span> (<span class="id" title="definition">optionUR</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprR"><span class="id" title="abbreviation">exprR</span></a>) <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memreg_specUR"><span class="id" title="abbreviation">memreg_specUR</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="to_spec_map" class="idref" href="#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> {<a id="L:1" class="idref" href="#L:1"><span class="id" title="binder">L</span></a> <a id="V:2" class="idref" href="#V:2"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>} `{<a id="H:4" class="idref" href="#H:4"><span class="id" title="binder">Countable</span></a> <a id="H:4" class="idref" href="#H:4"><span class="id" title="binder">L</span></a>} : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#L:1"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#V:2"><span class="id" title="variable">V</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="definition">gmapUR</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#L:1"><span class="id" title="variable">L</span></a> (<span class="id" title="definition">prodR</span> <span class="id" title="definition">fracR</span> (<span class="id" title="definition">agreeR</span> (<span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#V:2"><span class="id" title="variable">V</span></a>))) :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">fmap</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="w:5" class="idref" href="#w:5"><span class="id" title="binder">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1%<span class="id" title="var">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="definition">to_agree</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:5"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;the&nbsp;CMRA&nbsp;for&nbsp;the&nbsp;specification&nbsp;side&nbsp;*)</span><br/>
<span class="id" title="keyword">Class</span> <a id="cfgSG" class="idref" href="#cfgSG"><span class="id" title="record">cfgSG</span></a> <a id="f525610baade8c1419220d275a93fff0" class="idref" href="#f525610baade8c1419220d275a93fff0"><span class="id" title="binder">Σ</span></a> := <span class="id" title="var">CFGSG</span> {<br/>
&nbsp;&nbsp;<a id="cfg_invG" class="idref" href="#cfg_invG"><span class="id" title="projection">cfg_invG</span></a> :: <span class="id" title="class">inG</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#f525610baade8c1419220d275a93fff0"><span class="id" title="variable">Σ</span></a> (<span class="id" title="definition">authR</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#cfgUR"><span class="id" title="abbreviation">cfgUR</span></a>);<br/>
&nbsp;&nbsp;<a id="cfg_name" class="idref" href="#cfg_name"><span class="id" title="projection">cfg_name</span></a> : <span class="id" title="definition">gname</span><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="to_spec_map" class="idref" href="#to_spec_map"><span class="id" title="section">to_spec_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="L:10" class="idref" href="#L:10"><span class="id" title="binder">L</span></a> <a id="V:11" class="idref" href="#V:11"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) `{<a id="H:13" class="idref" href="#H:13"><span class="id" title="binder">Countable</span></a> <a id="H:13" class="idref" href="#H:13"><span class="id" title="binder">L</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map.L"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map.V"><span class="id" title="variable">V</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_to_spec_map_None" class="idref" href="#lookup_to_spec_map_None"><span class="id" title="lemma">lookup_to_spec_map_None</span></a> <a id="90e77474618ba1a451407daf80040e41" class="idref" href="#90e77474618ba1a451407daf80040e41"><span class="id" title="binder">σ</span></a> <a id="l:15" class="idref" href="#l:15"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#90e77474618ba1a451407daf80040e41"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:15"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#90e77474618ba1a451407daf80040e41"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:15"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> <span class="id" title="method">lookup_fmap</span>=&gt; -&gt;. <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="to_spec_map_insert" class="idref" href="#to_spec_map_insert"><span class="id" title="lemma">to_spec_map_insert</span></a> <a id="l:16" class="idref" href="#l:16"><span class="id" title="binder">l</span></a> <a id="v:17" class="idref" href="#v:17"><span class="id" title="binder">v</span></a> <a id="afb2f45ff79aed8fbb6b6cf08ccf3841" class="idref" href="#afb2f45ff79aed8fbb6b6cf08ccf3841"><span class="id" title="binder">σ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:16"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:17"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:16"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1%<span class="id" title="var">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="definition">to_agree</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:17"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a><span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map.V"><span class="id" title="variable">V</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(</span><span class="id" title="notation">to_spec_map</span> <span class="id" title="notation">σ)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> <span class="id" title="lemma">fmap_insert</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="spec_map_singleton_included" class="idref" href="#spec_map_singleton_included"><span class="id" title="lemma">spec_map_singleton_included</span></a> <a id="a1f2f8c42645ef2cdf56abf4643509eb" class="idref" href="#a1f2f8c42645ef2cdf56abf4643509eb"><span class="id" title="binder">σ</span></a> <a id="l:20" class="idref" href="#l:20"><span class="id" title="binder">l</span></a> <a id="q:21" class="idref" href="#q:21"><span class="id" title="binder">q</span></a> <a id="v:22" class="idref" href="#v:22"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:20"><span class="id" title="variable">l</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:21"><span class="id" title="variable">q</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="definition">to_agree</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:22"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]}</span> <span class="id" title="notation">≼</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a1f2f8c42645ef2cdf56abf4643509eb"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a1f2f8c42645ef2cdf56abf4643509eb"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:20"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:22"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">singleton_included_l</span>=&gt; -[[<span class="id" title="var">q'</span> <span class="id" title="var">av</span>] []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> <span class="id" title="method">lookup_fmap</span> <span class="id" title="lemma">fmap_Some_equiv</span> =&gt; -[<span class="id" title="var">v'</span> [<span class="id" title="var">Hl</span> [/= -&gt; -&gt;]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">Some_pair_included_total_2</span> [<span class="id" title="var">_</span>] /<span class="id" title="lemma">to_agree_included</span> /<span class="id" title="lemma">leibniz_equiv_iff</span> -&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="section">to_spec_map</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="definitionsS" class="idref" href="#definitionsS"><span class="id" title="section">definitionsS</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:24" class="idref" href="#H:24"><span class="id" title="binder">cfgSG</span></a> <a id="3eadb2a0aeaeef49bd6cd27b7316c266" class="idref" href="#3eadb2a0aeaeef49bd6cd27b7316c266"><span class="id" title="binder"><span id="H:24" class="id">Σ</span></span></a>, <a id="H0:25" class="idref" href="#H0:25"><span class="id" title="binder">MachineParameters</span></a>, <a id="invGS0:26" class="idref" href="#invGS0:26"><span class="id" title="binder">invGS</span></a> <a id="invGS0:26" class="idref" href="#invGS0:26"><span class="id" title="binder">Σ</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="memspec_mapsto" class="idref" href="#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> (<a id="a:27" class="idref" href="#a:27"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>) (<a id="q:28" class="idref" href="#q:28"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span>) (<a id="w:29" class="idref" href="#w:29"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#8983bd3dd80ced97bdc81fa5a0081152"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">own</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#cfg_name"><span class="id" title="method">cfg_name</span></a> (<span class="id" title="notation">◯</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="definition">ε</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="notation">{[</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a:27"><span class="id" title="variable">a</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:28"><span class="id" title="variable">q</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="definition">to_agree</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:29"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">]}</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="regspec_mapsto" class="idref" href="#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> (<a id="r:30" class="idref" href="#r:30"><span class="id" title="binder">r</span></a> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="q:31" class="idref" href="#q:31"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span>) (<a id="w:32" class="idref" href="#w:32"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#8983bd3dd80ced97bdc81fa5a0081152"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">own</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#cfg_name"><span class="id" title="method">cfg_name</span></a> (<span class="id" title="notation">◯</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="definition">ε</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="notation">{[</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:30"><span class="id" title="variable">r</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:31"><span class="id" title="variable">q</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="definition">to_agree</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:32"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">]}</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="exprspec_mapsto" class="idref" href="#exprspec_mapsto"><span class="id" title="definition">exprspec_mapsto</span></a> (<a id="e:33" class="idref" href="#e:33"><span class="id" title="binder">e</span></a> : <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">expr</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#8983bd3dd80ced97bdc81fa5a0081152"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">own</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#cfg_name"><span class="id" title="method">cfg_name</span></a> (<span class="id" title="notation">◯</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="abbreviation">Excl'</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:33"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="definition">optionUR</span> (<span class="id" title="definition">exclR</span> (<span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">expr</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,(</span></a><span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;following&nbsp;invariant&nbsp;contains&nbsp;the&nbsp;authoritative&nbsp;view&nbsp;of&nbsp;specification&nbsp;state&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="spec_res" class="idref" href="#spec_res"><span class="id" title="definition">spec_res</span></a> (<a id="e:34" class="idref" href="#e:34"><span class="id" title="binder">e</span></a>: <span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">expr</span></a>) (<a id="8b3949d2de8620e054410c326ed1c9c8" class="idref" href="#8b3949d2de8620e054410c326ed1c9c8"><span class="id" title="binder">σ</span></a>: <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#8983bd3dd80ced97bdc81fa5a0081152"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">own</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#cfg_name"><span class="id" title="method">cfg_name</span></a> (<span class="id" title="notation">●</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="abbreviation">Excl'</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:34"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,(</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#8b3949d2de8620e054410c326ed1c9c8"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#8b3949d2de8620e054410c326ed1c9c8"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a>))%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="spec_inv" class="idref" href="#spec_inv"><span class="id" title="definition">spec_inv</span></a> (<a id="2c04bcc6220b58c543d0eb87cdab8bad" class="idref" href="#2c04bcc6220b58c543d0eb87cdab8bad"><span class="id" title="binder">ρ</span></a> : <span class="id" title="definition">cfg</span> <a class="idref" href="cap_machine.cap_lang.html#cap_lang"><span class="id" title="definition">cap_lang</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#8983bd3dd80ced97bdc81fa5a0081152"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">∃</span> <a id="e:37" class="idref" href="#e:37"><span class="id" title="binder">e</span></a> <a id="976ecaa1329e69582a26aa858b5e636c" class="idref" href="#976ecaa1329e69582a26aa858b5e636c"><span class="id" title="binder">σ</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:37"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#976ecaa1329e69582a26aa858b5e636c"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><span class="id" title="inductive">rtc</span> <span class="id" title="definition">erased_step</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#2c04bcc6220b58c543d0eb87cdab8bad"><span class="id" title="variable">ρ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:37"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#976ecaa1329e69582a26aa858b5e636c"><span class="id" title="variable">σ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="spec_ctx" class="idref" href="#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#8983bd3dd80ced97bdc81fa5a0081152"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">∃</span> <a id="25de8c06a6a550ad40455eab3a9cd572" class="idref" href="#25de8c06a6a550ad40455eab3a9cd572"><span class="id" title="binder">ρ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">inv</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#specN"><span class="id" title="definition">specN</span></a> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_inv"><span class="id" title="definition">spec_inv</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#25de8c06a6a550ad40455eab3a9cd572"><span class="id" title="variable">ρ</span></a>))%<span class="id" title="var">I</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="memspec_mapsto_timeless" class="idref" href="#memspec_mapsto_timeless"><span class="id" title="instance">memspec_mapsto_timeless</span></a> <a id="l:40" class="idref" href="#l:40"><span class="id" title="binder">l</span></a> <a id="q:41" class="idref" href="#q:41"><span class="id" title="binder">q</span></a> <a id="v:42" class="idref" href="#v:42"><span class="id" title="binder">v</span></a> : <span class="id" title="class">Timeless</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:40"><span class="id" title="variable">l</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:41"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:42"><span class="id" title="variable">v</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="regspec_mapsto_timeless" class="idref" href="#regspec_mapsto_timeless"><span class="id" title="instance">regspec_mapsto_timeless</span></a> <a id="l:43" class="idref" href="#l:43"><span class="id" title="binder">l</span></a> <a id="q:44" class="idref" href="#q:44"><span class="id" title="binder">q</span></a> <a id="v:45" class="idref" href="#v:45"><span class="id" title="binder">v</span></a> : <span class="id" title="class">Timeless</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:43"><span class="id" title="variable">l</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:44"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:45"><span class="id" title="variable">v</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="spec_ctx_persistent" class="idref" href="#spec_ctx_persistent"><span class="id" title="instance">spec_ctx_persistent</span></a> : <span class="id" title="class">Persistent</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="spec_heap_valid" class="idref" href="#spec_heap_valid"><span class="id" title="lemma">spec_heap_valid</span></a> <a id="e:46" class="idref" href="#e:46"><span class="id" title="binder">e</span></a> <a id="430eb15c7314e2ebbce013f4e023cc44" class="idref" href="#430eb15c7314e2ebbce013f4e023cc44"><span class="id" title="binder">σ</span></a> <a id="a:48" class="idref" href="#a:48"><span class="id" title="binder">a</span></a> <a id="q:49" class="idref" href="#q:49"><span class="id" title="binder">q</span></a> <a id="w:50" class="idref" href="#w:50"><span class="id" title="binder">w</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:46"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#430eb15c7314e2ebbce013f4e023cc44"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a:48"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:49"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:50"><span class="id" title="variable">w</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#430eb15c7314e2ebbce013f4e023cc44"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.2</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a:48"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:50"><span class="id" title="variable">w</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hown &amp; Ha)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid_2</span> <span class="id" title="notation">with</span> "Hown Ha"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> %[[<span class="id" title="var">_</span> [<span class="id" title="var">_</span> ?%<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_map_singleton_included"><span class="id" title="axiom">spec_map_singleton_included</span></a>]%<span class="id" title="lemma">prod_included</span>]%<span class="id" title="lemma">prod_included</span> <span class="id" title="var">_</span>]%<span class="id" title="lemma">auth_both_valid_discrete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="spec_regs_valid" class="idref" href="#spec_regs_valid"><span class="id" title="lemma">spec_regs_valid</span></a> <a id="e:51" class="idref" href="#e:51"><span class="id" title="binder">e</span></a> <a id="193018d7d3b117e3eea7635a6f1d98b6" class="idref" href="#193018d7d3b117e3eea7635a6f1d98b6"><span class="id" title="binder">σ</span></a> <a id="r:53" class="idref" href="#r:53"><span class="id" title="binder">r</span></a> <a id="q:54" class="idref" href="#q:54"><span class="id" title="binder">q</span></a> <a id="w:55" class="idref" href="#w:55"><span class="id" title="binder">w</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:51"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#193018d7d3b117e3eea7635a6f1d98b6"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:53"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:54"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:55"><span class="id" title="variable">w</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#193018d7d3b117e3eea7635a6f1d98b6"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.1</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:53"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:55"><span class="id" title="variable">w</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hown &amp; Ha)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid_2</span> <span class="id" title="notation">with</span> "Hown Ha"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> %[[<span class="id" title="var">_</span> [?%<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_map_singleton_included"><span class="id" title="axiom">spec_map_singleton_included</span></a> <span class="id" title="var">_</span>]%<span class="id" title="lemma">prod_included</span>]%<span class="id" title="lemma">prod_included</span> <span class="id" title="var">_</span>]%<span class="id" title="lemma">auth_both_valid_discrete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="spec_expr_valid" class="idref" href="#spec_expr_valid"><span class="id" title="lemma">spec_expr_valid</span></a> <a id="e:56" class="idref" href="#e:56"><span class="id" title="binder">e</span></a> <a id="e':57" class="idref" href="#e':57"><span class="id" title="binder">e'</span></a> <a id="4a70e451ab5af26934c040fea6e57d54" class="idref" href="#4a70e451ab5af26934c040fea6e57d54"><span class="id" title="binder">σ</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:56"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#4a70e451ab5af26934c040fea6e57d54"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprspec_mapsto"><span class="id" title="definition">exprspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e':57"><span class="id" title="variable">e'</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:56"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e':57"><span class="id" title="variable">e'</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hown &amp; Ha)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid_2</span> <span class="id" title="notation">with</span> "Hown Ha"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> %[[? <span class="id" title="var">_</span>]%<span class="id" title="lemma">prod_included</span> <span class="id" title="var">_</span>]%<span class="id" title="lemma">auth_both_valid_discrete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> <span class="id" title="notation">≡</span> <span class="id" title="var">e'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#symmetry"><span class="id" title="definition">symmetry</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Excl_included</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="definition">leibniz_equiv</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regspec_mapsto_agree" class="idref" href="#regspec_mapsto_agree"><span class="id" title="lemma">regspec_mapsto_agree</span></a> <a id="l:59" class="idref" href="#l:59"><span class="id" title="binder">l</span></a> <a id="q1:60" class="idref" href="#q1:60"><span class="id" title="binder">q1</span></a> <a id="q2:61" class="idref" href="#q2:61"><span class="id" title="binder">q2</span></a> <a id="v1:62" class="idref" href="#v1:62"><span class="id" title="binder">v1</span></a> <a id="v2:63" class="idref" href="#v2:63"><span class="id" title="binder">v2</span></a> : <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:59"><span class="id" title="variable">l</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q1:60"><span class="id" title="variable">q1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v1:62"><span class="id" title="variable">v1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:59"><span class="id" title="variable">l</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q2:61"><span class="id" title="variable">q2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v2:63"><span class="id" title="variable">v2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v1:62"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v2:63"><span class="id" title="variable">v2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2". <span class="id" title="var">iCombine</span> "Hr1 Hr2" <span class="id" title="keyword">as</span> "Hr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <span class="id" title="lemma">own_valid</span> !<span class="id" title="lemma">uPred.discrete_valid</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!<span class="id" title="lemma">auth_frag_valid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hr" <span class="id" title="keyword">as</span> %[<span class="id" title="var">_</span> [[<span class="id" title="var">_</span> <span class="id" title="var">Hr</span>]%<span class="id" title="lemma">singleton_valid</span> <span class="id" title="var">_</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span>. <span class="id" title="tactic">apply</span> @<span class="id" title="lemma">to_agree_op_inv_L</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regspec_mapsto_valid" class="idref" href="#regspec_mapsto_valid"><span class="id" title="lemma">regspec_mapsto_valid</span></a> <a id="r:64" class="idref" href="#r:64"><span class="id" title="binder">r</span></a> <a id="q:65" class="idref" href="#q:65"><span class="id" title="binder">q</span></a> <a id="v:66" class="idref" href="#v:66"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:64"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:65"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:66"><span class="id" title="variable">v</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">✓</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:65"><span class="id" title="variable">q</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <span class="id" title="lemma">own_valid</span> !<span class="id" title="lemma">uPred.discrete_valid</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!<span class="id" title="lemma">auth_frag_valid</span>. <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">_</span> [[? <span class="id" title="var">_</span>]%<span class="id" title="lemma">singleton_valid</span> <span class="id" title="var">_</span>]]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regspec_mapsto_valid_2" class="idref" href="#regspec_mapsto_valid_2"><span class="id" title="lemma">regspec_mapsto_valid_2</span></a> <a id="r:67" class="idref" href="#r:67"><span class="id" title="binder">r</span></a> <a id="q1:68" class="idref" href="#q1:68"><span class="id" title="binder">q1</span></a> <a id="q2:69" class="idref" href="#q2:69"><span class="id" title="binder">q2</span></a> <a id="v1:70" class="idref" href="#v1:70"><span class="id" title="binder">v1</span></a> <a id="v2:71" class="idref" href="#v2:71"><span class="id" title="binder">v2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:67"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q1:68"><span class="id" title="variable">q1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v1:70"><span class="id" title="variable">v1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:67"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q2:69"><span class="id" title="variable">q2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v2:71"><span class="id" title="variable">v2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">✓</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q1:68"><span class="id" title="variable">q1</span></a> <span class="id" title="notation">+</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q2:69"><span class="id" title="variable">q2</span></a>)%<span class="id" title="var">Qp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto_agree"><span class="id" title="axiom">regspec_mapsto_agree</span></a> <span class="id" title="notation">with</span> "Hr1 Hr2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "Hr1 Hr2" <span class="id" title="keyword">as</span> "Hr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto_valid"><span class="id" title="axiom">regspec_mapsto_valid</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regspec_mapsto_update" class="idref" href="#regspec_mapsto_update"><span class="id" title="lemma">regspec_mapsto_update</span></a> <a id="e:72" class="idref" href="#e:72"><span class="id" title="binder">e</span></a> (<a id="f42bfb3555370f7bd96de7b0c6e7b6db" class="idref" href="#f42bfb3555370f7bd96de7b0c6e7b6db"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) <a id="r:74" class="idref" href="#r:74"><span class="id" title="binder">r</span></a> (<a id="w:75" class="idref" href="#w:75"><span class="id" title="binder">w</span></a> <a id="w':76" class="idref" href="#w':76"><span class="id" title="binder">w'</span></a> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:72"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#f42bfb3555370f7bd96de7b0c6e7b6db"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:74"><span class="id" title="variable">r</span></a> 1 <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:75"><span class="id" title="variable">w</span></a> <span class="id" title="notation">==∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:72"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:74"><span class="id" title="variable">r</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w':76"><span class="id" title="variable">w'</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ.1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#f42bfb3555370f7bd96de7b0c6e7b6db"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:74"><span class="id" title="variable">r</span></a> 1 <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w':76"><span class="id" title="variable">w'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hσ Hr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_regs_valid"><span class="id" title="axiom">spec_regs_valid</span></a> <span class="id" title="notation">with</span> "[$Hσ $Hr]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_update_2</span> <span class="id" title="notation">with</span> "Hσ Hr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hσ Hr]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">auth_update</span>, <span class="id" title="lemma">prod_local_update_2</span>,<span class="id" title="lemma">prod_local_update_1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">singleton_local_update</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> σ<span class="id" title="notation">.1</span>) <span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1%<span class="id" title="var">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="definition">to_agree</span> <span class="id" title="var">w</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1%<span class="id" title="var">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="definition">to_agree</span> <span class="id" title="var">w'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="var">Hr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">exclusive_local_update</span>. <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span> "Hr". <span class="id" title="var">iFrame</span>. <span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">fmap_insert</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memspec_mapsto_agree" class="idref" href="#memspec_mapsto_agree"><span class="id" title="lemma">memspec_mapsto_agree</span></a> <a id="l:77" class="idref" href="#l:77"><span class="id" title="binder">l</span></a> <a id="q1:78" class="idref" href="#q1:78"><span class="id" title="binder">q1</span></a> <a id="q2:79" class="idref" href="#q2:79"><span class="id" title="binder">q2</span></a> <a id="v1:80" class="idref" href="#v1:80"><span class="id" title="binder">v1</span></a> <a id="v2:81" class="idref" href="#v2:81"><span class="id" title="binder">v2</span></a> : <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:77"><span class="id" title="variable">l</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q1:78"><span class="id" title="variable">q1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v1:80"><span class="id" title="variable">v1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:77"><span class="id" title="variable">l</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q2:79"><span class="id" title="variable">q2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v2:81"><span class="id" title="variable">v2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v1:80"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v2:81"><span class="id" title="variable">v2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2". <span class="id" title="var">iCombine</span> "Hr1 Hr2" <span class="id" title="keyword">as</span> "Hr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <span class="id" title="lemma">own_valid</span> !<span class="id" title="lemma">uPred.discrete_valid</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!<span class="id" title="lemma">auth_frag_valid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hr" <span class="id" title="keyword">as</span> %[<span class="id" title="var">_</span> [<span class="id" title="var">_</span> [<span class="id" title="var">_</span> <span class="id" title="var">Hr</span>]%<span class="id" title="lemma">singleton_valid</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span>. <span class="id" title="tactic">apply</span> @<span class="id" title="lemma">to_agree_op_inv_L</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memspec_mapsto_valid" class="idref" href="#memspec_mapsto_valid"><span class="id" title="lemma">memspec_mapsto_valid</span></a> <a id="r:82" class="idref" href="#r:82"><span class="id" title="binder">r</span></a> <a id="q:83" class="idref" href="#q:83"><span class="id" title="binder">q</span></a> <a id="v:84" class="idref" href="#v:84"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:82"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:83"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:84"><span class="id" title="variable">v</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">✓</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:83"><span class="id" title="variable">q</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <span class="id" title="lemma">own_valid</span> !<span class="id" title="lemma">uPred.discrete_valid</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!<span class="id" title="lemma">auth_frag_valid</span>. <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">_</span> [<span class="id" title="var">_</span> [? <span class="id" title="var">_</span>]%<span class="id" title="lemma">singleton_valid</span>]]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memspec_mapsto_valid_2" class="idref" href="#memspec_mapsto_valid_2"><span class="id" title="lemma">memspec_mapsto_valid_2</span></a> <a id="r:85" class="idref" href="#r:85"><span class="id" title="binder">r</span></a> <a id="q1:86" class="idref" href="#q1:86"><span class="id" title="binder">q1</span></a> <a id="q2:87" class="idref" href="#q2:87"><span class="id" title="binder">q2</span></a> <a id="v1:88" class="idref" href="#v1:88"><span class="id" title="binder">v1</span></a> <a id="v2:89" class="idref" href="#v2:89"><span class="id" title="binder">v2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:85"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q1:86"><span class="id" title="variable">q1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v1:88"><span class="id" title="variable">v1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:85"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q2:87"><span class="id" title="variable">q2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v2:89"><span class="id" title="variable">v2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">✓</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q1:86"><span class="id" title="variable">q1</span></a> <span class="id" title="notation">+</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q2:87"><span class="id" title="variable">q2</span></a>)%<span class="id" title="var">Qp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto_agree"><span class="id" title="axiom">memspec_mapsto_agree</span></a> <span class="id" title="notation">with</span> "Hr1 Hr2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "Hr1 Hr2" <span class="id" title="keyword">as</span> "Hr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto_valid"><span class="id" title="axiom">memspec_mapsto_valid</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memspec_mapsto_update" class="idref" href="#memspec_mapsto_update"><span class="id" title="lemma">memspec_mapsto_update</span></a> <a id="e:90" class="idref" href="#e:90"><span class="id" title="binder">e</span></a> (<a id="c45a719e878307ba3d2852fbe7434a9c" class="idref" href="#c45a719e878307ba3d2852fbe7434a9c"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) <a id="r:92" class="idref" href="#r:92"><span class="id" title="binder">r</span></a> (<a id="w:93" class="idref" href="#w:93"><span class="id" title="binder">w</span></a> <a id="w':94" class="idref" href="#w':94"><span class="id" title="binder">w'</span></a> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:90"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#c45a719e878307ba3d2852fbe7434a9c"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:92"><span class="id" title="variable">r</span></a> 1 <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:93"><span class="id" title="variable">w</span></a> <span class="id" title="notation">==∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:90"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#c45a719e878307ba3d2852fbe7434a9c"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:92"><span class="id" title="variable">r</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w':94"><span class="id" title="variable">w'</span></a><span class="id" title="notation">]&gt;σ.2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:92"><span class="id" title="variable">r</span></a> 1 <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w':94"><span class="id" title="variable">w'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hσ Hr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_heap_valid"><span class="id" title="axiom">spec_heap_valid</span></a> <span class="id" title="notation">with</span> "[$Hσ $Hr]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_update_2</span> <span class="id" title="notation">with</span> "Hσ Hr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hσ Hr]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">auth_update</span>, <span class="id" title="lemma">prod_local_update_2</span>,<span class="id" title="lemma">prod_local_update_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">singleton_local_update</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#to_spec_map"><span class="id" title="definition">to_spec_map</span></a> σ<span class="id" title="notation">.2</span>) <span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1%<span class="id" title="var">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="definition">to_agree</span> <span class="id" title="var">w</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1%<span class="id" title="var">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="definition">to_agree</span> <span class="id" title="var">w'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="var">Hr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">exclusive_local_update</span>. <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span> "Hr". <span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">fmap_insert</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="exprspec_mapsto_update" class="idref" href="#exprspec_mapsto_update"><span class="id" title="lemma">exprspec_mapsto_update</span></a> <a id="e:95" class="idref" href="#e:95"><span class="id" title="binder">e</span></a> <a id="a9bcc5764d17e174b3024cd55432ea32" class="idref" href="#a9bcc5764d17e174b3024cd55432ea32"><span class="id" title="binder">σ</span></a> <a id="e':97" class="idref" href="#e':97"><span class="id" title="binder">e'</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:95"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a9bcc5764d17e174b3024cd55432ea32"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprspec_mapsto"><span class="id" title="definition">exprspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:95"><span class="id" title="variable">e</span></a> <span class="id" title="notation">==∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e':97"><span class="id" title="variable">e'</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a9bcc5764d17e174b3024cd55432ea32"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprspec_mapsto"><span class="id" title="definition">exprspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e':97"><span class="id" title="variable">e'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hσ He".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprspec_mapsto"><span class="id" title="definition">exprspec_mapsto</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_update_2</span> <span class="id" title="notation">with</span> "Hσ He"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hσ He]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">auth_update</span>, <span class="id" title="lemma">prod_local_update_1</span>, (<span class="id" title="lemma">option_local_update</span> (<span class="id" title="var">A</span>:=<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprR"><span class="id" title="abbreviation">exprR</span></a>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="lemma">exclusive_local_update</span> (<span class="id" title="var">A</span>:=<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprR"><span class="id" title="abbreviation">exprR</span></a>) <span class="id" title="var">_</span> (<span class="id" title="constructor">Excl</span> <span class="id" title="var">e'</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#definitionsS"><span class="id" title="section">definitionsS</span></a>.<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Typeclasses</span> <span class="id" title="keyword">Opaque</span> <span class="id" title="var">memspec_mapsto</span> <span class="id" title="var">regspec_mapsto</span> <span class="id" title="var">exprspec_mapsto</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="251e4a8d7a8a934960f2d1025e95e982" class="idref" href="#251e4a8d7a8a934960f2d1025e95e982"><span class="id" title="notation">&quot;</span></a>a ↣ₐ{ q } v" := (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <span class="id" title="var">a</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20, <span class="id" title="var">q</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="var">format</span> "a  ↣ₐ{ q }  v") : <span class="id" title="var">bi_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a id="e2f4294cd5d6fe856f8983153f4c256a" class="idref" href="#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">&quot;</span></a>a ↣ₐ v" := (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <span class="id" title="var">a</span> 1 <span class="id" title="var">v</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20) : <span class="id" title="var">bi_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a id="00fcdef66f0cd6857156aee43a4f5920" class="idref" href="#00fcdef66f0cd6857156aee43a4f5920"><span class="id" title="notation">&quot;</span></a>r ↣ᵣ{ q } v" := (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <span class="id" title="var">r</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20, <span class="id" title="var">q</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="var">format</span> "r  ↣ᵣ{ q }  v") : <span class="id" title="var">bi_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a id="126fc705c29813fa06e80ede95664257" class="idref" href="#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">&quot;</span></a>r ↣ᵣ v" := (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <span class="id" title="var">r</span> 1 <span class="id" title="var">v</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20) : <span class="id" title="var">bi_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a id="39726a285d21e5558b05ca4123ecd5f5" class="idref" href="#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">&quot;</span></a>⤇ e" := (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprspec_mapsto"><span class="id" title="definition">exprspec_mapsto</span></a> <span class="id" title="var">e</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20) : <span class="id" title="var">bi_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iAsimpl</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> ?<span class="id" title="var">e</span>)%<span class="id" title="var">I</span> ] =&gt; <span class="id" title="tactic">progress</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e'</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">evar</span> (<span class="id" title="var">e'</span>:<a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">expr</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">e'</span>) <span class="id" title="keyword">as</span> -&gt;; [<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">e'</span>; <span class="id" title="tactic">reflexivity</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">e'</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">e'</span>)<br/>
&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="notation">WP</span> ?<span class="id" title="var">e</span> <span class="id" title="notation">@</span> <span class="id" title="var">_</span> <span class="id" title="notation">{{</span> <span class="id" title="var">_</span> <span class="id" title="notation">}}</span>%<span class="id" title="var">I</span> ] =&gt; <span class="id" title="tactic">progress</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e'</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">evar</span> (<span class="id" title="var">e'</span>:<a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">expr</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">e'</span>) <span class="id" title="keyword">as</span> -&gt;; [<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">e'</span>; <span class="id" title="tactic">reflexivity</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">e'</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">e'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_spec_resources" class="idref" href="#cap_lang_spec_resources"><span class="id" title="section">cap_lang_spec_resources</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:99" class="idref" href="#H:99"><span class="id" title="binder">cfgSG</span></a> <a id="d28bbe011225204c88b57a270b5a3987" class="idref" href="#d28bbe011225204c88b57a270b5a3987"><span class="id" title="binder"><span id="H:99" class="id">Σ</span></span></a>, <a id="H0:100" class="idref" href="#H0:100"><span class="id" title="binder">MachineParameters</span></a>, <a id="invGS0:101" class="idref" href="#invGS0:101"><span class="id" title="binder">invGS</span></a> <a id="invGS0:101" class="idref" href="#invGS0:101"><span class="id" title="binder">Σ</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;registers&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_dupl_false" class="idref" href="#regname_dupl_false"><span class="id" title="lemma">regname_dupl_false</span></a> <a id="r:102" class="idref" href="#r:102"><span class="id" title="binder">r</span></a> <a id="w1:103" class="idref" href="#w1:103"><span class="id" title="binder">w1</span></a> <a id="w2:104" class="idref" href="#w2:104"><span class="id" title="binder">w2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:102"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:103"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r:102"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w2:104"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto_valid_2"><span class="id" title="axiom">regspec_mapsto_valid_2</span></a> <span class="id" title="notation">with</span> "Hr1 Hr2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_neq" class="idref" href="#regname_neq"><span class="id" title="lemma">regname_neq</span></a> <a id="r1:105" class="idref" href="#r1:105"><span class="id" title="binder">r1</span></a> <a id="r2:106" class="idref" href="#r2:106"><span class="id" title="binder">r2</span></a> <a id="w1:107" class="idref" href="#w1:107"><span class="id" title="binder">w1</span></a> <a id="w2:108" class="idref" href="#w2:108"><span class="id" title="binder">w2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:105"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:107"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:106"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w2:108"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:105"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:106"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2" (?). <span class="id" title="tactic">subst</span> <span class="id" title="var">r1</span>. <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_dupl_false"><span class="id" title="axiom">regname_dupl_false</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_1" class="idref" href="#map_of_regs_1"><span class="id" title="lemma">map_of_regs_1</span></a> (<a id="r1:109" class="idref" href="#r1:109"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:110" class="idref" href="#w1:110"><span class="id" title="binder">w1</span></a>: <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:109"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:110"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:111" class="idref" href="#k:111"><span class="id" title="binder"><span id="k:112" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:113" class="idref" href="#y:113"><span class="id" title="binder"><span id="y:114" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:109"><span class="id" title="variable">r1</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:110"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]}</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:111"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:113"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_singleton</span> ; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_1" class="idref" href="#regs_of_map_1"><span class="id" title="lemma">regs_of_map_1</span></a> (<a id="r1:115" class="idref" href="#r1:115"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:116" class="idref" href="#w1:116"><span class="id" title="binder">w1</span></a>: <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:117" class="idref" href="#k:117"><span class="id" title="binder"><span id="k:118" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:119" class="idref" href="#y:119"><span class="id" title="binder"><span id="y:120" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:115"><span class="id" title="variable">r1</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:116"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]}</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:117"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:119"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:115"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:116"><span class="id" title="variable">w1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_singleton</span> ; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_2" class="idref" href="#map_of_regs_2"><span class="id" title="lemma">map_of_regs_2</span></a> (<a id="r1:121" class="idref" href="#r1:121"><span class="id" title="binder">r1</span></a> <a id="r2:122" class="idref" href="#r2:122"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:123" class="idref" href="#w1:123"><span class="id" title="binder">w1</span></a> <a id="w2:124" class="idref" href="#w2:124"><span class="id" title="binder">w2</span></a>: <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:121"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:123"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:122"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w2:124"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:125" class="idref" href="#k:125"><span class="id" title="binder"><span id="k:126" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:127" class="idref" href="#y:127"><span class="id" title="binder"><span id="y:128" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:121"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:123"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:125"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:127"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:121"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:122"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2". <span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_2" class="idref" href="#regs_of_map_2"><span class="id" title="lemma">regs_of_map_2</span></a> (<a id="r1:129" class="idref" href="#r1:129"><span class="id" title="binder">r1</span></a> <a id="r2:130" class="idref" href="#r2:130"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:131" class="idref" href="#w1:131"><span class="id" title="binder">w1</span></a> <a id="w2:132" class="idref" href="#w2:132"><span class="id" title="binder">w2</span></a>: <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:129"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:130"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:133" class="idref" href="#k:133"><span class="id" title="binder"><span id="k:134" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:135" class="idref" href="#y:135"><span class="id" title="binder"><span id="y:136" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:129"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:131"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:133"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:135"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:129"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:131"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:130"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w2:132"><span class="id" title="variable">w2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_3" class="idref" href="#map_of_regs_3"><span class="id" title="lemma">map_of_regs_3</span></a> (<a id="r1:137" class="idref" href="#r1:137"><span class="id" title="binder">r1</span></a> <a id="r2:138" class="idref" href="#r2:138"><span class="id" title="binder">r2</span></a> <a id="r3:139" class="idref" href="#r3:139"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:140" class="idref" href="#w1:140"><span class="id" title="binder">w1</span></a> <a id="w2:141" class="idref" href="#w2:141"><span class="id" title="binder">w2</span></a> <a id="w3:142" class="idref" href="#w3:142"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:137"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:140"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:138"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w2:141"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:139"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w3:142"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:143" class="idref" href="#k:143"><span class="id" title="binder"><span id="k:144" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:145" class="idref" href="#y:145"><span class="id" title="binder"><span id="y:146" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:137"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:140"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:143"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:145"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:137"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:138"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:137"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:139"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:138"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:139"><span class="id" title="variable">r3</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_3" class="idref" href="#regs_of_map_3"><span class="id" title="lemma">regs_of_map_3</span></a> (<a id="r1:147" class="idref" href="#r1:147"><span class="id" title="binder">r1</span></a> <a id="r2:148" class="idref" href="#r2:148"><span class="id" title="binder">r2</span></a> <a id="r3:149" class="idref" href="#r3:149"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:150" class="idref" href="#w1:150"><span class="id" title="binder">w1</span></a> <a id="w2:151" class="idref" href="#w2:151"><span class="id" title="binder">w2</span></a> <a id="w3:152" class="idref" href="#w3:152"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:147"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:148"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:147"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:149"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:148"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:149"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:153" class="idref" href="#k:153"><span class="id" title="binder"><span id="k:154" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:155" class="idref" href="#y:155"><span class="id" title="binder"><span id="y:156" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:147"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:150"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:153"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:155"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:147"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:150"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:148"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w2:151"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:149"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w3:152"><span class="id" title="variable">w3</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? ? ?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_4" class="idref" href="#map_of_regs_4"><span class="id" title="lemma">map_of_regs_4</span></a> (<a id="r1:157" class="idref" href="#r1:157"><span class="id" title="binder">r1</span></a> <a id="r2:158" class="idref" href="#r2:158"><span class="id" title="binder">r2</span></a> <a id="r3:159" class="idref" href="#r3:159"><span class="id" title="binder">r3</span></a> <a id="r4:160" class="idref" href="#r4:160"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:161" class="idref" href="#w1:161"><span class="id" title="binder">w1</span></a> <a id="w2:162" class="idref" href="#w2:162"><span class="id" title="binder">w2</span></a> <a id="w3:163" class="idref" href="#w3:163"><span class="id" title="binder">w3</span></a> <a id="w4:164" class="idref" href="#w4:164"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:157"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:161"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:158"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w2:162"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:159"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w3:163"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r4:160"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w4:164"><span class="id" title="variable">w4</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:165" class="idref" href="#k:165"><span class="id" title="binder"><span id="k:166" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:167" class="idref" href="#y:167"><span class="id" title="binder"><span id="y:168" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:157"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:161"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:165"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:167"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:157"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:158"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:157"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:159"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:157"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r4:160"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:158"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:159"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:158"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r4:160"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:159"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r4:160"><span class="id" title="variable">r4</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3 H4".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H3 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_4" class="idref" href="#regs_of_map_4"><span class="id" title="lemma">regs_of_map_4</span></a> (<a id="r1:169" class="idref" href="#r1:169"><span class="id" title="binder">r1</span></a> <a id="r2:170" class="idref" href="#r2:170"><span class="id" title="binder">r2</span></a> <a id="r3:171" class="idref" href="#r3:171"><span class="id" title="binder">r3</span></a> <a id="r4:172" class="idref" href="#r4:172"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:173" class="idref" href="#w1:173"><span class="id" title="binder">w1</span></a> <a id="w2:174" class="idref" href="#w2:174"><span class="id" title="binder">w2</span></a> <a id="w3:175" class="idref" href="#w3:175"><span class="id" title="binder">w3</span></a> <a id="w4:176" class="idref" href="#w4:176"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:169"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:170"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:169"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:171"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:169"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r4:172"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:170"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:171"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:170"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r4:172"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:171"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r4:172"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:177" class="idref" href="#k:177"><span class="id" title="binder"><span id="k:178" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:179" class="idref" href="#y:179"><span class="id" title="binder"><span id="y:180" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:169"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:173"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:177"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:179"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r1:169"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:173"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r2:170"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w2:174"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r3:171"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w3:175"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#r4:172"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w4:176"><span class="id" title="variable">w4</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;address&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne" class="idref" href="#memMap_resource_2ne"><span class="id" title="lemma">memMap_resource_2ne</span></a> (<a id="a1:181" class="idref" href="#a1:181"><span class="id" title="binder">a1</span></a> <a id="a2:182" class="idref" href="#a2:182"><span class="id" title="binder">a2</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>) (<a id="w1:183" class="idref" href="#w1:183"><span class="id" title="binder">w1</span></a> <a id="w2:184" class="idref" href="#w2:184"><span class="id" title="binder">w2</span></a> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a1:181"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a2:182"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:185" class="idref" href="#a:185"><span class="id" title="binder"><span id="a:186" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:187" class="idref" href="#w:187"><span class="id" title="binder"><span id="w:188" class="id">w</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a1:181"><span class="id" title="variable">a1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:183"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">a2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a:185"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">↣ₐ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:187"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a1:181"><span class="id" title="variable">a1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">↣ₐ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:183"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a2:182"><span class="id" title="variable">a2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">↣ₐ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w2:184"><span class="id" title="variable">w2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a2</span> <span class="id" title="var">w2</span>); <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>. 2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 [H2 _ ] ]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 H2]". <span class="id" title="var">iFrame</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;semantic&nbsp;heap&nbsp;+&nbsp;a&nbsp;map&nbsp;of&nbsp;pointsto:&nbsp;spec&nbsp;side&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memspec_heap_valid_inSepM" class="idref" href="#memspec_heap_valid_inSepM"><span class="id" title="lemma">memspec_heap_valid_inSepM</span></a> <a id="e:189" class="idref" href="#e:189"><span class="id" title="binder">e</span></a> <a id="a6e4d683e55bf2b470c0972aeb840aae" class="idref" href="#a6e4d683e55bf2b470c0972aeb840aae"><span class="id" title="binder">σ</span></a> <a id="a63a27f84be7db486cc3869ce2456f18" class="idref" href="#a63a27f84be7db486cc3869ce2456f18"><span class="id" title="binder">σ'</span></a> <a id="q:192" class="idref" href="#q:192"><span class="id" title="binder">q</span></a> <a id="l:193" class="idref" href="#l:193"><span class="id" title="binder">l</span></a> <a id="v:194" class="idref" href="#v:194"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a63a27f84be7db486cc3869ce2456f18"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:193"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:194"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:189"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a6e4d683e55bf2b470c0972aeb840aae"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:195" class="idref" href="#k:195"><span class="id" title="binder"><span id="k:196" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:197" class="idref" href="#y:197"><span class="id" title="binder"><span id="y:198" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a63a27f84be7db486cc3869ce2456f18"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:195"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:192"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:197"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a6e4d683e55bf2b470c0972aeb840aae"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.2</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:193"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:194"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_heap_valid"><span class="id" title="axiom">spec_heap_valid</span></a> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regspec_heap_valid_inSepM" class="idref" href="#regspec_heap_valid_inSepM"><span class="id" title="lemma">regspec_heap_valid_inSepM</span></a> <a id="e:199" class="idref" href="#e:199"><span class="id" title="binder">e</span></a> <a id="cd8732bb4b65cc99786539317e720fa1" class="idref" href="#cd8732bb4b65cc99786539317e720fa1"><span class="id" title="binder">σ</span></a> <a id="e3c74fdef8f66c80afe7a582f1cc5686" class="idref" href="#e3c74fdef8f66c80afe7a582f1cc5686"><span class="id" title="binder">σ'</span></a> <a id="q:202" class="idref" href="#q:202"><span class="id" title="binder">q</span></a> <a id="l:203" class="idref" href="#l:203"><span class="id" title="binder">l</span></a> <a id="v:204" class="idref" href="#v:204"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e3c74fdef8f66c80afe7a582f1cc5686"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:203"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:204"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:199"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#cd8732bb4b65cc99786539317e720fa1"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:205" class="idref" href="#k:205"><span class="id" title="binder"><span id="k:206" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:207" class="idref" href="#y:207"><span class="id" title="binder"><span id="y:208" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e3c74fdef8f66c80afe7a582f1cc5686"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:205"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:202"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:207"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#cd8732bb4b65cc99786539317e720fa1"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.1</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:203"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:204"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_regs_valid"><span class="id" title="axiom">spec_regs_valid</span></a> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memspec_heap_valid_inSepM'" class="idref" href="#memspec_heap_valid_inSepM'"><span class="id" title="lemma">memspec_heap_valid_inSepM'</span></a> <a id="e:209" class="idref" href="#e:209"><span class="id" title="binder">e</span></a> <a id="775ece8fae5e4b4061cf4b658276d95e" class="idref" href="#775ece8fae5e4b4061cf4b658276d95e"><span class="id" title="binder">σ</span></a> <a id="9b0bf0f4463fa660970d713e7ccd2b0c" class="idref" href="#9b0bf0f4463fa660970d713e7ccd2b0c"><span class="id" title="binder">σ'</span></a> <a id="q:212" class="idref" href="#q:212"><span class="id" title="binder">q</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:209"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#775ece8fae5e4b4061cf4b658276d95e"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:213" class="idref" href="#k:213"><span class="id" title="binder"><span id="k:214" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:215" class="idref" href="#y:215"><span class="id" title="binder"><span id="y:216" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#9b0bf0f4463fa660970d713e7ccd2b0c"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:213"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:212"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:215"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <a id="l:217" class="idref" href="#l:217"><span class="id" title="binder">l</span></a> <a id="v:218" class="idref" href="#v:218"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#9b0bf0f4463fa660970d713e7ccd2b0c"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:217"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:218"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#775ece8fae5e4b4061cf4b658276d95e"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.2</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:217"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:218"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_heap_valid"><span class="id" title="axiom">spec_heap_valid</span></a> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regspec_heap_valid_inSepM'" class="idref" href="#regspec_heap_valid_inSepM'"><span class="id" title="lemma">regspec_heap_valid_inSepM'</span></a> <a id="e:219" class="idref" href="#e:219"><span class="id" title="binder">e</span></a> <a id="4bbdf4179427bca65f4c2394b0d356f3" class="idref" href="#4bbdf4179427bca65f4c2394b0d356f3"><span class="id" title="binder">σ</span></a> <a id="83002f901decea0122871a68a34b6980" class="idref" href="#83002f901decea0122871a68a34b6980"><span class="id" title="binder">σ'</span></a> <a id="q:222" class="idref" href="#q:222"><span class="id" title="binder">q</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:219"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#4bbdf4179427bca65f4c2394b0d356f3"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:223" class="idref" href="#k:223"><span class="id" title="binder"><span id="k:224" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:225" class="idref" href="#y:225"><span class="id" title="binder"><span id="y:226" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#83002f901decea0122871a68a34b6980"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:223"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:222"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:225"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <a id="l:227" class="idref" href="#l:227"><span class="id" title="binder">l</span></a> <a id="v:228" class="idref" href="#v:228"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#83002f901decea0122871a68a34b6980"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:227"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:228"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#4bbdf4179427bca65f4c2394b0d356f3"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.1</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:227"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:228"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_regs_valid"><span class="id" title="axiom">spec_regs_valid</span></a> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memspec_heap_valid_inclSepM" class="idref" href="#memspec_heap_valid_inclSepM"><span class="id" title="lemma">memspec_heap_valid_inclSepM</span></a> <a id="e:229" class="idref" href="#e:229"><span class="id" title="binder">e</span></a> <a id="2e12aedcbcb60fd78c86a47252bf41fd" class="idref" href="#2e12aedcbcb60fd78c86a47252bf41fd"><span class="id" title="binder">σ</span></a> <a id="c77b95b748d2719e5c8b8bb626c43f21" class="idref" href="#c77b95b748d2719e5c8b8bb626c43f21"><span class="id" title="binder">σ'</span></a> <a id="q:232" class="idref" href="#q:232"><span class="id" title="binder">q</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:229"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#2e12aedcbcb60fd78c86a47252bf41fd"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:233" class="idref" href="#k:233"><span class="id" title="binder"><span id="k:234" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:235" class="idref" href="#y:235"><span class="id" title="binder"><span id="y:236" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#c77b95b748d2719e5c8b8bb626c43f21"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:233"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:232"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:235"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#c77b95b748d2719e5c8b8bb626c43f21"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#2e12aedcbcb60fd78c86a47252bf41fd"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_heap_valid_inSepM'"><span class="id" title="axiom">memspec_heap_valid_inSepM'</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (σ' <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ<span class="id" title="notation">.2</span> <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span>; <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regspec_heap_valid_inclSepM" class="idref" href="#regspec_heap_valid_inclSepM"><span class="id" title="lemma">regspec_heap_valid_inclSepM</span></a> <a id="e:237" class="idref" href="#e:237"><span class="id" title="binder">e</span></a> <a id="4f6dbf0709f30dd8c7d1015e78175245" class="idref" href="#4f6dbf0709f30dd8c7d1015e78175245"><span class="id" title="binder">σ</span></a> <a id="87552c748f3bad3f3544a55724b92e95" class="idref" href="#87552c748f3bad3f3544a55724b92e95"><span class="id" title="binder">σ'</span></a> <a id="q:240" class="idref" href="#q:240"><span class="id" title="binder">q</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:237"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#4f6dbf0709f30dd8c7d1015e78175245"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:241" class="idref" href="#k:241"><span class="id" title="binder"><span id="k:242" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:243" class="idref" href="#y:243"><span class="id" title="binder"><span id="y:244" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#87552c748f3bad3f3544a55724b92e95"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:241"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:240"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:243"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#87552c748f3bad3f3544a55724b92e95"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#4f6dbf0709f30dd8c7d1015e78175245"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.1</span><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_heap_valid_inSepM'"><span class="id" title="axiom">regspec_heap_valid_inSepM'</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (σ' <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ<span class="id" title="notation">.1</span> <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span>; <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memspec_heap_valid_allSepM" class="idref" href="#memspec_heap_valid_allSepM"><span class="id" title="lemma">memspec_heap_valid_allSepM</span></a> <a id="e:245" class="idref" href="#e:245"><span class="id" title="binder">e</span></a> <a id="fa96745e117cb155acde81849acfa355" class="idref" href="#fa96745e117cb155acde81849acfa355"><span class="id" title="binder">σ</span></a> <a id="7d828453c7e2edb524ca4e2f4ec62062" class="idref" href="#7d828453c7e2edb524ca4e2f4ec62062"><span class="id" title="binder">σ'</span></a> <a id="q:248" class="idref" href="#q:248"><span class="id" title="binder">q</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="l:249" class="idref" href="#l:249"><span class="id" title="binder">l</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#7d828453c7e2edb524ca4e2f4ec62062"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:249"><span class="id" title="variable">l</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:245"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#fa96745e117cb155acde81849acfa355"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:250" class="idref" href="#k:250"><span class="id" title="binder"><span id="k:251" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:252" class="idref" href="#y:252"><span class="id" title="binder"><span id="y:253" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#7d828453c7e2edb524ca4e2f4ec62062"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:250"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:248"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:252"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#fa96745e117cb155acde81849acfa355"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#7d828453c7e2edb524ca4e2f4ec62062"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'. <span class="id" title="var">iIntros</span> "A B".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<span class="id" title="notation">⌜</span> <span class="id" title="notation">forall</span> <a id="l:254" class="idref" href="#l:254"><span class="id" title="binder"><span id="l:255" class="id">l</span></span></a><span class="id" title="notation">,</span> σ<span class="id" title="notation">.2</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:254"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> σ' <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:254"><span class="id" title="variable">l</span></a> <span class="id" title="notation">⌝</span>)%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[A B]" <span class="id" title="keyword">as</span> %<span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> (<span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span>σ' <span class="id" title="var">l</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="definition">is_Some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ' <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> <span class="id" title="var">H</span>σ'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_heap_valid_inSepM"><span class="id" title="axiom">memspec_heap_valid_inSepM</span></a> <span class="id" title="var">e</span> σ σ') <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">H</span>σ' <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">map_leibniz</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">leibniz_equiv_iff</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="instance">option_leibniz</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regspec_heap_valid_allSepM" class="idref" href="#regspec_heap_valid_allSepM"><span class="id" title="lemma">regspec_heap_valid_allSepM</span></a> <a id="e:256" class="idref" href="#e:256"><span class="id" title="binder">e</span></a> <a id="91cc84ecee74a42c663c7ee2977bf2de" class="idref" href="#91cc84ecee74a42c663c7ee2977bf2de"><span class="id" title="binder">σ</span></a> <a id="34f1eb4e45bb01642ecc4fd33cdd03ea" class="idref" href="#34f1eb4e45bb01642ecc4fd33cdd03ea"><span class="id" title="binder">σ'</span></a> <a id="q:259" class="idref" href="#q:259"><span class="id" title="binder">q</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="l:260" class="idref" href="#l:260"><span class="id" title="binder">l</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#34f1eb4e45bb01642ecc4fd33cdd03ea"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:260"><span class="id" title="variable">l</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:256"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#91cc84ecee74a42c663c7ee2977bf2de"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:261" class="idref" href="#k:261"><span class="id" title="binder"><span id="k:262" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:263" class="idref" href="#y:263"><span class="id" title="binder"><span id="y:264" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#34f1eb4e45bb01642ecc4fd33cdd03ea"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:261"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:259"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:263"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#91cc84ecee74a42c663c7ee2977bf2de"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#34f1eb4e45bb01642ecc4fd33cdd03ea"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'. <span class="id" title="var">iIntros</span> "A B".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<span class="id" title="notation">⌜</span> <span class="id" title="notation">forall</span> <a id="l:265" class="idref" href="#l:265"><span class="id" title="binder"><span id="l:266" class="id">l</span></span></a><span class="id" title="notation">,</span> σ<span class="id" title="notation">.1</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:265"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> σ' <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:265"><span class="id" title="variable">l</span></a> <span class="id" title="notation">⌝</span>)%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[A B]" <span class="id" title="keyword">as</span> %<span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> (<span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span>σ' <span class="id" title="var">l</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="definition">is_Some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ' <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> <span class="id" title="var">H</span>σ'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_heap_valid_inSepM"><span class="id" title="axiom">regspec_heap_valid_inSepM</span></a> <span class="id" title="var">e</span> σ σ') <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">H</span>σ' <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">map_leibniz</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">leibniz_equiv_iff</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="instance">option_leibniz</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memspec_v_implies_m_v" class="idref" href="#memspec_v_implies_m_v"><span class="id" title="lemma">memspec_v_implies_m_v</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="mem0:267" class="idref" href="#mem0:267"><span class="id" title="binder">mem0</span></a> <a id="b09e57e6c9ce47f2c3e91d2413bec717" class="idref" href="#b09e57e6c9ce47f2c3e91d2413bec717"><span class="id" title="binder">σ</span></a> <a id="e':269" class="idref" href="#e':269"><span class="id" title="binder">e'</span></a> (<a id="b:270" class="idref" href="#b:270"><span class="id" title="binder">b</span></a> <a id="e:271" class="idref" href="#e:271"><span class="id" title="binder">e</span></a> <a id="a:272" class="idref" href="#a:272"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>) (<a id="v:273" class="idref" href="#v:273"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>) <a id="q:274" class="idref" href="#q:274"><span class="id" title="binder">q</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#mem0:267"><span class="id" title="variable">mem0</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a:272"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:273"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a0:275" class="idref" href="#a0:275"><span class="id" title="binder"><span id="a0:276" class="id">a0</span></span></a><span class="id" title="notation">↦</span><a id="w:277" class="idref" href="#w:277"><span class="id" title="binder"><span id="w:278" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#mem0:267"><span class="id" title="variable">mem0</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a0:275"><span class="id" title="variable">a0</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#q:274"><span class="id" title="variable">q</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:277"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e':269"><span class="id" title="variable">e'</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#b09e57e6c9ce47f2c3e91d2413bec717"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#b09e57e6c9ce47f2c3e91d2413bec717"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.2</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a:272"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:273"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">mem0</span> σ <span class="id" title="var">e'</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span> <span class="id" title="var">q</span> <span class="id" title="var">Hmem</span>) "Hmem Hm".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">mem0</span> <span class="id" title="var">a</span>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> "[H_a Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_heap_valid"><span class="id" title="axiom">spec_heap_valid</span></a> <span class="id" title="notation">with</span> "[$Hm $H_a]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memspec_heap_update_inSepM" class="idref" href="#memspec_heap_update_inSepM"><span class="id" title="lemma">memspec_heap_update_inSepM</span></a> <a id="e:279" class="idref" href="#e:279"><span class="id" title="binder">e</span></a> <a id="3ff37c6f0856e0568e0f4febf1d8ffe4" class="idref" href="#3ff37c6f0856e0568e0f4febf1d8ffe4"><span class="id" title="binder">σ</span></a> <a id="7f69e06da5f39c438b873e94cf8f7426" class="idref" href="#7f69e06da5f39c438b873e94cf8f7426"><span class="id" title="binder">σ'</span></a> <a id="l:282" class="idref" href="#l:282"><span class="id" title="binder">l</span></a> <a id="v:283" class="idref" href="#v:283"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#7f69e06da5f39c438b873e94cf8f7426"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:282"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:279"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#3ff37c6f0856e0568e0f4febf1d8ffe4"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:284" class="idref" href="#k:284"><span class="id" title="binder"><span id="k:285" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:286" class="idref" href="#y:286"><span class="id" title="binder"><span id="y:287" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#7f69e06da5f39c438b873e94cf8f7426"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:284"><span class="id" title="variable">k</span></a> 1 <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:286"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:279"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#3ff37c6f0856e0568e0f4febf1d8ffe4"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:282"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:283"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;σ.2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:288" class="idref" href="#k:288"><span class="id" title="binder"><span id="k:289" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:290" class="idref" href="#y:290"><span class="id" title="binder"><span id="y:291" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:282"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:283"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto"><span class="id" title="definition">memspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:288"><span class="id" title="variable">k</span></a> 1 <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:290"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto_update"><span class="id" title="axiom">memspec_mapsto_update</span></a> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]". <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><span class="id" title="var">v</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span>) <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_delete</span>. <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regspec_heap_update_inSepM" class="idref" href="#regspec_heap_update_inSepM"><span class="id" title="lemma">regspec_heap_update_inSepM</span></a> <a id="e:292" class="idref" href="#e:292"><span class="id" title="binder">e</span></a> <a id="924d37b02c6dec9de91ce04b656783b5" class="idref" href="#924d37b02c6dec9de91ce04b656783b5"><span class="id" title="binder">σ</span></a> <a id="789608085391b1dffb96de5fc9844810" class="idref" href="#789608085391b1dffb96de5fc9844810"><span class="id" title="binder">σ'</span></a> <a id="l:295" class="idref" href="#l:295"><span class="id" title="binder">l</span></a> <a id="v:296" class="idref" href="#v:296"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#789608085391b1dffb96de5fc9844810"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:295"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:292"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#924d37b02c6dec9de91ce04b656783b5"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:297" class="idref" href="#k:297"><span class="id" title="binder"><span id="k:298" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:299" class="idref" href="#y:299"><span class="id" title="binder"><span id="y:300" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#789608085391b1dffb96de5fc9844810"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:297"><span class="id" title="variable">k</span></a> 1 <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:299"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_res"><span class="id" title="definition">spec_res</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:292"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:295"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:296"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ.1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#924d37b02c6dec9de91ce04b656783b5"><span class="id" title="variable">σ</span></a><span class="id" title="notation">.2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:301" class="idref" href="#k:301"><span class="id" title="binder"><span id="k:302" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:303" class="idref" href="#y:303"><span class="id" title="binder"><span id="y:304" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#l:295"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#v:296"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto"><span class="id" title="definition">regspec_mapsto</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#k:301"><span class="id" title="variable">k</span></a> 1 <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#y:303"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#regspec_mapsto_update"><span class="id" title="axiom">regspec_mapsto_update</span></a> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]". <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><span class="id" title="var">v</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span>) <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_delete</span>. <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="spec_memMap_resource_2ne_apply" class="idref" href="#spec_memMap_resource_2ne_apply"><span class="id" title="lemma">spec_memMap_resource_2ne_apply</span></a> (<a id="a1:305" class="idref" href="#a1:305"><span class="id" title="binder">a1</span></a> <a id="a2:306" class="idref" href="#a2:306"><span class="id" title="binder">a2</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>) (<a id="w1:307" class="idref" href="#w1:307"><span class="id" title="binder">w1</span></a> <a id="w2:308" class="idref" href="#w2:308"><span class="id" title="binder">w2</span></a> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a1:305"><span class="id" title="variable">a1</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">↣ₐ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:307"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a2:306"><span class="id" title="variable">a2</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">↣ₐ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w2:308"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:309" class="idref" href="#a:309"><span class="id" title="binder"><span id="a:310" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:311" class="idref" href="#w:311"><span class="id" title="binder"><span id="w:312" class="id">w</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a1:305"><span class="id" title="variable">a1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w1:307"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">a2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a:309"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">↣ₐ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:311"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a1:305"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#a2:306"><span class="id" title="variable">a2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hi Hr2a".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">decide</span> (<span class="id" title="var">a1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">a2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span>. <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memspec_mapsto_valid_2"><span class="id" title="axiom">memspec_mapsto_valid_2</span></a> <span class="id" title="notation">with</span> "Hi Hr2a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hne</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iSplitL</span> "Hi"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#cap_lang_spec_resources"><span class="id" title="section">cap_lang_spec_resources</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_spec_rules" class="idref" href="#cap_lang_spec_rules"><span class="id" title="section">cap_lang_spec_rules</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:314" class="idref" href="#H:314"><span class="id" title="binder">cfgSG</span></a> <a id="c5b21a4ce8a9b5abb84f552f72b80f4d" class="idref" href="#c5b21a4ce8a9b5abb84f552f72b80f4d"><span class="id" title="binder"><span id="H:314" class="id">Σ</span></span></a>, <a id="H0:315" class="idref" href="#H0:315"><span class="id" title="binder">MachineParameters</span></a>, <a id="invGS0:316" class="idref" href="#invGS0:316"><span class="id" title="binder">invGS</span></a> <a id="invGS0:316" class="idref" href="#invGS0:316"><span class="id" title="binder">Σ</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#6c3a0e346dda49f8ac759f52f8e789e6"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">w</span> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">ms</span> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="spec_step_bind" class="idref" href="#spec_step_bind"><span class="id" title="lemma">spec_step_bind</span></a> <a id="K:317" class="idref" href="#K:317"><span class="id" title="binder">K</span></a> <a id="e:318" class="idref" href="#e:318"><span class="id" title="binder">e</span></a> <a id="f9181946e2fc50149ec845977a3ffe65" class="idref" href="#f9181946e2fc50149ec845977a3ffe65"><span class="id" title="binder">σ</span></a> <a id="e7c7d1f58a667a353ef01f064e957f7d" class="idref" href="#e7c7d1f58a667a353ef01f064e957f7d"><span class="id" title="binder">κ</span></a> <a id="e':321" class="idref" href="#e':321"><span class="id" title="binder">e'</span></a> <a id="004b48a1f0cd32557d5185d103e453bc" class="idref" href="#004b48a1f0cd32557d5185d103e453bc"><span class="id" title="binder">σ'</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="projection">head_step</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:318"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#f9181946e2fc50149ec845977a3ffe65"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e7c7d1f58a667a353ef01f064e957f7d"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e':321"><span class="id" title="variable">e'</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#004b48a1f0cd32557d5185d103e453bc"><span class="id" title="variable">σ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">erased_step</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="projection">fill</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#K:317"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:318"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#f9181946e2fc50149ec845977a3ffe65"><span class="id" title="variable">σ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="projection">fill</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#K:317"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e':321"><span class="id" title="variable">e'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#004b48a1f0cd32557d5185d103e453bc"><span class="id" title="variable">σ'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="projection">fill</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span>0<span class="id" title="notation">:=</span><span class="id" title="projection">fill</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">[</span><span class="id" title="notation">fill</span> <span class="id" title="notation">K</span> <span class="id" title="notation">e</span><span class="id" title="notation">]</span>) <span class="id" title="keyword">as</span> -&gt;;[<span class="id" title="tactic">auto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">right_id_L</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <span class="id" title="notation">(++)</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">_</span><span class="id" title="notation">:=</span><span class="id" title="var">_</span><span class="id" title="notation">]&gt;</span><span class="id" title="notation">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">take_drop_middle</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="projection">fill</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> 0 (<span class="id" title="projection">fill</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span>)) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">step_atomic</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">Ectx_step'</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="spec_step_pure" class="idref" href="#spec_step_pure"><span class="id" title="lemma">spec_step_pure</span></a> <a id="E:323" class="idref" href="#E:323"><span class="id" title="binder">E</span></a> <a id="K:324" class="idref" href="#K:324"><span class="id" title="binder">K</span></a> <a id="e:325" class="idref" href="#e:325"><span class="id" title="binder">e</span></a> <a id="e':326" class="idref" href="#e':326"><span class="id" title="binder">e'</span></a> (<a id="P:327" class="idref" href="#P:327"><span class="id" title="binder">P</span></a> : <span class="id" title="keyword">Prop</span>) <a id="n:328" class="idref" href="#n:328"><span class="id" title="binder">n</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#P:327"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="class">PureExec</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#P:327"><span class="id" title="variable">P</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#n:328"><span class="id" title="variable">n</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:325"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e':326"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#E:323"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <span class="id" title="projection">fill</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#K:324"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:325"><span class="id" title="variable">e</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#E:323"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <span class="id" title="projection">fill</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#K:324"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e':326"><span class="id" title="variable">e'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">HP</span> <span class="id" title="var">Hpure</span> <span class="id" title="var">Hsub</span>) "[#Hinv He]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hinv" <span class="id" title="keyword">as</span> (ρ) "Hinv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_inv"><span class="id" title="definition">spec_inv</span></a> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprspec_mapsto"><span class="id" title="definition">exprspec_mapsto</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> "&gt;H" "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> (<span class="id" title="var">c</span> σ) "[Hcfg Hstep]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hstep" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid_2</span> <span class="id" title="notation">with</span> "Hcfg He"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %[[<span class="id" title="var">Hincle</span> <span class="id" title="var">_</span>]%<span class="id" title="lemma">prod_included</span> <span class="id" title="var">Hvalid</span>]%<span class="id" title="lemma">auth_both_valid_discrete</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="notation">(</span><span class="id" title="definition">ectxi_language.fill</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="definition">exprO</span> <a class="idref" href="cap_machine.cap_lang.html#cap_lang"><span class="id" title="definition">cap_lang</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">≡</span> <span class="id" title="var">c</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Heq</span>;[<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Excl_included</span>|<span class="id" title="var">simplify_eq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_update_2</span> <span class="id" title="notation">with</span> "Hcfg He"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hcfg He]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">auth_update</span>,<span class="id" title="lemma">prod_local_update_1</span>,(<span class="id" title="lemma">option_local_update</span> (<span class="id" title="var">A</span>:=<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprR"><span class="id" title="abbreviation">exprR</span></a>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="lemma">exclusive_local_update</span> (<span class="id" title="var">A</span>:=<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprR"><span class="id" title="abbreviation">exprR</span></a>) <span class="id" title="var">_</span> (<span class="id" title="constructor">Excl</span> (<span class="id" title="projection">fill</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span>))). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "Hclose".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iExists</span> (<span class="id" title="projection">fill</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span>),σ. <span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">rtc_nsteps_1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">m</span> <span class="id" title="var">Hrtc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hpure</span> <span class="id" title="var">HP</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="lemma">rtc_nsteps_2</span> (<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nsteps_trans</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">clear</span> -<span class="id" title="var">Hpure</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">e</span> <span class="id" title="var">e'</span> <span class="id" title="var">Hpure</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">e</span> <span class="id" title="var">e'</span> <span class="id" title="var">Hpure</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hpure</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="constructor">nsteps_O</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hpure</span>;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="constructor">relations.nsteps_l</span>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hexs</span> <span class="id" title="var">Hexd</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hexs</span> σ). <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hexs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">e''</span> [σ' [<span class="id" title="var">efs</span> <span class="id" title="var">Hexs</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hexd</span> σ <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <span class="id" title="var">e''</span> σ' <span class="id" title="var">efs</span> <span class="id" title="var">Hexs</span>); <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hexd</span> <span class="id" title="keyword">as</span> [? [? [? ?]]]; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hexs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">fill_prim_step</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">K</span>:=<span class="id" title="var">K</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hexs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">step_atomic</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">t1</span>:=<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) (<span class="id" title="var">t2</span>:=<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>);<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="do_step_pure" class="idref" href="#do_step_pure"><span class="id" title="lemma">do_step_pure</span></a> <a id="E:329" class="idref" href="#E:329"><span class="id" title="binder">E</span></a> <a id="K:330" class="idref" href="#K:330"><span class="id" title="binder">K</span></a> <a id="e:331" class="idref" href="#e:331"><span class="id" title="binder">e</span></a> <a id="e':332" class="idref" href="#e':332"><span class="id" title="binder">e'</span></a> `{<a id="PureExec0:333" class="idref" href="#PureExec0:333"><span class="id" title="binder">!</span></a><a id="PureExec0:333" class="idref" href="#PureExec0:333"><span class="id" title="binder">PureExec</span></a> <a id="PureExec0:333" class="idref" href="#PureExec0:333"><span class="id" title="binder">True</span></a> <a id="PureExec0:333" class="idref" href="#PureExec0:333"><span class="id" title="binder">1</span></a> <a id="PureExec0:333" class="idref" href="#PureExec0:333"><span class="id" title="binder">e</span></a> <a id="PureExec0:333" class="idref" href="#PureExec0:333"><span class="id" title="binder">e'</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#E:329"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <span class="id" title="projection">fill</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#K:330"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e:331"><span class="id" title="variable">e</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#E:329"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <span class="id" title="projection">fill</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#K:330"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e':332"><span class="id" title="variable">e'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_step_pure"><span class="id" title="axiom">spec_step_pure</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">eauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#cap_lang_spec_rules"><span class="id" title="section">cap_lang_spec_rules</span></a>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">prim_step_from_exec</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.cap_lang.html#exec"><span class="id" title="definition">exec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">res</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>;<span class="id" title="tactic">eapply</span> <span class="id" title="constructor">step_atomic</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">t1</span>:=<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) (<span class="id" title="var">t2</span>:=<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>);<span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>;<span class="id" title="tactic">eauto</span>;<span class="id" title="tactic">constructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_instr"><span class="id" title="constructor">step_exec_instr</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">c</span>:=<span class="id" title="var">res</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">exact</span>; <span class="id" title="var">simplify_map_eq</span>;<span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailStep</span> <span class="id" title="var">fail_type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprspec_mapsto_update"><span class="id" title="axiom">exprspec_mapsto_update</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="projection">fill</span> <span class="id" title="var">_</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>)) <span class="id" title="notation">with</span> "Hown Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hown Hj]";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[Hown]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "_";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iNext</span>;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>;<span class="id" title="var">iFrame</span>;<span class="id" title="var">iPureIntro</span>;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">rtc_r</span>;<span class="id" title="tactic">eauto</span>;<span class="id" title="var">prim_step_from_exec</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> (<a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a>),<span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>;<span class="id" title="var">iModIntro</span>;<span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_type</span>.<br/>

<br/>
<span class="comment">(*&nbsp;FIXME:&nbsp;simplify_map_eq&nbsp;ought&nbsp;to&nbsp;do&nbsp;this&nbsp;but&nbsp;fails&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">simplify_map_eq_alt</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<span class="id" title="notation">&lt;[</span><span class="id" title="var">_</span><span class="id" title="notation">:=</span><span class="id" title="var">_</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">_</span> <span class="id" title="notation">!!</span> <span class="id" title="var">_</span>] |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;[|<span class="id" title="var">done</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<span class="id" title="notation">&lt;[</span><span class="id" title="var">_</span><span class="id" title="notation">:=</span><span class="id" title="var">_</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">_</span> <span class="id" title="notation">!!</span> <span class="id" title="var">_</span>] |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>); <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_spec_rules" class="idref" href="#cap_lang_spec_rules"><span class="id" title="section">cap_lang_spec_rules</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:335" class="idref" href="#H:335"><span class="id" title="binder">cfgSG</span></a> <a id="e4e396109864c24ba7afd74253c39310" class="idref" href="#e4e396109864c24ba7afd74253c39310"><span class="id" title="binder"><span id="H:335" class="id">Σ</span></span></a>, <a id="H0:336" class="idref" href="#H0:336"><span class="id" title="binder">MachineParameters</span></a>, <a id="invGS0:337" class="idref" href="#invGS0:337"><span class="id" title="binder">invGS</span></a> <a id="invGS0:337" class="idref" href="#invGS0:337"><span class="id" title="binder">Σ</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#6c3a0e346dda49f8ac759f52f8e789e6"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">w</span> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">ms</span> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------&nbsp;Fail&nbsp;and&nbsp;Halt&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="step_halt" class="idref" href="#step_halt"><span class="id" title="lemma">step_halt</span></a> <a id="E:338" class="idref" href="#E:338"><span class="id" title="binder">E</span></a> <a id="K:339" class="idref" href="#K:339"><span class="id" title="binder">K</span></a> <a id="pc_p:340" class="idref" href="#pc_p:340"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:341" class="idref" href="#pc_b:341"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:342" class="idref" href="#pc_e:342"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:343" class="idref" href="#pc_a:343"><span class="id" title="binder">pc_a</span></a> <a id="w:344" class="idref" href="#w:344"><span class="id" title="binder">w</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#decodeInstrW"><span class="id" title="definition">decodeInstrW</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:344"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#Halt"><span class="id" title="constructor">Halt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#isCorrectPC"><span class="id" title="inductive">isCorrectPC</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_p:340"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_b:341"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_e:342"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_a:343"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#E:338"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <span class="id" title="projection">fill</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#K:339"><span class="id" title="variable">K</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_p:340"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_b:341"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_e:342"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_a:343"><span class="id" title="variable">pc_a</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_a:343"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">↣ₐ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:344"><span class="id" title="variable">w</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#E:338"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <span class="id" title="projection">fill</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#K:339"><span class="id" title="variable">K</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_p:340"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_b:341"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_e:342"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_a:343"><span class="id" title="variable">pc_a</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_a:343"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">↣ₐ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:344"><span class="id" title="variable">w</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinstr</span> <span class="id" title="var">Hvpc</span> <span class="id" title="var">Hnclose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hinv &amp; Hj &amp; Hpc &amp; Hpca)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hinv" <span class="id" title="keyword">as</span> (ρ) "Hinv". <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_inv"><span class="id" title="definition">spec_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> "&gt;Hinv'" "Hclose". <span class="id" title="var">iDestruct</span> "Hinv'" <span class="id" title="keyword">as</span> (<span class="id" title="var">e</span> [σ<span class="id" title="var">r</span> σ<span class="id" title="var">m</span>]) "[Hown %] /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_regs_valid"><span class="id" title="axiom">spec_regs_valid</span></a> <span class="id" title="notation">with</span> "[$Hown $Hpc]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_heap_valid"><span class="id" title="axiom">spec_heap_valid</span></a> <span class="id" title="notation">with</span> "[$Hown $Hpca]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_expr_valid"><span class="id" title="axiom">spec_expr_valid</span></a> <span class="id" title="notation">with</span> "[$Hown $Hj]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Heq</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="cap_machine.cap_lang.html#normal_always_step"><span class="id" title="axiom">normal_always_step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>σ<span class="id" title="var">r</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a>σ<span class="id" title="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span> [ σ2 <span class="id" title="var">Hstep</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hstep'</span>:=<span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>. <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprspec_mapsto_update"><span class="id" title="axiom">exprspec_mapsto_update</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="projection">fill</span> <span class="id" title="var">K</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>)) <span class="id" title="notation">with</span> "Hown Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hown Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[Hown]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iNext</span>. <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">rtc_r</span>;<span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">prim_step_from_exec</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="step_fail" class="idref" href="#step_fail"><span class="id" title="lemma">step_fail</span></a> <a id="E:345" class="idref" href="#E:345"><span class="id" title="binder">E</span></a> <a id="K:346" class="idref" href="#K:346"><span class="id" title="binder">K</span></a> <a id="pc_p:347" class="idref" href="#pc_p:347"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:348" class="idref" href="#pc_b:348"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:349" class="idref" href="#pc_e:349"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:350" class="idref" href="#pc_a:350"><span class="id" title="binder">pc_a</span></a> <a id="w:351" class="idref" href="#w:351"><span class="id" title="binder">w</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#decodeInstrW"><span class="id" title="definition">decodeInstrW</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:351"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#Fail"><span class="id" title="constructor">Fail</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#isCorrectPC"><span class="id" title="inductive">isCorrectPC</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_p:347"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_b:348"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_e:349"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_a:350"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="instance">nclose</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#E:345"><span class="id" title="variable">E</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_ctx"><span class="id" title="definition">spec_ctx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <span class="id" title="projection">fill</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#K:346"><span class="id" title="variable">K</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_p:347"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_b:348"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_e:349"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_a:350"><span class="id" title="variable">pc_a</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_a:350"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">↣ₐ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:351"><span class="id" title="variable">w</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#E:345"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#39726a285d21e5558b05ca4123ecd5f5"><span class="id" title="notation">⤇</span></a> <span class="id" title="projection">fill</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#K:346"><span class="id" title="variable">K</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#126fc705c29813fa06e80ede95664257"><span class="id" title="notation">↣ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_p:347"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_b:348"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_e:349"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_a:350"><span class="id" title="variable">pc_a</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#pc_a:350"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#e2f4294cd5d6fe856f8983153f4c256a"><span class="id" title="notation">↣ₐ</span></a> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#w:351"><span class="id" title="variable">w</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinstr</span> <span class="id" title="var">Hvpc</span> <span class="id" title="var">Hnclose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hinv &amp; Hj &amp; Hpc &amp; Hpca)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hinv" <span class="id" title="keyword">as</span> (ρ) "Hinv". <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_inv"><span class="id" title="definition">spec_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInv</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#specN"><span class="id" title="definition">specN</span></a> <span class="id" title="keyword">as</span> "&gt;Hinv'" "Hclose". <span class="id" title="var">iDestruct</span> "Hinv'" <span class="id" title="keyword">as</span> (<span class="id" title="var">e</span> [σ<span class="id" title="var">r</span> σ<span class="id" title="var">m</span>]) "[Hown %] /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_regs_valid"><span class="id" title="axiom">spec_regs_valid</span></a> <span class="id" title="notation">with</span> "[$Hown $Hpc]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_heap_valid"><span class="id" title="axiom">spec_heap_valid</span></a> <span class="id" title="notation">with</span> "[$Hown $Hpca]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#spec_expr_valid"><span class="id" title="axiom">spec_expr_valid</span></a> <span class="id" title="notation">with</span> "[$Hown $Hj]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Heq</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="cap_machine.cap_lang.html#normal_always_step"><span class="id" title="axiom">normal_always_step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>σ<span class="id" title="var">r</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a>σ<span class="id" title="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span> [ σ2 <span class="id" title="var">Hstep</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hstep'</span>:=<span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>. <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#exprspec_mapsto_update"><span class="id" title="axiom">exprspec_mapsto_update</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="projection">fill</span> <span class="id" title="var">K</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>)) <span class="id" title="notation">with</span> "Hown Hj"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hown Hj]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[Hown]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iNext</span>. <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">rtc_r</span>;<span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">prim_step_from_exec</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules_binary.rules_binary_base.html#cap_lang_spec_rules"><span class="id" title="section">cap_lang_spec_rules</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
