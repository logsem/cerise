<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">cap_machine.rules.rules_base</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">proofmode</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">invariants</span> <span class="id" title="library">gen_heap</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">weakestpre</span> <span class="id" title="library">ectx_lifting</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">frac</span> <span class="id" title="library">auth</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.logical_mapsto.html#"><span class="id" title="library">logical_mapsto</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.cap_lang.html#"><span class="id" title="library">cap_lang</span></a> <a class="idref" href="cap_machine.iris_extra.html#"><span class="id" title="library">iris_extra</span></a> <a class="idref" href="cap_machine.stdpp_extra.html#"><span class="id" title="library">stdpp_extra</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;---------------------------&nbsp;LTAC&nbsp;DEFINITIONS&nbsp;-----------------------------------&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_cons_hook</span> ::= <span class="id" title="var">destruct_cons_hook2</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv_head_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">progress</span> <span class="id" title="var">simplify_map_eq</span>/= <span class="comment">(*&nbsp;simplify&nbsp;memory&nbsp;stuff&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#of_to_val"><span class="id" title="axiom">of_to_val</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.cap_lang.html#of_val"><span class="id" title="definition">of_val</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_var</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">first</span>[<span class="id" title="tactic">discriminate</span> <span class="id" title="var">H</span>|<span class="id" title="tactic">injection</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">cap_lang.prim_step</span></a> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">is_var</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">fail</span> 1); <span class="comment">(*&nbsp;inversion&nbsp;yields&nbsp;many&nbsp;goals&nbsp;if&nbsp;<span class="inlinecode"><span class="id" title="var">e</span></span>&nbsp;is&nbsp;a&nbsp;variable&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;can&nbsp;thus&nbsp;better&nbsp;be&nbsp;avoided.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> φ := <span class="id" title="tactic">fresh</span> "φ" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [| φ]; <span class="id" title="tactic">subst</span> φ; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_rules" class="idref" href="#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:1" class="idref" href="#H:1"><span class="id" title="binder">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H0:3" class="idref" href="#H0:3"><span class="id" title="binder">memG</span></a> <a id="ebf069dbc779b42a15c441a6d39d5f83" class="idref" href="#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="binder"><span id="H0:3" class="id">Σ</span></span></a>, <a id="H1:4" class="idref" href="#H1:4"><span class="id" title="binder">regG</span></a> <a id="H1:4" class="idref" href="#H1:4"><span class="id" title="binder">Σ</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">c</span> : <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">la</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lw</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lregs</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">mem</span> : <a class="idref" href="cap_machine.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lmem</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Conditionally&nbsp;unify&nbsp;on&nbsp;the&nbsp;read&nbsp;register&nbsp;value&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="read_reg_inr" class="idref" href="#read_reg_inr"><span class="id" title="definition">read_reg_inr</span></a> (<a id="lregs:5" class="idref" href="#lregs:5"><span class="id" title="binder">lregs</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="r:6" class="idref" href="#r:6"><span class="id" title="binder">r</span></a> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) <a id="p:7" class="idref" href="#p:7"><span class="id" title="binder">p</span></a> <a id="b:8" class="idref" href="#b:8"><span class="id" title="binder">b</span></a> <a id="e:9" class="idref" href="#e:9"><span class="id" title="binder">e</span></a> <a id="a:10" class="idref" href="#a:10"><span class="id" title="binder">a</span></a> <a id="v:11" class="idref" href="#v:11"><span class="id" title="binder">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:5"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:6"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">b'</span> <span class="id" title="var">e'</span> <span class="id" title="var">a'</span> <span class="id" title="var">v'</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">b'</span> <span class="id" title="var">e'</span> <span class="id" title="var">a'</span> <span class="id" title="var">v'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:7"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:8"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:9"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:10"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:11"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="notation">False</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;registers&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_dupl_false" class="idref" href="#regname_dupl_false"><span class="id" title="lemma">regname_dupl_false</span></a> <a id="r:12" class="idref" href="#r:12"><span class="id" title="binder">r</span></a> <a id="lw1:13" class="idref" href="#lw1:13"><span class="id" title="binder">lw1</span></a> <a id="lw2:14" class="idref" href="#lw2:14"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:12"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:13"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:12"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:14"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">mapsto_valid_2</span> <span class="id" title="notation">with</span> "Hr1 Hr2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">dfrac_full_exclusive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_neq" class="idref" href="#regname_neq"><span class="id" title="lemma">regname_neq</span></a> <a id="r1:15" class="idref" href="#r1:15"><span class="id" title="binder">r1</span></a> <a id="r2:16" class="idref" href="#r2:16"><span class="id" title="binder">r2</span></a> <a id="lw1:17" class="idref" href="#lw1:17"><span class="id" title="binder">lw1</span></a> <a id="lw2:18" class="idref" href="#lw2:18"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:15"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:17"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:16"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:18"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:15"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:16"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2" (?). <span class="id" title="tactic">subst</span> <span class="id" title="var">r1</span>. <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_dupl_false"><span class="id" title="axiom">regname_dupl_false</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_1" class="idref" href="#map_of_regs_1"><span class="id" title="lemma">map_of_regs_1</span></a> (<a id="r1:19" class="idref" href="#r1:19"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:20" class="idref" href="#lw1:20"><span class="id" title="binder">lw1</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:19"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:20"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:21" class="idref" href="#k:21"><span class="id" title="binder"><span id="k:22" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:23" class="idref" href="#y:23"><span class="id" title="binder"><span id="y:24" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:19"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:20"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:21"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:23"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_1" class="idref" href="#regs_of_map_1"><span class="id" title="lemma">regs_of_map_1</span></a> (<a id="r1:25" class="idref" href="#r1:25"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:26" class="idref" href="#lw1:26"><span class="id" title="binder">lw1</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:27" class="idref" href="#k:27"><span class="id" title="binder"><span id="k:28" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:29" class="idref" href="#y:29"><span class="id" title="binder"><span id="y:30" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:25"><span class="id" title="variable">r1</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:26"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]}</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:27"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:29"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:25"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:26"><span class="id" title="variable">lw1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_singleton</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_2" class="idref" href="#map_of_regs_2"><span class="id" title="lemma">map_of_regs_2</span></a> (<a id="r1:31" class="idref" href="#r1:31"><span class="id" title="binder">r1</span></a> <a id="r2:32" class="idref" href="#r2:32"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:33" class="idref" href="#lw1:33"><span class="id" title="binder">lw1</span></a> <a id="lw2:34" class="idref" href="#lw2:34"><span class="id" title="binder">lw2</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:31"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:33"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:32"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:34"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:35" class="idref" href="#k:35"><span class="id" title="binder"><span id="k:36" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:37" class="idref" href="#y:37"><span class="id" title="binder"><span id="y:38" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:31"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:33"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:35"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:37"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:31"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:32"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2". <span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_2" class="idref" href="#regs_of_map_2"><span class="id" title="lemma">regs_of_map_2</span></a> (<a id="r1:39" class="idref" href="#r1:39"><span class="id" title="binder">r1</span></a> <a id="r2:40" class="idref" href="#r2:40"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:41" class="idref" href="#lw1:41"><span class="id" title="binder">lw1</span></a> <a id="lw2:42" class="idref" href="#lw2:42"><span class="id" title="binder">lw2</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:39"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:40"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:43" class="idref" href="#k:43"><span class="id" title="binder"><span id="k:44" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:45" class="idref" href="#y:45"><span class="id" title="binder"><span id="y:46" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:39"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:41"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:43"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:45"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:39"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:41"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:40"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:42"><span class="id" title="variable">lw2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_3" class="idref" href="#map_of_regs_3"><span class="id" title="lemma">map_of_regs_3</span></a> (<a id="r1:47" class="idref" href="#r1:47"><span class="id" title="binder">r1</span></a> <a id="r2:48" class="idref" href="#r2:48"><span class="id" title="binder">r2</span></a> <a id="r3:49" class="idref" href="#r3:49"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:50" class="idref" href="#w1:50"><span class="id" title="binder">w1</span></a> <a id="w2:51" class="idref" href="#w2:51"><span class="id" title="binder">w2</span></a> <a id="w3:52" class="idref" href="#w3:52"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:50"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:48"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:51"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:49"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:52"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:53" class="idref" href="#k:53"><span class="id" title="binder"><span id="k:54" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:55" class="idref" href="#y:55"><span class="id" title="binder"><span id="y:56" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:50"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:53"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:55"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:48"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:49"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:48"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:49"><span class="id" title="variable">r3</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_3" class="idref" href="#regs_of_map_3"><span class="id" title="lemma">regs_of_map_3</span></a> (<a id="r1:57" class="idref" href="#r1:57"><span class="id" title="binder">r1</span></a> <a id="r2:58" class="idref" href="#r2:58"><span class="id" title="binder">r2</span></a> <a id="r3:59" class="idref" href="#r3:59"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:60" class="idref" href="#w1:60"><span class="id" title="binder">w1</span></a> <a id="w2:61" class="idref" href="#w2:61"><span class="id" title="binder">w2</span></a> <a id="w3:62" class="idref" href="#w3:62"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:58"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:59"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:58"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:59"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:63" class="idref" href="#k:63"><span class="id" title="binder"><span id="k:64" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:65" class="idref" href="#y:65"><span class="id" title="binder"><span id="y:66" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:60"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:63"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:65"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:60"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:58"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:61"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:59"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:62"><span class="id" title="variable">w3</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? ? ?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_4" class="idref" href="#map_of_regs_4"><span class="id" title="lemma">map_of_regs_4</span></a> (<a id="r1:67" class="idref" href="#r1:67"><span class="id" title="binder">r1</span></a> <a id="r2:68" class="idref" href="#r2:68"><span class="id" title="binder">r2</span></a> <a id="r3:69" class="idref" href="#r3:69"><span class="id" title="binder">r3</span></a> <a id="r4:70" class="idref" href="#r4:70"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:71" class="idref" href="#w1:71"><span class="id" title="binder">w1</span></a> <a id="w2:72" class="idref" href="#w2:72"><span class="id" title="binder">w2</span></a> <a id="w3:73" class="idref" href="#w3:73"><span class="id" title="binder">w3</span></a> <a id="w4:74" class="idref" href="#w4:74"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:71"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:72"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:73"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w4:74"><span class="id" title="variable">w4</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:75" class="idref" href="#k:75"><span class="id" title="binder"><span id="k:76" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:77" class="idref" href="#y:77"><span class="id" title="binder"><span id="y:78" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:71"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:75"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:77"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3 H4".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H3 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_4" class="idref" href="#regs_of_map_4"><span class="id" title="lemma">regs_of_map_4</span></a> (<a id="r1:79" class="idref" href="#r1:79"><span class="id" title="binder">r1</span></a> <a id="r2:80" class="idref" href="#r2:80"><span class="id" title="binder">r2</span></a> <a id="r3:81" class="idref" href="#r3:81"><span class="id" title="binder">r3</span></a> <a id="r4:82" class="idref" href="#r4:82"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:83" class="idref" href="#w1:83"><span class="id" title="binder">w1</span></a> <a id="w2:84" class="idref" href="#w2:84"><span class="id" title="binder">w2</span></a> <a id="w3:85" class="idref" href="#w3:85"><span class="id" title="binder">w3</span></a> <a id="w4:86" class="idref" href="#w4:86"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:87" class="idref" href="#k:87"><span class="id" title="binder"><span id="k:88" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:89" class="idref" href="#y:89"><span class="id" title="binder"><span id="y:90" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:83"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:87"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:89"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:83"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:84"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:85"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w4:86"><span class="id" title="variable">w4</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;memory&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="addr_dupl_false" class="idref" href="#addr_dupl_false"><span class="id" title="lemma">addr_dupl_false</span></a> <a id="la:91" class="idref" href="#la:91"><span class="id" title="binder">la</span></a> <a id="lw1:92" class="idref" href="#lw1:92"><span class="id" title="binder">lw1</span></a> <a id="lw2:93" class="idref" href="#lw2:93"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la:91"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:92"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:91"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:93"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ha1 Ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">mapsto_valid_2</span> <span class="id" title="notation">with</span> "Ha1 Ha2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">dfrac_full_exclusive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;semantic&nbsp;heap&nbsp;+&nbsp;a&nbsp;map&nbsp;of&nbsp;pointsto&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM_general" class="idref" href="#gen_heap_valid_inSepM_general"><span class="id" title="lemma">gen_heap_valid_inSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:94" class="idref" href="#L:94"><span class="id" title="binder">L</span></a> <a id="V:95" class="idref" href="#V:95"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:96" class="idref" href="#EqDecision0:96"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a>) (<a id="H:97" class="idref" href="#H:97"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="d28bbe011225204c88b57a270b5a3987" class="idref" href="#d28bbe011225204c88b57a270b5a3987"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:99" class="idref" href="#gen_heapG0:99"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d28bbe011225204c88b57a270b5a3987"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="616bc304c6b7e4c8af72eed31cf6fe79" class="idref" href="#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="binder">d</span></a><a id="616bc304c6b7e4c8af72eed31cf6fe79" class="idref" href="#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a>)) (<a id="0068bba064954ff1d2256a45ce198696" class="idref" href="#0068bba064954ff1d2256a45ce198696"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:102" class="idref" href="#l:102"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a>) (<a id="dq:103" class="idref" href="#dq:103"><span class="id" title="binder">dq</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="v:104" class="idref" href="#v:104"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:102"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:103"><span class="id" title="variable">dq</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:104"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#0068bba064954ff1d2256a45ce198696"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:105" class="idref" href="#k:105"><span class="id" title="binder"><span id="k:106" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:107" class="idref" href="#dqw:107"><span class="id" title="binder"><span id="dqw:108" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:105"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:107"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:107"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#0068bba064954ff1d2256a45ce198696"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:102"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:104"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>σ <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM" class="idref" href="#gen_heap_valid_inSepM"><span class="id" title="lemma">gen_heap_valid_inSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:109" class="idref" href="#L:109"><span class="id" title="binder">L</span></a> <a id="V:110" class="idref" href="#V:110"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:111" class="idref" href="#EqDecision0:111"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a>) (<a id="H:112" class="idref" href="#H:112"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="67028e5db0d7f321f964117e73116fa2" class="idref" href="#67028e5db0d7f321f964117e73116fa2"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:114" class="idref" href="#gen_heapG0:114"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:110"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#67028e5db0d7f321f964117e73116fa2"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="30194486bb6c4e804d25f7da04abfdab" class="idref" href="#30194486bb6c4e804d25f7da04abfdab"><span class="id" title="binder">σ</span></a> <a id="387984c2561d9e0751d72243983585d8" class="idref" href="#387984c2561d9e0751d72243983585d8"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:110"><span class="id" title="variable">V</span></a>) (<a id="l:117" class="idref" href="#l:117"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a>) (<a id="q:118" class="idref" href="#q:118"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span>) (<a id="v:119" class="idref" href="#v:119"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:110"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#387984c2561d9e0751d72243983585d8"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:117"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:119"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#30194486bb6c4e804d25f7da04abfdab"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:120" class="idref" href="#k:120"><span class="id" title="binder"><span id="k:121" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:122" class="idref" href="#y:122"><span class="id" title="binder"><span id="y:123" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#387984c2561d9e0751d72243983585d8"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:120"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:118"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:122"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#30194486bb6c4e804d25f7da04abfdab"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:117"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:119"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM'" class="idref" href="#gen_heap_valid_inSepM'"><span class="id" title="lemma">gen_heap_valid_inSepM'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:124" class="idref" href="#L:124"><span class="id" title="binder">L</span></a> <a id="V:125" class="idref" href="#V:125"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:126" class="idref" href="#EqDecision0:126"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a>) (<a id="H:127" class="idref" href="#H:127"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="4cf90600e8413682f73ea298d1219fe2" class="idref" href="#4cf90600e8413682f73ea298d1219fe2"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:129" class="idref" href="#gen_heapG0:129"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:125"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4cf90600e8413682f73ea298d1219fe2"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="edfcf2c1d0f2984bf130d5d32af280c0" class="idref" href="#edfcf2c1d0f2984bf130d5d32af280c0"><span class="id" title="binder">σ</span></a> <a id="373bdbf96b46bf3aa373e85ba19b5d69" class="idref" href="#373bdbf96b46bf3aa373e85ba19b5d69"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:125"><span class="id" title="variable">V</span></a>) (<a id="q:132" class="idref" href="#q:132"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#edfcf2c1d0f2984bf130d5d32af280c0"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:133" class="idref" href="#k:133"><span class="id" title="binder"><span id="k:134" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:135" class="idref" href="#y:135"><span class="id" title="binder"><span id="y:136" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#373bdbf96b46bf3aa373e85ba19b5d69"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:133"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:132"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:135"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:137" class="idref" href="#l:137"><span class="id" title="binder">l</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a>) (<a id="v:138" class="idref" href="#v:138"><span class="id" title="binder">v</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#V:125"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#373bdbf96b46bf3aa373e85ba19b5d69"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:137"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:138"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#edfcf2c1d0f2984bf130d5d32af280c0"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:137"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:138"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM'_general" class="idref" href="#gen_heap_valid_inSepM'_general"><span class="id" title="lemma">gen_heap_valid_inSepM'_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:139" class="idref" href="#L:139"><span class="id" title="binder">L</span></a> <a id="V:140" class="idref" href="#V:140"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:141" class="idref" href="#EqDecision0:141"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a>) (<a id="H:142" class="idref" href="#H:142"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="92fc1184c72183659a7f8012cd13be07" class="idref" href="#92fc1184c72183659a7f8012cd13be07"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:144" class="idref" href="#gen_heapG0:144"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#92fc1184c72183659a7f8012cd13be07"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="570cad8308dcbf910a2525b22eba0976" class="idref" href="#570cad8308dcbf910a2525b22eba0976"><span class="id" title="binder">d</span></a><a id="570cad8308dcbf910a2525b22eba0976" class="idref" href="#570cad8308dcbf910a2525b22eba0976"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a>)) (<a id="1cd9065e8a4e883005d819069f13ddb7" class="idref" href="#1cd9065e8a4e883005d819069f13ddb7"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#1cd9065e8a4e883005d819069f13ddb7"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:147" class="idref" href="#k:147"><span class="id" title="binder"><span id="k:148" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:149" class="idref" href="#dqw:149"><span class="id" title="binder"><span id="dqw:150" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:147"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:149"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:149"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:151" class="idref" href="#l:151"><span class="id" title="binder">l</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a>) (<a id="d:152" class="idref" href="#d:152"><span class="id" title="binder">d</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="v:153" class="idref" href="#v:153"><span class="id" title="binder">v</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:151"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#d:152"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:153"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1cd9065e8a4e883005d819069f13ddb7"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:151"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:153"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">d</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>σ <span class="id" title="var">l</span>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]". <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inclSepM_general" class="idref" href="#gen_heap_valid_inclSepM_general"><span class="id" title="lemma">gen_heap_valid_inclSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:154" class="idref" href="#L:154"><span class="id" title="binder">L</span></a> <a id="V:155" class="idref" href="#V:155"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:156" class="idref" href="#EqDecision0:156"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a>) (<a id="H:157" class="idref" href="#H:157"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="4083cb2bcc85852dfb10cc3813a0b868" class="idref" href="#4083cb2bcc85852dfb10cc3813a0b868"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:159" class="idref" href="#gen_heapG0:159"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:155"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4083cb2bcc85852dfb10cc3813a0b868"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="2fc7cc3ed54450ffecb827be278e72cb" class="idref" href="#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="binder">d</span></a><a id="2fc7cc3ed54450ffecb827be278e72cb" class="idref" href="#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:155"><span class="id" title="variable">V</span></a>)) (<a id="76873164e1875c9cabe83440d7af70c6" class="idref" href="#76873164e1875c9cabe83440d7af70c6"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:155"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#76873164e1875c9cabe83440d7af70c6"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:162" class="idref" href="#k:162"><span class="id" title="binder"><span id="k:163" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:164" class="idref" href="#dqw:164"><span class="id" title="binder"><span id="dqw:165" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:162"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:164"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:164"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><span class="id" title="notation">(</span><span class="id" title="definition">fmap</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">σ</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#76873164e1875c9cabe83440d7af70c6"><span class="id" title="variable">σ</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM'_general"><span class="id" title="axiom">gen_heap_valid_inSepM'_general</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H". <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">d</span>σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="var">HH'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hincl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HH'</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hincl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HH'</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;+&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inclSepM" class="idref" href="#gen_heap_valid_inclSepM"><span class="id" title="lemma">gen_heap_valid_inclSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:166" class="idref" href="#L:166"><span class="id" title="binder">L</span></a> <a id="V:167" class="idref" href="#V:167"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:168" class="idref" href="#EqDecision0:168"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a>) (<a id="H:169" class="idref" href="#H:169"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="de0bdd995243600a0219716b7c05224c" class="idref" href="#de0bdd995243600a0219716b7c05224c"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:171" class="idref" href="#gen_heapG0:171"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:167"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#de0bdd995243600a0219716b7c05224c"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ac8cc0af11d0313b0e423490272f7d38" class="idref" href="#ac8cc0af11d0313b0e423490272f7d38"><span class="id" title="binder">σ</span></a> <a id="96e39509c5c968a1f0fa15accc0fa1e6" class="idref" href="#96e39509c5c968a1f0fa15accc0fa1e6"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:167"><span class="id" title="variable">V</span></a>) (<a id="q:174" class="idref" href="#q:174"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#ac8cc0af11d0313b0e423490272f7d38"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:175" class="idref" href="#k:175"><span class="id" title="binder"><span id="k:176" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:177" class="idref" href="#y:177"><span class="id" title="binder"><span id="y:178" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#96e39509c5c968a1f0fa15accc0fa1e6"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:175"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:174"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:177"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#96e39509c5c968a1f0fa15accc0fa1e6"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#ac8cc0af11d0313b0e423490272f7d38"><span class="id" title="variable">σ</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM'"><span class="id" title="axiom">gen_heap_valid_inSepM'</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (σ' <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span>; <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_allSepM" class="idref" href="#gen_heap_valid_allSepM"><span class="id" title="lemma">gen_heap_valid_allSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:179" class="idref" href="#L:179"><span class="id" title="binder">L</span></a> <a id="V:180" class="idref" href="#V:180"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:181" class="idref" href="#EqDecision0:181"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a>) (<a id="H:182" class="idref" href="#H:182"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="EV:183" class="idref" href="#EV:183"><span class="id" title="binder">EV</span></a>: <span class="id" title="class">Equiv</span> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a>) (<a id="REV:184" class="idref" href="#REV:184"><span class="id" title="binder">REV</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#Reflexive"><span class="id" title="class">Reflexive</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#EV:183"><span class="id" title="variable">EV</span></a>) (<a id="LEV:185" class="idref" href="#LEV:185"><span class="id" title="binder">LEV</span></a>: @<span class="id" title="class">LeibnizEquiv</span> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#EV:183"><span class="id" title="variable">EV</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="f95f1e88d28d837cd72b8674833b46fb" class="idref" href="#f95f1e88d28d837cd72b8674833b46fb"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:187" class="idref" href="#gen_heapG0:187"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f95f1e88d28d837cd72b8674833b46fb"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="b42cfa1eec7d2b00a4392b11732c8740" class="idref" href="#b42cfa1eec7d2b00a4392b11732c8740"><span class="id" title="binder">σ</span></a> <a id="3ffff23e1e93db122c1bd2ae63df0d61" class="idref" href="#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a>) (<a id="q:190" class="idref" href="#q:190"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:191" class="idref" href="#l:191"><span class="id" title="binder">l</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a><span class="id" title="notation">),</span> <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:191"><span class="id" title="variable">l</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#b42cfa1eec7d2b00a4392b11732c8740"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:192" class="idref" href="#k:192"><span class="id" title="binder"><span id="k:193" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:194" class="idref" href="#y:194"><span class="id" title="binder"><span id="y:195" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:192"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:190"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:194"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#b42cfa1eec7d2b00a4392b11732c8740"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * ? ? * <span class="id" title="var">H</span>σ'. <span class="id" title="var">iIntros</span> "A B".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<span class="id" title="notation">⌜</span> <span class="id" title="notation">forall</span> <a id="l:196" class="idref" href="#l:196"><span class="id" title="binder"><span id="l:197" class="id">l</span></span></a><span class="id" title="notation">,</span> σ <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:196"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> σ' <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:196"><span class="id" title="variable">l</span></a> <span class="id" title="notation">⌝</span>)%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[A B]" <span class="id" title="keyword">as</span> %<span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> (<span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span>σ' <span class="id" title="var">l</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="definition">is_Some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ' <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> <span class="id" title="var">H</span>σ'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM"><span class="id" title="axiom">gen_heap_valid_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> σ σ') <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">H</span>σ' <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">map_leibniz</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">leibniz_equiv_iff</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">equiv</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#Reflexive"><span class="id" title="class">Reflexive</span></a>. <span class="id" title="tactic">intros</span> [ <span class="id" title="var">x</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="instance">option_equiv</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">REV</span>. } <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_update_inSepM_general" class="idref" href="#gen_heap_update_inSepM_general"><span class="id" title="lemma">gen_heap_update_inSepM_general</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="L:198" class="idref" href="#L:198"><span class="id" title="binder">L</span></a> <a id="V:199" class="idref" href="#V:199"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>} {<a id="EqDecision0:200" class="idref" href="#EqDecision0:200"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H:201" class="idref" href="#H:201"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a>} {<a id="eb108301922c3577e58b724777773441" class="idref" href="#eb108301922c3577e58b724777773441"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="gen_heapG0:203" class="idref" href="#gen_heapG0:203"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#eb108301922c3577e58b724777773441"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="019a176b853a03971213611fa9d8fc1e" class="idref" href="#019a176b853a03971213611fa9d8fc1e"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a>) (<a id="109fa0b16cc8515a5eaa4883ae7aa4a8" class="idref" href="#109fa0b16cc8515a5eaa4883ae7aa4a8"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a>)) (<a id="l:206" class="idref" href="#l:206"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a>) (<a id="v:207" class="idref" href="#v:207"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="w:208" class="idref" href="#w:208"><span class="id" title="binder">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#109fa0b16cc8515a5eaa4883ae7aa4a8"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:206"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:208"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#019a176b853a03971213611fa9d8fc1e"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:209" class="idref" href="#k:209"><span class="id" title="binder"><span id="k:210" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:211" class="idref" href="#y:211"><span class="id" title="binder"><span id="y:212" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#109fa0b16cc8515a5eaa4883ae7aa4a8"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:209"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:211"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:211"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:206"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#v:207"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:213" class="idref" href="#k:213"><span class="id" title="binder"><span id="k:214" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:215" class="idref" href="#y:215"><span class="id" title="binder"><span id="y:216" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:206"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:207"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span><span class="id" title="notation">),</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:213"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:215"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:215"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hw</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]". <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span>) <span class="id" title="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_delete</span>. <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_update_inSepM" class="idref" href="#gen_heap_update_inSepM"><span class="id" title="lemma">gen_heap_update_inSepM</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="L:217" class="idref" href="#L:217"><span class="id" title="binder">L</span></a> <a id="V:218" class="idref" href="#V:218"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>} {<a id="EqDecision0:219" class="idref" href="#EqDecision0:219"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:217"><span class="id" title="variable">L</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H:220" class="idref" href="#H:220"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:217"><span class="id" title="variable">L</span></a>} {<a id="a64a867eb3871e7528f7f78d097b24f0" class="idref" href="#a64a867eb3871e7528f7f78d097b24f0"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="gen_heapG0:222" class="idref" href="#gen_heapG0:222"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:217"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:218"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a64a867eb3871e7528f7f78d097b24f0"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="d664ada8148ca2c7da21edd48409a73d" class="idref" href="#d664ada8148ca2c7da21edd48409a73d"><span class="id" title="binder">σ</span></a> <a id="32214766c65c4988d47c4a1dda4522f2" class="idref" href="#32214766c65c4988d47c4a1dda4522f2"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:217"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:218"><span class="id" title="variable">V</span></a>) (<a id="l:225" class="idref" href="#l:225"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:217"><span class="id" title="variable">L</span></a>) (<a id="v:226" class="idref" href="#v:226"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:218"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#32214766c65c4988d47c4a1dda4522f2"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:225"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#d664ada8148ca2c7da21edd48409a73d"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:227" class="idref" href="#k:227"><span class="id" title="binder"><span id="k:228" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:229" class="idref" href="#y:229"><span class="id" title="binder"><span id="y:230" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#32214766c65c4988d47c4a1dda4522f2"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:227"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:229"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:225"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#v:226"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:231" class="idref" href="#k:231"><span class="id" title="binder"><span id="k:232" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:233" class="idref" href="#y:233"><span class="id" title="binder"><span id="y:234" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:225"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#v:226"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span><span class="id" title="notation">),</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:231"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:233"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]". <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><span class="id" title="var">v</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span>) <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_delete</span>. <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_lmem_version_update" class="idref" href="#gen_heap_lmem_version_update"><span class="id" title="lemma">gen_heap_lmem_version_update</span></a> `{<a id="HmemG:235" class="idref" href="#HmemG:235"><span class="id" title="binder">HmemG</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#memG"><span class="id" title="class">memG</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>, <a id="HregG:236" class="idref" href="#HregG:236"><span class="id" title="binder">HregG</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#regG"><span class="id" title="class">regG</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:237" class="idref" href="#lmem:237"><span class="id" title="binder">lmem</span></a> <a id="lm:238" class="idref" href="#lm:238"><span class="id" title="binder">lm</span></a> <a id="lmem':239" class="idref" href="#lmem':239"><span class="id" title="binder">lmem'</span></a> <a id="lm':240" class="idref" href="#lm':240"><span class="id" title="binder">lm'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="vmap:241" class="idref" href="#vmap:241"><span class="id" title="binder">vmap</span></a> <a id="vmap':242" class="idref" href="#vmap':242"><span class="id" title="binder">vmap'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#VMap"><span class="id" title="definition">VMap</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la:243" class="idref" href="#la:243"><span class="id" title="binder">la</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>) ( <a id="v:244" class="idref" href="#v:244"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="inductive">NoDup</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:243"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:237"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:238"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#update_cur_version_region"><span class="id" title="definition">update_cur_version_region</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:237"><span class="id" title="variable">lmem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:238"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:241"><span class="id" title="variable">vmap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:243"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#lmem':239"><span class="id" title="variable">lmem'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm':240"><span class="id" title="variable">lm'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap':242"><span class="id" title="variable">vmap'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:245" class="idref" href="#a:245"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:238"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:245"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:244"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#la:243"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:246" class="idref" href="#a:246"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:246"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules.rules_base.html#v:244"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:241"><span class="id" title="variable">vmap</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#la:243"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:238"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:247" class="idref" href="#k:247"><span class="id" title="binder"><span id="k:248" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:249" class="idref" href="#y:249"><span class="id" title="binder"><span id="y:250" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:237"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:247"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:249"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm':240"><span class="id" title="variable">lm'</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:251" class="idref" href="#k:251"><span class="id" title="binder"><span id="k:252" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:253" class="idref" href="#y:253"><span class="id" title="binder"><span id="y:254" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':239"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:251"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:253"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span> <span class="id" title="var">la</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">la</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">la</span> <span class="id" title="var">IH</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iIntros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span> <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">HNoDup_la</span> <span class="id" title="var">Hlmem_incl</span> <span class="id" title="var">Hupd</span> <span class="id" title="var">Hmaxv_lm</span> <span class="id" title="var">Hcur_lm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Hgen Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;no&nbsp;addresses&nbsp;updated&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupd</span> ; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">destruct_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lmem0</span> <span class="id" title="notation">⊆</span> <span class="id" title="var">lm0</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hlmem0_incl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#update_cur_version_region_preserves_lmem_incl"><span class="id" title="axiom">update_cur_version_region_preserves_lmem_incl</span></a>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.logical_mapsto.html#update_cur_version_addr"><span class="id" title="definition">update_cur_version_addr</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupd0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">vmap0</span> <span class="id" title="notation">!!</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">va</span> |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hvmap0_a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">last</span> ( <span class="id" title="var">simplify_eq</span> ; <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">IH</span> <span class="id" title="notation">with</span> "Hgen"<span class="id" title="notation">)</span>; <span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lm_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="cap_machine.logical_mapsto.html#update_cur_version_region_notin_preserves_cur"><span class="id" title="axiom">update_cur_version_region_notin_preserves_cur</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lm_a</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvmap0_a</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -/(<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">va</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">vmap0</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hvmap0_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr_same"><span class="id" title="axiom">is_cur_addr_same</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lm_a</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">simplify_map_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lm0</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">lw</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hlm0_a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlm0_a</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupd0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">simplify_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">last</span> (<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">IH</span> <span class="id" title="notation">with</span> "Hgen"<span class="id" title="notation">)</span>; <span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="var">IH</span> <span class="id" title="notation">with</span> "Hgen Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "&gt;[Hgen Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="cap_machine.logical_mapsto.html#update_cur_version_region_notin_preserves_lm"><span class="id" title="axiom">update_cur_version_region_notin_preserves_lm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hmaxv_lm_a</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> (<span class="id" title="notation">((</span><span class="id" title="lemma">gen_heap_alloc</span> <span class="id" title="var">lm0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">lw</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hgen"<span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> "(Hgen &amp; Ha &amp; _)"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span> ; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "[Hmem Ha]"<span class="id" title="notation">)</span>; <span class="id" title="var">last</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken_None</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prim_step_no_kappa" class="idref" href="#prim_step_no_kappa"><span class="id" title="lemma">prim_step_no_kappa</span></a> {<a id="e1:255" class="idref" href="#e1:255"><span class="id" title="binder">e1</span></a> <a id="f37fa95c8196807d4ebdd8acba5c9af8" class="idref" href="#f37fa95c8196807d4ebdd8acba5c9af8"><span class="id" title="binder">σ1</span></a> <a id="08648a441fdb83d991c8a04288c26378" class="idref" href="#08648a441fdb83d991c8a04288c26378"><span class="id" title="binder">κ</span></a> <a id="e2:258" class="idref" href="#e2:258"><span class="id" title="binder">e2</span></a> <a id="4fe907a719ffc25bee025a72441e4b0e" class="idref" href="#4fe907a719ffc25bee025a72441e4b0e"><span class="id" title="binder">σ2</span></a> <a id="efs:260" class="idref" href="#efs:260"><span class="id" title="binder">efs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:255"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f37fa95c8196807d4ebdd8acba5c9af8"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#08648a441fdb83d991c8a04288c26378"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:258"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4fe907a719ffc25bee025a72441e4b0e"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:260"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#08648a441fdb83d991c8a04288c26378"><span class="id" title="variable">κ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prim_step_no_efs" class="idref" href="#prim_step_no_efs"><span class="id" title="lemma">prim_step_no_efs</span></a> {<a id="e1:261" class="idref" href="#e1:261"><span class="id" title="binder">e1</span></a> <a id="5ad1e9c598bcef2144741e1dcd35f912" class="idref" href="#5ad1e9c598bcef2144741e1dcd35f912"><span class="id" title="binder">σ1</span></a> <a id="203f2ed31479844946ca48b1ace56bd5" class="idref" href="#203f2ed31479844946ca48b1ace56bd5"><span class="id" title="binder">κ</span></a> <a id="e2:264" class="idref" href="#e2:264"><span class="id" title="binder">e2</span></a> <a id="e0cdba13ada238360ea2b0036b384018" class="idref" href="#e0cdba13ada238360ea2b0036b384018"><span class="id" title="binder">σ2</span></a> <a id="efs:266" class="idref" href="#efs:266"><span class="id" title="binder">efs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:261"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5ad1e9c598bcef2144741e1dcd35f912"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#203f2ed31479844946ca48b1ace56bd5"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:264"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e0cdba13ada238360ea2b0036b384018"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:266"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:266"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="LMemF" class="idref" href="#LMemF"><span class="id" title="definition">LMemF</span></a> := <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="state_interp_transient" class="idref" href="#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> (<a id="7e3d4e7cb555b377816757bd947c2b62" class="idref" href="#7e3d4e7cb555b377816757bd947c2b62"><span class="id" title="binder">φ</span></a> <a id="f3377e1ec1cec36b7e799eae48656b84" class="idref" href="#f3377e1ec1cec36b7e799eae48656b84"><span class="id" title="binder">φ</span></a><a id="f3377e1ec1cec36b7e799eae48656b84" class="idref" href="#f3377e1ec1cec36b7e799eae48656b84"><span class="id" title="binder">t</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>) (<a id="lr:269" class="idref" href="#lr:269"><span class="id" title="binder">lr</span></a> <a id="lrt:270" class="idref" href="#lrt:270"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="lm:271" class="idref" href="#lm:271"><span class="id" title="binder">lm</span></a> <a id="lmt:272" class="idref" href="#lmt:272"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7e3d4e7cb555b377816757bd947c2b62"><span class="id" title="variable">φ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:273" class="idref" href="#k:273"><span class="id" title="binder"><span id="k:274" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:275" class="idref" href="#y:275"><span class="id" title="binder"><span id="y:276" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:269"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:273"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:275"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;∗&nbsp;⌜&nbsp;lreg_strip&nbsp;lrt&nbsp;⊆&nbsp;reg&nbsp;φt&nbsp;⌝&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:277" class="idref" href="#k:277"><span class="id" title="binder"><span id="k:278" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:279" class="idref" href="#y:279"><span class="id" title="binder"><span id="y:280" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:271"><span class="id" title="variable">lm</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:277"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:279"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:279"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">∃</span> <a id="lreg_t:281" class="idref" href="#lreg_t:281"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:282" class="idref" href="#lmem_t:282"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:283" class="idref" href="#cur_map:283"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:270"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:281"><span class="id" title="variable">lreg_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:272"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:282"><span class="id" title="variable">lmem_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f3377e1ec1cec36b7e799eae48656b84"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#f3377e1ec1cec36b7e799eae48656b84"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#f3377e1ec1cec36b7e799eae48656b84"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#f3377e1ec1cec36b7e799eae48656b84"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:281"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:282"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:283"><span class="id" title="variable">cur_map</span></a><span class="id" title="notation">⌝</span><span class="id" title="notation">)</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="Ep:284" class="idref" href="#Ep:284"><span class="id" title="binder">Ep</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7e3d4e7cb555b377816757bd947c2b62"><span class="id" title="variable">φ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:285" class="idref" href="#k:285"><span class="id" title="binder"><span id="k:286" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:287" class="idref" href="#y:287"><span class="id" title="binder"><span id="y:288" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:269"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:285"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:287"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:289" class="idref" href="#k:289"><span class="id" title="binder"><span id="k:290" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:291" class="idref" href="#y:291"><span class="id" title="binder"><span id="y:292" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:271"><span class="id" title="variable">lm</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:289"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:291"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:291"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:284"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f3377e1ec1cec36b7e799eae48656b84"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#f3377e1ec1cec36b7e799eae48656b84"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:293" class="idref" href="#k:293"><span class="id" title="binder"><span id="k:294" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:295" class="idref" href="#y:295"><span class="id" title="binder"><span id="y:296" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:270"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:293"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:295"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:297" class="idref" href="#k:297"><span class="id" title="binder"><span id="k:298" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:299" class="idref" href="#y:299"><span class="id" title="binder"><span id="y:300" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:272"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:297"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:299"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:299"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">))</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_corr" class="idref" href="#state_interp_corr"><span class="id" title="lemma">state_interp_corr</span></a> {<a id="963c31f7a3a14b0d0ab71d1d8a2f2d75" class="idref" href="#963c31f7a3a14b0d0ab71d1d8a2f2d75"><span class="id" title="binder">σ</span></a> <a id="lregs:302" class="idref" href="#lregs:302"><span class="id" title="binder">lregs</span></a> <a id="Ep:303" class="idref" href="#Ep:303"><span class="id" title="binder">Ep</span></a>} {<a id="lmem:304" class="idref" href="#lmem:304"><span class="id" title="binder">lmem</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#963c31f7a3a14b0d0ab71d1d8a2f2d75"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:305" class="idref" href="#k:305"><span class="id" title="binder"><span id="k:306" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:307" class="idref" href="#y:307"><span class="id" title="binder"><span id="y:308" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:302"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:305"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:307"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:309" class="idref" href="#k:309"><span class="id" title="binder"><span id="k:310" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:311" class="idref" href="#y:311"><span class="id" title="binder"><span id="y:312" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:304"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:309"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:311"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:311"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:303"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#963c31f7a3a14b0d0ab71d1d8a2f2d75"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:313" class="idref" href="#k:313"><span class="id" title="binder"><span id="k:314" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:315" class="idref" href="#y:315"><span class="id" title="binder"><span id="y:316" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:302"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:313"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:315"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:317" class="idref" href="#k:317"><span class="id" title="binder"><span id="k:318" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:319" class="idref" href="#y:319"><span class="id" title="binder"><span id="y:320" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:304"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:317"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:319"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:319"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">∃</span> <a id="lreg_t:321" class="idref" href="#lreg_t:321"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:322" class="idref" href="#lmem_t:322"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:323" class="idref" href="#cur_map:323"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:302"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:321"><span class="id" title="variable">lreg_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:304"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:322"><span class="id" title="variable">lmem_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#963c31f7a3a14b0d0ab71d1d8a2f2d75"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#963c31f7a3a14b0d0ab71d1d8a2f2d75"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:321"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:322"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:323"><span class="id" title="variable">cur_map</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;∗&nbsp;⌜&nbsp;lreg_strip&nbsp;regs&nbsp;⊆&nbsp;reg&nbsp;σ&nbsp;⌝.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hr Hm".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>. <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 (<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_intro" class="idref" href="#state_interp_transient_intro"><span class="id" title="lemma">state_interp_transient_intro</span></a> {<a id="Ep:324" class="idref" href="#Ep:324"><span class="id" title="binder">Ep</span></a>} {<a id="9e0a66f49ce2f32b96753315aa09a3d8" class="idref" href="#9e0a66f49ce2f32b96753315aa09a3d8"><span class="id" title="binder">φ</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:326" class="idref" href="#lr:326"><span class="id" title="binder">lr</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:327" class="idref" href="#lm:327"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9e0a66f49ce2f32b96753315aa09a3d8"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:328" class="idref" href="#k:328"><span class="id" title="binder"><span id="k:329" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:330" class="idref" href="#y:330"><span class="id" title="binder"><span id="y:331" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:326"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:328"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:330"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:332" class="idref" href="#k:332"><span class="id" title="binder"><span id="k:333" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:334" class="idref" href="#y:334"><span class="id" title="binder"><span id="y:335" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:327"><span class="id" title="variable">lm</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:332"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:334"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:334"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:324"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9e0a66f49ce2f32b96753315aa09a3d8"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9e0a66f49ce2f32b96753315aa09a3d8"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:326"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:326"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:327"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:327"><span class="id" title="variable">lm</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hφ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_corr"><span class="id" title="axiom">state_interp_corr</span></a> <span class="id" title="notation">with</span> "[$Hφ $Hregs $Hmem]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hφ &amp; Hregs &amp; Hmem &amp; Hcorr)"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hcorr" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">cur_map</span>) "(%Hlr_incl &amp; %Hlm_incl &amp; %Hcorr)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iExists</span> <span class="id" title="var">lr'</span>, <span class="id" title="var">lm'</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_intro_nodfracs" class="idref" href="#state_interp_transient_intro_nodfracs"><span class="id" title="lemma">state_interp_transient_intro_nodfracs</span></a> {<a id="Ep:336" class="idref" href="#Ep:336"><span class="id" title="binder">Ep</span></a>} {<a id="cf3ea702adb888f6eda225d24e56bf60" class="idref" href="#cf3ea702adb888f6eda225d24e56bf60"><span class="id" title="binder">φ</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:338" class="idref" href="#lr:338"><span class="id" title="binder">lr</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:339" class="idref" href="#lm:339"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cf3ea702adb888f6eda225d24e56bf60"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:340" class="idref" href="#k:340"><span class="id" title="binder"><span id="k:341" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:342" class="idref" href="#y:342"><span class="id" title="binder"><span id="y:343" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:338"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:340"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:342"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:344" class="idref" href="#k:344"><span class="id" title="binder"><span id="k:345" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:346" class="idref" href="#y:346"><span class="id" title="binder"><span id="y:347" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:339"><span class="id" title="variable">lm</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:344"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:346"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:336"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cf3ea702adb888f6eda225d24e56bf60"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cf3ea702adb888f6eda225d24e56bf60"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:338"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:338"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">(</span><span class="id" title="keyword">fun</span> <a id="y:348" class="idref" href="#y:348"><span class="id" title="binder">y</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:348"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:339"><span class="id" title="variable">lm</span></a>) (<span class="id" title="notation">(</span><span class="id" title="keyword">fun</span> <a id="y:349" class="idref" href="#y:349"><span class="id" title="binder">y</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:349"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:339"><span class="id" title="variable">lm</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient_intro"><span class="id" title="axiom">state_interp_transient_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_fmap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_elim_abort" class="idref" href="#state_interp_transient_elim_abort"><span class="id" title="lemma">state_interp_transient_elim_abort</span></a> {<a id="08efc51b8f3945ce666d7677cc480d58" class="idref" href="#08efc51b8f3945ce666d7677cc480d58"><span class="id" title="binder">φ</span></a> <a id="5935838dc063d531401d21961cadc75c" class="idref" href="#5935838dc063d531401d21961cadc75c"><span class="id" title="binder">φ</span></a><a id="5935838dc063d531401d21961cadc75c" class="idref" href="#5935838dc063d531401d21961cadc75c"><span class="id" title="binder">t</span></a>: <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:352" class="idref" href="#lr:352"><span class="id" title="binder">lr</span></a> <a id="lrt:353" class="idref" href="#lrt:353"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:354" class="idref" href="#lm:354"><span class="id" title="binder">lm</span></a> <a id="lmt:355" class="idref" href="#lmt:355"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#08efc51b8f3945ce666d7677cc480d58"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5935838dc063d531401d21961cadc75c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#5935838dc063d531401d21961cadc75c"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:352"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:353"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:354"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:355"><span class="id" title="variable">lmt</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#08efc51b8f3945ce666d7677cc480d58"><span class="id" title="variable">φ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:356" class="idref" href="#k:356"><span class="id" title="binder"><span id="k:357" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:358" class="idref" href="#y:358"><span class="id" title="binder"><span id="y:359" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:352"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:356"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:358"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:360" class="idref" href="#k:360"><span class="id" title="binder"><span id="k:361" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:362" class="idref" href="#y:362"><span class="id" title="binder"><span id="y:363" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:354"><span class="id" title="variable">lm</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:360"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:362"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:362"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hφ &amp; Hregs &amp; Hmem &amp; _)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_elim_commit" class="idref" href="#state_interp_transient_elim_commit"><span class="id" title="lemma">state_interp_transient_elim_commit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Ep:364" class="idref" href="#Ep:364"><span class="id" title="binder">Ep</span></a>} {<a id="8b626253a783aac67aa905b7b9050c39" class="idref" href="#8b626253a783aac67aa905b7b9050c39"><span class="id" title="binder">φ</span></a> <a id="612ac968b86ace9054b2de0db3135a8d" class="idref" href="#612ac968b86ace9054b2de0db3135a8d"><span class="id" title="binder">φ</span></a><a id="612ac968b86ace9054b2de0db3135a8d" class="idref" href="#612ac968b86ace9054b2de0db3135a8d"><span class="id" title="binder">t</span></a>: <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:367" class="idref" href="#lr:367"><span class="id" title="binder">lr</span></a> <a id="lrt:368" class="idref" href="#lrt:368"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:369" class="idref" href="#lm:369"><span class="id" title="binder">lm</span></a> <a id="lmt:370" class="idref" href="#lmt:370"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8b626253a783aac67aa905b7b9050c39"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#612ac968b86ace9054b2de0db3135a8d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#612ac968b86ace9054b2de0db3135a8d"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:367"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:368"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:369"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:370"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:364"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#612ac968b86ace9054b2de0db3135a8d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#612ac968b86ace9054b2de0db3135a8d"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:371" class="idref" href="#k:371"><span class="id" title="binder"><span id="k:372" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:373" class="idref" href="#y:373"><span class="id" title="binder"><span id="y:374" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:368"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:371"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:373"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:375" class="idref" href="#k:375"><span class="id" title="binder"><span id="k:376" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:377" class="idref" href="#y:377"><span class="id" title="binder"><span id="y:378" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:370"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:375"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:377"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:377"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hφ &amp; Hregs &amp; Hmem &amp; _ &amp; Hupd)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hupd" <span class="id" title="notation">with</span> "[$Hφ $Hregs $Hmem]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hφ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_cap_lang" class="idref" href="#wp_cap_lang"><span class="id" title="lemma">wp_cap_lang</span></a> {<a id="s:379" class="idref" href="#s:379"><span class="id" title="binder">s</span></a> <a id="E:380" class="idref" href="#E:380"><span class="id" title="binder">E</span></a>} {<a id="801327616e656b89f677e80d08fdbff8" class="idref" href="#801327616e656b89f677e80d08fdbff8"><span class="id" title="binder">Φ</span></a>} : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="e1:382" class="idref" href="#e1:382"><span class="id" title="binder">e1</span></a> : <span class="id" title="projection">language.expr</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:382"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="f0adbd4bbccaa55a4aac7cbcec714327" class="idref" href="#f0adbd4bbccaa55a4aac7cbcec714327"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f0adbd4bbccaa55a4aac7cbcec714327"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:380"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="definition">head_reducible</span> <a class="idref" href="cap_machine.rules.rules_base.html#e1:382"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f0adbd4bbccaa55a4aac7cbcec714327"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e2:384" class="idref" href="#e2:384"><span class="id" title="binder">e2</span></a> : <span class="id" title="projection">language.expr</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="f5eca97d04f8028caa31bc4b50d84026" class="idref" href="#f5eca97d04f8028caa31bc4b50d84026"><span class="id" title="binder">σ2</span></a> : <span class="id" title="projection">ectx_language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:382"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f0adbd4bbccaa55a4aac7cbcec714327"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:384"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f5eca97d04f8028caa31bc4b50d84026"><span class="id" title="variable">σ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:380"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f5eca97d04f8028caa31bc4b50d84026"><span class="id" title="variable">σ2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#801327616e656b89f677e80d08fdbff8"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> <a class="idref" href="cap_machine.rules.rules_base.html#e2:384"><span class="id" title="variable">e2</span></a>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:379"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:380"><span class="id" title="variable">E</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:382"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#801327616e656b89f677e80d08fdbff8"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? <span class="id" title="var">Hnoval</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>) "Hσ1 /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> σ1 <span class="id" title="notation">with</span> "[$Hσ1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[%Hred H]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iIntros</span> (? ? ?) "%Hstep Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.rules.rules_base.html#prim_step_no_efs"><span class="id" title="axiom">prim_step_no_efs</span></a> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.rules.rules_base.html#prim_step_no_kappa"><span class="id" title="axiom">prim_step_no_kappa</span></a> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">Hstep</span> <span class="id" title="notation">with</span> "Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_instr_exec" class="idref" href="#wp_instr_exec"><span class="id" title="lemma">wp_instr_exec</span></a> {<a id="s:386" class="idref" href="#s:386"><span class="id" title="binder">s</span></a> <a id="E:387" class="idref" href="#E:387"><span class="id" title="binder">E</span></a>} {<a id="0248c7b1d52fcddb3637b26a71aef9e9" class="idref" href="#0248c7b1d52fcddb3637b26a71aef9e9"><span class="id" title="binder">Φ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="3083686d4a1a0ce63fb55ad68a3937a0" class="idref" href="#3083686d4a1a0ce63fb55ad68a3937a0"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3083686d4a1a0ce63fb55ad68a3937a0"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:387"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e2:390" class="idref" href="#e2:390"><span class="id" title="binder">e2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ConfFlag"><span class="id" title="inductive">ConfFlag</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="e92f6cd30d663bd2719c5bbec712f3e9" class="idref" href="#e92f6cd30d663bd2719c5bbec712f3e9"><span class="id" title="binder">σ2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3083686d4a1a0ce63fb55ad68a3937a0"><span class="id" title="variable">σ1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e2:390"><span class="id" title="variable">e2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e92f6cd30d663bd2719c5bbec712f3e9"><span class="id" title="variable">σ2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:387"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e92f6cd30d663bd2719c5bbec712f3e9"><span class="id" title="variable">σ2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#0248c7b1d52fcddb3637b26a71aef9e9"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:390"><span class="id" title="variable">e2</span></a>))<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:386"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:387"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#0248c7b1d52fcddb3637b26a71aef9e9"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_cap_lang"><span class="id" title="axiom">wp_cap_lang</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1) "Hσ1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">with</span> "Hσ1"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2) "%Hstep".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hstep</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Program Definition</span> <a id="wp_lift_atomic_head_step_no_fork_determ" class="idref" href="#wp_lift_atomic_head_step_no_fork_determ"><span class="id" title="definition">wp_lift_atomic_head_step_no_fork_determ</span></a> {<a id="s:392" class="idref" href="#s:392"><span class="id" title="binder">s</span></a> <a id="E:393" class="idref" href="#E:393"><span class="id" title="binder">E</span></a> <a id="1ec5268b3e17be026489a53ad4e99f96" class="idref" href="#1ec5268b3e17be026489a53ad4e99f96"><span class="id" title="binder">Φ</span></a>} <a id="e1:395" class="idref" href="#e1:395"><span class="id" title="binder">e1</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:395"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="5e60dcda559eae2b599ec92cb18b7208" class="idref" href="#5e60dcda559eae2b599ec92cb18b7208"><span class="id" title="binder">σ1</span></a>:<a class="idref" href="cap_machine.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) <a id="ns:397" class="idref" href="#ns:397"><span class="id" title="binder">ns</span></a> <a id="06e7fac70f83703e0155f8575f82410d" class="idref" href="#06e7fac70f83703e0155f8575f82410d"><span class="id" title="binder">κ</span></a> <a id="ff0c2a50c650492cf8f5ef36dd4f8720" class="idref" href="#ff0c2a50c650492cf8f5ef36dd4f8720"><span class="id" title="binder">κs</span></a> <a id="nt:400" class="idref" href="#nt:400"><span class="id" title="binder">nt</span></a><span class="id" title="notation">,</span> <span class="id" title="method">state_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#5e60dcda559eae2b599ec92cb18b7208"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ns:397"><span class="id" title="variable">ns</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#06e7fac70f83703e0155f8575f82410d"><span class="id" title="variable">κ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ff0c2a50c650492cf8f5ef36dd4f8720"><span class="id" title="variable">κs</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#nt:400"><span class="id" title="variable">nt</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:393"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="9af45093268fa18afffb575077a01343" class="idref" href="#9af45093268fa18afffb575077a01343"><span class="id" title="binder">κ</span></a> <a id="e2:402" class="idref" href="#e2:402"><span class="id" title="binder">e2</span></a> (<a id="62d2cad3d8be7ca1333cb369598dd6dd" class="idref" href="#62d2cad3d8be7ca1333cb369598dd6dd"><span class="id" title="binder">σ2</span></a>:<a class="idref" href="cap_machine.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) <a id="efs:404" class="idref" href="#efs:404"><span class="id" title="binder">efs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">cap_lang.prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:395"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5e60dcda559eae2b599ec92cb18b7208"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9af45093268fa18afffb575077a01343"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:402"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#62d2cad3d8be7ca1333cb369598dd6dd"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:404"><span class="id" title="variable">efs</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <span class="id" title="notation">|==&gt;</span> <span class="id" title="notation">(</span><span class="id" title="method">state_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#62d2cad3d8be7ca1333cb369598dd6dd"><span class="id" title="variable">σ2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ns:397"><span class="id" title="variable">ns</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#ff0c2a50c650492cf8f5ef36dd4f8720"><span class="id" title="variable">κs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#nt:400"><span class="id" title="variable">nt</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#1ec5268b3e17be026489a53ad4e99f96"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:402"><span class="id" title="variable">e2</span></a>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.rules.rules_base.html#e1:395"><span class="id" title="variable">e1</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:392"><span class="id" title="variable">s</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:393"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="cap_machine.rules.rules_base.html#1ec5268b3e17be026489a53ad4e99f96"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "H". <span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>)  "Hσ1 /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span> <span class="id" title="notation">with</span> "[Hσ1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> (<span class="id" title="var">κ'</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span>) "[H1 H2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<span class="id" title="definition">head_reducible</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">κ'</span>, <span class="id" title="var">e2</span>, σ2, <span class="id" title="var">efs</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> (? ? ?) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H1" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#cap_lang_determ"><span class="id" title="axiom">cap_lang_determ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hs1</span> <span class="id" title="var">Hs2</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq1</span> [<span class="id" title="var">Heq2</span> [<span class="id" title="var">Heq3</span> <span class="id" title="var">Heq4</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">iMod</span> "H2". <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">inv</span> <span class="id" title="var">Hs1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;predicates&nbsp;on&nbsp;memory&nbsp;maps&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="extract_sep_if_split" class="idref" href="#extract_sep_if_split"><span class="id" title="lemma">extract_sep_if_split</span></a> (<a id="a:405" class="idref" href="#a:405"><span class="id" title="binder">a</span></a> <a id="pc_a:406" class="idref" href="#pc_a:406"><span class="id" title="binder">pc_a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) <a id="P:407" class="idref" href="#P:407"><span class="id" title="binder">P</span></a> <a id="Q:408" class="idref" href="#Q:408"><span class="id" title="binder">Q</span></a> <a id="R:409" class="idref" href="#R:409"><span class="id" title="binder">R</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:405"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:406"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:407"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Q:408"><span class="id" title="variable">Q</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#R:409"><span class="id" title="variable">R</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">≡</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:405"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:406"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:407"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Q:408"><span class="id" title="variable">Q</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:405"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:406"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#R:409"><span class="id" title="variable">R</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">pc_a</span>)%<span class="id" title="var">la</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iIntros</span> "[H1 H2]"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_0" class="idref" href="#memMap_resource_0"><span class="id" title="lemma">memMap_resource_0</span></a>  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">True</span> <span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:410" class="idref" href="#la:410"><span class="id" title="binder"><span id="la:411" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:412" class="idref" href="#w:412"><span class="id" title="binder"><span id="w:413" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:410"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:412"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_1" class="idref" href="#memMap_resource_1"><span class="id" title="lemma">memMap_resource_1</span></a> (<a id="a:414" class="idref" href="#a:414"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w:415" class="idref" href="#w:415"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a:414"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:415"><span class="id" title="variable">w</span></a>  <span class="id" title="notation">⊣⊢</span> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:416" class="idref" href="#la:416"><span class="id" title="binder"><span id="la:417" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:418" class="idref" href="#w:418"><span class="id" title="binder"><span id="w:419" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a:414"><span class="id" title="variable">a</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w:415"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:416"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:418"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_0"><span class="id" title="axiom">memMap_resource_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[HH _]".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_1_dq" class="idref" href="#memMap_resource_1_dq"><span class="id" title="lemma">memMap_resource_1_dq</span></a> (<a id="a:420" class="idref" href="#a:420"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w:421" class="idref" href="#w:421"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <a id="dq:422" class="idref" href="#dq:422"><span class="id" title="binder">dq</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a:420"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:422"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:421"><span class="id" title="variable">w</span></a>  <span class="id" title="notation">⊣⊢</span> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:423" class="idref" href="#la:423"><span class="id" title="binder"><span id="la:424" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:425" class="idref" href="#w:425"><span class="id" title="binder"><span id="w:426" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a:420"><span class="id" title="variable">a</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w:421"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:423"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:422"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:425"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[HH _]".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne" class="idref" href="#memMap_resource_2ne"><span class="id" title="lemma">memMap_resource_2ne</span></a> (<a id="a1:427" class="idref" href="#a1:427"><span class="id" title="binder">a1</span></a> <a id="a2:428" class="idref" href="#a2:428"><span class="id" title="binder">a2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w1:429" class="idref" href="#w1:429"><span class="id" title="binder">w1</span></a> <a id="w2:430" class="idref" href="#w2:430"><span class="id" title="binder">w2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a1:427"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a2:428"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:431" class="idref" href="#a:431"><span class="id" title="binder"><span id="a:432" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:433" class="idref" href="#w:433"><span class="id" title="binder"><span id="w:434" class="id">w</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a1:427"><span class="id" title="variable">a1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:429"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">a2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:431"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:433"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#a1:427"><span class="id" title="variable">a1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:429"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#a2:428"><span class="id" title="variable">a2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:430"><span class="id" title="variable">w2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a2</span> <span class="id" title="var">w2</span>); <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>. 2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_0"><span class="id" title="axiom">memMap_resource_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 [H2 _ ] ]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 H2]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="address_neq" class="idref" href="#address_neq"><span class="id" title="lemma">address_neq</span></a> <a id="la1:435" class="idref" href="#la1:435"><span class="id" title="binder">la1</span></a> <a id="la2:436" class="idref" href="#la2:436"><span class="id" title="binder">la2</span></a> <a id="lw1:437" class="idref" href="#lw1:437"><span class="id" title="binder">lw1</span></a> <a id="lw2:438" class="idref" href="#lw2:438"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la1:435"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:437"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la2:436"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:438"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:435"><span class="id" title="variable">la1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:436"><span class="id" title="variable">la2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ha1 Ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="machine_utils.finz_base.html#finz_eq_dec"><span class="id" title="instance">finz_eq_dec</span></a> <span class="id" title="var">la1</span><span class="id" title="notation">.1</span> <span class="id" title="var">la2</span><span class="id" title="notation">.1</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="instance">Nat.eq_dec</span> <span class="id" title="var">la1</span><span class="id" title="notation">.2</span> <span class="id" title="var">la2</span><span class="id" title="notation">.2</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExFalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">la1</span> <span class="id" title="keyword">with</span> <span class="id" title="var">la2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#addr_dupl_false"><span class="id" title="axiom">addr_dupl_false</span></a> <span class="id" title="notation">with</span> "[$Ha1] [$Ha2]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#injective_projections"><span class="id" title="lemma">injective_projections</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne_apply" class="idref" href="#memMap_resource_2ne_apply"><span class="id" title="lemma">memMap_resource_2ne_apply</span></a> (<a id="la1:439" class="idref" href="#la1:439"><span class="id" title="binder">la1</span></a> <a id="la2:440" class="idref" href="#la2:440"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:441" class="idref" href="#lw1:441"><span class="id" title="binder">lw1</span></a> <a id="lw2:442" class="idref" href="#lw2:442"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la1:439"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:441"><span class="id" title="variable">lw1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la2:440"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:442"><span class="id" title="variable">lw2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:443" class="idref" href="#la:443"><span class="id" title="binder"><span id="la:444" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:445" class="idref" href="#lw:445"><span class="id" title="binder"><span id="lw:446" class="id">lw</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:439"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:441"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:443"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:445"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:439"><span class="id" title="variable">la1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:440"><span class="id" title="variable">la2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hi Hr2a".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#address_neq"><span class="id" title="axiom">address_neq</span></a>  <span class="id" title="notation">with</span> "Hi Hr2a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hne</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iSplitL</span> "Hi"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen" class="idref" href="#memMap_resource_2gen"><span class="id" title="lemma">memMap_resource_2gen</span></a> (<a id="la1:447" class="idref" href="#la1:447"><span class="id" title="binder">la1</span></a> <a id="la2:448" class="idref" href="#la2:448"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:449" class="idref" href="#lw1:449"><span class="id" title="binder">lw1</span></a> <a id="lw2:450" class="idref" href="#lw2:450"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="notation">∃</span> <a id="lmem:451" class="idref" href="#lmem:451"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:452" class="idref" href="#la:452"><span class="id" title="binder"><span id="la:453" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:454" class="idref" href="#lw:454"><span class="id" title="binder"><span id="lw:455" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:451"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:452"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:454"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:448"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:447"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:451"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:447"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:449"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:451"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:447"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:449"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:447"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:449"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:448"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:447"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:448"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:450"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HeqZ</span> <span class="id" title="var">HeqV</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#Z.eqb_eq"><span class="id" title="lemma">Z.eqb_eq</span></a>, <a class="idref" href="machine_utils.finz_base.html#finz_to_z_eq"><span class="id" title="lemma">finz_to_z_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqZ</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.eqb_eq"><span class="id" title="lemma">Nat.eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">la2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">la1</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#injective_projections"><span class="id" title="lemma">injective_projections</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_1"><span class="id" title="axiom">memMap_resource_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (<span class="id" title="var">lmem</span>) "[HH -&gt;]". <span class="id" title="tactic">by</span> <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> "[Hmap _]". <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (<span class="id" title="var">mem</span>) "[HH -&gt;]" ; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> "Hmap"; <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_d" class="idref" href="#memMap_resource_2gen_d"><span class="id" title="lemma">memMap_resource_2gen_d</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="163a6160452a92d5a3cb1a4efcc5045e" class="idref" href="#163a6160452a92d5a3cb1a4efcc5045e"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la1:457" class="idref" href="#la1:457"><span class="id" title="binder">la1</span></a> <a id="la2:458" class="idref" href="#la2:458"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:459" class="idref" href="#lw1:459"><span class="id" title="binder">lw1</span></a> <a id="lw2:460" class="idref" href="#lw2:460"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">∃</span> <a id="lmem:461" class="idref" href="#lmem:461"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:462" class="idref" href="#la:462"><span class="id" title="binder"><span id="la:463" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:464" class="idref" href="#lw:464"><span class="id" title="binder"><span id="lw:465" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:461"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#163a6160452a92d5a3cb1a4efcc5045e"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:462"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:464"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:458"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:457"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:461"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:457"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:459"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:461"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:457"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:459"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#163a6160452a92d5a3cb1a4efcc5045e"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:457"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:459"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:458"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:457"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#163a6160452a92d5a3cb1a4efcc5045e"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:458"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:460"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> (<span class="id" title="var">lmem</span>) "[Hmem Hif]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ((<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_d_dq" class="idref" href="#memMap_resource_2gen_d_dq"><span class="id" title="lemma">memMap_resource_2gen_d_dq</span></a> (<a id="ce8b0ccdd306ef41d33a0f2ae7fec60f" class="idref" href="#ce8b0ccdd306ef41d33a0f2ae7fec60f"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la1:467" class="idref" href="#la1:467"><span class="id" title="binder">la1</span></a> <a id="la2:468" class="idref" href="#la2:468"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="dq1:469" class="idref" href="#dq1:469"><span class="id" title="binder">dq1</span></a> <a id="dq2:470" class="idref" href="#dq2:470"><span class="id" title="binder">dq2</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="lw1:471" class="idref" href="#lw1:471"><span class="id" title="binder">lw1</span></a> <a id="lw2:472" class="idref" href="#lw2:472"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">∃</span> <a id="lmem:473" class="idref" href="#lmem:473"><span class="id" title="binder">lmem</span></a> <a id="dfracs:474" class="idref" href="#dfracs:474"><span class="id" title="binder">dfracs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:475" class="idref" href="#la:475"><span class="id" title="binder"><span id="la:476" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dlw:477" class="idref" href="#dlw:477"><span class="id" title="binder"><span id="dlw:478" class="id">dlw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:474"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:473"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#ce8b0ccdd306ef41d33a0f2ae7fec60f"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:475"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:477"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:477"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:468"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:467"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:473"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:467"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:471"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:473"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:467"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:471"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:468"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:467"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:474"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:467"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:469"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:474"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:467"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:469"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#ce8b0ccdd306ef41d33a0f2ae7fec60f"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:467"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq1:469"><span class="id" title="variable">dq1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:471"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:468"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:467"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ce8b0ccdd306ef41d33a0f2ae7fec60f"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:468"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq2:470"><span class="id" title="variable">dq2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:472"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> (<span class="id" title="var">mem</span> <span class="id" title="var">dfracs</span>) "[Hmem [Hif Hif'] ]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ((<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> "Hif'" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> "Hif'" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Not&nbsp;the&nbsp;world's&nbsp;most&nbsp;beautiful&nbsp;lemma,&nbsp;but&nbsp;it&nbsp;does&nbsp;avoid&nbsp;us&nbsp;having&nbsp;to&nbsp;fiddle&nbsp;around&nbsp;with&nbsp;a&nbsp;later&nbsp;under&nbsp;an&nbsp;if&nbsp;in&nbsp;proofs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_clater" class="idref" href="#memMap_resource_2gen_clater"><span class="id" title="lemma">memMap_resource_2gen_clater</span></a> (<a id="la1:479" class="idref" href="#la1:479"><span class="id" title="binder">la1</span></a> <a id="la2:480" class="idref" href="#la2:480"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:481" class="idref" href="#lw1:481"><span class="id" title="binder">lw1</span></a> <a id="lw2:482" class="idref" href="#lw2:482"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="1b4d74dff668c410bae6da1cc4758de3" class="idref" href="#1b4d74dff668c410bae6da1cc4758de3"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#1b4d74dff668c410bae6da1cc4758de3"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:479"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:481"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:480"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:479"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#1b4d74dff668c410bae6da1cc4758de3"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:480"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:482"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> (<span class="id" title="notation">∃</span> <a id="lmem:484" class="idref" href="#lmem:484"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:485" class="idref" href="#la:485"><span class="id" title="binder"><span id="la:486" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:487" class="idref" href="#lw:487"><span class="id" title="binder"><span id="lw:488" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:484"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#1b4d74dff668c410bae6da1cc4758de3"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:485"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:487"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:480"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:479"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:484"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:479"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:481"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:484"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:479"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:481"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hc1 Hc2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iNext</span>. <span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;More&nbsp;general&nbsp;lemmas&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_clater_dq" class="idref" href="#memMap_resource_2gen_clater_dq"><span class="id" title="lemma">memMap_resource_2gen_clater_dq</span></a> (<a id="la1:489" class="idref" href="#la1:489"><span class="id" title="binder">la1</span></a> <a id="la2:490" class="idref" href="#la2:490"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="dq1:491" class="idref" href="#dq1:491"><span class="id" title="binder">dq1</span></a> <a id="dq2:492" class="idref" href="#dq2:492"><span class="id" title="binder">dq2</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="lw1:493" class="idref" href="#lw1:493"><span class="id" title="binder">lw1</span></a> <a id="lw2:494" class="idref" href="#lw2:494"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="9db3c0b4bc3f53fb2c5e78b1b0def8f3" class="idref" href="#9db3c0b4bc3f53fb2c5e78b1b0def8f3"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#9db3c0b4bc3f53fb2c5e78b1b0def8f3"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:489"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq1:491"><span class="id" title="variable">dq1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:493"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:490"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:489"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#9db3c0b4bc3f53fb2c5e78b1b0def8f3"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:490"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq2:492"><span class="id" title="variable">dq2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:494"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">∃</span> <a id="lmem:496" class="idref" href="#lmem:496"><span class="id" title="binder">lmem</span></a> <a id="dfracs:497" class="idref" href="#dfracs:497"><span class="id" title="binder">dfracs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:498" class="idref" href="#la:498"><span class="id" title="binder"><span id="la:499" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dlw:500" class="idref" href="#dlw:500"><span class="id" title="binder"><span id="dlw:501" class="id">dlw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:497"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:496"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#9db3c0b4bc3f53fb2c5e78b1b0def8f3"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:498"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:500"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:500"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:490"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:489"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:496"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:489"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:493"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:496"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:489"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:493"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:490"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:489"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:497"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:489"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:491"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:497"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:489"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:491"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hc1 Hc2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>),(<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">dq1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>),(<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">dq1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_delete" class="idref" href="#memMap_delete"><span class="id" title="lemma">memMap_delete</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="la:502" class="idref" href="#la:502"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:503" class="idref" href="#lw:503"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <a id="lmem:504" class="idref" href="#lmem:504"><span class="id" title="binder">lmem</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:504"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:502"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:503"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:505" class="idref" href="#la:505"><span class="id" title="binder"><span id="la:506" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:507" class="idref" href="#lw:507"><span class="id" title="binder"><span id="lw:508" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:504"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:505"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:507"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#la:502"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:503"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:509" class="idref" href="#k:509"><span class="id" title="binder"><span id="k:510" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:511" class="idref" href="#y:511"><span class="id" title="binder"><span id="y:512" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">delete</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:502"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:504"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:509"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:511"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">lmem</span> <span class="id" title="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <a id="mem_remove_dq" class="idref" href="#mem_remove_dq"><span class="id" title="lemma">mem_remove_dq</span></a> <a id="lmem:513" class="idref" href="#lmem:513"><span class="id" title="binder">lmem</span></a> <a id="dq:514" class="idref" href="#dq:514"><span class="id" title="binder">dq</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:515" class="idref" href="#la:515"><span class="id" title="binder"><span id="la:516" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:517" class="idref" href="#lw:517"><span class="id" title="binder"><span id="lw:518" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:513"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:515"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:514"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:517"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊣⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:519" class="idref" href="#la:519"><span class="id" title="binder"><span id="la:520" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:521" class="idref" href="#dw:521"><span class="id" title="binder"><span id="dw:522" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:513"><span class="id" title="variable">lmem</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#dq:514"><span class="id" title="variable">dq</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lmem:513"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:519"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:521"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:521"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInduction</span> (<span class="id" title="var">lmem</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">la</span> <span class="id" title="var">k</span> <span class="id" title="var">lmem</span>] "IH" <span class="id" title="keyword">using</span> <span class="id" title="lemma">map_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span> <span class="id" title="lemma">dom_empty_L</span> <span class="id" title="lemma">elements_empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/= /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <span class="id" title="lemma">merge_empty</span> <span class="id" title="lemma">big_sepM_empty</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">dom_insert_L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">elements</span> (<span class="id" title="notation">{[</span><span class="id" title="var">la</span><span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>) <span class="id" title="notation">≡ₚ</span> <span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">elements_union_singleton</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default_permutation"><span class="id" title="axiom">create_gmap_default_permutation</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dq</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hperm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hperm</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Ha Hmem]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_merge</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_op"><span class="id" title="definition">prod_op</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="var">dq</span> <span class="id" title="notation">!!</span> <span class="id" title="var">la</span>);<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "IH". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Ha Hmem]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_merge</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_op"><span class="id" title="definition">prod_op</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="var">dq</span> <span class="id" title="notation">!!</span> <span class="id" title="var">la</span>);<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "IH". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;more&nbsp;general&nbsp;version&nbsp;of&nbsp;load&nbsp;to&nbsp;work&nbsp;also&nbsp;with&nbsp;any&nbsp;fraction&nbsp;and&nbsp;persistent&nbsp;points&nbsp;tos&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_valid_inSepM_general" class="idref" href="#gen_mem_valid_inSepM_general"><span class="id" title="lemma">gen_mem_valid_inSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:523" class="idref" href="#lmem:523"><span class="id" title="binder">lmem</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)) (<a id="lmem':524" class="idref" href="#lmem':524"><span class="id" title="binder">lmem'</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la:525" class="idref" href="#la:525"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:526" class="idref" href="#lw:526"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="dq:527" class="idref" href="#dq:527"><span class="id" title="binder">dq</span></a> : <span class="id" title="inductive">dfrac</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:523"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:525"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:527"><span class="id" title="variable">dq</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:526"><span class="id" title="variable">lw</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':524"><span class="id" title="variable">lmem'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:528" class="idref" href="#a:528"><span class="id" title="binder"><span id="a:529" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="dqw:530" class="idref" href="#dqw:530"><span class="id" title="binder"><span id="dqw:531" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:523"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:528"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:530"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:530"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#lmem':524"><span class="id" title="variable">lmem'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:525"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:526"><span class="id" title="variable">lw</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lmem</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">dq</span> <span class="id" title="var">Hmem_pc</span>) "Hm Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hpc_a Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpc_a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_valid_inSepM" class="idref" href="#gen_mem_valid_inSepM"><span class="id" title="lemma">gen_mem_valid_inSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:532" class="idref" href="#lmem:532"><span class="id" title="binder">lmem</span></a> <a id="lm:533" class="idref" href="#lm:533"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="la:534" class="idref" href="#la:534"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:535" class="idref" href="#lw:535"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:532"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:534"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:535"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:533"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:536" class="idref" href="#la:536"><span class="id" title="binder"><span id="la:537" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:538" class="idref" href="#lw:538"><span class="id" title="binder"><span id="lw:539" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:532"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:536"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:538"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#lm:533"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:534"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:535"><span class="id" title="variable">lw</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">Hmem_pc</span>) "Hm Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#memMap_delete"><span class="id" title="axiom">memMap_delete</span></a> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hpc_a Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpc_a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_update_inSepM" class="idref" href="#gen_mem_update_inSepM"><span class="id" title="lemma">gen_mem_update_inSepM</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="47ac5bc1e7acb10c2d139e6e4aa30b23" class="idref" href="#47ac5bc1e7acb10c2d139e6e4aa30b23"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>} {<a id="gen_heapG0:541" class="idref" href="#gen_heapG0:541"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#47ac5bc1e7acb10c2d139e6e4aa30b23"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="lmem:542" class="idref" href="#lmem:542"><span class="id" title="binder">lmem</span></a> <a id="lmem':543" class="idref" href="#lmem':543"><span class="id" title="binder">lmem'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="la:544" class="idref" href="#la:544"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:545" class="idref" href="#lw:545"><span class="id" title="binder">lw</span></a> <a id="lw':546" class="idref" href="#lw':546"><span class="id" title="binder">lw'</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem':543"><span class="id" title="variable">lmem'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:544"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw':546"><span class="id" title="variable">lw'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:542"><span class="id" title="variable">lmem</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:547" class="idref" href="#la:547"><span class="id" title="binder"><span id="la:548" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:549" class="idref" href="#lw:549"><span class="id" title="binder"><span id="lw:550" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':543"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:547"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:549"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la:544"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:545"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:551" class="idref" href="#a:551"><span class="id" title="binder"><span id="a:552" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:553" class="idref" href="#w:553"><span class="id" title="binder"><span id="w:554" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la:544"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:545"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem'</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:551"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:553"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span>);[|<span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "[$Hmap $Hl]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_delete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">insert_delete_insert</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;FAIL&nbsp;RULES&nbsp;----------------------------------&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Bind&nbsp;Scope&nbsp;expr_scope&nbsp;with&nbsp;language.expr&nbsp;cap_lang.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC" class="idref" href="#wp_notCorrectPC"><span class="id" title="lemma">wp_notCorrectPC</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">forall</span> <a id="E:555" class="idref" href="#E:555"><span class="id" title="binder">E</span></a> (<a id="lw:556" class="idref" href="#lw:556"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:556"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:556"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:555"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:556"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hnpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">ϕ</span>) "HPC Hϕ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">nt</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">ns</span>) "Hσ1 /="; <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span>) "(Hr &amp; Hm &amp; %HLinv)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr HPC"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">fupd_frame_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">e1</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_fail_inv"><span class="id" title="axiom">step_fail_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> [-&gt; -&gt;]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">intro</span> <span class="id" title="var">contra</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">contra</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hϕ HPC"; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hϕ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Subcases&nbsp;for&nbsp;respecitvely&nbsp;permissions&nbsp;and&nbsp;bounds&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC_perm" class="idref" href="#wp_notCorrectPC_perm"><span class="id" title="lemma">wp_notCorrectPC_perm</span></a> <a id="E:557" class="idref" href="#E:557"><span class="id" title="binder">E</span></a> <a id="pc_p:558" class="idref" href="#pc_p:558"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:559" class="idref" href="#pc_b:559"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:560" class="idref" href="#pc_e:560"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:561" class="idref" href="#pc_a:561"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:562" class="idref" href="#pc_v:562"><span class="id" title="binder">pc_v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#pc_p:558"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.machine_base.html#RX"><span class="id" title="constructor">RX</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:558"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:558"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:559"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:560"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:561"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:562"><span class="id" title="variable">pc_v</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:557"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <span class="id" title="notation">True</span> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hperm</span> φ) "HPC Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_notCorrectPC"><span class="id" title="axiom">wp_notCorrectPC</span></a> <span class="id" title="notation">with</span> "[HPC]"<span class="id" title="notation">)</span> ; [<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#not_isCorrectLPC_perm"><span class="id" title="axiom">not_isCorrectLPC_perm</span></a>; <span class="id" title="tactic">eauto</span>|<span class="id" title="var">iFrame</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "HPC /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC_range" class="idref" href="#wp_notCorrectPC_range"><span class="id" title="lemma">wp_notCorrectPC_range</span></a> <a id="E:563" class="idref" href="#E:563"><span class="id" title="binder">E</span></a> <a id="pc_p:564" class="idref" href="#pc_p:564"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:565" class="idref" href="#pc_b:565"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:566" class="idref" href="#pc_e:566"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:567" class="idref" href="#pc_a:567"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:568" class="idref" href="#pc_v:568"><span class="id" title="binder">pc_v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#pc_b:565"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.addr_reg.html#ecb49afb136c57143f8ddd1e3e9a03fe"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:567"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.addr_reg.html#ecb49afb136c57143f8ddd1e3e9a03fe"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:566"><span class="id" title="variable">pc_e</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:564"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:565"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:566"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:567"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:568"><span class="id" title="variable">pc_v</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:563"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <span class="id" title="notation">True</span> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hperm</span> φ) "HPC Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_notCorrectPC"><span class="id" title="axiom">wp_notCorrectPC</span></a> <span class="id" title="notation">with</span> "[HPC]"<span class="id" title="notation">)</span> ; [<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#not_isCorrectLPC_bounds"><span class="id" title="axiom">not_isCorrectLPC_bounds</span></a>; <span class="id" title="tactic">eauto</span>|<span class="id" title="var">iFrame</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "HPC /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;ATOMIC&nbsp;RULES&nbsp;--------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_halt" class="idref" href="#wp_halt"><span class="id" title="lemma">wp_halt</span></a> <a id="E:569" class="idref" href="#E:569"><span class="id" title="binder">E</span></a> <a id="pc_p:570" class="idref" href="#pc_p:570"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:571" class="idref" href="#pc_b:571"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:572" class="idref" href="#pc_e:572"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:573" class="idref" href="#pc_a:573"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:574" class="idref" href="#pc_v:574"><span class="id" title="binder">pc_v</span></a> <a id="lw:575" class="idref" href="#lw:575"><span class="id" title="binder">lw</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:575"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#Halt"><span class="id" title="constructor">Halt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:570"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:571"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:572"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:573"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:574"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:570"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:571"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:572"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:573"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:574"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:573"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:574"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:575"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:569"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#HaltedV"><span class="id" title="constructor">HaltedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:570"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:571"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:572"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:573"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:574"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:573"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:574"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:575"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinstr</span> <span class="id" title="var">Hvpc</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (φ) "[Hpc Hpca] Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">nt</span>) "Hσ1 /=". <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr Hpc"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpca"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">rewrite</span> -/((<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_correct_PC"><span class="id" title="axiom">state_corresponds_mem_correct_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>. <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hφ Hpc Hpca"; <span class="id" title="var">last</span> (<span class="id" title="var">iApply</span> "Hφ" ; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_fail" class="idref" href="#wp_fail"><span class="id" title="lemma">wp_fail</span></a> <a id="E:576" class="idref" href="#E:576"><span class="id" title="binder">E</span></a> <a id="pc_p:577" class="idref" href="#pc_p:577"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:578" class="idref" href="#pc_b:578"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:579" class="idref" href="#pc_e:579"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:580" class="idref" href="#pc_a:580"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:581" class="idref" href="#pc_v:581"><span class="id" title="binder">pc_v</span></a> <a id="lw:582" class="idref" href="#lw:582"><span class="id" title="binder">lw</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:582"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#Fail"><span class="id" title="constructor">Fail</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:577"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:578"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:579"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:580"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:581"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:577"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:578"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:579"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:580"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:581"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:580"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:581"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:582"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:576"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:577"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:578"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:579"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:580"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:581"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:580"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:581"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:582"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinstr</span> <span class="id" title="var">Hvpc</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (φ) "[Hpc Hpca] Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">nt</span>) "Hσ1 /=". <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr Hpc"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpca"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">rewrite</span> -/((<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_correct_PC"><span class="id" title="axiom">state_corresponds_mem_correct_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>. <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hφ Hpc Hpca"; <span class="id" title="var">last</span> (<span class="id" title="var">iApply</span> "Hφ" ; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;PURE&nbsp;RULES&nbsp;----------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_safe</span> := <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_puredet</span> := <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">inv_head_step</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_pure</span> := <span class="id" title="tactic">intros</span> ?; <span class="id" title="tactic">apply</span> <span class="id" title="lemma">nsteps_once</span>, <span class="id" title="lemma">pure_head_step_pure_step</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; [<span class="id" title="var">solve_exec_safe</span>|]; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="projection">head_step</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_failed" class="idref" href="#pure_seq_failed"><span class="id" title="instance">pure_seq_failed</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_halted" class="idref" href="#pure_seq_halted"><span class="id" title="instance">pure_seq_halted</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_done" class="idref" href="#pure_seq_done"><span class="id" title="instance">pure_seq_done</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules.rules_base.html#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Used&nbsp;to&nbsp;close&nbsp;the&nbsp;failing&nbsp;cases&nbsp;of&nbsp;the&nbsp;ftlr.<br/>
&nbsp;&nbsp;-&nbsp;Hcont&nbsp;is&nbsp;the&nbsp;(iris)&nbsp;name&nbsp;of&nbsp;the&nbsp;closing&nbsp;hypothesis&nbsp;(usually&nbsp;"Hφ")<br/>
&nbsp;&nbsp;-&nbsp;fail_case_name&nbsp;is&nbsp;one&nbsp;constructor&nbsp;of&nbsp;the&nbsp;spec_name,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;indicating&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;case<br/>
&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_case_name</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">fail_case_name</span> ; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailWP</span> <span class="id" title="var">Hcont</span> <span class="id" title="var">fail_case_name</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="var">cbn</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iApply</span> <span class="id" title="var">Hcont</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_case_name</span>).<br/>

<br/>
<span class="comment">(*&nbsp;-----------------&nbsp;useful&nbsp;definitions&nbsp;to&nbsp;factor&nbsp;out&nbsp;the&nbsp;wp&nbsp;specs&nbsp;----------------&nbsp;*)</span><br/>

<br/>
<span class="comment">(*---&nbsp;register&nbsp;equality&nbsp;---*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="addr_ne_reg_ne" class="idref" href="#addr_ne_reg_ne"><span class="id" title="lemma">addr_ne_reg_ne</span></a> {<a id="regs:583" class="idref" href="#regs:583"><span class="id" title="binder">regs</span></a> : <span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>} {<a id="r1:584" class="idref" href="#r1:584"><span class="id" title="binder">r1</span></a> <a id="r2:585" class="idref" href="#r2:585"><span class="id" title="binder">r2</span></a> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="p0:586" class="idref" href="#p0:586"><span class="id" title="binder">p0</span></a> <a id="b0:587" class="idref" href="#b0:587"><span class="id" title="binder">b0</span></a> <a id="e0:588" class="idref" href="#e0:588"><span class="id" title="binder">e0</span></a> <a id="a0:589" class="idref" href="#a0:589"><span class="id" title="binder">a0</span></a> <a id="p:590" class="idref" href="#p:590"><span class="id" title="binder">p</span></a> <a id="b:591" class="idref" href="#b:591"><span class="id" title="binder">b</span></a> <a id="e:592" class="idref" href="#e:592"><span class="id" title="binder">e</span></a> <a id="a:593" class="idref" href="#a:593"><span class="id" title="binder">a</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:583"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:584"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p0:586"><span class="id" title="variable">p0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b0:587"><span class="id" title="variable">b0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e0:588"><span class="id" title="variable">e0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0:589"><span class="id" title="variable">a0</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:583"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:585"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:590"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:591"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:592"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:593"><span class="id" title="variable">a</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0:589"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:593"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:584"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:585"><span class="id" title="variable">r2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hr1</span> <span class="id" title="var">Hr2</span> <span class="id" title="var">Hne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">decide</span> (<span class="id" title="var">r1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">r2</span>)); <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;regs_of&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="regs_of_argument" class="idref" href="#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> (<a id="arg:594" class="idref" href="#arg:594"><span class="id" title="binder">arg</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e03f39daf98516fa530d3f6f5a1b4d92"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>): <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#arg:594"><span class="id" title="variable">arg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#inl"><span class="id" title="constructor">inl</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#inr"><span class="id" title="constructor">inr</span></a> <span class="id" title="var">r</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="regs_of" class="idref" href="#regs_of"><span class="id" title="definition">regs_of</span></a> (<a id="i:596" class="idref" href="#i:596"><span class="id" title="binder">i</span></a>: <a class="idref" href="cap_machine.machine_base.html#instr"><span class="id" title="inductive">instr</span></a>): <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#i:596"><span class="id" title="variable">i</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Lea"><span class="id" title="constructor">Lea</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetP"><span class="id" title="constructor">GetP</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetB"><span class="id" title="constructor">GetB</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetE"><span class="id" title="constructor">GetE</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetA"><span class="id" title="constructor">GetA</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetOType"><span class="id" title="constructor">GetOType</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetWType"><span class="id" title="constructor">GetWType</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Add"><span class="id" title="constructor">Add</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Sub"><span class="id" title="constructor">Sub</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Lt"><span class="id" title="constructor">Lt</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Mov"><span class="id" title="constructor">Mov</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Restrict"><span class="id" title="constructor">Restrict</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Subseg"><span class="id" title="constructor">Subseg</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Load"><span class="id" title="constructor">Load</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Store"><span class="id" title="constructor">Store</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Jnz"><span class="id" title="constructor">Jnz</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Seal"><span class="id" title="constructor">Seal</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#UnSeal"><span class="id" title="constructor">UnSeal</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#IsUnique"><span class="id" title="constructor">IsUnique</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;@Denis&nbsp;add&nbsp;enclaves&nbsp;instructions&nbsp;here&nbsp;*)</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="indom_regs_incl" class="idref" href="#indom_regs_incl"><span class="id" title="lemma">indom_regs_incl</span></a> <a id="D:598" class="idref" href="#D:598"><span class="id" title="binder">D</span></a> (<a id="regs:599" class="idref" href="#regs:599"><span class="id" title="binder">regs</span></a> <a id="regs':600" class="idref" href="#regs':600"><span class="id" title="binder">regs'</span></a>: <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#D:598"><span class="id" title="variable">D</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:599"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:599"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':600"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="r:601" class="idref" href="#r:601"><span class="id" title="binder">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r:601"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#D:598"><span class="id" title="variable">D</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="w:602" class="idref" href="#w:602"><span class="id" title="binder">w</span></a>:<a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#regs:599"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:601"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:602"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#regs':600"><span class="id" title="variable">regs'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:601"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:602"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">HD</span> <span class="id" title="var">Hincl</span> <span class="id" title="var">rr</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <span class="id" title="var">rr</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> @<span class="id" title="method">elem_of_dom</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">D</span> := <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>). <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">elem_of_subseteq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="indom_lregs_incl" class="idref" href="#indom_lregs_incl"><span class="id" title="lemma">indom_lregs_incl</span></a> <a id="D:603" class="idref" href="#D:603"><span class="id" title="binder">D</span></a> (<a id="lregs:604" class="idref" href="#lregs:604"><span class="id" title="binder">lregs</span></a> <a id="lregs':605" class="idref" href="#lregs':605"><span class="id" title="binder">lregs'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#D:603"><span class="id" title="variable">D</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:604"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:604"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs':605"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="r:606" class="idref" href="#r:606"><span class="id" title="binder">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r:606"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#D:603"><span class="id" title="variable">D</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="w:607" class="idref" href="#w:607"><span class="id" title="binder">w</span></a>:<a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#lregs:604"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:606"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:607"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#lregs':605"><span class="id" title="variable">lregs'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:606"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:607"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">HD</span> <span class="id" title="var">Hincl</span> <span class="id" title="var">rr</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <span class="id" title="var">rr</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> @<span class="id" title="method">elem_of_dom</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">D</span> := <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>). <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">elem_of_subseteq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;incrementPC&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incrementPC" class="idref" href="#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a id="regs:608" class="idref" href="#regs:608"><span class="id" title="binder">regs</span></a>: <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:608"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a'</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_Some_inv" class="idref" href="#incrementPC_Some_inv"><span class="id" title="lemma">incrementPC_Some_inv</span></a> <a id="regs:609" class="idref" href="#regs:609"><span class="id" title="binder">regs</span></a> <a id="regs':610" class="idref" href="#regs':610"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:609"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':610"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:611" class="idref" href="#p:611"><span class="id" title="binder">p</span></a> <a id="b:612" class="idref" href="#b:612"><span class="id" title="binder">b</span></a> <a id="e:613" class="idref" href="#e:613"><span class="id" title="binder">e</span></a> <a id="a:614" class="idref" href="#a:614"><span class="id" title="binder">a</span></a> <a id="a':615" class="idref" href="#a':615"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:609"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:611"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:612"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:613"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:614"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:614"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':615"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':610"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:611"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:612"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:613"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':615"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> | ] | ] | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 5 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_None_inv" class="idref" href="#incrementPC_None_inv"><span class="id" title="lemma">incrementPC_None_inv</span></a> <a id="regs:616" class="idref" href="#regs:616"><span class="id" title="binder">regs</span></a> <a id="pg:617" class="idref" href="#pg:617"><span class="id" title="binder">pg</span></a> <a id="b:618" class="idref" href="#b:618"><span class="id" title="binder">b</span></a> <a id="e:619" class="idref" href="#e:619"><span class="id" title="binder">e</span></a> <a id="a:620" class="idref" href="#a:620"><span class="id" title="binder">a</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:616"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:616"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pg:617"><span class="id" title="variable">pg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:618"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:619"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:620"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:620"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> | ] | ] |];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_overflow_mono" class="idref" href="#incrementPC_overflow_mono"><span class="id" title="lemma">incrementPC_overflow_mono</span></a> <a id="regs:621" class="idref" href="#regs:621"><span class="id" title="binder">regs</span></a> <a id="regs':622" class="idref" href="#regs':622"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:621"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#regs:621"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:621"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':622"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':622"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">HPC</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span> <span class="id" title="var">HPC</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">HPC'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HPC</span> <span class="id" title="var">HPC'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span> |- *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">aa</span> | ] | ]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">aa</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_overflow_antimono" class="idref" href="#incrementPC_overflow_antimono"><span class="id" title="lemma">incrementPC_overflow_antimono</span></a> <a id="regs:623" class="idref" href="#regs:623"><span class="id" title="binder">regs</span></a> <a id="regs':624" class="idref" href="#regs':624"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:623"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':624"><span class="id" title="variable">regs'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:623"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':624"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hincl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs'</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HrpPC</span>; <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HrpPC</span> <span class="id" title="var">Hincl</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*&nbsp;todo:&nbsp;instead,&nbsp;define&nbsp;updatePC&nbsp;on&nbsp;top&nbsp;of&nbsp;incrementPC&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_fail_updatePC" class="idref" href="#incrementPC_fail_updatePC"><span class="id" title="lemma">incrementPC_fail_updatePC</span></a> <a id="regs:625" class="idref" href="#regs:625"><span class="id" title="binder">regs</span></a> <a id="m:626" class="idref" href="#m:626"><span class="id" title="binder">m</span></a> <a id="etbl:627" class="idref" href="#etbl:627"><span class="id" title="binder">etbl</span></a> <a id="ecur:628" class="idref" href="#ecur:628"><span class="id" title="binder">ecur</span></a>:<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:625"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:625"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:626"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:627"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:628"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a'</span> | ] |]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a'</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_success_updatePC" class="idref" href="#incrementPC_success_updatePC"><span class="id" title="lemma">incrementPC_success_updatePC</span></a> <a id="regs:629" class="idref" href="#regs:629"><span class="id" title="binder">regs</span></a> <a id="m:630" class="idref" href="#m:630"><span class="id" title="binder">m</span></a> <a id="etbl:631" class="idref" href="#etbl:631"><span class="id" title="binder">etbl</span></a> <a id="ecur:632" class="idref" href="#ecur:632"><span class="id" title="binder">ecur</span></a> <a id="regs':633" class="idref" href="#regs':633"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:629"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':633"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="p:634" class="idref" href="#p:634"><span class="id" title="binder">p</span></a> <a id="b:635" class="idref" href="#b:635"><span class="id" title="binder">b</span></a> <a id="e:636" class="idref" href="#e:636"><span class="id" title="binder">e</span></a> <a id="a:637" class="idref" href="#a:637"><span class="id" title="binder">a</span></a> <a id="a':638" class="idref" href="#a':638"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:629"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:634"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:635"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:636"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:637"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:637"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':638"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:629"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:630"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:631"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:632"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:634"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:635"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:636"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':638"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:630"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:631"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:632"><span class="id" title="variable">ecur</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':633"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:634"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:635"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:636"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':638"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a'</span>|]|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a'</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:?; [| <span class="id" title="tactic">congruence</span>]. <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span> <span class="id" title="var">regs'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 5 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_success_incl" class="idref" href="#updatePC_success_incl"><span class="id" title="lemma">updatePC_success_incl</span></a> <a id="m:639" class="idref" href="#m:639"><span class="id" title="binder">m</span></a> <a id="m':640" class="idref" href="#m':640"><span class="id" title="binder">m'</span></a> <a id="regs:641" class="idref" href="#regs:641"><span class="id" title="binder">regs</span></a> <a id="regs':642" class="idref" href="#regs':642"><span class="id" title="binder">regs'</span></a> <a id="etbl:643" class="idref" href="#etbl:643"><span class="id" title="binder">etbl</span></a> <a id="etbl':644" class="idref" href="#etbl':644"><span class="id" title="binder">etbl'</span></a> <a id="ecur:645" class="idref" href="#ecur:645"><span class="id" title="binder">ecur</span></a> <a id="ecur':646" class="idref" href="#ecur':646"><span class="id" title="binder">ecur'</span></a> <a id="w:647" class="idref" href="#w:647"><span class="id" title="binder">w</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:641"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':642"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:641"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:639"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:643"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:645"><span class="id" title="variable">ecur</span></a> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:647"><span class="id" title="variable">w</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:639"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:643"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:645"><span class="id" title="variable">ecur</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs':642"><span class="id" title="variable">regs'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':640"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':644"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':646"><span class="id" title="variable">ecur'</span></a> |}<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:647"><span class="id" title="variable">w</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs'</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':640"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':644"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':646"><span class="id" title="variable">ecur'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hincl</span> <span class="id" title="var">Hu</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ <span class="id" title="var">w1</span> |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hrr</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hrr</span> <span class="id" title="var">Hincl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hregs'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hregs'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w1</span> <span class="id" title="keyword">as</span> [|[ ? ? ? <span class="id" title="var">a1</span>|] | ]; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ha1</span>; <span class="id" title="var">simplify_eq</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HH</span>: <span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="reg1:648" class="idref" href="#reg1:648"><span class="id" title="binder"><span id="reg1:650" class="id">reg1</span></span></a> <a id="reg2:649" class="idref" href="#reg2:649"><span class="id" title="binder"><span id="reg2:651" class="id">reg2</span></span></a>:<a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#reg1:648"><span class="id" title="variable">reg1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg2:649"><span class="id" title="variable">reg2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg1:648"><span class="id" title="variable">reg1</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg2:649"><span class="id" title="variable">reg2</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">intros</span> * -&gt;; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">Hu</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HH</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">lookup_insert</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;{  <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hu</span>. }<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_fail_incl" class="idref" href="#updatePC_fail_incl"><span class="id" title="lemma">updatePC_fail_incl</span></a> <a id="m:652" class="idref" href="#m:652"><span class="id" title="binder">m</span></a> <a id="m':653" class="idref" href="#m':653"><span class="id" title="binder">m'</span></a> <a id="regs:654" class="idref" href="#regs:654"><span class="id" title="binder">regs</span></a> <a id="regs':655" class="idref" href="#regs':655"><span class="id" title="binder">regs'</span></a> <a id="etbl:656" class="idref" href="#etbl:656"><span class="id" title="binder">etbl</span></a> <a id="etbl':657" class="idref" href="#etbl':657"><span class="id" title="binder">etbl'</span></a> <a id="ecur:658" class="idref" href="#ecur:658"><span class="id" title="binder">ecur</span></a> <a id="ecur':659" class="idref" href="#ecur':659"><span class="id" title="binder">ecur'</span></a>  :<br/>
&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#regs:654"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:654"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':655"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:654"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:652"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:656"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:658"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs':655"><span class="id" title="variable">regs'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':653"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':657"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':659"><span class="id" title="variable">ecur'</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> <span class="id" title="var">HPC</span>] <span class="id" title="var">Hincl</span> <span class="id" title="var">Hfail</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hfail</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">HPC</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfail</span>. <span class="id" title="var">have</span> -&gt; := <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a1</span> | ] |]; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>;[].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">incrementPC_inv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC_Some_inv"><span class="id" title="axiom">incrementPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC_None_inv"><span class="id" title="axiom">incrementPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_incrementPC" class="idref" href="#updatePC_incrementPC"><span class="id" title="lemma">updatePC_incrementPC</span></a> {<a id="4dc2fc6424f379077deb5456585f153b" class="idref" href="#4dc2fc6424f379077deb5456585f153b"><span class="id" title="binder">φ</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4dc2fc6424f379077deb5456585f153b"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="r':661" class="idref" href="#r':661"><span class="id" title="binder">r'</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4dc2fc6424f379077deb5456585f153b"><span class="id" title="variable">φ</span></a>) <span class="id" title="notation">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4dc2fc6424f379077deb5456585f153b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r':661"><span class="id" title="variable">r'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a>, <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a>, <a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;incrementLPC&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incrementLPC" class="idref" href="#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> (<a id="regs:662" class="idref" href="#regs:662"><span class="id" title="binder">regs</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:662"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a'</span> <span class="id" title="var">v</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_incrementPC_some&nbsp;regs&nbsp;regs'&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;Some&nbsp;regs'&nbsp;-&gt;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementPC&nbsp;(lreg_strip&nbsp;regs)&nbsp;=&nbsp;Some&nbsp;(lreg_strip&nbsp;regs').&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/incrementPC&nbsp;/incrementLPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intros&nbsp;Hlpc.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/lreg_strip&nbsp;lookup_fmap;&nbsp;cbn.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(regs&nbsp;!!&nbsp;PC)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">lw</span>|</span>&nbsp;eqn:Heq&nbsp;;&nbsp;rewrite&nbsp;Heq;&nbsp;cbn&nbsp;in&nbsp;*;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct_lword&nbsp;lw;&nbsp;cbn&nbsp;in&nbsp;*;&nbsp;try&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;simplify_eq.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;rewrite&nbsp;fmap_insert.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_incrementPC_none&nbsp;regs&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;None&nbsp;&lt;-&gt;&nbsp;incrementPC&nbsp;(lreg_strip&nbsp;regs)&nbsp;=&nbsp;None.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intros.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/incrementPC&nbsp;/incrementLPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/lreg_strip&nbsp;lookup_fmap;&nbsp;cbn.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(regs&nbsp;!!&nbsp;PC)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">LX</span>|</span>&nbsp;eqn:Heq&nbsp;;&nbsp;rewrite&nbsp;Heq;&nbsp;cbn;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;LX&nbsp;;&nbsp;cbn&nbsp;;&nbsp;<span class="inlinecode">(<span class="id" title="tactic">clear</span>;</span> <span class="inlinecode"><span class="id" title="tactic">firstorder</span>)</span> <span class="inlinecode">|</span> <span class="inlinecode">|</span> <span class="inlinecode">(<span class="id" title="tactic">clear</span>;</span> <span class="inlinecode"><span class="id" title="tactic">firstorder</span>)</span>.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;sb&nbsp;as&nbsp;<span class="inlinecode">?</span> <span class="inlinecode">?</span> <span class="inlinecode">?</span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode">|</span> <span class="inlinecode"></span>&nbsp;;&nbsp;eauto;&nbsp;cbn;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(a'&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_fail_updatePC&nbsp;regs&nbsp;m&nbsp;etbl&nbsp;ecur:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;None&nbsp;-&gt;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;updatePC&nbsp;{|&nbsp;reg&nbsp;:=&nbsp;(lreg_strip&nbsp;regs);&nbsp;mem&nbsp;:=&nbsp;m;&nbsp;etable&nbsp;:=&nbsp;etbl&nbsp;;&nbsp;enumcur&nbsp;:=&nbsp;ecur&nbsp;|}&nbsp;=&nbsp;None.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intro&nbsp;Hincr.&nbsp;apply&nbsp;incrementLPC_incrementPC_none&nbsp;in&nbsp;Hincr.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;apply&nbsp;incrementPC_fail_updatePC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementLPC_Some_inv" class="idref" href="#incrementLPC_Some_inv"><span class="id" title="lemma">incrementLPC_Some_inv</span></a> <a id="lregs:663" class="idref" href="#lregs:663"><span class="id" title="binder">lregs</span></a> <a id="lregs':664" class="idref" href="#lregs':664"><span class="id" title="binder">lregs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:663"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs':664"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:665" class="idref" href="#p:665"><span class="id" title="binder">p</span></a> <a id="b:666" class="idref" href="#b:666"><span class="id" title="binder">b</span></a> <a id="e:667" class="idref" href="#e:667"><span class="id" title="binder">e</span></a> <a id="a:668" class="idref" href="#a:668"><span class="id" title="binder">a</span></a> <a id="v:669" class="idref" href="#v:669"><span class="id" title="binder">v</span></a> <a id="a':670" class="idref" href="#a':670"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:663"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:665"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:666"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:667"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:668"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:669"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:668"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':670"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs':664"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:665"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:666"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:667"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':670"><span class="id" title="variable">a'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:669"><span class="id" title="variable">v</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> ? | ] | ] | ]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 6 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementLPC_None_inv" class="idref" href="#incrementLPC_None_inv"><span class="id" title="lemma">incrementLPC_None_inv</span></a> <a id="lregs:671" class="idref" href="#lregs:671"><span class="id" title="binder">lregs</span></a> <a id="pg:672" class="idref" href="#pg:672"><span class="id" title="binder">pg</span></a> <a id="b:673" class="idref" href="#b:673"><span class="id" title="binder">b</span></a> <a id="e:674" class="idref" href="#e:674"><span class="id" title="binder">e</span></a> <a id="a:675" class="idref" href="#a:675"><span class="id" title="binder">a</span></a> <a id="v:676" class="idref" href="#v:676"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:671"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:671"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pg:672"><span class="id" title="variable">pg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:673"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:674"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:675"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:676"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:675"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> ? | ] | ] |]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_success_updatePC&nbsp;regs&nbsp;m&nbsp;etbl&nbsp;ecur&nbsp;regs'&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;Some&nbsp;regs'&nbsp;-&gt;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;∃&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;a'&nbsp;(v&nbsp;:&nbsp;Version),&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regs&nbsp;!!&nbsp;PC&nbsp;=&nbsp;Some&nbsp;(LCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;v)&nbsp;∧&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updatePC&nbsp;{|&nbsp;reg&nbsp;:=&nbsp;(lreg_strip&nbsp;regs);&nbsp;mem&nbsp;:=&nbsp;m;&nbsp;etable&nbsp;:=&nbsp;etbl&nbsp;;&nbsp;enumcur&nbsp;:=&nbsp;ecur&nbsp;|}&nbsp;=&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;(NextI,&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|&nbsp;reg&nbsp;:=&nbsp;(&lt;<span class="inlinecode"><span class="id" title="var">PC</span>:=<span class="id" title="var">WCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span>&gt;&nbsp;(lreg_strip&nbsp;regs));&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mem&nbsp;:=&nbsp;m;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;etable&nbsp;:=&nbsp;etbl&nbsp;;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enumcur&nbsp;:=&nbsp;ecur&nbsp;|})&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧&nbsp;regs'&nbsp;=&nbsp;&lt;<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">PC</span></span> <span class="inlinecode">:=</span> <span class="inlinecode">(<span class="id" title="var">LCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">v</span>)</span> <span class="inlinecode"></span>&gt;&nbsp;regs.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intro&nbsp;Hincr.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;opose&nbsp;proof&nbsp;(incrementLPC_incrementPC_some&nbsp;_&nbsp;_&nbsp;Hincr)&nbsp;as&nbsp;HincrPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;eapply&nbsp;(incrementPC_success_updatePC&nbsp;_&nbsp;m&nbsp;etbl&nbsp;ecur)&nbsp;in&nbsp;HincrPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;HincrPC&nbsp;as&nbsp;(p'&amp;b'&amp;e'&amp;a''&amp;a'''&amp;Hregs&amp;Heq&amp;Hupd&amp;Hregseq).&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/incrementLPC&nbsp;in&nbsp;Hincr.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(regs&nbsp;!!&nbsp;PC)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">wpc</span></span> <span class="inlinecode">|</span>;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct_lword&nbsp;wpc;&nbsp;try&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/lreg_strip&nbsp;fmap_insert&nbsp;//=&nbsp;-/(lreg_strip&nbsp;regs)&nbsp;&nbsp;in&nbsp;Hregseq.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;exists&nbsp;p,&nbsp;b,&nbsp;e,&nbsp;a,&nbsp;a',&nbsp;v.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;repeat&nbsp;(split;&nbsp;try&nbsp;done).&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;rewrite&nbsp;Hupd&nbsp;Hregseq.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">incrementLPC_inv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_Some_inv"><span class="id" title="axiom">incrementLPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_None_inv"><span class="id" title="axiom">incrementLPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "incrementLPC_inv" "as" <span class="id" title="var">simple_intropattern</span>(<span class="id" title="var">pat</span>):=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_Some_inv"><span class="id" title="axiom">incrementLPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">pat</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_None_inv"><span class="id" title="axiom">incrementLPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_rules_opt" class="idref" href="#cap_lang_rules_opt"><span class="id" title="section">cap_lang_rules_opt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:677" class="idref" href="#H:677"><span class="id" title="binder">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H0:679" class="idref" href="#H0:679"><span class="id" title="binder">memG</span></a> <a id="27085762ad9bdfb8aca026432c4225fc" class="idref" href="#27085762ad9bdfb8aca026432c4225fc"><span class="id" title="binder"><span id="H0:679" class="id">Σ</span></span></a>, <a id="H1:680" class="idref" href="#H1:680"><span class="id" title="binder">regG</span></a> <a id="H1:680" class="idref" href="#H1:680"><span class="id" title="binder">Σ</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">c</span> : <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">la</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lw</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lregs</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">mem</span> : <a class="idref" href="cap_machine.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lmem</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="wp_opt" class="idref" href="#wp_opt"><span class="id" title="definition">wp_opt</span></a> {<a id="A:681" class="idref" href="#A:681"><span class="id" title="binder">A</span></a>} (<a id="a5a5c5f2e850e476144e944c3cbd1280" class="idref" href="#a5a5c5f2e850e476144e944c3cbd1280"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:681"><span class="id" title="variable">A</span></a>) (<a id="bd7869f751ac81ac608fea00490611dd" class="idref" href="#bd7869f751ac81ac608fea00490611dd"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="0888a657d3a9ee0b5e3e82b90bc7d406" class="idref" href="#0888a657d3a9ee0b5e3e82b90bc7d406"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:681"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#a5a5c5f2e850e476144e944c3cbd1280"><span class="id" title="variable">φ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#bd7869f751ac81ac608fea00490611dd"><span class="id" title="variable">Φf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> φ' =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#0888a657d3a9ee0b5e3e82b90bc7d406"><span class="id" title="variable">Φs</span></a> φ'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_unfold" class="idref" href="#wp_opt_unfold"><span class="id" title="lemma">wp_opt_unfold</span></a> {<a id="A:686" class="idref" href="#A:686"><span class="id" title="binder">A</span></a>} {<a id="8322dbf19d29c163e57ab86a805019f4" class="idref" href="#8322dbf19d29c163e57ab86a805019f4"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:686"><span class="id" title="variable">A</span></a>} {<a id="42032cfe311fc1f8c595df53000833e6" class="idref" href="#42032cfe311fc1f8c595df53000833e6"><span class="id" title="binder">Φf</span></a> <a id="f9726a59638519761bcd4bd06f983fe7" class="idref" href="#f9726a59638519761bcd4bd06f983fe7"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#8322dbf19d29c163e57ab86a805019f4"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#42032cfe311fc1f8c595df53000833e6"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:690" class="idref" href="#x:690"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#8322dbf19d29c163e57ab86a805019f4"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:690"><span class="id" title="variable">x</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#f9726a59638519761bcd4bd06f983fe7"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:690"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8322dbf19d29c163e57ab86a805019f4"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#42032cfe311fc1f8c595df53000833e6"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f9726a59638519761bcd4bd06f983fe7"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; [<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>| <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_eqn" class="idref" href="#wp_opt_eqn"><span class="id" title="lemma">wp_opt_eqn</span></a> {<a id="A:691" class="idref" href="#A:691"><span class="id" title="binder">A</span></a>} (<a id="b38939d801c0ffa113b5ccd438e801d5" class="idref" href="#b38939d801c0ffa113b5ccd438e801d5"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:691"><span class="id" title="variable">A</span></a>) (<a id="d4cb417b9e4708f87a3671efc0d963bd" class="idref" href="#d4cb417b9e4708f87a3671efc0d963bd"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="95fb7d826a578333f4460c0a130687f8" class="idref" href="#95fb7d826a578333f4460c0a130687f8"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:691"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b38939d801c0ffa113b5ccd438e801d5"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d4cb417b9e4708f87a3671efc0d963bd"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x:695" class="idref" href="#x:695"><span class="id" title="binder">x</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#b38939d801c0ffa113b5ccd438e801d5"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:695"><span class="id" title="variable">x</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#95fb7d826a578333f4460c0a130687f8"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:695"><span class="id" title="variable">x</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b38939d801c0ffa113b5ccd438e801d5"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d4cb417b9e4708f87a3671efc0d963bd"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#95fb7d826a578333f4460c0a130687f8"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="var">cbn</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_is_Some" class="idref" href="#wp_opt_is_Some"><span class="id" title="lemma">wp_opt_is_Some</span></a> {<a id="A:696" class="idref" href="#A:696"><span class="id" title="binder">A</span></a> <a id="797ef5f97313a1727e073e5d02cd2709" class="idref" href="#797ef5f97313a1727e073e5d02cd2709"><span class="id" title="binder">Φs</span></a> <a id="0fe3b26f12ad56a0258297d6d006b881" class="idref" href="#0fe3b26f12ad56a0258297d6d006b881"><span class="id" title="binder">Φf</span></a>} {<a id="299d2b93ff02ce2e97669bb80cb962ac" class="idref" href="#299d2b93ff02ce2e97669bb80cb962ac"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:696"><span class="id" title="variable">A</span></a>} : <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#299d2b93ff02ce2e97669bb80cb962ac"><span class="id" title="variable">φ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#299d2b93ff02ce2e97669bb80cb962ac"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0fe3b26f12ad56a0258297d6d006b881"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#797ef5f97313a1727e073e5d02cd2709"><span class="id" title="variable">Φs</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#299d2b93ff02ce2e97669bb80cb962ac"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">False</span> <a class="idref" href="cap_machine.rules.rules_base.html#797ef5f97313a1727e073e5d02cd2709"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_univ" class="idref" href="#wp_opt_univ"><span class="id" title="lemma">wp_opt_univ</span></a> {<a id="A:700" class="idref" href="#A:700"><span class="id" title="binder">A</span></a> <a id="605a2a6c1e0937e75e7663061b0fe11c" class="idref" href="#605a2a6c1e0937e75e7663061b0fe11c"><span class="id" title="binder">Φs</span></a>} {<a id="de0c2f0c74fbc61a3cb87962fd0c212e" class="idref" href="#de0c2f0c74fbc61a3cb87962fd0c212e"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:700"><span class="id" title="variable">A</span></a>} : <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:703" class="idref" href="#x:703"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#605a2a6c1e0937e75e7663061b0fe11c"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:703"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#de0c2f0c74fbc61a3cb87962fd0c212e"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">True</span> <a class="idref" href="cap_machine.rules.rules_base.html#605a2a6c1e0937e75e7663061b0fe11c"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> φ.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_bind" class="idref" href="#wp_opt_bind"><span class="id" title="lemma">wp_opt_bind</span></a> {<a id="A:704" class="idref" href="#A:704"><span class="id" title="binder">A</span></a> <a id="B:705" class="idref" href="#B:705"><span class="id" title="binder">B</span></a>} {<a id="179d7294f501887fc63942486b154ede" class="idref" href="#179d7294f501887fc63942486b154ede"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:704"><span class="id" title="variable">A</span></a>} {<a id="K:707" class="idref" href="#K:707"><span class="id" title="binder">K</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:704"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B:705"><span class="id" title="variable">B</span></a>} {<a id="4b4a3c618d5344ba724a75a2e8b68ae9" class="idref" href="#4b4a3c618d5344ba724a75a2e8b68ae9"><span class="id" title="binder">Φf</span></a> <a id="05056f3bc81e52cc24bec841c4761268" class="idref" href="#05056f3bc81e52cc24bec841c4761268"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#179d7294f501887fc63942486b154ede"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4b4a3c618d5344ba724a75a2e8b68ae9"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="f7c96f4780ade15e3c9a170685110383" class="idref" href="#f7c96f4780ade15e3c9a170685110383"><span class="id" title="binder">φ'</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#K:707"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f7c96f4780ade15e3c9a170685110383"><span class="id" title="variable">φ'</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#4b4a3c618d5344ba724a75a2e8b68ae9"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#05056f3bc81e52cc24bec841c4761268"><span class="id" title="variable">Φs</span></a>) <span class="id" title="notation">⊣⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#179d7294f501887fc63942486b154ede"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">≫=</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:707"><span class="id" title="variable">K</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#4b4a3c618d5344ba724a75a2e8b68ae9"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#05056f3bc81e52cc24bec841c4761268"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_mono" class="idref" href="#wp_opt_mono"><span class="id" title="lemma">wp_opt_mono</span></a> {<a id="A:711" class="idref" href="#A:711"><span class="id" title="binder">A</span></a>} {<a id="m:712" class="idref" href="#m:712"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:711"><span class="id" title="variable">A</span></a>} {<a id="b62ab8d95492b1772f0f5860bd5dc350" class="idref" href="#b62ab8d95492b1772f0f5860bd5dc350"><span class="id" title="binder">Φf</span></a> <a id="4bdd0cda6421de0398ce465a1e021c7e" class="idref" href="#4bdd0cda6421de0398ce465a1e021c7e"><span class="id" title="binder">Φs1</span></a> <a id="0e402aa86a1e0b6a74b0ddd63b245d8e" class="idref" href="#0e402aa86a1e0b6a74b0ddd63b245d8e"><span class="id" title="binder">Φs2</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:716" class="idref" href="#x:716"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#4bdd0cda6421de0398ce465a1e021c7e"><span class="id" title="variable">Φs1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:716"><span class="id" title="variable">x</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#0e402aa86a1e0b6a74b0ddd63b245d8e"><span class="id" title="variable">Φs2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:716"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#m:712"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b62ab8d95492b1772f0f5860bd5dc350"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4bdd0cda6421de0398ce465a1e021c7e"><span class="id" title="variable">Φs1</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#m:712"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b62ab8d95492b1772f0f5860bd5dc350"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0e402aa86a1e0b6a74b0ddd63b245d8e"><span class="id" title="variable">Φs2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(HΦs &amp; Hwp)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "HΦs".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="wp_opt2" class="idref" href="#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> {<a id="A1:717" class="idref" href="#A1:717"><span class="id" title="binder">A1</span></a> <a id="A2:718" class="idref" href="#A2:718"><span class="id" title="binder">A2</span></a>} <a id="Ep:719" class="idref" href="#Ep:719"><span class="id" title="binder">Ep</span></a> (<a id="8b65fd6dac88c31513ab0f44ad62271e" class="idref" href="#8b65fd6dac88c31513ab0f44ad62271e"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:717"><span class="id" title="variable">A1</span></a>) (<a id="980a85ef475d43fbba440e6150771588" class="idref" href="#980a85ef475d43fbba440e6150771588"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:718"><span class="id" title="variable">A2</span></a>) (<a id="95dcd0cd821e24345191f806e6956c66" class="idref" href="#95dcd0cd821e24345191f806e6956c66"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="11392f1d3e111780b6d8186896d7a1ec" class="idref" href="#11392f1d3e111780b6d8186896d7a1ec"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:717"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:718"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#8b65fd6dac88c31513ab0f44ad62271e"><span class="id" title="variable">φ1</span></a> , <a class="idref" href="cap_machine.rules.rules_base.html#980a85ef475d43fbba440e6150771588"><span class="id" title="variable">φ2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> , <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:719"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#95dcd0cd821e24345191f806e6956c66"><span class="id" title="variable">Φf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x1</span> , <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x2</span> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:719"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#11392f1d3e111780b6d8186896d7a1ec"><span class="id" title="variable">Φs</span></a> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:719"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <span class="id" title="notation">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_diag_univ" class="idref" href="#wp2_diag_univ"><span class="id" title="lemma">wp2_diag_univ</span></a> {<a id="A:726" class="idref" href="#A:726"><span class="id" title="binder">A</span></a>} {<a id="d812d9413124a8b9cde461ed77036fa4" class="idref" href="#d812d9413124a8b9cde461ed77036fa4"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:726"><span class="id" title="variable">A</span></a>} {<a id="Ep:728" class="idref" href="#Ep:728"><span class="id" title="binder">Ep</span></a> <a id="e3c9bf02377fbd6118cd08b8c2b27fef" class="idref" href="#e3c9bf02377fbd6118cd08b8c2b27fef"><span class="id" title="binder">Φf</span></a>} {<a id="507615542346c16c333045d76bae469b" class="idref" href="#507615542346c16c333045d76bae469b"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:726"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:726"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#e3c9bf02377fbd6118cd08b8c2b27fef"><span class="id" title="variable">Φf</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:731" class="idref" href="#x:731"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#507615542346c16c333045d76bae469b"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:731"><span class="id" title="variable">x</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:731"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:728"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d812d9413124a8b9cde461ed77036fa4"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d812d9413124a8b9cde461ed77036fa4"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e3c9bf02377fbd6118cd08b8c2b27fef"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#507615542346c16c333045d76bae469b"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; [<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span> | <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_wp2" class="idref" href="#wp_wp2"><span class="id" title="lemma">wp_wp2</span></a> {<a id="Ep:732" class="idref" href="#Ep:732"><span class="id" title="binder">Ep</span></a> <a id="A1:733" class="idref" href="#A1:733"><span class="id" title="binder">A1</span></a> <a id="A2:734" class="idref" href="#A2:734"><span class="id" title="binder">A2</span></a>} {<a id="3592633beaf64a64ed89a89d2e097ca6" class="idref" href="#3592633beaf64a64ed89a89d2e097ca6"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:733"><span class="id" title="variable">A1</span></a>} {<a id="44ae6912827cc6f02a80529f2accea93" class="idref" href="#44ae6912827cc6f02a80529f2accea93"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:734"><span class="id" title="variable">A2</span></a>} {<a id="3a22a7103dbbf0d981288b49d58481e5" class="idref" href="#3a22a7103dbbf0d981288b49d58481e5"><span class="id" title="binder">Φf</span></a> <a id="11439f318315556bc6059fb008b6f457" class="idref" href="#11439f318315556bc6059fb008b6f457"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:732"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3592633beaf64a64ed89a89d2e097ca6"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#44ae6912827cc6f02a80529f2accea93"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3a22a7103dbbf0d981288b49d58481e5"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:739" class="idref" href="#x1:739"><span class="id" title="binder">x1</span></a> <a id="x2:740" class="idref" href="#x2:740"><span class="id" title="binder">x2</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#11439f318315556bc6059fb008b6f457"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:740"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#44ae6912827cc6f02a80529f2accea93"><span class="id" title="variable">φ2</span></a> (<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:732"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#3a22a7103dbbf0d981288b49d58481e5"><span class="id" title="variable">Φf</span></a>) (<span class="id" title="keyword">fun</span> <a id="x:741" class="idref" href="#x:741"><span class="id" title="binder">x</span></a> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:732"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#11439f318315556bc6059fb008b6f457"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:741"><span class="id" title="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1 , φ2; <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> "Hk" <span class="id" title="keyword">as</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_val" class="idref" href="#wp2_val"><span class="id" title="lemma">wp2_val</span></a> {<a id="A1:742" class="idref" href="#A1:742"><span class="id" title="binder">A1</span></a> <a id="A2:743" class="idref" href="#A2:743"><span class="id" title="binder">A2</span></a>} {<a id="x1:744" class="idref" href="#x1:744"><span class="id" title="binder">x1</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:742"><span class="id" title="variable">A1</span></a>} {<a id="x2:745" class="idref" href="#x2:745"><span class="id" title="binder">x2</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A2:743"><span class="id" title="variable">A2</span></a>} {<a id="0525d0ffa33bc8af865599a1fe8b054f" class="idref" href="#0525d0ffa33bc8af865599a1fe8b054f"><span class="id" title="binder">Φf</span></a> <a id="0eddbacd93afaaf5568e6d2ed5c1eee0" class="idref" href="#0eddbacd93afaaf5568e6d2ed5c1eee0"><span class="id" title="binder">Φs</span></a> <a id="Ep:748" class="idref" href="#Ep:748"><span class="id" title="binder">Ep</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:748"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#0eddbacd93afaaf5568e6d2ed5c1eee0"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:744"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:745"><span class="id" title="variable">x2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:748"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:744"><span class="id" title="variable">x1</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:745"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#0525d0ffa33bc8af865599a1fe8b054f"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0eddbacd93afaaf5568e6d2ed5c1eee0"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_eqn" class="idref" href="#wp_opt2_eqn"><span class="id" title="lemma">wp_opt2_eqn</span></a> {<a id="Ep:749" class="idref" href="#Ep:749"><span class="id" title="binder">Ep</span></a>} {<a id="A1:750" class="idref" href="#A1:750"><span class="id" title="binder">A1</span></a> <a id="A2:751" class="idref" href="#A2:751"><span class="id" title="binder">A2</span></a>} {<a id="a45e76df7c357ff43662efb36f43056f" class="idref" href="#a45e76df7c357ff43662efb36f43056f"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:750"><span class="id" title="variable">A1</span></a>} {<a id="fb9c7434e98e76f3786ee1a5408b8399" class="idref" href="#fb9c7434e98e76f3786ee1a5408b8399"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:751"><span class="id" title="variable">A2</span></a>} (<a id="4c791ba4b202c9ea42072ada0d061f22" class="idref" href="#4c791ba4b202c9ea42072ada0d061f22"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="675773e304a63e8e31e28f230007832a" class="idref" href="#675773e304a63e8e31e28f230007832a"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:750"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:751"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:749"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a45e76df7c357ff43662efb36f43056f"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fb9c7434e98e76f3786ee1a5408b8399"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4c791ba4b202c9ea42072ada0d061f22"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:756" class="idref" href="#x1:756"><span class="id" title="binder">x1</span></a> <a id="x2:757" class="idref" href="#x2:757"><span class="id" title="binder">x2</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#a45e76df7c357ff43662efb36f43056f"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:756"><span class="id" title="variable">x1</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#fb9c7434e98e76f3786ee1a5408b8399"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:757"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#675773e304a63e8e31e28f230007832a"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:756"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:757"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:749"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a45e76df7c357ff43662efb36f43056f"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fb9c7434e98e76f3786ee1a5408b8399"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4c791ba4b202c9ea42072ada0d061f22"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#675773e304a63e8e31e28f230007832a"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_eqn_both" class="idref" href="#wp_opt2_eqn_both"><span class="id" title="lemma">wp_opt2_eqn_both</span></a> {<a id="Ep:758" class="idref" href="#Ep:758"><span class="id" title="binder">Ep</span></a>} {<a id="A1:759" class="idref" href="#A1:759"><span class="id" title="binder">A1</span></a> <a id="A2:760" class="idref" href="#A2:760"><span class="id" title="binder">A2</span></a>} {<a id="cccc457c47f33964aa7d3d862b4b1aa2" class="idref" href="#cccc457c47f33964aa7d3d862b4b1aa2"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:759"><span class="id" title="variable">A1</span></a>} {<a id="500adc83f259b663e973c9155926050a" class="idref" href="#500adc83f259b663e973c9155926050a"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:760"><span class="id" title="variable">A2</span></a>} (<a id="42634ea9538600b5ffbfafec14500d8d" class="idref" href="#42634ea9538600b5ffbfafec14500d8d"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="df896dac154867aadb8ff9d79f3b9a59" class="idref" href="#df896dac154867aadb8ff9d79f3b9a59"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:759"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:760"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:758"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cccc457c47f33964aa7d3d862b4b1aa2"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#500adc83f259b663e973c9155926050a"><span class="id" title="variable">φ2</span></a> (<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#cccc457c47f33964aa7d3d862b4b1aa2"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#500adc83f259b663e973c9155926050a"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#42634ea9538600b5ffbfafec14500d8d"><span class="id" title="variable">Φf</span></a>) (<span class="id" title="keyword">fun</span> <a id="x1:765" class="idref" href="#x1:765"><span class="id" title="binder">x1</span></a> <a id="x2:766" class="idref" href="#x2:766"><span class="id" title="binder">x2</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#cccc457c47f33964aa7d3d862b4b1aa2"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:765"><span class="id" title="variable">x1</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#500adc83f259b663e973c9155926050a"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:766"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#df896dac154867aadb8ff9d79f3b9a59"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:765"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:766"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:758"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cccc457c47f33964aa7d3d862b4b1aa2"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#500adc83f259b663e973c9155926050a"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#42634ea9538600b5ffbfafec14500d8d"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df896dac154867aadb8ff9d79f3b9a59"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_mod" class="idref" href="#wp_opt2_mod"><span class="id" title="lemma">wp_opt2_mod</span></a> {<a id="Ep:767" class="idref" href="#Ep:767"><span class="id" title="binder">Ep</span></a>} {<a id="A1:768" class="idref" href="#A1:768"><span class="id" title="binder">A1</span></a> <a id="A2:769" class="idref" href="#A2:769"><span class="id" title="binder">A2</span></a>} {<a id="7fb69c83f2a5a49f483c4390213b4b13" class="idref" href="#7fb69c83f2a5a49f483c4390213b4b13"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:768"><span class="id" title="variable">A1</span></a>} {<a id="71e4259f97a49456c26e43a7637264fa" class="idref" href="#71e4259f97a49456c26e43a7637264fa"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:769"><span class="id" title="variable">A2</span></a>} {<a id="c8feeff11af940a99081b226f4898474" class="idref" href="#c8feeff11af940a99081b226f4898474"><span class="id" title="binder">Φf</span></a> <a id="84c11147170cc65b748f3ad23ad7d4ef" class="idref" href="#84c11147170cc65b748f3ad23ad7d4ef"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:767"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:767"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7fb69c83f2a5a49f483c4390213b4b13"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#71e4259f97a49456c26e43a7637264fa"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c8feeff11af940a99081b226f4898474"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#84c11147170cc65b748f3ad23ad7d4ef"><span class="id" title="variable">Φs</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:767"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7fb69c83f2a5a49f483c4390213b4b13"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#71e4259f97a49456c26e43a7637264fa"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c8feeff11af940a99081b226f4898474"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#84c11147170cc65b748f3ad23ad7d4ef"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "&gt;H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_bind" class="idref" href="#wp_opt2_bind"><span class="id" title="lemma">wp_opt2_bind</span></a> {<a id="Ep:774" class="idref" href="#Ep:774"><span class="id" title="binder">Ep</span></a>} {<a id="A1:775" class="idref" href="#A1:775"><span class="id" title="binder">A1</span></a> <a id="A2:776" class="idref" href="#A2:776"><span class="id" title="binder">A2</span></a>} {<a id="B1:777" class="idref" href="#B1:777"><span class="id" title="binder">B1</span></a> <a id="B2:778" class="idref" href="#B2:778"><span class="id" title="binder">B2</span></a>} {<a id="ebc2605e4a0c57c3710b3c9b5c985af7" class="idref" href="#ebc2605e4a0c57c3710b3c9b5c985af7"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:775"><span class="id" title="variable">A1</span></a>} {<a id="66e0daf9d3f9778f47d923ad83407203" class="idref" href="#66e0daf9d3f9778f47d923ad83407203"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:776"><span class="id" title="variable">A2</span></a>} {<a id="k1:781" class="idref" href="#k1:781"><span class="id" title="binder">k1</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:775"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B1:777"><span class="id" title="variable">B1</span></a>} {<a id="k2:782" class="idref" href="#k2:782"><span class="id" title="binder">k2</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A2:776"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B2:778"><span class="id" title="variable">B2</span></a>} {<a id="6299affca1b36588262ae7cfdfef6189" class="idref" href="#6299affca1b36588262ae7cfdfef6189"><span class="id" title="binder">Φf</span></a> <a id="0ca7c01eb0a080745de717a36b78bb28" class="idref" href="#0ca7c01eb0a080745de717a36b78bb28"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:774"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ebc2605e4a0c57c3710b3c9b5c985af7"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#66e0daf9d3f9778f47d923ad83407203"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6299affca1b36588262ae7cfdfef6189"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:785" class="idref" href="#x1:785"><span class="id" title="binder">x1</span></a> <a id="x2:786" class="idref" href="#x2:786"><span class="id" title="binder">x2</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:774"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#k1:781"><span class="id" title="variable">k1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:785"><span class="id" title="variable">x1</span></a>) (<a class="idref" href="cap_machine.rules.rules_base.html#k2:782"><span class="id" title="variable">k2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:786"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#6299affca1b36588262ae7cfdfef6189"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0ca7c01eb0a080745de717a36b78bb28"><span class="id" title="variable">Φs</span></a>) <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:774"><span class="id" title="variable">Ep</span></a> (<a id="x1:788" class="idref" href="#x1:788"><span class="id" title="binder">x1</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#ebc2605e4a0c57c3710b3c9b5c985af7"><span class="id" title="variable">φ1</span></a> <span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#k1:781"><span class="id" title="variable">k1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:788"><span class="id" title="variable">x1</span></a>) (<a id="x2:787" class="idref" href="#x2:787"><span class="id" title="binder">x2</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#66e0daf9d3f9778f47d923ad83407203"><span class="id" title="variable">φ2</span></a> <span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#k2:782"><span class="id" title="variable">k2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:787"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#6299affca1b36588262ae7cfdfef6189"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0ca7c01eb0a080745de717a36b78bb28"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_mod"><span class="id" title="axiom">wp_opt2_mod</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> "Hk" <span class="id" title="keyword">as</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_mono" class="idref" href="#wp_opt2_mono"><span class="id" title="lemma">wp_opt2_mono</span></a> {<a id="Ep:789" class="idref" href="#Ep:789"><span class="id" title="binder">Ep</span></a>} {<a id="A1:790" class="idref" href="#A1:790"><span class="id" title="binder">A1</span></a> <a id="A2:791" class="idref" href="#A2:791"><span class="id" title="binder">A2</span></a>} {<a id="6ea9a7528dd9e54c6722b68e753b8200" class="idref" href="#6ea9a7528dd9e54c6722b68e753b8200"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:790"><span class="id" title="variable">A1</span></a>} {<a id="bfc792fd7112e17ea5c37f1a8b5a24ee" class="idref" href="#bfc792fd7112e17ea5c37f1a8b5a24ee"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:791"><span class="id" title="variable">A2</span></a>} {<a id="b4f9792d72a08774293cf360d5edfc7c" class="idref" href="#b4f9792d72a08774293cf360d5edfc7c"><span class="id" title="binder">Φf</span></a> <a id="d85dc0a647ab885d1163425c3edf1afd" class="idref" href="#d85dc0a647ab885d1163425c3edf1afd"><span class="id" title="binder">Φsa</span></a> <a id="04f627edeb93ae1d289aeb03f520e4fa" class="idref" href="#04f627edeb93ae1d289aeb03f520e4fa"><span class="id" title="binder">Φsb</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x1:797" class="idref" href="#x1:797"><span class="id" title="binder">x1</span></a> <a id="x2:798" class="idref" href="#x2:798"><span class="id" title="binder">x2</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#d85dc0a647ab885d1163425c3edf1afd"><span class="id" title="variable">Φsa</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:797"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:798"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#04f627edeb93ae1d289aeb03f520e4fa"><span class="id" title="variable">Φsb</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:797"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:798"><span class="id" title="variable">x2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:789"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6ea9a7528dd9e54c6722b68e753b8200"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bfc792fd7112e17ea5c37f1a8b5a24ee"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b4f9792d72a08774293cf360d5edfc7c"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d85dc0a647ab885d1163425c3edf1afd"><span class="id" title="variable">Φsa</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:789"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6ea9a7528dd9e54c6722b68e753b8200"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bfc792fd7112e17ea5c37f1a8b5a24ee"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b4f9792d72a08774293cf360d5edfc7c"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#04f627edeb93ae1d289aeb03f520e4fa"><span class="id" title="variable">Φsb</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="var">iIntros</span> "(Hab &amp; Hwp)"; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hab".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_instr_exec_opt" class="idref" href="#wp_instr_exec_opt"><span class="id" title="lemma">wp_instr_exec_opt</span></a> {<a id="s:799" class="idref" href="#s:799"><span class="id" title="binder">s</span></a> <a id="E:800" class="idref" href="#E:800"><span class="id" title="binder">E</span></a> <a id="e2d6cba2ddacaa4a086301cf2a613497" class="idref" href="#e2d6cba2ddacaa4a086301cf2a613497"><span class="id" title="binder">Φ</span></a> <a id="pc_a:802" class="idref" href="#pc_a:802"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:803" class="idref" href="#pc_v:803"><span class="id" title="binder">pc_v</span></a> <a id="dq:804" class="idref" href="#dq:804"><span class="id" title="binder">dq</span></a> <a id="regs:805" class="idref" href="#regs:805"><span class="id" title="binder">regs</span></a> <a id="lw:806" class="idref" href="#lw:806"><span class="id" title="binder">lw</span></a> <a id="pc_p:807" class="idref" href="#pc_p:807"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:808" class="idref" href="#pc_b:808"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:809" class="idref" href="#pc_e:809"><span class="id" title="binder">pc_e</span></a> <a id="instr:810" class="idref" href="#instr:810"><span class="id" title="binder">instr</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:807"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:808"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:809"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:802"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:803"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:805"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:807"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:808"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:809"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:802"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:803"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:806"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:810"><span class="id" title="variable">instr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of"><span class="id" title="definition">regs_of</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:810"><span class="id" title="variable">instr</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:805"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:802"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:803"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:804"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:806"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:811" class="idref" href="#k:811"><span class="id" title="binder"><span id="k:812" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:813" class="idref" href="#y:813"><span class="id" title="binder"><span id="y:814" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:805"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:811"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:813"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="57b2b1058609a9ac686e8f6f5132ba4d" class="idref" href="#57b2b1058609a9ac686e8f6f5132ba4d"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#57b2b1058609a9ac686e8f6f5132ba4d"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:816" class="idref" href="#k:816"><span class="id" title="binder"><span id="k:817" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:818" class="idref" href="#y:818"><span class="id" title="binder"><span id="y:819" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:805"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:816"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:818"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:802"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:803"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:804"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:806"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:800"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="wa:820" class="idref" href="#wa:820"><span class="id" title="binder">wa</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#57b2b1058609a9ac686e8f6f5132ba4d"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:807"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:808"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:809"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:802"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#57b2b1058609a9ac686e8f6f5132ba4d"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:802"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wa:820"><span class="id" title="variable">wa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#isCorrectPC"><span class="id" title="inductive">isCorrectPC</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:807"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:808"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:809"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:802"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#decodeInstrW"><span class="id" title="definition">decodeInstrW</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wa:820"><span class="id" title="variable">wa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:810"><span class="id" title="variable">instr</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:800"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.cap_lang.html#exec_opt"><span class="id" title="definition">exec_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:810"><span class="id" title="variable">instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#57b2b1058609a9ac686e8f6f5132ba4d"><span class="id" title="variable">σ1</span></a>) (<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:800"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#57b2b1058609a9ac686e8f6f5132ba4d"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#e2d6cba2ddacaa4a086301cf2a613497"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> (<a id="c2:821" class="idref" href="#c2:821"><span class="id" title="binder">c2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#Conf"><span class="id" title="definition">Conf</span></a>) =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:800"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=&gt;</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c2:821"><span class="id" title="variable">c2</span></a><span class="id" title="notation">.2</span> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#e2d6cba2ddacaa4a086301cf2a613497"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c2:821"><span class="id" title="variable">c2</span></a><span class="id" title="notation">.1</span>))<span class="id" title="notation">)</span>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:799"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:800"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#e2d6cba2ddacaa4a086301cf2a613497"><span class="id" title="variable">Φ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcorrpc</span> <span class="id" title="var">Hregspc</span> <span class="id" title="var">Hdecode</span> <span class="id" title="var">Hregs_incl</span>) "(&gt;Hcode &amp; &gt;Hregs &amp; H)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_instr_exec"><span class="id" title="axiom">wp_instr_exec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1) "Hσ1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregsincl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">Hregs_pc</span> := <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hregspc</span> <span class="id" title="var">Hregsincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hcode"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlcode</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">Hstep</span>) "Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="notation">{|</span> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="var">reg</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <span class="id" title="var">mem</span>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <span class="id" title="var">etable</span>; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <span class="id" title="var">enumcur</span> <span class="id" title="notation">|}</span> <span class="id" title="notation">with</span> "[Hr Hm $Hregs $Hcode]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;allow&nbsp;changing&nbsp;cur_map?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word_cap"><span class="id" title="axiom">state_corresponds_reg_get_word_cap</span></a> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_correct_PC"><span class="id" title="axiom">state_corresponds_mem_correct_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <span class="id" title="var">lw</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "[%] Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>) <span class="id" title="var">HLinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_get_word"><span class="id" title="axiom">state_corresponds_mem_get_word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span> <span class="id" title="var">lw</span> <span class="id" title="var">HLinv</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a> ; [ <span class="id" title="tactic">apply</span> <span class="id" title="var">HLinv</span> | | | | <span class="id" title="tactic">apply</span> <span class="id" title="var">Hregs_pc</span> | ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.machine_base.html#isCorrectPC_withinBounds"><span class="id" title="axiom">isCorrectPC_withinBounds</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcorrpc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#exec"><span class="id" title="definition">exec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#exec_opt"><span class="id" title="definition">exec_opt</span></a> <span class="id" title="var">instr</span> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="var">reg</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <span class="id" title="var">mem</span>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <span class="id" title="var">etable</span>; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <span class="id" title="var">enumcur</span> |});<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_opt_updatePC&nbsp;{φ&nbsp;Φs&nbsp;Φf&nbsp;w&nbsp;E}:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;reg&nbsp;φ&nbsp;!!&nbsp;PC&nbsp;=&nbsp;Some&nbsp;w&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;a',&nbsp;⌜&nbsp;w&nbsp;=&nbsp;WCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;⌝&nbsp;-∗&nbsp;⌜&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(⌜&nbsp;incrementPC&nbsp;(reg&nbsp;φ)&nbsp;=&nbsp;None&nbsp;⌝&nbsp;-∗&nbsp;Φf)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⊢&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;|={E}=&gt;&nbsp;wp_opt&nbsp;(updatePC&nbsp;φ)&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;updatePC,&nbsp;incrementPC.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(-&gt;)&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;w&nbsp;eqn:Heqw;&nbsp;iFrame;&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;destruct&nbsp;sb&nbsp;eqn:Heqsb;&nbsp;iFrame;&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;destruct&nbsp;(f1&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{rewrite&nbsp;bi.and_elim_l.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;}&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_phys_log_corresponds_update_reg" class="idref" href="#state_phys_log_corresponds_update_reg"><span class="id" title="lemma">state_phys_log_corresponds_update_reg</span></a> {<a id="reg:822" class="idref" href="#reg:822"><span class="id" title="binder">reg</span></a> <a id="mem:823" class="idref" href="#mem:823"><span class="id" title="binder">mem</span></a> <a id="lr:824" class="idref" href="#lr:824"><span class="id" title="binder">lr</span></a> <a id="lm:825" class="idref" href="#lm:825"><span class="id" title="binder">lm</span></a> <a id="cur_map:826" class="idref" href="#cur_map:826"><span class="id" title="binder">cur_map</span></a> <a id="i:827" class="idref" href="#i:827"><span class="id" title="binder">i</span></a> <a id="w:828" class="idref" href="#w:828"><span class="id" title="binder">w</span></a> <a id="lw:829" class="idref" href="#lw:829"><span class="id" title="binder">lw</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:829"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:828"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:829"><span class="id" title="variable">lw</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:826"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg:822"><span class="id" title="variable">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#mem:823"><span class="id" title="variable">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:824"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:825"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:826"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#i:827"><span class="id" title="variable">i</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:828"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">reg</span>) <a class="idref" href="cap_machine.rules.rules_base.html#mem:823"><span class="id" title="variable">mem</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#i:827"><span class="id" title="variable">i</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:829"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:825"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:826"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hlw</span> <span class="id" title="var">Hcw</span> ((<span class="id" title="var">HLreg</span> &amp; <span class="id" title="var">HLcurreg</span>) &amp; <span class="id" title="var">HLmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.logical_mapsto.html#lreg_strip"><span class="id" title="definition">lreg_strip</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fmap_insert</span> <span class="id" title="var">HLreg</span> <span class="id" title="var">Hlw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">map_Forall_insert_2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_phys_log_corresponds_update_mem" class="idref" href="#state_phys_log_corresponds_update_mem"><span class="id" title="lemma">state_phys_log_corresponds_update_mem</span></a> {<a id="reg:830" class="idref" href="#reg:830"><span class="id" title="binder">reg</span></a> <a id="mem:831" class="idref" href="#mem:831"><span class="id" title="binder">mem</span></a> <a id="lr:832" class="idref" href="#lr:832"><span class="id" title="binder">lr</span></a> <a id="lm:833" class="idref" href="#lm:833"><span class="id" title="binder">lm</span></a> <a id="cur_map:834" class="idref" href="#cur_map:834"><span class="id" title="binder">cur_map</span></a> <a id="la:835" class="idref" href="#la:835"><span class="id" title="binder">la</span></a> <a id="lw:836" class="idref" href="#lw:836"><span class="id" title="binder">lw</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:835"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:834"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:836"><span class="id" title="variable">lw</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:834"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg:830"><span class="id" title="variable">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#mem:831"><span class="id" title="variable">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:832"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:833"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:834"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg:830"><span class="id" title="variable">reg</span></a> (<span class="id" title="notation">&lt;[(</span><a class="idref" href="cap_machine.logical_mapsto.html#laddr_get_addr"><span class="id" title="definition">laddr_get_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:835"><span class="id" title="variable">la</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">:=</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:836"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)]&gt;</span> <span class="id" title="notation">mem</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lr:832"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la:835"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:836"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lm</span>) <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:834"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hcurra</span> <span class="id" title="var">Hcurrw</span> (<span class="id" title="var">Hreg</span> &amp; <span class="id" title="var">Hmemcurr</span> &amp; <span class="id" title="var">Hmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lmem_corresponds_insert_respects"><span class="id" title="axiom">lmem_corresponds_insert_respects</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.logical_mapsto.html#mem_phys_log_corresponds"><span class="id" title="definition">mem_phys_log_corresponds</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_insert_dec" class="idref" href="#lookup_insert_dec"><span class="id" title="lemma">lookup_insert_dec</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">forall</span> <span class="id" title="notation">{</span><a id="K:837" class="idref" href="#K:837"><span class="id" title="binder">K</span></a> : <span class="id" title="keyword">Type</span>} {<a id="M:838" class="idref" href="#M:838"><span class="id" title="binder">M</span></a> : <span class="id" title="notation">forall</span> <span class="id" title="var">_</span> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="keyword">Type</span>} {<a id="H:839" class="idref" href="#H:839"><span class="id" title="binder">H</span></a> : <span class="id" title="class">FMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:838"><span class="id" title="variable">M</span></a>} {<a id="H0:841" class="idref" href="#H0:841"><span class="id" title="binder">H0</span></a> : <span class="id" title="notation">forall</span> <a id="A:840" class="idref" href="#A:840"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">Lookup</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:837"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:840"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:838"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:840"><span class="id" title="variable">A</span></a>)}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H1:843" class="idref" href="#H1:843"><span class="id" title="binder">H1</span></a> : <span class="id" title="notation">forall</span> <a id="A:842" class="idref" href="#A:842"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">Empty</span> (<a class="idref" href="cap_machine.rules.rules_base.html#M:838"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:842"><span class="id" title="variable">A</span></a>)} {<a id="H2:845" class="idref" href="#H2:845"><span class="id" title="binder">H2</span></a> : <span class="id" title="notation">forall</span> <a id="A:844" class="idref" href="#A:844"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">PartialAlter</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:837"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:844"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:838"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:844"><span class="id" title="variable">A</span></a>)} {<a id="H3:846" class="idref" href="#H3:846"><span class="id" title="binder">H3</span></a> : <span class="id" title="class">OMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:838"><span class="id" title="variable">M</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H4:847" class="idref" href="#H4:847"><span class="id" title="binder">H4</span></a> : <span class="id" title="class">Merge</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:838"><span class="id" title="variable">M</span></a>} {<a id="H5:849" class="idref" href="#H5:849"><span class="id" title="binder">H5</span></a> : <span class="id" title="notation">forall</span> <a id="A:848" class="idref" href="#A:848"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">MapFold</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:837"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:848"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:838"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:848"><span class="id" title="variable">A</span></a>)} {<a id="EqDecision0:850" class="idref" href="#EqDecision0:850"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="class">RelDecision</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">_</span> : <span class="id" title="class">FinMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:837"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#M:838"><span class="id" title="variable">M</span></a>} {<a id="A:851" class="idref" href="#A:851"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>} {<a id="m:852" class="idref" href="#m:852"><span class="id" title="binder">m</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#M:838"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:851"><span class="id" title="variable">A</span></a>} {<a id="i:853" class="idref" href="#i:853"><span class="id" title="binder">i</span></a> <a id="j:854" class="idref" href="#j:854"><span class="id" title="binder">j</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#K:837"><span class="id" title="variable">K</span></a>} {<a id="x:855" class="idref" href="#x:855"><span class="id" title="binder">x</span></a> <a id="y:856" class="idref" href="#y:856"><span class="id" title="binder">y</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:851"><span class="id" title="variable">A</span></a><span class="id" title="notation">},</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#m:852"><span class="id" title="variable">m</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#j:854"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:856"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#i:853"><span class="id" title="variable">i</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#x:855"><span class="id" title="variable">x</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">m</span><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#j:854"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">(</span></a><span class="id" title="definition">bool_decide</span> (<a class="idref" href="cap_machine.rules.rules_base.html#i:853"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#j:854"><span class="id" title="variable">j</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:855"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:856"><span class="id" title="variable">y</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="lemma">bool_decide_reflect</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">j</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">subst</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_corr" class="idref" href="#state_interp_transient_corr"><span class="id" title="lemma">state_interp_transient_corr</span></a> {<a id="23c1500fb89245c5d0c1f69059918c98" class="idref" href="#23c1500fb89245c5d0c1f69059918c98"><span class="id" title="binder">φ</span></a> <a id="064c857fe4c7ea230e46c410cc8add19" class="idref" href="#064c857fe4c7ea230e46c410cc8add19"><span class="id" title="binder">φ</span></a><a id="064c857fe4c7ea230e46c410cc8add19" class="idref" href="#064c857fe4c7ea230e46c410cc8add19"><span class="id" title="binder">t</span></a> <a id="lr:859" class="idref" href="#lr:859"><span class="id" title="binder">lr</span></a> <a id="lrt:860" class="idref" href="#lrt:860"><span class="id" title="binder">lrt</span></a> <a id="lm:861" class="idref" href="#lm:861"><span class="id" title="binder">lm</span></a> <a id="lmt:862" class="idref" href="#lmt:862"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#23c1500fb89245c5d0c1f69059918c98"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#064c857fe4c7ea230e46c410cc8add19"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#064c857fe4c7ea230e46c410cc8add19"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:859"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:860"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:861"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:862"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="lreg_t:863" class="idref" href="#lreg_t:863"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:864" class="idref" href="#lmem_t:864"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:865" class="idref" href="#cur_map:865"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:860"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:863"><span class="id" title="variable">lreg_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:862"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:864"><span class="id" title="variable">lmem_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#064c857fe4c7ea230e46c410cc8add19"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#064c857fe4c7ea230e46c410cc8add19"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#064c857fe4c7ea230e46c410cc8add19"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#064c857fe4c7ea230e46c410cc8add19"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:863"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:864"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:865"><span class="id" title="variable">cur_map</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "(Hσ &amp; Hregs &amp; Hmem &amp; %Hres &amp; Hcommit)".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_reg_lookup&nbsp;lrt&nbsp;{r&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;Φs&nbsp;Φf}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(lrt&nbsp;!!&nbsp;r)&nbsp;False&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;lwr&nbsp;=&gt;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;-∗&nbsp;Φs&nbsp;(lword_get_word&nbsp;lwr)))&nbsp;⊢&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(reg&nbsp;φt&nbsp;!!&nbsp;r)&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;"(Hσr&nbsp;&amp;&nbsp;Hk)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iPoseProof&nbsp;(state_interp_regs_transient_corr&nbsp;with&nbsp;"Hσr")&nbsp;as&nbsp;"*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(lrt&nbsp;!!&nbsp;r)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">lwr</span>|</span>&nbsp;eqn:Heqr&nbsp;;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;map_subseteq_spec&nbsp;in&nbsp;Hregs_incl.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;erewrite&nbsp;Hregs_incl.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;iApply&nbsp;"Hk".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;rewrite&nbsp;lookup_fmap&nbsp;Heqr.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup" class="idref" href="#wp2_reg_lookup"><span class="id" title="lemma">wp2_reg_lookup</span></a> {<a id="Ep:866" class="idref" href="#Ep:866"><span class="id" title="binder">Ep</span></a>} {<a id="lrt:867" class="idref" href="#lrt:867"><span class="id" title="binder">lrt</span></a> <a id="lmt:868" class="idref" href="#lmt:868"><span class="id" title="binder">lmt</span></a> <a id="r:869" class="idref" href="#r:869"><span class="id" title="binder">r</span></a> <a id="5ad9454ec8929315fb87659fdfc76390" class="idref" href="#5ad9454ec8929315fb87659fdfc76390"><span class="id" title="binder">φ</span></a> <a id="4c1ec0dad672507400ceb6a1c626a941" class="idref" href="#4c1ec0dad672507400ceb6a1c626a941"><span class="id" title="binder">φ</span></a><a id="4c1ec0dad672507400ceb6a1c626a941" class="idref" href="#4c1ec0dad672507400ceb6a1c626a941"><span class="id" title="binder">t</span></a> <a id="lr:872" class="idref" href="#lr:872"><span class="id" title="binder">lr</span></a> <a id="lm:873" class="idref" href="#lm:873"><span class="id" title="binder">lm</span></a> <a id="4d6cb1bbefa69521acb2fe383c1dcf23" class="idref" href="#4d6cb1bbefa69521acb2fe383c1dcf23"><span class="id" title="binder">Φs</span></a> <a id="9fec6dabea612fbf541a9129335954d3" class="idref" href="#9fec6dabea612fbf541a9129335954d3"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:869"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:867"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5ad9454ec8929315fb87659fdfc76390"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4c1ec0dad672507400ceb6a1c626a941"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#4c1ec0dad672507400ceb6a1c626a941"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:872"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:867"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:873"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:868"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lwr:876" class="idref" href="#lwr:876"><span class="id" title="binder">lwr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5ad9454ec8929315fb87659fdfc76390"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4c1ec0dad672507400ceb6a1c626a941"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#4c1ec0dad672507400ceb6a1c626a941"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:872"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:867"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:873"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:868"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#4d6cb1bbefa69521acb2fe383c1dcf23"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwr:876"><span class="id" title="variable">lwr</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwr:876"><span class="id" title="variable">lwr</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:866"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#lrt:867"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:869"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4c1ec0dad672507400ceb6a1c626a941"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#4c1ec0dad672507400ceb6a1c626a941"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:869"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#9fec6dabea612fbf541a9129335954d3"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4d6cb1bbefa69521acb2fe383c1dcf23"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient_corr"><span class="id" title="axiom">state_interp_transient_corr</span></a> <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%HInv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HInv</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lregs_t</span> &amp; <span class="id" title="var">lmem_t</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hregs_incl</span> &amp; <span class="id" title="var">Hmem_incl</span> &amp; <span class="id" title="var">HInv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="method">elem_of_dom</span> <span class="id" title="var">lrt</span> <span class="id" title="var">r</span>) <span class="id" title="var">Hdom</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">lrw</span> &amp; <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_subseteq_spec</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hregs_incl</span> <span class="id" title="var">r</span> <span class="id" title="var">lrw</span> <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hregs_incl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">Hregs_incl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_word_of_argument&nbsp;{src&nbsp;lw&nbsp;Φf&nbsp;Φs&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;regs_of_argument&nbsp;src&nbsp;⊆&nbsp;dom&nbsp;lrt&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(word_of_argumentL&nbsp;lrt&nbsp;src)&nbsp;False&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;lw&nbsp;=&gt;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;-∗&nbsp;Φs&nbsp;(lword_get_word&nbsp;lw))&nbsp;⊢&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(word_of_argument&nbsp;(reg&nbsp;φt)&nbsp;src)&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(Hdom)&nbsp;"(Hσr&nbsp;&amp;&nbsp;HΦs)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;src&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">z</span>|<span class="id" title="var">r</span></span>;&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;iApply&nbsp;("HΦs"&nbsp;with&nbsp;"Hσr").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;iApply&nbsp;(wp_reg_lookup&nbsp;lrt&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">H</span>σ<span class="id" title="var">r</span></span> <span class="inlinecode">$<span class="id" title="var">HΦs</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_word_of_argument" class="idref" href="#wp2_word_of_argument"><span class="id" title="lemma">wp2_word_of_argument</span></a> {<a id="Ep:877" class="idref" href="#Ep:877"><span class="id" title="binder">Ep</span></a>} {<a id="src:878" class="idref" href="#src:878"><span class="id" title="binder">src</span></a> <a id="lw:879" class="idref" href="#lw:879"><span class="id" title="binder">lw</span></a> <a id="1035a75183b27f8be08fcbdd9f7b614c" class="idref" href="#1035a75183b27f8be08fcbdd9f7b614c"><span class="id" title="binder">Φf</span></a> <a id="73ce3aa42fb82bbf51e6aa664e8fc2d5" class="idref" href="#73ce3aa42fb82bbf51e6aa664e8fc2d5"><span class="id" title="binder">Φs</span></a> <a id="9200d07eadb0322361fb618689fce54a" class="idref" href="#9200d07eadb0322361fb618689fce54a"><span class="id" title="binder">φ</span></a> <a id="8baec740eb91e6409c8e54423ba52f81" class="idref" href="#8baec740eb91e6409c8e54423ba52f81"><span class="id" title="binder">φ</span></a><a id="8baec740eb91e6409c8e54423ba52f81" class="idref" href="#8baec740eb91e6409c8e54423ba52f81"><span class="id" title="binder">t</span></a> <a id="lr:884" class="idref" href="#lr:884"><span class="id" title="binder">lr</span></a> <a id="lrt:885" class="idref" href="#lrt:885"><span class="id" title="binder">lrt</span></a> <a id="lm:886" class="idref" href="#lm:886"><span class="id" title="binder">lm</span></a> <a id="lmt:887" class="idref" href="#lmt:887"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:878"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:885"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9200d07eadb0322361fb618689fce54a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8baec740eb91e6409c8e54423ba52f81"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8baec740eb91e6409c8e54423ba52f81"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:884"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:885"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:886"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:887"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lw:888" class="idref" href="#lw:888"><span class="id" title="binder">lw</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9200d07eadb0322361fb618689fce54a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8baec740eb91e6409c8e54423ba52f81"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8baec740eb91e6409c8e54423ba52f81"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:884"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:885"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:886"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:887"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#73ce3aa42fb82bbf51e6aa664e8fc2d5"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:888"><span class="id" title="variable">lw</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:888"><span class="id" title="variable">lw</span></a>)<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:877"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:885"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:878"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#word_of_argument"><span class="id" title="definition">word_of_argument</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8baec740eb91e6409c8e54423ba52f81"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8baec740eb91e6409c8e54423ba52f81"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:878"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#1035a75183b27f8be08fcbdd9f7b614c"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#73ce3aa42fb82bbf51e6aa664e8fc2d5"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσr &amp; HΦs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span>|<span class="id" title="var">r</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"HΦs" <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hσr $HΦs]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_word_get_cap" class="idref" href="#wp2_word_get_cap"><span class="id" title="lemma">wp2_word_get_cap</span></a> {<a id="Ep:889" class="idref" href="#Ep:889"><span class="id" title="binder">Ep</span></a>} {<a id="w:890" class="idref" href="#w:890"><span class="id" title="binder">w</span></a> <a id="24987e481b92b03918c81e9471484339" class="idref" href="#24987e481b92b03918c81e9471484339"><span class="id" title="binder">Φf</span></a> <a id="3f2878f2340c480455feabc473f8ecba" class="idref" href="#3f2878f2340c480455feabc473f8ecba"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#24987e481b92b03918c81e9471484339"><span class="id" title="variable">Φf</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="p:893" class="idref" href="#p:893"><span class="id" title="binder">p</span></a> <a id="b:894" class="idref" href="#b:894"><span class="id" title="binder">b</span></a> <a id="e:895" class="idref" href="#e:895"><span class="id" title="binder">e</span></a> <a id="a:896" class="idref" href="#a:896"><span class="id" title="binder">a</span></a> <a id="v:897" class="idref" href="#v:897"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#3f2878f2340c480455feabc473f8ecba"><span class="id" title="variable">Φs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#p:893"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:894"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:895"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:896"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:897"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#p:893"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:894"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:895"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:896"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:889"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_cap"><span class="id" title="definition">lword_get_cap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:890"><span class="id" title="variable">w</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#get_wcap"><span class="id" title="definition">get_wcap</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:890"><span class="id" title="variable">w</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#24987e481b92b03918c81e9471484339"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3f2878f2340c480455feabc473f8ecba"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span> | [<span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span> | <span class="id" title="var">x</span>] | <span class="id" title="var">w</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_mem_lookup" class="idref" href="#wp2_mem_lookup"><span class="id" title="lemma">wp2_mem_lookup</span></a> {<a id="Ep:898" class="idref" href="#Ep:898"><span class="id" title="binder">Ep</span></a>} {<a id="lrt:899" class="idref" href="#lrt:899"><span class="id" title="binder">lrt</span></a> <a id="lmt:900" class="idref" href="#lmt:900"><span class="id" title="binder">lmt</span></a> <a id="b9ba0c1e2342c18de571f7a04013a149" class="idref" href="#b9ba0c1e2342c18de571f7a04013a149"><span class="id" title="binder">φ</span></a> <a id="477aa725e440bb03a16ec985357efe41" class="idref" href="#477aa725e440bb03a16ec985357efe41"><span class="id" title="binder">φ</span></a><a id="477aa725e440bb03a16ec985357efe41" class="idref" href="#477aa725e440bb03a16ec985357efe41"><span class="id" title="binder">t</span></a> <a id="lr:903" class="idref" href="#lr:903"><span class="id" title="binder">lr</span></a> <a id="lm:904" class="idref" href="#lm:904"><span class="id" title="binder">lm</span></a> <a id="f698ad2e8c35961800ca7a15a798acbe" class="idref" href="#f698ad2e8c35961800ca7a15a798acbe"><span class="id" title="binder">Φs</span></a> <a id="c3c423c896ca94b943f3db9c9bb8f3c7" class="idref" href="#c3c423c896ca94b943f3db9c9bb8f3c7"><span class="id" title="binder">Φf</span></a> <a id="r:907" class="idref" href="#r:907"><span class="id" title="binder">r</span></a> <a id="p:908" class="idref" href="#p:908"><span class="id" title="binder">p</span></a> <a id="b:909" class="idref" href="#b:909"><span class="id" title="binder">b</span></a> <a id="e:910" class="idref" href="#e:910"><span class="id" title="binder">e</span></a> <a id="a:911" class="idref" href="#a:911"><span class="id" title="binder">a</span></a> <a id="v:912" class="idref" href="#v:912"><span class="id" title="binder">v</span></a> <a id="lwa:913" class="idref" href="#lwa:913"><span class="id" title="binder">lwa</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:909"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:910"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:911"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lrt:899"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:907"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:908"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:909"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:910"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:911"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:912"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:900"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:911"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules.rules_base.html#v:912"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwa:913"><span class="id" title="variable">lwa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b9ba0c1e2342c18de571f7a04013a149"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#477aa725e440bb03a16ec985357efe41"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#477aa725e440bb03a16ec985357efe41"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:903"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:899"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:904"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:900"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b9ba0c1e2342c18de571f7a04013a149"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#477aa725e440bb03a16ec985357efe41"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#477aa725e440bb03a16ec985357efe41"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:903"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:899"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:904"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:900"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#f698ad2e8c35961800ca7a15a798acbe"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwa:913"><span class="id" title="variable">lwa</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwa:913"><span class="id" title="variable">lwa</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:898"><span class="id" title="variable">Ep</span></a> (<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:900"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:911"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules.rules_base.html#v:912"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#477aa725e440bb03a16ec985357efe41"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#477aa725e440bb03a16ec985357efe41"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:911"><span class="id" title="variable">a</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#c3c423c896ca94b943f3db9c9bb8f3c7"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f698ad2e8c35961800ca7a15a798acbe"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hin_bounds</span> <span class="id" title="var">Hlrt_r</span> <span class="id" title="var">Hlmt_a</span>) "(Hσr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient_corr"><span class="id" title="axiom">state_interp_transient_corr</span></a> <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hcor".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> &amp; <span class="id" title="var">lm'</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlrt_incl</span> &amp; <span class="id" title="var">Hlmt_incl</span> &amp; <span class="id" title="var">Hinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>, <span class="id" title="var">Hlrt_r</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_get_word"><span class="id" title="axiom">state_corresponds_mem_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_z_of_argument" class="idref" href="#wp2_z_of_argument"><span class="id" title="lemma">wp2_z_of_argument</span></a> {<a id="Ep:914" class="idref" href="#Ep:914"><span class="id" title="binder">Ep</span></a>} {<a id="src:915" class="idref" href="#src:915"><span class="id" title="binder">src</span></a> <a id="91b9b97ed5d1cb31fc3577f95c2f4816" class="idref" href="#91b9b97ed5d1cb31fc3577f95c2f4816"><span class="id" title="binder">Φf</span></a> <a id="fd066e68f1af6ef529cb29440801ad74" class="idref" href="#fd066e68f1af6ef529cb29440801ad74"><span class="id" title="binder">Φs</span></a> <a id="04950b309e80e9857056e92569da98de" class="idref" href="#04950b309e80e9857056e92569da98de"><span class="id" title="binder">φ</span></a> <a id="64e071f418f6a7dca337d082bc4104f4" class="idref" href="#64e071f418f6a7dca337d082bc4104f4"><span class="id" title="binder">φ</span></a><a id="64e071f418f6a7dca337d082bc4104f4" class="idref" href="#64e071f418f6a7dca337d082bc4104f4"><span class="id" title="binder">t</span></a> <a id="lr:920" class="idref" href="#lr:920"><span class="id" title="binder">lr</span></a> <a id="lrt:921" class="idref" href="#lrt:921"><span class="id" title="binder">lrt</span></a> <a id="lm:922" class="idref" href="#lm:922"><span class="id" title="binder">lm</span></a> <a id="lmt:923" class="idref" href="#lmt:923"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:915"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:921"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#04950b309e80e9857056e92569da98de"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#64e071f418f6a7dca337d082bc4104f4"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#64e071f418f6a7dca337d082bc4104f4"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:920"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:921"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:922"><span class="id" title="variable">lm</span></a>  <a class="idref" href="cap_machine.rules.rules_base.html#lmt:923"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#04950b309e80e9857056e92569da98de"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#64e071f418f6a7dca337d082bc4104f4"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#64e071f418f6a7dca337d082bc4104f4"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:920"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:921"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:922"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:923"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#91b9b97ed5d1cb31fc3577f95c2f4816"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">((</span><span class="id" title="notation">∀</span> <a id="z:924" class="idref" href="#z:924"><span class="id" title="binder">z</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#04950b309e80e9857056e92569da98de"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#64e071f418f6a7dca337d082bc4104f4"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#64e071f418f6a7dca337d082bc4104f4"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:920"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:921"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:922"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:923"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#fd066e68f1af6ef529cb29440801ad74"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:924"><span class="id" title="variable">z</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:924"><span class="id" title="variable">z</span></a><span class="id" title="notation">))</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:914"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#z_of_argumentL"><span class="id" title="definition">z_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:921"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:915"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#z_of_argument"><span class="id" title="definition">z_of_argument</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#64e071f418f6a7dca337d082bc4104f4"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#64e071f418f6a7dca337d082bc4104f4"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:915"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#91b9b97ed5d1cb31fc3577f95c2f4816"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fd066e68f1af6ef529cb29440801ad74"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hregs</span>) "(Hφ &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <span class="id" title="var">Ep</span> (<span class="id" title="var">lrt</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:927" class="idref" href="#y:927"><span class="id" title="binder"><span id="y:931" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:927"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.logical_mapsto.html#LInt"><span class="id" title="abbreviation">LInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ<span class="id" title="var">t</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:925" class="idref" href="#y:925"><span class="id" title="binder"><span id="y:929" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:925"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Φf</span> <span class="id" title="var">Φs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφ Hk]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;More&nbsp;expressive&nbsp;version&nbsp;of&nbsp;update_state_interp_from_reg_nomod.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;needed&nbsp;for&nbsp;operations&nbsp;that&nbsp;edit&nbsp;a&nbsp;current&nbsp;(in&nbsp;terms&nbsp;of&nbsp;version)&nbsp;word,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requiring&nbsp;us&nbsp;to&nbsp;re-prove&nbsp;"currentness"&nbsp;of&nbsp;the&nbsp;edited&nbsp;word.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Think&nbsp;e.g.&nbsp;shrinking&nbsp;the&nbsp;bounds&nbsp;of&nbsp;a&nbsp;capability&nbsp;read&nbsp;from&nbsp;a&nbsp;register.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_regs_mod" class="idref" href="#update_state_interp_from_regs_mod"><span class="id" title="lemma">update_state_interp_from_regs_mod</span></a> {<a id="a20a7ad49fe39bbcfb225caca83b7774" class="idref" href="#a20a7ad49fe39bbcfb225caca83b7774"><span class="id" title="binder">σ</span></a> <a id="dst:934" class="idref" href="#dst:934"><span class="id" title="binder">dst</span></a> <a id="lw2:935" class="idref" href="#lw2:935"><span class="id" title="binder">lw2</span></a> <a id="Ep:936" class="idref" href="#Ep:936"><span class="id" title="binder">Ep</span></a> <a id="lregs:937" class="idref" href="#lregs:937"><span class="id" title="binder">lregs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:934"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:937"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:938" class="idref" href="#cur_map:938"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:937"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:938"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:935"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:938"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a20a7ad49fe39bbcfb225caca83b7774"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:939" class="idref" href="#k:939"><span class="id" title="binder"><span id="k:940" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:941" class="idref" href="#y:941"><span class="id" title="binder"><span id="y:942" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:937"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:939"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:941"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:936"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a20a7ad49fe39bbcfb225caca83b7774"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:934"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:935"><span class="id" title="variable">lw2</span></a>)) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:943" class="idref" href="#k:943"><span class="id" title="binder"><span id="k:944" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:945" class="idref" href="#y:945"><span class="id" title="binder"><span id="y:946" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:934"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:935"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:943"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:945"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdst</span> <span class="id" title="var">Hcur</span>) "(Hσ &amp; Hregs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dst</span> <span class="id" title="var">lw2</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">cur_map</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">Hcur</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="var">Hregs_incl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> <span class="id" title="var">HLinv</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_regs_mod" class="idref" href="#update_state_interp_transient_from_regs_mod"><span class="id" title="lemma">update_state_interp_transient_from_regs_mod</span></a> {<a id="67038daf82804fa5a8ed4aa0d3074ad5" class="idref" href="#67038daf82804fa5a8ed4aa0d3074ad5"><span class="id" title="binder">σ</span></a> <a id="f3973ea71a6d98aad329421fa0322633" class="idref" href="#f3973ea71a6d98aad329421fa0322633"><span class="id" title="binder">σ</span></a><a id="f3973ea71a6d98aad329421fa0322633" class="idref" href="#f3973ea71a6d98aad329421fa0322633"><span class="id" title="binder">t</span></a> <a id="lr:949" class="idref" href="#lr:949"><span class="id" title="binder">lr</span></a> <a id="lrt:950" class="idref" href="#lrt:950"><span class="id" title="binder">lrt</span></a> <a id="lm:951" class="idref" href="#lm:951"><span class="id" title="binder">lm</span></a> <a id="lmt:952" class="idref" href="#lmt:952"><span class="id" title="binder">lmt</span></a> <a id="dst:953" class="idref" href="#dst:953"><span class="id" title="binder">dst</span></a> <a id="lw2:954" class="idref" href="#lw2:954"><span class="id" title="binder">lw2</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:953"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:950"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:955" class="idref" href="#cur_map:955"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:950"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:955"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:954"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:955"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#67038daf82804fa5a8ed4aa0d3074ad5"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f3973ea71a6d98aad329421fa0322633"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#f3973ea71a6d98aad329421fa0322633"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:949"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:950"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:951"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:952"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#67038daf82804fa5a8ed4aa0d3074ad5"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f3973ea71a6d98aad329421fa0322633"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#f3973ea71a6d98aad329421fa0322633"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:953"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:954"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:949"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:953"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:954"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:951"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:952"><span class="id" title="variable">lmt</span></a> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hcur</span>). <span class="id" title="var">iIntros</span> "(Hσ &amp; Hregs &amp; Hmem &amp; %Hcor &amp; Hcommit)"; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span> "Hσ Hregs Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iPureIntro</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> &amp; <span class="id" title="var">lm'</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlrt_incl</span> &amp; <span class="id" title="var">Hlmt_incl</span> &amp; <span class="id" title="var">Hinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">dst</span><span class="id" title="notation">:=</span><span class="id" title="var">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr'</span>), <span class="id" title="var">lm'</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">insert_mono</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <span class="id" title="var">lr'</span> <span class="id" title="var">cur_map</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hcur_lr'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">_</span> <span class="id" title="var">Hcur'</span>] <span class="id" title="var">_</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lr'</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hcur</span> <span class="id" title="var">cur_map</span> <span class="id" title="var">Hcur_lr'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hregs</span> ?] ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lreg_corresponds_insert_respects"><span class="id" title="axiom">lreg_corresponds_insert_respects</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> (<span class="id" title="var">Ep</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcommit" <span class="id" title="notation">with</span> "H"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hcur</span> <span class="id" title="notation">with</span> "[$Hσ $Hregs]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;lemma&nbsp;updates&nbsp;the&nbsp;state&nbsp;for&nbsp;operations&nbsp;where&nbsp;a&nbsp;current&nbsp;word&nbsp;is<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;immediately&nbsp;moved&nbsp;(to&nbsp;another&nbsp;register).&nbsp;Since&nbsp;the&nbsp;word&nbsp;was&nbsp;not&nbsp;edited,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;it&nbsp;was&nbsp;read&nbsp;from&nbsp;a&nbsp;register,&nbsp;it&nbsp;is&nbsp;obviously&nbsp;already&nbsp;"current"&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_reg_nomod" class="idref" href="#update_state_interp_from_reg_nomod"><span class="id" title="lemma">update_state_interp_from_reg_nomod</span></a> {<a id="4b05c1fac3a27c12ea9e0af9c11375c3" class="idref" href="#4b05c1fac3a27c12ea9e0af9c11375c3"><span class="id" title="binder">σ</span></a> <a id="src:957" class="idref" href="#src:957"><span class="id" title="binder">src</span></a> <a id="dst:958" class="idref" href="#dst:958"><span class="id" title="binder">dst</span></a> <a id="lw:959" class="idref" href="#lw:959"><span class="id" title="binder">lw</span></a> <a id="Ep:960" class="idref" href="#Ep:960"><span class="id" title="binder">Ep</span></a> <a id="regs:961" class="idref" href="#regs:961"><span class="id" title="binder">regs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:958"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:961"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:961"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#src:957"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:959"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4b05c1fac3a27c12ea9e0af9c11375c3"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:962" class="idref" href="#k:962"><span class="id" title="binder"><span id="k:963" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:964" class="idref" href="#y:964"><span class="id" title="binder"><span id="y:965" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:961"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:962"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:964"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:960"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4b05c1fac3a27c12ea9e0af9c11375c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:958"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:959"><span class="id" title="variable">lw</span></a>)) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:966" class="idref" href="#k:966"><span class="id" title="binder"><span id="k:967" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:968" class="idref" href="#y:968"><span class="id" title="binder"><span id="y:969" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:958"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw:959"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:966"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:968"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdst</span> <span class="id" title="var">Hsrc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a>; <span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_int" class="idref" href="#update_state_interp_int"><span class="id" title="lemma">update_state_interp_int</span></a> {<a id="ef8ab5e01ad0cbcdc9590303856006ad" class="idref" href="#ef8ab5e01ad0cbcdc9590303856006ad"><span class="id" title="binder">σ</span></a> <a id="dst:971" class="idref" href="#dst:971"><span class="id" title="binder">dst</span></a> <a id="z:972" class="idref" href="#z:972"><span class="id" title="binder">z</span></a> <a id="Ep:973" class="idref" href="#Ep:973"><span class="id" title="binder">Ep</span></a> <a id="regs:974" class="idref" href="#regs:974"><span class="id" title="binder">regs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:971"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:974"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ef8ab5e01ad0cbcdc9590303856006ad"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:975" class="idref" href="#k:975"><span class="id" title="binder"><span id="k:976" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:977" class="idref" href="#y:977"><span class="id" title="binder"><span id="y:978" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:974"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:975"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:977"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:973"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ef8ab5e01ad0cbcdc9590303856006ad"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:971"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:972"><span class="id" title="variable">z</span></a>)) <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:979" class="idref" href="#k:979"><span class="id" title="binder"><span id="k:980" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:981" class="idref" href="#y:981"><span class="id" title="binder"><span id="y:982" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:971"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:972"><span class="id" title="variable">z</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:979"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:981"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <span class="id" title="var">z</span>)); <span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_int" class="idref" href="#update_state_interp_transient_int"><span class="id" title="lemma">update_state_interp_transient_int</span></a> {<a id="6ffe7f3af91ce96ca8778abc305e04fe" class="idref" href="#6ffe7f3af91ce96ca8778abc305e04fe"><span class="id" title="binder">σ</span></a> <a id="181cba73b8862e931f6cd88f51c6e2ec" class="idref" href="#181cba73b8862e931f6cd88f51c6e2ec"><span class="id" title="binder">σ</span></a><a id="181cba73b8862e931f6cd88f51c6e2ec" class="idref" href="#181cba73b8862e931f6cd88f51c6e2ec"><span class="id" title="binder">t</span></a> <a id="lr:985" class="idref" href="#lr:985"><span class="id" title="binder">lr</span></a> <a id="lrt:986" class="idref" href="#lrt:986"><span class="id" title="binder">lrt</span></a> <a id="lm:987" class="idref" href="#lm:987"><span class="id" title="binder">lm</span></a> <a id="lmt:988" class="idref" href="#lmt:988"><span class="id" title="binder">lmt</span></a> <a id="dst:989" class="idref" href="#dst:989"><span class="id" title="binder">dst</span></a> <a id="z:990" class="idref" href="#z:990"><span class="id" title="binder">z</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:989"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:986"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6ffe7f3af91ce96ca8778abc305e04fe"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#181cba73b8862e931f6cd88f51c6e2ec"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#181cba73b8862e931f6cd88f51c6e2ec"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:985"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:986"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:987"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:988"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6ffe7f3af91ce96ca8778abc305e04fe"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#181cba73b8862e931f6cd88f51c6e2ec"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#181cba73b8862e931f6cd88f51c6e2ec"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:989"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:990"><span class="id" title="variable">z</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:985"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:989"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:990"><span class="id" title="variable">z</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:987"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:988"><span class="id" title="variable">lmt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_transient_from_regs_mod"><span class="id" title="axiom">update_state_interp_transient_from_regs_mod</span></a> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <span class="id" title="var">z</span>) <span class="id" title="var">Hdom</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_cap_mod" class="idref" href="#update_state_interp_from_cap_mod"><span class="id" title="lemma">update_state_interp_from_cap_mod</span></a> {<a id="a0de7b14fbdfa6ddc0b5f781d0c3c305" class="idref" href="#a0de7b14fbdfa6ddc0b5f781d0c3c305"><span class="id" title="binder">σ</span></a> <a id="dst:992" class="idref" href="#dst:992"><span class="id" title="binder">dst</span></a> <a id="lw2:993" class="idref" href="#lw2:993"><span class="id" title="binder">lw2</span></a> <a id="Ep:994" class="idref" href="#Ep:994"><span class="id" title="binder">Ep</span></a> <a id="lregs:995" class="idref" href="#lregs:995"><span class="id" title="binder">lregs</span></a>} {<a id="lmem:996" class="idref" href="#lmem:996"><span class="id" title="binder">lmem</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} {<a id="p:997" class="idref" href="#p:997"><span class="id" title="binder">p</span></a> <a id="b:998" class="idref" href="#b:998"><span class="id" title="binder">b</span></a> <a id="e:999" class="idref" href="#e:999"><span class="id" title="binder">e</span></a> <a id="a:1000" class="idref" href="#a:1000"><span class="id" title="binder">a</span></a> <a id="v:1001" class="idref" href="#v:1001"><span class="id" title="binder">v</span></a> <a id="r:1002" class="idref" href="#r:1002"><span class="id" title="binder">r</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:992"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:995"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:995"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:1002"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:997"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:998"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:999"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1000"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1001"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:998"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:999"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1000"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:996"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:1000"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1001"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:993"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0de7b14fbdfa6ddc0b5f781d0c3c305"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1003" class="idref" href="#k:1003"><span class="id" title="binder"><span id="k:1004" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1005" class="idref" href="#y:1005"><span class="id" title="binder"><span id="y:1006" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:995"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1003"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1005"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:1007" class="idref" href="#la:1007"><span class="id" title="binder"><span id="la:1008" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:1009" class="idref" href="#dw:1009"><span class="id" title="binder"><span id="dw:1010" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:996"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1007"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:1009"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:1009"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:994"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0de7b14fbdfa6ddc0b5f781d0c3c305"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:992"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:993"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1011" class="idref" href="#k:1011"><span class="id" title="binder"><span id="k:1012" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1013" class="idref" href="#y:1013"><span class="id" title="binder"><span id="y:1014" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:992"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:993"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1011"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1013"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:1015" class="idref" href="#la:1015"><span class="id" title="binder"><span id="la:1016" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:1017" class="idref" href="#dw:1017"><span class="id" title="binder"><span id="dw:1018" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:996"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1015"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:1017"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:1017"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdst</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span>) "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dst</span> <span class="id" title="var">lw2</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">cur_map</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HLinv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hinv_reg</span> <span class="id" title="var">Hinv_mem</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lmem_corresponds_read_iscur"><span class="id" title="axiom">lmem_corresponds_read_iscur</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_cap_mod" class="idref" href="#update_state_interp_transient_from_cap_mod"><span class="id" title="lemma">update_state_interp_transient_from_cap_mod</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="7148acd180dd822990db2ca6f908eeb2" class="idref" href="#7148acd180dd822990db2ca6f908eeb2"><span class="id" title="binder">σ</span></a> <a id="dcef8f7d896a48542f05136e144ee25a" class="idref" href="#dcef8f7d896a48542f05136e144ee25a"><span class="id" title="binder">σ</span></a><a id="dcef8f7d896a48542f05136e144ee25a" class="idref" href="#dcef8f7d896a48542f05136e144ee25a"><span class="id" title="binder">t</span></a> <a id="lr:1021" class="idref" href="#lr:1021"><span class="id" title="binder">lr</span></a> <a id="lrt:1022" class="idref" href="#lrt:1022"><span class="id" title="binder">lrt</span></a> <a id="lm:1023" class="idref" href="#lm:1023"><span class="id" title="binder">lm</span></a> <a id="lmt:1024" class="idref" href="#lmt:1024"><span class="id" title="binder">lmt</span></a> <a id="dst:1025" class="idref" href="#dst:1025"><span class="id" title="binder">dst</span></a> <a id="lw2:1026" class="idref" href="#lw2:1026"><span class="id" title="binder">lw2</span></a> <a id="r:1027" class="idref" href="#r:1027"><span class="id" title="binder">r</span></a> <a id="p:1028" class="idref" href="#p:1028"><span class="id" title="binder">p</span></a> <a id="b:1029" class="idref" href="#b:1029"><span class="id" title="binder">b</span></a> <a id="e:1030" class="idref" href="#e:1030"><span class="id" title="binder">e</span></a> <a id="a:1031" class="idref" href="#a:1031"><span class="id" title="binder">a</span></a> <a id="v:1032" class="idref" href="#v:1032"><span class="id" title="binder">v</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:1025"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1022"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lrt:1022"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:1027"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:1028"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1029"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1030"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1031"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1032"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1029"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1030"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1031"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1024"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:1031"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1032"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1026"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7148acd180dd822990db2ca6f908eeb2"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dcef8f7d896a48542f05136e144ee25a"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dcef8f7d896a48542f05136e144ee25a"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1021"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1022"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1023"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1024"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#7148acd180dd822990db2ca6f908eeb2"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dcef8f7d896a48542f05136e144ee25a"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dcef8f7d896a48542f05136e144ee25a"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1025"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1026"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:1021"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1025"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1026"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:1023"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1024"><span class="id" title="variable">lmt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span>) "(Hσ &amp; Hregs &amp; Hmem &amp; %Hcor &amp; Hcommit)"; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span> "Hσ Hregs Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iPureIntro</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> &amp; <span class="id" title="var">lm'</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlrt_incl</span> &amp; <span class="id" title="var">Hlmt_incl</span> &amp; <span class="id" title="var">Hinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">dst</span><span class="id" title="notation">:=</span><span class="id" title="var">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr'</span>), <span class="id" title="var">lm'</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">insert_mono</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <span class="id" title="var">lr'</span> <span class="id" title="var">cur_map</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hcur_lr'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">_</span> <span class="id" title="var">Hcur'</span>] <span class="id" title="var">_</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lr'</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hregs</span> ?] ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha</span>, <span class="id" title="var">Hr</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lmem_corresponds_read_iscur"><span class="id" title="axiom">lmem_corresponds_read_iscur</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lreg_corresponds_insert_respects"><span class="id" title="axiom">lreg_corresponds_insert_respects</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a>; <span class="id" title="tactic">eauto</span> ; <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> (<span class="id" title="var">Ep</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcommit" <span class="id" title="notation">with</span> "H"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_cap_mod"><span class="id" title="axiom">update_state_interp_from_cap_mod</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span> <span class="id" title="notation">with</span> "[$Hσ $Hregs $Hmem]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_mem_mod" class="idref" href="#update_state_interp_from_mem_mod"><span class="id" title="lemma">update_state_interp_from_mem_mod</span></a> {<a id="a5690351051a572aef7c97f9a967a0e1" class="idref" href="#a5690351051a572aef7c97f9a967a0e1"><span class="id" title="binder">σ</span></a> <a id="Ep:1034" class="idref" href="#Ep:1034"><span class="id" title="binder">Ep</span></a> <a id="lregs:1035" class="idref" href="#lregs:1035"><span class="id" title="binder">lregs</span></a>} {<a id="lmem:1036" class="idref" href="#lmem:1036"><span class="id" title="binder">lmem</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} <a id="laddr:1037" class="idref" href="#laddr:1037"><span class="id" title="binder">laddr</span></a> <a id="lwold:1038" class="idref" href="#lwold:1038"><span class="id" title="binder">lwold</span></a> <a id="lwnew:1039" class="idref" href="#lwnew:1039"><span class="id" title="binder">lwnew</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1040" class="idref" href="#cur_map:1040"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1035"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1040"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwnew:1039"><span class="id" title="variable">lwnew</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1040"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1041" class="idref" href="#cur_map:1041"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1035"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1041"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#laddr:1037"><span class="id" title="variable">laddr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1041"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:1036"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#laddr:1037"><span class="id" title="variable">laddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwold:1038"><span class="id" title="variable">lwold</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a5690351051a572aef7c97f9a967a0e1"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1042" class="idref" href="#k:1042"><span class="id" title="binder"><span id="k:1043" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1044" class="idref" href="#y:1044"><span class="id" title="binder"><span id="y:1045" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1035"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1042"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1044"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:1046" class="idref" href="#la:1046"><span class="id" title="binder"><span id="la:1047" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:1048" class="idref" href="#dw:1048"><span class="id" title="binder"><span id="dw:1049" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:1036"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1046"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:1048"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:1048"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:1034"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_mem"><span class="id" title="definition">update_mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a5690351051a572aef7c97f9a967a0e1"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#laddr_get_addr"><span class="id" title="definition">laddr_get_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#laddr:1037"><span class="id" title="variable">laddr</span></a>) (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwnew:1039"><span class="id" title="variable">lwnew</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:1050" class="idref" href="#k:1050"><span class="id" title="binder"><span id="k:1051" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:1052" class="idref" href="#y:1052"><span class="id" title="binder"><span id="y:1053" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1035"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:1050"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:1052"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:1054" class="idref" href="#la:1054"><span class="id" title="binder"><span id="la:1055" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:1056" class="idref" href="#dw:1056"><span class="id" title="binder"><span id="dw:1057" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#laddr:1037"><span class="id" title="variable">laddr</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwnew:1039"><span class="id" title="variable">lwnew</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1054"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:1056"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:1056"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcurw</span> <span class="id" title="var">Hcura</span> <span class="id" title="var">Hladdr</span>) "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span>@<a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_update_inSepM_general"><span class="id" title="axiom">gen_heap_update_inSepM_general</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">laddr</span> <span class="id" title="var">lwnew</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hm Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">cur_map</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HLinv</span> <span class="id" title="keyword">as</span> [[? <span class="id" title="var">Hregscur</span>] <span class="id" title="var">Hinv_mem</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_mem"><span class="id" title="axiom">state_phys_log_corresponds_update_mem</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">Hcura</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">Hcurw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="var">Hlregs_incl</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_mem_mod" class="idref" href="#update_state_interp_transient_from_mem_mod"><span class="id" title="lemma">update_state_interp_transient_from_mem_mod</span></a> {<a id="bc4c5911ee07409bb8f7137ad67492c0" class="idref" href="#bc4c5911ee07409bb8f7137ad67492c0"><span class="id" title="binder">σ</span></a> <a id="f0d199fa29f6d5e857ed8941d92b195c" class="idref" href="#f0d199fa29f6d5e857ed8941d92b195c"><span class="id" title="binder">σ</span></a><a id="f0d199fa29f6d5e857ed8941d92b195c" class="idref" href="#f0d199fa29f6d5e857ed8941d92b195c"><span class="id" title="binder">t</span></a> <a id="lr:1060" class="idref" href="#lr:1060"><span class="id" title="binder">lr</span></a> <a id="lrt:1061" class="idref" href="#lrt:1061"><span class="id" title="binder">lrt</span></a>} {<a id="lm:1062" class="idref" href="#lm:1062"><span class="id" title="binder">lm</span></a> <a id="lmt:1063" class="idref" href="#lmt:1063"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#LMemF"><span class="id" title="definition">LMemF</span></a>} <a id="la:1064" class="idref" href="#la:1064"><span class="id" title="binder">la</span></a> <a id="lw:1065" class="idref" href="#lw:1065"><span class="id" title="binder">lw</span></a> <a id="lw':1066" class="idref" href="#lw':1066"><span class="id" title="binder">lw'</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1067" class="idref" href="#cur_map:1067"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1061"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1067"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1065"><span class="id" title="variable">lw</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1067"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1068" class="idref" href="#cur_map:1068"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1061"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1068"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:1064"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1068"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmt:1063"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1064"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw':1066"><span class="id" title="variable">lw'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bc4c5911ee07409bb8f7137ad67492c0"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f0d199fa29f6d5e857ed8941d92b195c"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#f0d199fa29f6d5e857ed8941d92b195c"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1060"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1061"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1062"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1063"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bc4c5911ee07409bb8f7137ad67492c0"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_mem"><span class="id" title="definition">update_mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f0d199fa29f6d5e857ed8941d92b195c"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#f0d199fa29f6d5e857ed8941d92b195c"><span class="id" title="variable">t</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#laddr_get_addr"><span class="id" title="definition">laddr_get_addr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:1064"><span class="id" title="variable">la</span></a>) (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1065"><span class="id" title="variable">lw</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:1060"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1061"><span class="id" title="variable">lrt</span></a> <span class="comment">(*&nbsp;registers&nbsp;remain&nbsp;unchanged&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lm:1062"><span class="id" title="variable">lm</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1064"><span class="id" title="variable">la</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1065"><span class="id" title="variable">lw</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmt</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcurw</span> <span class="id" title="var">Hcura</span> <span class="id" title="var">Hla</span>) "(Hσ &amp; Hregs &amp; Hmem &amp; %Hcor &amp; Hcommit)". <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span> "Hσ Hregs Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iPureIntro</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> &amp; <span class="id" title="var">lm'</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlrt_incl</span> &amp; <span class="id" title="var">Hlmt_incl</span> &amp; <span class="id" title="var">Hinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">lr'</span>, (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la</span><span class="id" title="notation">:=</span><span class="id" title="var">lw</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lm'</span>), <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fmap_insert</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">insert_mono</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <span class="id" title="var">lr'</span> <span class="id" title="var">cur_map</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hcur_lr'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">_</span> <span class="id" title="var">Hcur'</span>] <span class="id" title="var">_</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lr'</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_mem"><span class="id" title="axiom">state_phys_log_corresponds_update_mem</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> (<span class="id" title="var">Ep</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcommit" <span class="id" title="notation">with</span> "H"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_mem_mod"><span class="id" title="axiom">update_state_interp_from_mem_mod</span></a> <span class="id" title="var">la</span> <span class="id" title="var">lw'</span> <span class="id" title="var">lw</span> <span class="id" title="var">Hcurw</span> <span class="id" title="var">Hcura</span> <span class="id" title="var">Hla</span>). <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="word_of_argumentL_cur" class="idref" href="#word_of_argumentL_cur"><span class="id" title="lemma">word_of_argumentL_cur</span></a> {<a id="lregs:1069" class="idref" href="#lregs:1069"><span class="id" title="binder">lregs</span></a> <a id="src:1070" class="idref" href="#src:1070"><span class="id" title="binder">src</span></a> <a id="lw2:1071" class="idref" href="#lw2:1071"><span class="id" title="binder">lw2</span></a> <a id="cur_map:1072" class="idref" href="#cur_map:1072"><span class="id" title="binder">cur_map</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1069"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:1070"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1071"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1069"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1072"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1071"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1072"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hreg</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span> <span class="id" title="var">Hreg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="cap_of_argumentL_cur" class="idref" href="#cap_of_argumentL_cur"><span class="id" title="lemma">cap_of_argumentL_cur</span></a> {<a id="lregs:1073" class="idref" href="#lregs:1073"><span class="id" title="binder">lregs</span></a> <a id="rsrc:1074" class="idref" href="#rsrc:1074"><span class="id" title="binder">rsrc</span></a> <a id="p:1075" class="idref" href="#p:1075"><span class="id" title="binder">p</span></a> <a id="b:1076" class="idref" href="#b:1076"><span class="id" title="binder">b</span></a> <a id="e:1077" class="idref" href="#e:1077"><span class="id" title="binder">e</span></a> <a id="a:1078" class="idref" href="#a:1078"><span class="id" title="binder">a</span></a> <a id="v:1079" class="idref" href="#v:1079"><span class="id" title="binder">v</span></a> <a id="cur_map:1080" class="idref" href="#cur_map:1080"><span class="id" title="binder">cur_map</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1073"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rsrc:1074"><span class="id" title="variable">rsrc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:1075"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1076"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1077"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1078"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1079"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1076"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1077"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1078"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1073"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1080"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:1078"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1079"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1080"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#cur_lword_cur_addr"><span class="id" title="axiom">cur_lword_cur_addr</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>) <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span>). <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_lword_version"><span class="id" title="definition">is_lword_version</span></a>. <span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#word_of_argumentL_cur"><span class="id" title="axiom">word_of_argumentL_cur</span></a>. <span class="id" title="tactic">eauto</span>. <span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Is_true_true_1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="seal_from_argumentL" class="idref" href="#seal_from_argumentL"><span class="id" title="lemma">seal_from_argumentL</span></a> {<a id="lregs:1081" class="idref" href="#lregs:1081"><span class="id" title="binder">lregs</span></a> <a id="src:1082" class="idref" href="#src:1082"><span class="id" title="binder">src</span></a> <a id="sb:1083" class="idref" href="#sb:1083"><span class="id" title="binder">sb</span></a> <a id="ot:1084" class="idref" href="#ot:1084"><span class="id" title="binder">ot</span></a> <a id="cur_map:1085" class="idref" href="#cur_map:1085"><span class="id" title="binder">cur_map</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:1081"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#src:1082"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LWSealable"><span class="id" title="constructor">LWSealable</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#sb:1083"><span class="id" title="variable">sb</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1081"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1085"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LWSealed"><span class="id" title="constructor">LWSealed</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ot:1084"><span class="id" title="variable">ot</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#sb:1083"><span class="id" title="variable">sb</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1085"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hreg</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span> <span class="id" title="var">Hreg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="unseal_from_argumentL" class="idref" href="#unseal_from_argumentL"><span class="id" title="lemma">unseal_from_argumentL</span></a> {<a id="lregs:1086" class="idref" href="#lregs:1086"><span class="id" title="binder">lregs</span></a> <a id="src:1087" class="idref" href="#src:1087"><span class="id" title="binder">src</span></a> <a id="sb:1088" class="idref" href="#sb:1088"><span class="id" title="binder">sb</span></a> <a id="ot:1089" class="idref" href="#ot:1089"><span class="id" title="binder">ot</span></a> <a id="cur_map:1090" class="idref" href="#cur_map:1090"><span class="id" title="binder">cur_map</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:1086"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#src:1087"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LWSealed"><span class="id" title="constructor">LWSealed</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ot:1089"><span class="id" title="variable">ot</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#sb:1088"><span class="id" title="variable">sb</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1086"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1090"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LWSealable"><span class="id" title="constructor">LWSealable</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#sb:1088"><span class="id" title="variable">sb</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1090"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hreg</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span> <span class="id" title="var">Hreg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;updatePC_impl&nbsp;{φ}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;updatePC&nbsp;φ&nbsp;=&nbsp;(reg'&nbsp;←&nbsp;incrementPC&nbsp;(reg&nbsp;φ);&nbsp;Some&nbsp;(NextI&nbsp;,&nbsp;update_regs&nbsp;φ&nbsp;reg')).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;updatePC,&nbsp;incrementPC.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(reg&nbsp;φ&nbsp;!!&nbsp;PC);&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;w;&nbsp;try&nbsp;done.&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;sb;&nbsp;try&nbsp;done.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;now&nbsp;destruct&nbsp;(f1&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_opt_incrementPC&nbsp;{φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;Φs&nbsp;Φf}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;PC&nbsp;∈&nbsp;dom&nbsp;lrt&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(wp_opt&nbsp;(incrementLPC&nbsp;lrt)&nbsp;(∀&nbsp;φt'&nbsp;lrt',&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt'&nbsp;lr&nbsp;lrt'&nbsp;-∗&nbsp;Φf)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;lrt'&nbsp;=&gt;&nbsp;∀&nbsp;φt',&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt'&nbsp;lr&nbsp;lrt'&nbsp;-∗&nbsp;Φs&nbsp;(reg&nbsp;φt')))&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;⊢&nbsp;wp_opt&nbsp;(incrementPC&nbsp;(reg&nbsp;φt))&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(Hdom)&nbsp;"(Hφr&nbsp;&amp;&nbsp;Hk)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;wp_opt_bind.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;incrementLPC,&nbsp;incrementPC.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;change&nbsp;(wp_opt&nbsp;match&nbsp;lrt&nbsp;!!&nbsp;PC&nbsp;with&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;(LCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;v)&nbsp;=&gt;&nbsp;match&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;a'&nbsp;=&gt;&nbsp;Some&nbsp;(&lt;<span class="inlinecode"><span class="id" title="var">PC</span>:=<span class="id" title="var">LCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>&gt;&nbsp;lrt)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;?Φf&nbsp;?Φs)&nbsp;with&nbsp;(wp_opt&nbsp;((lrt&nbsp;!!&nbsp;PC)&nbsp;≫=&nbsp;(fun&nbsp;w&nbsp;=&gt;&nbsp;match&nbsp;w&nbsp;with&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(LCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;v)&nbsp;=&gt;&nbsp;match&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;a'&nbsp;=&gt;&nbsp;Some&nbsp;(&lt;<span class="inlinecode"><span class="id" title="var">PC</span>:=<span class="id" title="var">LCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>&gt;&nbsp;lrt)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end)&nbsp;)&nbsp;Φf&nbsp;Φs).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;&lt;-wp_opt_bind.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;((wp_reg_lookup&nbsp;lrt&nbsp;(r&nbsp;:=&nbsp;PC)&nbsp;(φt&nbsp;:=&nbsp;φt))&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">H</span>φ<span class="id" title="var">r</span></span> <span class="inlinecode"><span class="id" title="var">Hk</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;wp_opt_eqn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;wp_opt_is_Some;&nbsp;last&nbsp;by&nbsp;apply&nbsp;elem_of_dom.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;(wp_opt_mono&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">Hk</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(x)&nbsp;"Hk&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;x&nbsp;eqn:Heqx;&nbsp;try&nbsp;(now&nbsp;iApply&nbsp;"Hk");&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;sb;&nbsp;try&nbsp;(now&nbsp;iApply&nbsp;"Hk");&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(f1&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;("Hk"&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;(update_state_interp_transient_from_regs_mod&nbsp;Hdom&nbsp;with&nbsp;"Hφr").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;intros&nbsp;cur_map&nbsp;Hcurregs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;eapply&nbsp;is_cur_word_cap_change,&nbsp;(map_Forall_lookup_1&nbsp;_&nbsp;_&nbsp;_&nbsp;_&nbsp;Hcurregs).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_opt_incrementPC" class="idref" href="#wp2_opt_incrementPC"><span class="id" title="lemma">wp2_opt_incrementPC</span></a> {<a id="Ep:1091" class="idref" href="#Ep:1091"><span class="id" title="binder">Ep</span></a>} {<a id="004aab482dcdc9090f75cce2c81972ad" class="idref" href="#004aab482dcdc9090f75cce2c81972ad"><span class="id" title="binder">φ</span></a> <a id="8275a8d5da268fd2eb8bfc14e379e37c" class="idref" href="#8275a8d5da268fd2eb8bfc14e379e37c"><span class="id" title="binder">φ</span></a><a id="8275a8d5da268fd2eb8bfc14e379e37c" class="idref" href="#8275a8d5da268fd2eb8bfc14e379e37c"><span class="id" title="binder">t</span></a> <a id="lr:1094" class="idref" href="#lr:1094"><span class="id" title="binder">lr</span></a> <a id="lrt:1095" class="idref" href="#lrt:1095"><span class="id" title="binder">lrt</span></a> <a id="lm:1096" class="idref" href="#lm:1096"><span class="id" title="binder">lm</span></a> <a id="lmt:1097" class="idref" href="#lmt:1097"><span class="id" title="binder">lmt</span></a> <a id="c29eeaed71cef73d297e5f7f8e24b6a5" class="idref" href="#c29eeaed71cef73d297e5f7f8e24b6a5"><span class="id" title="binder">Φs</span></a> <a id="ed452127c9488f164aa2f6ab173eb6c5" class="idref" href="#ed452127c9488f164aa2f6ab173eb6c5"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1095"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#004aab482dcdc9090f75cce2c81972ad"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8275a8d5da268fd2eb8bfc14e379e37c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8275a8d5da268fd2eb8bfc14e379e37c"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1094"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1095"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1096"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1097"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="b2e3195f4a5ffb1d7cc0f83fd499336b" class="idref" href="#b2e3195f4a5ffb1d7cc0f83fd499336b"><span class="id" title="binder">φ</span></a><a id="b2e3195f4a5ffb1d7cc0f83fd499336b" class="idref" href="#b2e3195f4a5ffb1d7cc0f83fd499336b"><span class="id" title="binder">t'</span></a> <a id="lrt':1101" class="idref" href="#lrt':1101"><span class="id" title="binder">lrt'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#004aab482dcdc9090f75cce2c81972ad"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b2e3195f4a5ffb1d7cc0f83fd499336b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#b2e3195f4a5ffb1d7cc0f83fd499336b"><span class="id" title="variable">t'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1094"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':1101"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1096"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1097"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#ed452127c9488f164aa2f6ab173eb6c5"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lrt':1102" class="idref" href="#lrt':1102"><span class="id" title="binder">lrt'</span></a> <a id="rs':1103" class="idref" href="#rs':1103"><span class="id" title="binder">rs'</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#004aab482dcdc9090f75cce2c81972ad"><span class="id" title="variable">φ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8275a8d5da268fd2eb8bfc14e379e37c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8275a8d5da268fd2eb8bfc14e379e37c"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rs':1103"><span class="id" title="variable">rs'</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lr:1094"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':1102"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1096"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1097"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#c29eeaed71cef73d297e5f7f8e24b6a5"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':1102"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rs':1103"><span class="id" title="variable">rs'</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:1091"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1095"><span class="id" title="variable">lrt</span></a>) (<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8275a8d5da268fd2eb8bfc14e379e37c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8275a8d5da268fd2eb8bfc14e379e37c"><span class="id" title="variable">t</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#ed452127c9488f164aa2f6ab173eb6c5"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c29eeaed71cef73d297e5f7f8e24b6a5"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hφr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_eqn"><span class="id" title="axiom">wp_opt2_eqn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφr Hk]"<span class="id" title="notation">)</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφr %Heq1 %Heq2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"Hk" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <span class="id" title="var">_</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(</span><span class="id" title="notation">reg</span> <span class="id" title="notation">φ</span><span class="id" title="notation">t</span><span class="id" title="notation">)</span><span class="id" title="notation">))</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_transient_from_regs_mod"><span class="id" title="axiom">update_state_interp_transient_from_regs_mod</span></a> <span class="id" title="var">Hdom</span> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f2</span> <span class="id" title="var">v</span>) <span class="id" title="notation">with</span> "Hφr"<span class="id" title="notation">)</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cur_map</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_lword_lea"><span class="id" title="axiom">is_cur_lword_lea</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">lw</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f1</span> <span class="id" title="var">v</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules.rules_base.html#cap_lang_rules_opt"><span class="id" title="section">cap_lang_rules_opt</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
