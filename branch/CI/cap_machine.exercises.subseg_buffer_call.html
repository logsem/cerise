<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">cap_machine.exercises.subseg_buffer_call</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">frac</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">tactics</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.examples.malloc.html#"><span class="id" title="library">malloc</span></a> <a class="idref" href="cap_machine.examples.macros.html#"><span class="id" title="library">macros</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.fundamental.html#"><span class="id" title="library">fundamental</span></a> <a class="idref" href="cap_machine.logrel.html#"><span class="id" title="library">logrel</span></a> <a class="idref" href="cap_machine.rules.html#"><span class="id" title="library">rules</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.proofmode.tactics_helpers.html#"><span class="id" title="library">tactics_helpers</span></a> <a class="idref" href="cap_machine.proofmode.proofmode.html#"><span class="id" title="library">proofmode</span></a> <a class="idref" href="cap_machine.proofmode.register_tactics.html#"><span class="id" title="library">register_tactics</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine.examples</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.examples.template_adequacy.html#"><span class="id" title="library">template_adequacy</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine.exercises</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.exercises.subseg_buffer.html#"><span class="id" title="library">subseg_buffer</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine.examples</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.examples.template_adequacy.html#"><span class="id" title="library">template_adequacy</span></a> <a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#"><span class="id" title="library">template_adequacy_ocpl</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.examples.call.html#"><span class="id" title="library">call</span></a> <a class="idref" href="cap_machine.examples.callback.html#"><span class="id" title="library">callback</span></a>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>

<br/>
</div>

<div class="doc">
Variant of the exercise where we use the call macro
    to jump to the adversary 
<div class="paragraph"> </div>

 The full program does the following:
<ul class="doclist">
<li> allocates a region

</li>
<li> stores a secret data in the newly allocated region

</li>
<li> derives 2 capabilities:
        + Cs: from the beginning of the buffer to the secret address
        + Cp: from the secret address (not included) to the end of the buffer

</li>
<li> calls the adversary (with the call macro)
        + locally encapsulates Cs
        + gives Cp in parameter for the adversary

</li>
<li> after the call, restores the locals and asserts the integrity of
        the secret data

</li>
<li> halts 

</li>
</ul>
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a id="program_call" class="idref" href="#program_call"><span class="id" title="section">program_call</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="0101b9beac487b383a5ba2a8f6922788" class="idref" href="#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="binder">Σ</span></a>:<span class="id" title="record">gFunctors</span>} {<a id="memg:2" class="idref" href="#memg:2"><span class="id" title="binder">memg</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#memG"><span class="id" title="class">memG</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>} {<a id="regg:3" class="idref" href="#regg:3"><span class="id" title="binder">regg</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#regG"><span class="id" title="class">regG</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>} {<a id="sealsg:4" class="idref" href="#sealsg:4"><span class="id" title="binder">sealsg</span></a> : <a class="idref" href="cap_machine.seal_store.html#sealStoreG"><span class="id" title="class">sealStoreG</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="MP:5" class="idref" href="#MP:5"><span class="id" title="binder">MP</span></a>: <a class="idref" href="cap_machine.machine_parameters.html#MachineParameters"><span class="id" title="class">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="nainv:6" class="idref" href="#nainv:6"><span class="id" title="binder">nainv</span></a>: <a class="idref" href="cap_machine.logrel.html#logrel_na_invs"><span class="id" title="class">logrel_na_invs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#3f70014d6833c01843097865a581990c"><span class="id" title="variable">Σ</span></a>}.<br/>

<br/>
</div>

<div class="doc">
Definition useful tactics 
</div>
<div class="code">
&nbsp;&nbsp;<span class="comment">(*&nbsp;Address&nbsp;arithmetic&nbsp;solver&nbsp;with&nbsp;substitution&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_addr'</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">x</span> := <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">solve_addr</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Set&nbsp;an&nbsp;Iris&nbsp;proposition&nbsp;as&nbsp;a&nbsp;variable:&nbsp;allows&nbsp;to&nbsp;hide&nbsp;it&nbsp;in&nbsp;Emacs<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;clarify&nbsp;the&nbsp;goal&nbsp;buffer&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">iHide0</span> <span class="id" title="var">irisH</span> <span class="id" title="var">coqH</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">coqH</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="var">coqH</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span>: <span class="id" title="projection">_</span> <span class="id" title="projection">|-</span> <span class="id" title="keyword">context</span> [ <span class="id" title="constructor">environments.Esnoc</span> <span class="id" title="var">_</span> (<span class="id" title="constructor">INamed</span> <span class="id" title="var">irisH</span>) ?<span class="id" title="var">prop</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">coqH</span> := <span class="id" title="var">prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Tactic Notation</span> "iHide" <span class="id" title="keyword">constr</span>(<span class="id" title="var">irisH</span>) "as" <span class="id" title="var">ident</span>(<span class="id" title="var">coqH</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iHide0</span> <span class="id" title="var">irisH</span> <span class="id" title="var">coqH</span>.<br/>

<br/>
</div>

<div class="doc">
Definition of the program 
<div class="paragraph"> </div>

 P1) First part: store the secret data, derive Cp and derive Cs 
</div>
<div class="code">
&nbsp;&nbsp;<span class="comment">(*&nbsp;-&nbsp;r_mem&nbsp;is&nbsp;the&nbsp;register&nbsp;that&nbsp;contains&nbsp;the&nbsp;capability&nbsp;pointing&nbsp;to<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;allocated&nbsp;buffer<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;secret_off&nbsp;is&nbsp;the&nbsp;offset&nbsp;of&nbsp;the&nbsp;secret&nbsp;in&nbsp;the&nbsp;buffer<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;secret&nbsp;is&nbsp;the&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;buffer&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="prog_secret_instrs" class="idref" href="#prog_secret_instrs"><span class="id" title="definition">prog_secret_instrs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="r_mem:7" class="idref" href="#r_mem:7"><span class="id" title="binder">r_mem</span></a> <a id="r_mem':8" class="idref" href="#r_mem':8"><span class="id" title="binder">r_mem'</span></a> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="secret_off:9" class="idref" href="#secret_off:9"><span class="id" title="binder">secret_off</span></a> <a id="secret:10" class="idref" href="#secret:10"><span class="id" title="binder">secret</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#encodeInstrsW"><span class="id" title="definition">encodeInstrsW</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.machine_base.html#Mov"><span class="id" title="constructor">Mov</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem':8"><span class="id" title="variable">r_mem'</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem:7"><span class="id" title="variable">r_mem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer.html#prog_base_instrs"><span class="id" title="definition">prog_base_instrs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem:7"><span class="id" title="variable">r_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:9"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret:10"><span class="id" title="variable">secret</span></a> <span class="comment">(*&nbsp;store&nbsp;data&nbsp;+&nbsp;derive&nbsp;Cp*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="cap_machine.machine_parameters.html#encodeInstrsW"><span class="id" title="definition">encodeInstrsW</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a> <span class="comment">(*&nbsp;derive&nbsp;Cs*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#GetB"><span class="id" title="constructor">GetB</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem':8"><span class="id" title="variable">r_mem'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#GetB"><span class="id" title="constructor">GetB</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem':8"><span class="id" title="variable">r_mem'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#Add"><span class="id" title="constructor">Add</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:9"><span class="id" title="variable">secret_off</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a>1) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#Subseg"><span class="id" title="constructor">Subseg</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem':8"><span class="id" title="variable">r_mem'</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
P) Full program, no assumptions on the registers 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="prog_call_instrs" class="idref" href="#prog_call_instrs"><span class="id" title="definition">prog_call_instrs</span></a> <a id="f_m:11" class="idref" href="#f_m:11"><span class="id" title="binder">f_m</span></a> <a id="f_a:12" class="idref" href="#f_a:12"><span class="id" title="binder">f_a</span></a> (<a id="size:13" class="idref" href="#size:13"><span class="id" title="binder">size</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="secret_off:14" class="idref" href="#secret_off:14"><span class="id" title="binder">secret_off</span></a> <a id="secret_val:15" class="idref" href="#secret_val:15"><span class="id" title="binder">secret_val</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.macros.html#malloc_instrs"><span class="id" title="definition">malloc_instrs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_m:11"><span class="id" title="variable">f_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#size:13"><span class="id" title="variable">size</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#encodeInstrsW"><span class="id" title="definition">encodeInstrsW</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a> <a class="idref" href="cap_machine.machine_base.html#Mov"><span class="id" title="constructor">Mov</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t1"><span class="id" title="definition">r_t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="cap_machine.machine_base.html#Mov"><span class="id" title="constructor">Mov</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t1"><span class="id" title="definition">r_t1</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_secret_instrs"><span class="id" title="definition">prog_secret_instrs</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:14"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:15"><span class="id" title="variable">secret_val</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.call.html#call_instrs"><span class="id" title="definition">call_instrs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_m:11"><span class="id" title="variable">f_m</span></a> (<a class="idref" href="cap_machine.examples.call.html#offset_to_cont_call"><span class="id" title="definition">offset_to_cont_call</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.callback.html#restore_locals_instrs"><span class="id" title="definition">restore_locals_instrs</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#encodeInstrsW"><span class="id" title="definition">encodeInstrsW</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a> <span class="comment">(*&nbsp;prepare&nbsp;the&nbsp;registers&nbsp;for&nbsp;the&nbsp;assert&nbsp;macro&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#Load"><span class="id" title="constructor">Load</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>      <span class="comment">(*&nbsp;r_t2&nbsp;-&gt;&nbsp;(RWX,&nbsp;b_mem,&nbsp;(b_mem&nbsp;^+&nbsp;(secret_off+1))*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#Lea"><span class="id" title="constructor">Lea</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:14"><span class="id" title="variable">secret_off</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;r_t2&nbsp;-&gt;&nbsp;(RWX,&nbsp;b_mem,&nbsp;(b_mem&nbsp;^+&nbsp;(secret_off+1))a)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#Load"><span class="id" title="constructor">Load</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t4"><span class="id" title="definition">r_t4</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>      <span class="comment">(*&nbsp;r_t4&nbsp;-&gt;&nbsp;secret_val&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#Mov"><span class="id" title="constructor">Mov</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t5"><span class="id" title="definition">r_t5</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:15"><span class="id" title="variable">secret_val</span></a> <span class="comment">(*&nbsp;Prepare&nbsp;the&nbsp;assert&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="cap_machine.examples.macros.html#assert_instrs"><span class="id" title="definition">assert_instrs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_a:12"><span class="id" title="variable">f_a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="cap_machine.machine_parameters.html#encodeInstrsW"><span class="id" title="definition">encodeInstrsW</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a> <a class="idref" href="cap_machine.machine_base.html#Halt"><span class="id" title="constructor">Halt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="prog_call_code" class="idref" href="#prog_call_code"><span class="id" title="definition">prog_call_code</span></a> <a id="a_prog:16" class="idref" href="#a_prog:16"><span class="id" title="binder">a_prog</span></a> <a id="f_m:17" class="idref" href="#f_m:17"><span class="id" title="binder">f_m</span></a> <a id="f_a:18" class="idref" href="#f_a:18"><span class="id" title="binder">f_a</span></a> (<a id="size:19" class="idref" href="#size:19"><span class="id" title="binder">size</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="secret_off:20" class="idref" href="#secret_off:20"><span class="id" title="binder">secret_off</span></a> <a id="secret_val:21" class="idref" href="#secret_val:21"><span class="id" title="binder">secret_val</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">[∗</span> <span class="id" title="notation">list</span><span class="id" title="notation">]</span> <a id="a_i:22" class="idref" href="#a_i:22"><span class="id" title="binder"><span id="a_i:23" class="id">a_i</span></span></a><span class="id" title="notation">;</span><a id="w:24" class="idref" href="#w:24"><span class="id" title="binder"><span id="w:25" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_prog:16"><span class="id" title="variable">a_prog</span></a><span class="id" title="notation">;(</span><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_instrs"><span class="id" title="definition">prog_call_instrs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_m:17"><span class="id" title="variable">f_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_a:18"><span class="id" title="variable">f_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#size:19"><span class="id" title="variable">size</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:20"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:21"><span class="id" title="variable">secret_val</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_i:22"><span class="id" title="variable">a_i</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:24"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>

<br/>
</div>

<div class="doc">
Definition of the invariants 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="call_versionN" class="idref" href="#call_versionN"><span class="id" title="definition">call_versionN</span></a> : <span class="id" title="definition">namespace</span> := <span class="id" title="definition">nroot</span> <span class="id" title="notation">.@</span> "call_version".<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Program&nbsp;invariant&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="call_codeN" class="idref" href="#call_codeN"><span class="id" title="definition">call_codeN</span></a> := (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_versionN"><span class="id" title="definition">call_versionN</span></a><span class="id" title="notation">.@</span>"code").<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="prog_call_inv" class="idref" href="#prog_call_inv"><span class="id" title="definition">prog_call_inv</span></a> <a id="a:26" class="idref" href="#a:26"><span class="id" title="binder">a</span></a> <a id="f_m:27" class="idref" href="#f_m:27"><span class="id" title="binder">f_m</span></a> <a id="f_a:28" class="idref" href="#f_a:28"><span class="id" title="binder">f_a</span></a> <a id="size:29" class="idref" href="#size:29"><span class="id" title="binder">size</span></a> <a id="secret_off:30" class="idref" href="#secret_off:30"><span class="id" title="binder">secret_off</span></a> <a id="secret_val:31" class="idref" href="#secret_val:31"><span class="id" title="binder">secret_val</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">na_inv</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_codeN"><span class="id" title="definition">call_codeN</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_code"><span class="id" title="definition">prog_call_code</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:26"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_m:27"><span class="id" title="variable">f_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_a:28"><span class="id" title="variable">f_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#size:29"><span class="id" title="variable">size</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:30"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:31"><span class="id" title="variable">secret_val</span></a> ).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="malloc_call_inv" class="idref" href="#malloc_call_inv"><span class="id" title="definition">malloc_call_inv</span></a> <a id="b_m:32" class="idref" href="#b_m:32"><span class="id" title="binder">b_m</span></a> <a id="e_m:33" class="idref" href="#e_m:33"><span class="id" title="binder">e_m</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">na_inv</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.mallocN"><span class="id" title="definition">ocpl.mallocN</span></a> (<a class="idref" href="cap_machine.examples.malloc.html#malloc_inv"><span class="id" title="definition">malloc_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_m:32"><span class="id" title="variable">b_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_m:33"><span class="id" title="variable">e_m</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Assert&nbsp;invariant&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="assert_call_inv" class="idref" href="#assert_call_inv"><span class="id" title="definition">assert_call_inv</span></a> <a id="b_a:34" class="idref" href="#b_a:34"><span class="id" title="binder">b_a</span></a> <a id="e_a:35" class="idref" href="#e_a:35"><span class="id" title="binder">e_a</span></a> <a id="a_flag:36" class="idref" href="#a_flag:36"><span class="id" title="binder">a_flag</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">na_inv</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assertN"><span class="id" title="definition">ocpl.assertN</span></a> (<a class="idref" href="cap_machine.examples.assert.html#assert_inv"><span class="id" title="definition">assert_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_a:34"><span class="id" title="variable">b_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_flag:36"><span class="id" title="variable">a_flag</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_a:35"><span class="id" title="variable">e_a</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="flag_call_inv" class="idref" href="#flag_call_inv"><span class="id" title="definition">flag_call_inv</span></a> <a id="a_flag:37" class="idref" href="#a_flag:37"><span class="id" title="binder">a_flag</span></a> <a id="flagN:38" class="idref" href="#flagN:38"><span class="id" title="binder">flagN</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">inv</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#flagN:38"><span class="id" title="variable">flagN</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_flag:37"><span class="id" title="variable">a_flag</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> 0%<span class="id" title="var">Z</span>) .<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="call_actN" class="idref" href="#call_actN"><span class="id" title="definition">call_actN</span></a> : <span class="id" title="definition">namespace</span> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_versionN"><span class="id" title="definition">call_versionN</span></a> <span class="id" title="notation">.@</span> "act".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="call_localsN" class="idref" href="#call_localsN"><span class="id" title="definition">call_localsN</span></a> : <span class="id" title="definition">namespace</span> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_versionN"><span class="id" title="definition">call_versionN</span></a> <span class="id" title="notation">.@</span> "locals".<br/>

<br/>
</div>

<div class="doc">
Specifications 
</div>
<div class="code">
&nbsp;&nbsp;<span class="comment">(*&nbsp;Specification&nbsp;P1&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prog_secret_spec" class="idref" href="#prog_secret_spec"><span class="id" title="lemma">prog_secret_spec</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="r_mem:39" class="idref" href="#r_mem:39"><span class="id" title="binder">r_mem</span></a> <a id="r_mem':40" class="idref" href="#r_mem':40"><span class="id" title="binder">r_mem'</span></a> <a id="secret_off:41" class="idref" href="#secret_off:41"><span class="id" title="binder">secret_off</span></a> <a id="secret:42" class="idref" href="#secret:42"><span class="id" title="binder">secret</span></a> <span class="comment">(*&nbsp;instantiation&nbsp;prog_base&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="p_pc:43" class="idref" href="#p_pc:43"><span class="id" title="binder">p_pc</span></a> <a id="b_pc:44" class="idref" href="#b_pc:44"><span class="id" title="binder">b_pc</span></a> <a id="e_pc:45" class="idref" href="#e_pc:45"><span class="id" title="binder">e_pc</span></a> <a id="s_prog:46" class="idref" href="#s_prog:46"><span class="id" title="binder">s_prog</span></a> <span class="comment">(*&nbsp;pc&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="p_mem:47" class="idref" href="#p_mem:47"><span class="id" title="binder">p_mem</span></a> <a id="b_mem:48" class="idref" href="#b_mem:48"><span class="id" title="binder">b_mem</span></a> <a id="e_mem:49" class="idref" href="#e_mem:49"><span class="id" title="binder">e_mem</span></a> <span class="comment">(*&nbsp;mem&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="w2:50" class="idref" href="#w2:50"><span class="id" title="binder">w2</span></a> <a id="w3:51" class="idref" href="#w3:51"><span class="id" title="binder">w3</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="61a02e58de2729ebf34d706c72aaf4b0" class="idref" href="#61a02e58de2729ebf34d706c72aaf4b0"><span class="id" title="binder">φ</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="e_prog:53" class="idref" href="#e_prog:53"><span class="id" title="binder">e_prog</span></a> := (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#s_prog:46"><span class="id" title="variable">s_prog</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <span class="id" title="abbreviation">length</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_secret_instrs"><span class="id" title="definition">prog_secret_instrs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem:39"><span class="id" title="variable">r_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem':40"><span class="id" title="variable">r_mem'</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:41"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret:42"><span class="id" title="variable">secret</span></a>))%<span class="id" title="var">a</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="a_secret:54" class="idref" href="#a_secret:54"><span class="id" title="binder">a_secret</span></a> := (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:41"><span class="id" title="variable">secret_off</span></a>)%<span class="id" title="var">a</span> <span class="id" title="tactic">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Validity&nbsp;pc&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#ExecPCPerm"><span class="id" title="definition">ExecPCPerm</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#p_pc:43"><span class="id" title="variable">p_pc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_base.html#SubBounds"><span class="id" title="definition">SubBounds</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_pc:44"><span class="id" title="variable">b_pc</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_pc:45"><span class="id" title="variable">e_pc</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#s_prog:46"><span class="id" title="variable">s_prog</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_prog:53"><span class="id" title="variable">e_prog</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Validity&nbsp;buffer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.addr_reg.html#ecb49afb136c57143f8ddd1e3e9a03fe"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_secret:54"><span class="id" title="variable">a_secret</span></a> <a class="idref" href="cap_machine.addr_reg.html#ecb49afb136c57143f8ddd1e3e9a03fe"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_mem:49"><span class="id" title="variable">e_mem</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#writeAllowed"><span class="id" title="definition">writeAllowed</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#p_mem:47"><span class="id" title="variable">p_mem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Specification&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> (<span class="id" title="notation">(</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#p_pc:43"><span class="id" title="variable">p_pc</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_pc:44"><span class="id" title="variable">b_pc</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_pc:45"><span class="id" title="variable">e_pc</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#s_prog:46"><span class="id" title="variable">s_prog</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem:39"><span class="id" title="variable">r_mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#p_mem:47"><span class="id" title="variable">p_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_mem:49"><span class="id" title="variable">e_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">∃</span> <a id="wm:55" class="idref" href="#wm:55"><span class="id" title="binder">wm</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem':40"><span class="id" title="variable">r_mem'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#wm:55"><span class="id" title="variable">wm</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w2:50"><span class="id" title="variable">w2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w3:51"><span class="id" title="variable">w3</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;I'd&nbsp;like&nbsp;to&nbsp;generelize&nbsp;more&nbsp;this&nbsp;hypothesis,&nbsp;such&nbsp;that&nbsp;it&nbsp;can&nbsp;be<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usefull&nbsp;even&nbsp;if&nbsp;I&nbsp;don't&nbsp;have&nbsp;a&nbsp;region&nbsp;of&nbsp;zeroes&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">[[</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a><a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_mem:49"><span class="id" title="variable">e_mem</span></a><a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">]]</span></a> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">[[</span></a> <a class="idref" href="cap_machine.examples.addr_reg_sample.html#region_addrs_zeroes"><span class="id" title="definition">region_addrs_zeroes</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_mem:49"><span class="id" title="variable">e_mem</span></a> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">]]</span></a><br/>
         <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.proofmode.region.html#codefrag"><span class="id" title="definition">codefrag</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#s_prog:46"><span class="id" title="variable">s_prog</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_secret_instrs"><span class="id" title="definition">prog_secret_instrs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem:39"><span class="id" title="variable">r_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem':40"><span class="id" title="variable">r_mem'</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:41"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret:42"><span class="id" title="variable">secret</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#p_pc:43"><span class="id" title="variable">p_pc</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_pc:44"><span class="id" title="variable">b_pc</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_pc:45"><span class="id" title="variable">e_pc</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_prog:53"><span class="id" title="variable">e_prog</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem:39"><span class="id" title="variable">r_mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#p_mem:47"><span class="id" title="variable">p_mem</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_secret:54"><span class="id" title="variable">a_secret</span></a><a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a>1)%<span class="id" title="var">a</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_mem:49"><span class="id" title="variable">e_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_secret:54"><span class="id" title="variable">a_secret</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem':40"><span class="id" title="variable">r_mem'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#p_mem:47"><span class="id" title="variable">p_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_secret:54"><span class="id" title="variable">a_secret</span></a><a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a>1)%<span class="id" title="var">a</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:41"><span class="id" title="variable">secret_off</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">[[</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a><a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_secret:54"><span class="id" title="variable">a_secret</span></a><a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">]]</span></a> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">[[</span></a> <a class="idref" href="cap_machine.examples.addr_reg_sample.html#region_addrs_zeroes"><span class="id" title="definition">region_addrs_zeroes</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:48"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_secret:54"><span class="id" title="variable">a_secret</span></a> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">]]</span></a><br/>
               <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_secret:54"><span class="id" title="variable">a_secret</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret:42"><span class="id" title="variable">secret</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">[[</span></a>(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_secret:54"><span class="id" title="variable">a_secret</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a>1)%<span class="id" title="var">a</span><a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_mem:49"><span class="id" title="variable">e_mem</span></a><a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">]]</span></a> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">[[</span></a> <a class="idref" href="cap_machine.examples.addr_reg_sample.html#region_addrs_zeroes"><span class="id" title="definition">region_addrs_zeroes</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_secret:54"><span class="id" title="variable">a_secret</span></a><a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a>1)%<span class="id" title="var">a</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_mem:49"><span class="id" title="variable">e_mem</span></a> <a class="idref" href="cap_machine.proofmode.region.html#f61454323753175334a2a2859e68823d"><span class="id" title="notation">]]</span></a><br/>
               <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.proofmode.region.html#codefrag"><span class="id" title="definition">codefrag</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#s_prog:46"><span class="id" title="variable">s_prog</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_secret_instrs"><span class="id" title="definition">prog_secret_instrs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem:39"><span class="id" title="variable">r_mem</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_mem':40"><span class="id" title="variable">r_mem'</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:41"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret:42"><span class="id" title="variable">secret</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <span class="id" title="notation">{{</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#61a02e58de2729ebf34d706c72aaf4b0"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">}}</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <span class="id" title="notation">{{</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#61a02e58de2729ebf34d706c72aaf4b0"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">}}</span>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> (<span class="id" title="tactic">try</span> <span class="id" title="var">solve_addr'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e_prog</span> <span class="id" title="var">a_secret</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hpc_perm</span> <span class="id" title="var">Hpc_bounds</span> <span class="id" title="var">Hsecret_bounds</span> <span class="id" title="var">Hp_mem</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(HPC &amp; Hr_mem &amp; Hr_mem' &amp; Hr2 &amp; Hr3 &amp; Hmem &amp; Hprog &amp; Post)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iDestruct</span> "Hr_mem'" <span class="id" title="keyword">as</span> (<span class="id" title="var">wmem</span>) "Hr_mem'".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;For&nbsp;more&nbsp;clarity,&nbsp;we&nbsp;split&nbsp;the&nbsp;fragments&nbsp;of&nbsp;the&nbsp;programs&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.proofmode.region.html#region_mapsto"><span class="id" title="definition">region_mapsto</span></a> /<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_secret_instrs"><span class="id" title="definition">prog_secret_instrs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span>:<span class="id" title="var">_</span> |- <span class="id" title="keyword">context</span> [<a class="idref" href="cap_machine.proofmode.region.html#codefrag"><span class="id" title="definition">codefrag</span></a> <span class="id" title="var">_</span> (?<span class="id" title="var">l1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> ?<span class="id" title="var">l2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> ?<span class="id" title="var">l3</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">copy_instrs</span> := <span class="id" title="var">l1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">set</span> (<span class="id" title="var">prog_base_instrs</span> := <span class="id" title="var">l2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">set</span> (<span class="id" title="var">secret_instrs</span> := <span class="id" title="var">l3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e_prog</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">e_prog</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Fragment&nbsp;1&nbsp;-&nbsp;copy&nbsp;the&nbsp;buffer&nbsp;capability&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codefrag_facts</span> "Hprog".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">focus_block_0</span> "Hprog" <span class="id" title="keyword">as</span> "Hcopy" "Hcont".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iGo</span> "Hcopy".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unfocus_block</span> "Hcopy" "Hcont" <span class="id" title="keyword">as</span> "Hprog".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Fragment&nbsp;2&nbsp;-&nbsp;execute&nbsp;base&nbsp;program&nbsp;(cf.&nbsp;subseg_buffer)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;restrict&nbsp;capability&nbsp;to&nbsp;public&nbsp;buffer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">focus_block</span> 1%<span class="id" title="var">nat</span> "Hprog" <span class="id" title="keyword">as</span> <span class="id" title="var">amid</span> <span class="id" title="var">Hamid</span> "Hprog_base" "Hcont".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.exercises.subseg_buffer.html#prog_base_spec"><span class="id" title="axiom">prog_base_spec</span></a> <span class="id" title="notation">with</span> "[- $HPC $Hr2 $Hr3 $Hmem $Hr_mem $Hprog_base]"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iIntros</span> "(HPC &amp; Hr_mem &amp; Hr2 &amp; Hr3 &amp; Hmem &amp; Hsecret &amp; Hmem' &amp; Hprog_base)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unfocus_block</span> "Hprog_base" "Hcont" <span class="id" title="keyword">as</span> "Hprog".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Fragment&nbsp;3&nbsp;-&nbsp;restrict&nbsp;capability&nbsp;to&nbsp;secret&nbsp;buffer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">focus_block</span> 2%<span class="id" title="var">nat</span> "Hprog" <span class="id" title="keyword">as</span> <span class="id" title="var">apc_secret</span> <span class="id" title="var">Hapc_secret</span> "Hprog_secret" "Hcont".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iGo</span> "Hprog_secret".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">transitivity</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="var">b_mem</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">(</span></a><span class="id" title="var">secret_off</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a>1<a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">a</span>) ; <span class="id" title="tactic">auto</span> ; <span class="id" title="var">solve_addr'</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> -&gt; ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp_mem</span> ; <span class="id" title="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">solve_addr'</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unfocus_block</span> "Hprog_secret" "Hcont" <span class="id" title="keyword">as</span> "Hprog".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Post&nbsp;condition&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "Post".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">apc_secret</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 4)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">s_prog</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 11%<span class="id" title="var">nat</span>)%<span class="id" title="var">a</span> <span class="id" title="tactic">by</span> <span class="id" title="var">solve_addr'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">a_secret</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">(</span></a><span class="id" title="var">b_mem</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <span class="id" title="var">secret_off</span><a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">b_mem</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">(</span></a><span class="id" title="var">secret_off</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a>1<a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">a</span> <span class="id" title="tactic">by</span> <span class="id" title="var">solve_addr'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Specification&nbsp;for&nbsp;the&nbsp;preparation&nbsp;of&nbsp;the&nbsp;registers&nbsp;for&nbsp;the&nbsp;assert&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prepa_assert_spec" class="idref" href="#prepa_assert_spec"><span class="id" title="lemma">prepa_assert_spec</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="prepa_addrs:56" class="idref" href="#prepa_addrs:56"><span class="id" title="binder">prepa_addrs</span></a> <a id="a_prepa:57" class="idref" href="#a_prepa:57"><span class="id" title="binder">a_prepa</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="pc_p:58" class="idref" href="#pc_p:58"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:59" class="idref" href="#pc_b:59"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:60" class="idref" href="#pc_e:60"><span class="id" title="binder">pc_e</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="secret_off:61" class="idref" href="#secret_off:61"><span class="id" title="binder">secret_off</span></a> <a id="secret_val:62" class="idref" href="#secret_val:62"><span class="id" title="binder">secret_val</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="b_local:63" class="idref" href="#b_local:63"><span class="id" title="binder">b_local</span></a> <a id="e_locals:64" class="idref" href="#e_locals:64"><span class="id" title="binder">e_locals</span></a> <a id="w4:65" class="idref" href="#w4:65"><span class="id" title="binder">w4</span></a> <a id="w5:66" class="idref" href="#w5:66"><span class="id" title="binder">w5</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="b_mem:67" class="idref" href="#b_mem:67"><span class="id" title="binder">b_mem</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>) <a id="EN:68" class="idref" href="#EN:68"><span class="id" title="binder">EN</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="c999342aad4195bf66e3a9f62a458ce4" class="idref" href="#c999342aad4195bf66e3a9f62a458ce4"><span class="id" title="binder">φ</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="instrs_prepa:70" class="idref" href="#instrs_prepa:70"><span class="id" title="binder">instrs_prepa</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.machine_parameters.html#encodeInstrW"><span class="id" title="definition">encodeInstrW</span></a> (<a class="idref" href="cap_machine.machine_base.html#Load"><span class="id" title="constructor">Load</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#encodeInstrW"><span class="id" title="definition">encodeInstrW</span></a> (<a class="idref" href="cap_machine.machine_base.html#Lea"><span class="id" title="constructor">Lea</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:61"><span class="id" title="variable">secret_off</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#encodeInstrW"><span class="id" title="definition">encodeInstrW</span></a> (<a class="idref" href="cap_machine.machine_base.html#Load"><span class="id" title="constructor">Load</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t4"><span class="id" title="definition">r_t4</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#encodeInstrW"><span class="id" title="definition">encodeInstrW</span></a> (<a class="idref" href="cap_machine.machine_base.html#Mov"><span class="id" title="constructor">Mov</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t5"><span class="id" title="definition">r_t5</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:62"><span class="id" title="variable">secret_val</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="e_prepa:71" class="idref" href="#e_prepa:71"><span class="id" title="binder">e_prepa</span></a> := (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_prepa:57"><span class="id" title="variable">a_prepa</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">(</span></a><span class="id" title="abbreviation">length</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#instrs_prepa:70"><span class="id" title="variable">instrs_prepa</span></a><a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">a</span> <span class="id" title="tactic">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between"><span class="id" title="inductive">contiguous_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prepa_addrs:56"><span class="id" title="variable">prepa_addrs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_prepa:57"><span class="id" title="variable">a_prepa</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_prepa:71"><span class="id" title="variable">e_prepa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#ExecPCPerm"><span class="id" title="definition">ExecPCPerm</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_p:58"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_base.html#SubBounds"><span class="id" title="definition">SubBounds</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_b:59"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_e:60"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_prepa:57"><span class="id" title="variable">a_prepa</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_prepa:71"><span class="id" title="variable">e_prepa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_local:63"><span class="id" title="variable">b_local</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_locals:64"><span class="id" title="variable">e_locals</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> <span class="id" title="notation">≤</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:61"><span class="id" title="variable">secret_off</span></a>)%<span class="id" title="var">a</span> <span class="id" title="notation">&lt;</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:61"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1<a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> ( <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_p:58"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_b:59"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_e:60"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_prepa:57"><span class="id" title="variable">a_prepa</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_local:63"><span class="id" title="variable">b_local</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_locals:64"><span class="id" title="variable">e_locals</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_local:63"><span class="id" title="variable">b_local</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t4"><span class="id" title="definition">r_t4</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w4:65"><span class="id" title="variable">w4</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t5"><span class="id" title="definition">r_t5</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w5:66"><span class="id" title="variable">w5</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_local:63"><span class="id" title="variable">b_local</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:61"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1<a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:61"><span class="id" title="variable">secret_off</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:62"><span class="id" title="variable">secret_val</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.proofmode.region.html#codefrag"><span class="id" title="definition">codefrag</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_prepa:57"><span class="id" title="variable">a_prepa</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#instrs_prepa:70"><span class="id" title="variable">instrs_prepa</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">▷</span> ( <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_p:58"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_b:59"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_e:60"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_prepa:71"><span class="id" title="variable">e_prepa</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:61"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1<a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">a</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:61"><span class="id" title="variable">secret_off</span></a>)%<span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t4"><span class="id" title="definition">r_t4</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:62"><span class="id" title="variable">secret_val</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t5"><span class="id" title="definition">r_t5</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:62"><span class="id" title="variable">secret_val</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_local:63"><span class="id" title="variable">b_local</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:61"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1<a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_mem:67"><span class="id" title="variable">b_mem</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:61"><span class="id" title="variable">secret_off</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:62"><span class="id" title="variable">secret_val</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.proofmode.region.html#codefrag"><span class="id" title="definition">codefrag</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_prepa:57"><span class="id" title="variable">a_prepa</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#instrs_prepa:70"><span class="id" title="variable">instrs_prepa</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#EN:68"><span class="id" title="variable">EN</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#c999342aad4195bf66e3a9f62a458ce4"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">}}</span>)%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#EN:68"><span class="id" title="variable">EN</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#c999342aad4195bf66e3a9f62a458ce4"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">}}</span>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">instrs_prepa</span> <span class="id" title="var">e_prepa</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hcont_prepa</span> <span class="id" title="var">Hperm</span> <span class="id" title="var">Hpc_valid</span> <span class="id" title="var">Hlocals</span> <span class="id" title="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(HPC &amp; Hr2 &amp; Hr4 &amp; Hr5 &amp; Hlocal &amp; Hsecret &amp; Hprog &amp; Hcont)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codefrag_facts</span> "Hprog".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInstr</span> "Hprog".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_base.html#le_addr_withinBounds"><span class="id" title="lemma">le_addr_withinBounds</span></a> ; <span class="id" title="var">solve_addr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInstr</span> "Hprog".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">transitivity</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="var">b_mem</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <span class="id" title="var">secret_off</span>)%<span class="id" title="var">a</span>) ; <span class="id" title="var">solve_addr</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInstr</span> "Hprog".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">eauto</span> ; <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInstr</span> "Hprog".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "Hcont". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Full&nbsp;spec&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prog_call_full_run_spec_aux" class="idref" href="#prog_call_full_run_spec_aux"><span class="id" title="lemma">prog_call_full_run_spec_aux</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;call&nbsp;*)</span> <a id="wadv:72" class="idref" href="#wadv:72"><span class="id" title="binder">wadv</span></a> <a id="w0:73" class="idref" href="#w0:73"><span class="id" title="binder">w0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;remaining&nbsp;registers&nbsp;*)</span> (<a id="rmap:74" class="idref" href="#rmap:74"><span class="id" title="binder">rmap</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;pc&nbsp;*)</span> <a id="a:75" class="idref" href="#a:75"><span class="id" title="binder">a</span></a> <a id="pc_p:76" class="idref" href="#pc_p:76"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:77" class="idref" href="#pc_b:77"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:78" class="idref" href="#pc_e:78"><span class="id" title="binder">pc_e</span></a> <a id="a_first:79" class="idref" href="#a_first:79"><span class="id" title="binder">a_first</span></a> <a id="a_last:80" class="idref" href="#a_last:80"><span class="id" title="binder">a_last</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;malloc&nbsp;*)</span> <a id="f_m:81" class="idref" href="#f_m:81"><span class="id" title="binder">f_m</span></a> <a id="b_m:82" class="idref" href="#b_m:82"><span class="id" title="binder">b_m</span></a> <a id="e_m:83" class="idref" href="#e_m:83"><span class="id" title="binder">e_m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;assert&nbsp;*)</span> <a id="f_a:84" class="idref" href="#f_a:84"><span class="id" title="binder">f_a</span></a> <a id="b_a:85" class="idref" href="#b_a:85"><span class="id" title="binder">b_a</span></a> <a id="e_a:86" class="idref" href="#e_a:86"><span class="id" title="binder">e_a</span></a> <a id="a_flag:87" class="idref" href="#a_flag:87"><span class="id" title="binder">a_flag</span></a> <a id="flagN:88" class="idref" href="#flagN:88"><span class="id" title="binder">flagN</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;linking&nbsp;*)</span> <a id="b_link:89" class="idref" href="#b_link:89"><span class="id" title="binder">b_link</span></a> <a id="a_link:90" class="idref" href="#a_link:90"><span class="id" title="binder">a_link</span></a> <a id="e_link:91" class="idref" href="#e_link:91"><span class="id" title="binder">e_link</span></a> <a id="malloc_entry:92" class="idref" href="#malloc_entry:92"><span class="id" title="binder">malloc_entry</span></a> <a id="assert_entry:93" class="idref" href="#assert_entry:93"><span class="id" title="binder">assert_entry</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="size:94" class="idref" href="#size:94"><span class="id" title="binder">size</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="secret_off:95" class="idref" href="#secret_off:95"><span class="id" title="binder">secret_off</span></a> <a id="secret_val:96" class="idref" href="#secret_val:96"><span class="id" title="binder">secret_val</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Validity&nbsp;PC&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#ExecPCPerm"><span class="id" title="definition">ExecPCPerm</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_p:76"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_base.html#SubBounds"><span class="id" title="definition">SubBounds</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_b:77"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_e:78"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_first:79"><span class="id" title="variable">a_first</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_last:80"><span class="id" title="variable">a_last</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between"><span class="id" title="inductive">contiguous_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:75"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_first:79"><span class="id" title="variable">a_first</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_last:80"><span class="id" title="variable">a_last</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Validity&nbsp;linking&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_link:89"><span class="id" title="variable">b_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_link:91"><span class="id" title="variable">e_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#malloc_entry:92"><span class="id" title="variable">malloc_entry</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_link:89"><span class="id" title="variable">b_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_link:91"><span class="id" title="variable">e_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#assert_entry:93"><span class="id" title="variable">assert_entry</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_link:90"><span class="id" title="variable">a_link</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_m:81"><span class="id" title="variable">f_m</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#malloc_entry:92"><span class="id" title="variable">malloc_entry</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_link:90"><span class="id" title="variable">a_link</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_a:84"><span class="id" title="variable">f_a</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#assert_entry:93"><span class="id" title="variable">assert_entry</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Validity&nbsp;secret*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a>0 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:95"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#size:94"><span class="id" title="variable">size</span></a> %<span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#rmap:74"><span class="id" title="variable">rmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.addr_reg.html#all_registers_s"><span class="id" title="definition">all_registers_s</span></a> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> <span class="id" title="notation">]}</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> ( <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_code"><span class="id" title="definition">prog_call_code</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:75"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_m:81"><span class="id" title="variable">f_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_a:84"><span class="id" title="variable">f_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#size:94"><span class="id" title="variable">size</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:95"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:96"><span class="id" title="variable">secret_val</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#malloc_call_inv"><span class="id" title="definition">malloc_call_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_m:82"><span class="id" title="variable">b_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_m:83"><span class="id" title="variable">e_m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#assert_call_inv"><span class="id" title="definition">assert_call_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_a:85"><span class="id" title="variable">b_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_a:86"><span class="id" title="variable">e_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_flag:87"><span class="id" title="variable">a_flag</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#flag_call_inv"><span class="id" title="definition">flag_call_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_flag:87"><span class="id" title="variable">a_flag</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#flagN:88"><span class="id" title="variable">flagN</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_p:76"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_b:77"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_e:78"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_first:79"><span class="id" title="variable">a_first</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#wadv:72"><span class="id" title="variable">wadv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="r_i:97" class="idref" href="#r_i:97"><span class="id" title="binder"><span id="r_i:98" class="id">r_i</span></span></a><span class="id" title="notation">↦</span><a id="w_i:99" class="idref" href="#w_i:99"><span class="id" title="binder"><span id="w_i:100" class="id">w_i</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#rmap:74"><span class="id" title="variable">rmap</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_i:97"><span class="id" title="variable">r_i</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w_i:99"><span class="id" title="variable">w_i</span></a><span class="id" title="notation">)</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Linking&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_b:77"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RO"><span class="id" title="constructor">RO</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_link:89"><span class="id" title="variable">b_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_link:91"><span class="id" title="variable">e_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_link:90"><span class="id" title="variable">a_link</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#malloc_entry:92"><span class="id" title="variable">malloc_entry</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_m:82"><span class="id" title="variable">b_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_m:83"><span class="id" title="variable">e_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_m:82"><span class="id" title="variable">b_m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#assert_entry:93"><span class="id" title="variable">assert_entry</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_a:85"><span class="id" title="variable">b_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_a:86"><span class="id" title="variable">e_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_a:85"><span class="id" title="variable">b_a</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="definition">na_own</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <span class="id" title="notation">⊤</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.logrel.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w0:73"><span class="id" title="variable">w0</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.logrel.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#wadv:72"><span class="id" title="variable">wadv</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <span class="id" title="notation">{{</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="v:101" class="idref" href="#v:101"><span class="id" title="binder">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#v:101"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.cap_lang.html#HaltedV"><span class="id" title="constructor">HaltedV</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">∃</span> <a id="r:102" class="idref" href="#r:102"><span class="id" title="binder">r</span></a> : <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logrel.html#full_map"><span class="id" title="definition">full_map</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r:102"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∧</span> <a class="idref" href="cap_machine.logrel.html#registers_mapsto"><span class="id" title="definition">registers_mapsto</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r:102"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">na_own</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <span class="id" title="notation">⊤</span>)%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∨</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#v:101"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">}}</span>)%<span class="id" title="var">I</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> (<span class="id" title="tactic">try</span> <span class="id" title="var">solve_addr'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Hpc_perm</span> <span class="id" title="var">Hpc_bounds</span> <span class="id" title="var">Hcont</span> <span class="id" title="var">Hwb_malloc</span> <span class="id" title="var">Hwb_assert</span> <span class="id" title="var">Hlink_malloc</span> <span class="id" title="var">Hlink_assert</span> <span class="id" title="var">Hsize</span> <span class="id" title="var">Hdom</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hprog&amp; #Hinv_malloc&amp; #Hinv_assert&amp; #Hinv_flag&amp; HPC&amp; Hr30&amp; Hrmap&amp;
Hlink&amp; Hentry_malloc&amp; Hentry_assert&amp; Hna&amp; #Hw0&amp; #Hadv)".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FTLR&nbsp;on&nbsp;wadv&nbsp;-&nbsp;we&nbsp;do&nbsp;it&nbsp;now&nbsp;because&nbsp;of&nbsp;the&nbsp;later&nbsp;modality&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.fundamental.html#jmp_to_unknown"><span class="id" title="axiom">jmp_to_unknown</span></a> <span class="id" title="notation">with</span> "Hadv"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Cont".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iHide</span> "Cont" <span class="id" title="keyword">as</span> <span class="id" title="var">cont</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;program&nbsp;is&nbsp;composed&nbsp;of&nbsp;multiple&nbsp;part.&nbsp;Most&nbsp;of&nbsp;them&nbsp;already&nbsp;have&nbsp;their<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;own&nbsp;specification.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;main&nbsp;method&nbsp;is&nbsp;the&nbsp;following:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;split&nbsp;the&nbsp;code&nbsp;into&nbsp;the&nbsp;different&nbsp;parts&nbsp;of&nbsp;the&nbsp;program<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;when&nbsp;splitting,&nbsp;generate&nbsp;hypothesis&nbsp;about&nbsp;addresses,&nbsp;required&nbsp;by&nbsp;solve_addr<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;for&nbsp;each&nbsp;part,&nbsp;prepare&nbsp;the&nbsp;resources&nbsp;and&nbsp;use&nbsp;the&nbsp;specification&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Split&nbsp;the&nbsp;program&nbsp;between&nbsp;each&nbsp;parts&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hprog"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_prog</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_code"><span class="id" title="definition">prog_call_code</span></a> /<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_instrs"><span class="id" title="definition">prog_call_instrs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;malloc&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_program_split"><span class="id" title="axiom">contiguous_between_program_split</span></a> <span class="id" title="notation">with</span> "Hprog"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">malloc_addrs</span> <span class="id" title="var">rest1</span> <span class="id" title="var">a_clear</span>) "(Hmalloc_prog &amp; Hprog &amp; #Hcont1)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcont</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hcont1" <span class="id" title="keyword">as</span> %(<span class="id" title="var">Hcont_malloc</span> &amp; <span class="id" title="var">Hcont_rest1</span> &amp; <span class="id" title="var">Heqapp1</span> &amp; <span class="id" title="var">Ha_clear</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hmalloc_prog"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_malloc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span>: <span class="id" title="var">_</span> |- <span class="id" title="keyword">context</span> [ (<span class="id" title="definition">big_sepL2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ?<span class="id" title="var">instrs</span>) ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">instrs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (?<span class="id" title="var">l0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> ?<span class="id" title="var">l1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> ?<span class="id" title="var">l2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> ?<span class="id" title="var">l3</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> ?<span class="id" title="var">l4</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> ?<span class="id" title="var">l5</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> ?<span class="id" title="var">l6</span> ) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">instrs_clear</span> := <span class="id" title="var">l0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">set</span> (<span class="id" title="var">instrs_prog</span> := <span class="id" title="var">l1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">set</span> (<span class="id" title="var">instrs_call</span> := <span class="id" title="var">l2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">set</span> (<span class="id" title="var">instrs_restore</span> := <span class="id" title="var">l3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">set</span> (<span class="id" title="var">instrs_prepa</span> := <span class="id" title="var">l4</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">set</span> (<span class="id" title="var">instrs_assert</span> := <span class="id" title="var">l5</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">set</span> (<span class="id" title="var">instrs_end</span> := <span class="id" title="var">l6</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;clear&nbsp;end&nbsp;prepare&nbsp;registers&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_program_split"><span class="id" title="axiom">contiguous_between_program_split</span></a> <span class="id" title="notation">with</span> "Hprog"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> (<span class="id" title="var">clear_addrs</span> <span class="id" title="var">rest1_addrs</span> <span class="id" title="var">a_prog</span>) "(Hclear &amp; Hrest2 &amp; #Hcont2)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcont_rest1</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hcont2" <span class="id" title="keyword">as</span> %(<span class="id" title="var">Hcont_clear</span> &amp; <span class="id" title="var">Hcont_rest2</span> &amp; <span class="id" title="var">Heqapp2</span> &amp; <span class="id" title="var">Ha_prog</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hclear"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hrest2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_rest2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;prog_base&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_program_split"><span class="id" title="axiom">contiguous_between_program_split</span></a> <span class="id" title="notation">with</span> "Hrest2"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> (<span class="id" title="var">prog_addrs</span> <span class="id" title="var">rest_addrs</span> <span class="id" title="var">a_call</span>) "(Hprogi &amp; Hrest3 &amp; #Hcont3)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcont_rest2</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hcont3" <span class="id" title="keyword">as</span> %(<span class="id" title="var">Hcont_prog</span> &amp; <span class="id" title="var">Hcont_rest3</span> &amp; <span class="id" title="var">Heqapp3</span> &amp; <span class="id" title="var">Ha_call</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hprogi"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_progi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hrest3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_rest3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_program_split"><span class="id" title="axiom">contiguous_between_program_split</span></a> <span class="id" title="notation">with</span> "Hrest3"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> (<span class="id" title="var">call_addrs</span> <span class="id" title="var">rest2_addrs</span> <span class="id" title="var">a_restore</span>) "(Hcall &amp; Hrest4 &amp; #Hcont4)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcont_rest3</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hcont4" <span class="id" title="keyword">as</span> %(<span class="id" title="var">Hcont_call</span> &amp; <span class="id" title="var">Hcont_rest4</span> &amp; <span class="id" title="var">Heqapp4</span> &amp; <span class="id" title="var">Ha_restore</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hcall"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_call</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hrest4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_rest4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;restore&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_program_split"><span class="id" title="axiom">contiguous_between_program_split</span></a> <span class="id" title="notation">with</span> "Hrest4"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> (<span class="id" title="var">restore_addrs</span> <span class="id" title="var">rest3_addrs</span> <span class="id" title="var">a_prepa</span>) "(Hrestore &amp; Hrest5 &amp; #Hcont5)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcont_rest4</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hcont5" <span class="id" title="keyword">as</span> %(<span class="id" title="var">Hcont_restore</span> &amp; <span class="id" title="var">Hcont_rest5</span> &amp; <span class="id" title="var">Heqapp5</span> &amp; <span class="id" title="var">Ha_prepa</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hrestore"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_restore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hrest5"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_rest5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;prepa&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_program_split"><span class="id" title="axiom">contiguous_between_program_split</span></a> <span class="id" title="notation">with</span> "Hrest5"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> (<span class="id" title="var">prepa_addrs</span> <span class="id" title="var">rest4_addrs</span> <span class="id" title="var">a_assert</span>) "(Hprepa &amp; Hrest6 &amp; #Hcont6)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcont_rest5</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hcont6" <span class="id" title="keyword">as</span> %(<span class="id" title="var">Hcont_prepa</span> &amp; <span class="id" title="var">Hcont_rest6</span> &amp; <span class="id" title="var">Heqapp6</span> &amp; <span class="id" title="var">Ha_assert</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hprepa"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_prepa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hrest6"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_rest6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;assert&nbsp;and&nbsp;end&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_program_split"><span class="id" title="axiom">contiguous_between_program_split</span></a> <span class="id" title="notation">with</span> "Hrest6"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> (<span class="id" title="var">assert_addrs</span> <span class="id" title="var">end_addrs</span> <span class="id" title="var">a_end</span>) "(Hassert &amp; Hend &amp; #Hcont7)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcont_rest6</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hcont7" <span class="id" title="keyword">as</span> %(<span class="id" title="var">Hcont_assert</span> &amp; <span class="id" title="var">Hcont_end</span> &amp; <span class="id" title="var">Heqapp7</span> &amp; <span class="id" title="var">Ha_end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hassert"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_assert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hend"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Part&nbsp;1&nbsp;-&nbsp;Malloc&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Prepare&nbsp;the&nbsp;resource&nbsp;for&nbsp;the&nbsp;malloc&nbsp;spec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInsert</span> "Hrmap" <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">rmap'</span> :=  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a><span class="id" title="notation">:=</span><span class="id" title="var">wadv</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">rmap</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hdom'</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">dom</span> <span class="id" title="var">rmap'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.addr_reg.html#all_registers_s"><span class="id" title="definition">all_registers_s</span></a> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><span class="id" title="notation">]}</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">rmap'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">dom_insert_L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> - <span class="id" title="lemma">difference_difference_l_L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">union_difference_L</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExtract</span> "Hrmap" <a class="idref" href="cap_machine.addr_reg.html#r_t0"><span class="id" title="definition">r_t0</span></a> <span class="id" title="keyword">as</span> "Hr0".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;malloc&nbsp;specification&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -/(<a class="idref" href="cap_machine.examples.macros.html#malloc"><span class="id" title="definition">malloc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> (<span class="id" title="lemma">wp_wand_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="v:103" class="idref" href="#v:103"><span class="id" title="binder"><span id="v:104" class="id">v</span></span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span><span class="id" title="var">_</span> <span class="id" title="notation">∨</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#v:103"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">⌝</span><span class="id" title="notation">)</span> <span class="id" title="notation">∨</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#v:103"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">⌝</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">)</span></a>))%<span class="id" title="var">I</span>. <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> (<span class="id" title="var">v</span>) "[H|H]";<span class="id" title="tactic">auto</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.examples.macros.html#malloc_spec"><span class="id" title="axiom">malloc_spec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">size</span> <span class="id" title="notation">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"[- $Hmalloc_prog $Hinv_malloc $Hna $Hlink $Hentry_malloc $HPC $Hr0 $Hrmap]"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">eauto</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">solve_ndisj</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.proofmode.contiguous.html#isCorrectPC_range"><span class="id" title="definition">contiguous.isCorrectPC_range</span></a>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_base.html#isCorrectPC_ExecPCPerm_InBounds"><span class="id" title="axiom">isCorrectPC_ExecPCPerm_InBounds</span></a> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_bounds"><span class="id" title="axiom">contiguous_between_bounds</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcont_rest1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">rmap'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_delete_L</span> !<span class="id" title="lemma">dom_insert_L</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> ( <a class="idref" href="cap_machine.addr_reg.html#all_registers_s"><span class="id" title="definition">all_registers_s</span></a> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#r_t0"><span class="id" title="definition">r_t0</span></a><span class="id" title="notation">]}</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> ( ( <a class="idref" href="cap_machine.addr_reg.html#all_registers_s"><span class="id" title="definition">all_registers_s</span></a> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><span class="id" title="notation">]}</span> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#r_t0"><span class="id" title="definition">r_t0</span></a><span class="id" title="notation">]}</span> ) ) <span class="id" title="tactic">by</span> <span class="id" title="var">set_solver</span>+.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> ( <a class="idref" href="cap_machine.addr_reg.html#all_registers_s"><span class="id" title="definition">all_registers_s</span></a> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a><span class="id" title="notation">]}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> ( ( <a class="idref" href="cap_machine.addr_reg.html#all_registers_s"><span class="id" title="definition">all_registers_s</span></a> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><span class="id" title="notation">]}</span> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a><span class="id" title="notation">]}</span> ) ) <span class="id" title="tactic">by</span> <span class="id" title="var">set_solver</span>+.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> ( <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a><span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.addr_reg.html#all_registers_s"><span class="id" title="definition">all_registers_s</span></a> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><span class="id" title="notation">]}</span> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a><span class="id" title="notation">]}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="cap_machine.addr_reg.html#all_registers_s"><span class="id" title="definition">all_registers_s</span></a> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><span class="id" title="notation">]}</span>) ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(HPC &amp; Hmalloc_prog &amp; Hlink &amp; Hentry_malloc &amp; Hreg &amp; Hr0 &amp; Hna &amp; Hrmap)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iDestruct</span> "Hreg" <span class="id" title="keyword">as</span> (<span class="id" title="var">b_mem</span> <span class="id" title="var">e_mem</span> <span class="id" title="var">Hmem_size</span>) "(Hr1 &amp; Hmem)".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Part&nbsp;2&nbsp;-&nbsp;Clear&nbsp;register&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Unlike&nbsp;the&nbsp;other&nbsp;part&nbsp;of&nbsp;the&nbsp;code,&nbsp;we&nbsp;prove&nbsp;this&nbsp;one&nbsp;instructions&nbsp;by&nbsp;instructions&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iHide</span> "Cont" <span class="id" title="keyword">as</span> <span class="id" title="var">Cont</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExtract</span> "Hrmap" <a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a> <span class="id" title="keyword">as</span> "Hr7".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 (<span class="id" title="tactic">destruct</span> <span class="id" title="var">clear_addrs</span>;[<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlength_clear</span>|]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_cons_inv_first"><span class="id" title="lemma">contiguous_between_cons_inv_first</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcont_clear</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Heq</span>;<span class="id" title="tactic">subst</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPrologue</span> "Hclear" ; <span class="id" title="var">iRename</span> "Hprog" <span class="id" title="var">into</span> "Hclear".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_Mov.html#wp_move_success_reg"><span class="id" title="axiom">wp_move_success_reg</span></a> <span class="id" title="notation">with</span> "[$HPC $Hr7 $Hr1 $Hi]"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_parameters.html#decode_encode_instrW_inv"><span class="id" title="lemma">decode_encode_instrW_inv</span></a>|..]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_base.html#isCorrectPC_ExecPCPerm_InBounds"><span class="id" title="axiom">isCorrectPC_ExecPCPerm_InBounds</span></a> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_bounds"><span class="id" title="axiom">contiguous_between_bounds</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcont_rest2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">transitivity</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">f0</span>) ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">a_clear</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a_clear</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1%<span class="id" title="var">nat</span>)%<span class="id" title="var">a</span> <span class="id" title="tactic">by</span> <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_incr_addr"><span class="id" title="axiom">contiguous_between_incr_addr</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">simplify_map_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iEpilogue</span> "(HPC &amp; Ha_clear &amp; Hr7 &amp; Hr1)".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPrologue</span> "Hclear" ; <span class="id" title="var">iRename</span> "Hprog" <span class="id" title="var">into</span> "Hclear".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_Mov.html#wp_move_success_z"><span class="id" title="axiom">wp_move_success_z</span></a> <span class="id" title="notation">with</span> "[$HPC $Hr1 $Hi]"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_parameters.html#decode_encode_instrW_inv"><span class="id" title="lemma">decode_encode_instrW_inv</span></a>|..]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_base.html#isCorrectPC_ExecPCPerm_InBounds"><span class="id" title="axiom">isCorrectPC_ExecPCPerm_InBounds</span></a> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hcont_clear'</span> := <span class="id" title="var">Hcont_clear</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_incr_addr"><span class="id" title="axiom">contiguous_between_incr_addr</span></a> <span class="id" title="var">_</span> 1%<span class="id" title="var">nat</span> <span class="id" title="var">_</span> <span class="id" title="var">f0</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <span class="id" title="var">Hcont_clear'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span>: <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between"><span class="id" title="inductive">contiguous_between</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_bounds"><span class="id" title="axiom">contiguous_between_bounds</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">simplify_map_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">transitivity</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a_prog</span>) ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlength_clear</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha_prog</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Ha_prog</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">f0</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">f0</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1%<span class="id" title="var">nat</span>)%<span class="id" title="var">a</span> <span class="id" title="tactic">by</span> <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_incr_addr"><span class="id" title="axiom">contiguous_between_incr_addr</span></a> <span class="id" title="var">_</span> 1%<span class="id" title="var">nat</span> <span class="id" title="var">_</span> <span class="id" title="var">f0</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <span class="id" title="var">Hcont_clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">simplify_map_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;iNext&nbsp;;&nbsp;iIntros&nbsp;"(HPC&nbsp;&amp;&nbsp;Hi&nbsp;&amp;&nbsp;Hr7&nbsp;&amp;&nbsp;Hr1)".&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iEpilogue</span> "(HPC &amp; Ha_f0 &amp; Hr1)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hend" <span class="id" title="keyword">as</span> "[Hend _]".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Part&nbsp;3&nbsp;-&nbsp;Prog_base&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Prepare&nbsp;the&nbsp;resources&nbsp;for&nbsp;the&nbsp;prog_base_spec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExtract</span> "Hrmap" <a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a> <span class="id" title="keyword">as</span> "Hr8".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<a class="idref" href="cap_machine.proofmode.region.html#codefrag"><span class="id" title="definition">codefrag</span></a> <span class="id" title="var">a_prog</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_secret_instrs"><span class="id" title="definition">prog_secret_instrs</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a> <span class="id" title="var">secret_off</span> <span class="id" title="var">secret_val</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> "[Hprogi]" <span class="id" title="keyword">as</span> "Hprogi".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.proofmode.region.html#codefrag"><span class="id" title="definition">codefrag</span></a>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.proofmode.region.html#region_mapsto"><span class="id" title="definition">region_mapsto</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">prog_addrs</span> <span class="id" title="keyword">with</span> (<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <span class="id" title="var">a_prog</span> (<span class="id" title="var">a_prog</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 11%<span class="id" title="var">nat</span>)%<span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#region_addrs_of_contiguous_between"><span class="id" title="axiom">region_addrs_of_contiguous_between</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">a_prog</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 11%<span class="id" title="var">nat</span>)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a_call</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlength_progi</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha_call</span>... }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 4 (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_ne</span> ; <span class="id" title="tactic">eauto</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;2&nbsp;-&nbsp;extract&nbsp;r2&nbsp;and&nbsp;r3&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExtractList</span> "Hrmap" <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <span class="id" title="keyword">as</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>"Hr2"<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>"Hr3"<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Apply&nbsp;the&nbsp;base_prog_spec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_secret_spec"><span class="id" title="axiom">prog_secret_spec</span></a> <span class="id" title="notation">with</span> "[- $HPC $Hr2 $Hr3 $Hprogi]"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> (<span class="id" title="var">iFrame</span> ; <span class="id" title="var">iFrame</span> "#")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">eauto</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_length"><span class="id" title="lemma">contiguous_between_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcont_call</span>, <span class="id" title="var">Hcont_end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_addr'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hr8" ; <span class="id" title="tactic">first</span> (<span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iIntros</span> "(HPC &amp; Hr7 &amp; Hr8 &amp; Hr2 &amp; Hr3 &amp; Hmem &amp; Hsecret &amp; Hmem' &amp; Hprogi)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iHide</span> "Cont" <span class="id" title="keyword">as</span> <span class="id" title="var">cont</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iClear</span> "Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">(</span></a><span class="id" title="var">b_mem</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <span class="id" title="var">secret_off</span><a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">b_mem</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">(</span></a><span class="id" title="var">secret_off</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a>1<a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">a</span> <span class="id" title="tactic">by</span> <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">(</span></a><span class="id" title="var">b_mem</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <span class="id" title="var">secret_off</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1) <span class="id" title="keyword">with</span> (<span class="id" title="var">b_mem</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">(</span></a><span class="id" title="var">secret_off</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">)</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Part&nbsp;4&nbsp;-&nbsp;Call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Prepare&nbsp;the&nbsp;ressource&nbsp;for&nbsp;the&nbsp;call_spec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> ( <a class="idref" href="cap_machine.examples.call.html#call"><span class="id" title="definition">call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">f_m</span> <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> "Hcall"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> "Hcall".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Re-insert&nbsp;r2&nbsp;and&nbsp;r3&nbsp;in&nbsp;the&nbsp;<span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">map</span></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInsertList</span> "Hrmap" <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t1"><span class="id" title="definition">r_t1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Extract&nbsp;r30&nbsp;-&nbsp;adv&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">rmap'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExtract</span> "Hrmap" <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> <span class="id" title="keyword">as</span> "Hr30".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">rmap_call'</span> := <span class="id" title="definition">delete</span> <a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">w7</span> := (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <span class="id" title="var">_</span> <span class="id" title="var">e_mem</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">w8</span> := (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <span class="id" title="var">b_mem</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Call_spec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.examples.call.html#call_spec"><span class="id" title="axiom">call_spec</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> (<span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a> <span class="id" title="notation">:=</span> <span class="id" title="var">w8</span><span class="id" title="notation">]}</span>) (<span class="id" title="notation">{[</span><a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a> <span class="id" title="notation">:=</span> <span class="id" title="var">w7</span><span class="id" title="notation">]}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wadv</span> <span class="id" title="var">_</span> <span class="id" title="var">rmap_call'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a_restore</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">with</span> "[- $HPC $Hna $Hr30 $Hrmap $Hlink $Hentry_malloc]"<span class="id" title="notation">)</span> ; <span class="id" title="var">cycle</span> -1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">iFrame</span> "#".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">shelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span>: <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between"><span class="id" title="inductive">contiguous_between</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_bounds"><span class="id" title="axiom">contiguous_between_bounds</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">replace</span> (<span class="id" title="var">a_prog</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 11%<span class="id" title="var">nat</span>)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a_call</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;set_solver&nbsp;+.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span> : <span class="id" title="tactic">subst</span> <span class="id" title="var">rmap_call'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2: (<span class="id" title="var">solve_map_dom</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> | |- <span class="id" title="var">_</span> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> ?<span class="id" title="var">m</span> =&gt; <span class="id" title="var">get_map_dom</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hid</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hid</span> <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_solver</span>+.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hcall" ; <span class="id" title="tactic">first</span> (<span class="id" title="var">iNext</span> ; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">map_to_list_singleton</span> /= ; <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hr7"; <span class="id" title="tactic">first</span> (<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_singleton</span>; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hr0"; <span class="id" title="tactic">first</span> (<span class="id" title="var">iNext</span> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hr8" ; <span class="id" title="tactic">first</span> (<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_singleton</span>; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H" ; <span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">b_act</span> <span class="id" title="var">e_act</span> <span class="id" title="var">b_local</span> <span class="id" title="var">e_locals</span> <span class="id" title="var">a_end_call</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"( %Hnext &amp; HPC &amp; Hrmap &amp; Hr7 &amp; Hpcb &amp; Hentry_malloc &amp; Hr30 &amp; Hr0 &amp; Hact &amp; Hlocals &amp; Hcall &amp; Hna )".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_to_list_singleton</span> /=.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;------------------&nbsp;Jump&nbsp;to&nbsp;the&nbsp;adversary&nbsp;code&nbsp;-----------------&nbsp;*)</span><br/>
</div>

<div class="doc">
In order to jump to the adversary code, we have to prove that the context is safe,
       i.e. all the registers are safe to share.
       We need to prove that all the registers contains safe-to-share words.
       In particular the register that contains the activation code is a
       sentry-capability, which relies on persistent proposition only.
       Thus, we encapsulate the needed memory resources for the remaining code
       into invariants. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Allocate&nbsp;the&nbsp;invariants&nbsp;necessary&nbsp;for&nbsp;the&nbsp;continuation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Activation&nbsp;record&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">na_inv_alloc</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <span class="id" title="var">_</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_actN"><span class="id" title="definition">call_actN</span></a> <span class="id" title="notation">with</span> "Hact"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#Hact".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Locals*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hlocals"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_locals</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_length"><span class="id" title="lemma">finz_seq_between_length</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hlength_locals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">na_inv_alloc</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <span class="id" title="var">_</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_localsN"><span class="id" title="definition">call_localsN</span></a> <span class="id" title="notation">with</span> "Hlocals"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#Hlocals".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Code&nbsp;after&nbsp;the&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "Hrestore" "Hprepa" <span class="id" title="keyword">as</span> "Hcallback".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "Hcallback" "Hassert" <span class="id" title="keyword">as</span> "Hcallback".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "Hcallback" "Hend" <span class="id" title="keyword">as</span> "Hcallback".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">na_inv_alloc</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <span class="id" title="var">_</span>  <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_codeN"><span class="id" title="definition">call_codeN</span></a> <span class="id" title="notation">with</span> "Hcallback"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"#Hcallback".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Secret&nbsp;address&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">na_inv_alloc</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <span class="id" title="var">_</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_versionN"><span class="id" title="definition">call_versionN</span></a><span class="id" title="notation">.@</span>"secret") <span class="id" title="notation">with</span> "Hsecret"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> "#Hsecret".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Linking&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "Hentry_malloc" "Hentry_assert" <span class="id" title="keyword">as</span> "Hlink_entries".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "Hpcb" "Hlink_entries" <span class="id" title="keyword">as</span> "Hlink".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">na_inv_alloc</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <span class="id" title="var">_</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_versionN"><span class="id" title="definition">call_versionN</span></a><span class="id" title="notation">.@</span>"link_table") <span class="id" title="notation">with</span> "Hlink"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> "#Hinv_link".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Cleaning&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iClear</span> "Hclear Hmalloc_prog Ha_clear Ha_f0 Hprogi".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iHide</span> "Hact" <span class="id" title="keyword">as</span> <span class="id" title="var">Hact</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iHide</span> "Hw0" <span class="id" title="keyword">as</span> <span class="id" title="var">Hinterp_w0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iHide</span> "Hadv" <span class="id" title="keyword">as</span> <span class="id" title="var">Hinterp_adv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iHide</span> "Hlocals" <span class="id" title="keyword">as</span> <span class="id" title="var">Hlocals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iHide</span> "Hinv_link" <span class="id" title="keyword">as</span> <span class="id" title="var">Hinv_link</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">rmap_call'</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Re-insert&nbsp;the&nbsp;registers&nbsp;into&nbsp;the&nbsp;map&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;r0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.iris_extra.html#big_sepM_to_create_gmap_default"><span class="id" title="axiom">big_sepM_to_create_gmap_default</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="k:105" class="idref" href="#k:105"><span class="id" title="binder"><span id="k:107" class="id">k</span></span></a> <a id="i:106" class="idref" href="#i:106"><span class="id" title="binder"><span id="i:108" class="id">i</span></span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#k:105"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#i:106"><span class="id" title="variable">i</span></a>)%<span class="id" title="var">I</span> (<a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> 0%<span class="id" title="var">Z</span>) <span class="id" title="notation">with</span> "Hrmap"<span class="id" title="notation">)</span>  <span class="id" title="keyword">as</span> "Hrmap";[<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Sorting.Permutation.html#Permutation_refl"><span class="id" title="lemma">Permutation_refl</span></a>|<span class="id" title="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "[$Hrmap $Hr0]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hrmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default_dom"><span class="id" title="axiom">create_gmap_default_dom</span></a> <a class="idref" href="cap_machine.stdpp_extra.html#list_to_set_map_to_list"><span class="id" title="axiom">list_to_set_map_to_list</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_delete_L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_insert_L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_delete_L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span>. <span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;r30&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "[$Hrmap $Hr30]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hrmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_insert_L</span> <a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default_dom"><span class="id" title="axiom">create_gmap_default_dom</span></a> <a class="idref" href="cap_machine.stdpp_extra.html#list_to_set_map_to_list"><span class="id" title="axiom">list_to_set_map_to_list</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_delete_L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_insert_L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_delete_L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span>. <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;r7&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_singleton</span> (<span class="id" title="keyword">fun</span> <a id="k:109" class="idref" href="#k:109"><span class="id" title="binder"><span id="k:111" class="id">k</span></span></a> <a id="a:110" class="idref" href="#a:110"><span class="id" title="binder"><span id="a:112" class="id">a</span></span></a> =&gt; <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#k:109"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:110"><span class="id" title="variable">a</span></a>)%<span class="id" title="var">I</span> <a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a> <span class="id" title="var">_</span> <span class="id" title="notation">with</span> "Hr7"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hr7".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "[$Hrmap $Hr7]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hrmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_insert_L</span> <a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default_dom"><span class="id" title="axiom">create_gmap_default_dom</span></a> <a class="idref" href="cap_machine.stdpp_extra.html#list_to_set_map_to_list"><span class="id" title="axiom">list_to_set_map_to_list</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_delete_L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_insert_L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_delete_L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span>. <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> <span class="id" title="var">rmap2</span> := (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a><span class="id" title="notation">:=</span><span class="id" title="var">w7</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">_</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;prove&nbsp;that&nbsp;the&nbsp;shared&nbsp;buffer&nbsp;is&nbsp;indeed&nbsp;safe&nbsp;to&nbsp;share<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(because&nbsp;it&nbsp;is&nbsp;given&nbsp;in&nbsp;param)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.proofmode.region.html#region_mapsto"><span class="id" title="definition">region_mapsto</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.fundamental.html#region_integers_alloc'"><span class="id" title="axiom">region_integers_alloc'</span></a> <span class="id" title="notation">with</span> "Hmem'"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "&gt;#Hinterp_buffer".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_replicate</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Apply&nbsp;the&nbsp;continuation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSpecialize</span> <span class="id" title="notation">(</span>"Cont" <span class="id" title="notation">$!</span> <span class="id" title="var">rmap2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> "Cont" ; <span class="id" title="tactic">auto</span> ; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_insert_L</span> <a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default_dom"><span class="id" title="axiom">create_gmap_default_dom</span></a> <a class="idref" href="cap_machine.stdpp_extra.html#list_to_set_map_to_list"><span class="id" title="axiom">list_to_set_map_to_list</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_delete_L</span> ; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_insert_L</span> ; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">dom_delete_L</span> ; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">singleton_union_difference_L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_solver</span>+. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;--&nbsp;It&nbsp;remains&nbsp;to&nbsp;prove&nbsp;that&nbsp;all&nbsp;the&nbsp;registers&nbsp;are&nbsp;safe&nbsp;to&nbsp;share&nbsp;--&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_sep</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert_2</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">iFrame</span> "#".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert_2</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">iFrame</span> "#".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert_2</span> ; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;remaining&nbsp;registers&nbsp;contains&nbsp;WInt*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_intro</span>. <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">r</span> ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">set</span> <span class="id" title="var">rmap'</span> := <span class="id" title="definition">delete</span> <a class="idref" href="cap_machine.addr_reg.html#r_t7"><span class="id" title="definition">r_t7</span></a> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> <span class="id" title="notation">(</span><span class="id" title="definition">map_to_list</span> <span class="id" title="var">rmap'</span><span class="id" title="notation">).*1</span> (<a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> 0%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hsome</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default_lookup_is_Some"><span class="id" title="axiom">create_gmap_default_lookup_is_Some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsome</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hsome</span> -&gt;]. <span class="id" title="tactic">rewrite</span> !<a class="idref" href="cap_machine.logrel.html#fixpoint_interp1_eq"><span class="id" title="lemma">fixpoint_interp1_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?). <span class="id" title="var">simplify_eq</span>. <span class="id" title="var">done</span>. <span class="id" title="var">iIntros</span> (?). <span class="id" title="var">done</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;activation&nbsp;code&nbsp;is&nbsp;safe&nbsp;to&nbsp;share&nbsp;-&nbsp;ie.&nbsp;safe&nbsp;to&nbsp;execute&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">cbn</span> <span class="id" title="keyword">beta</span>. <span class="id" title="tactic">rewrite</span> !<a class="idref" href="cap_machine.logrel.html#fixpoint_interp1_eq"><span class="id" title="lemma">fixpoint_interp1_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">r</span>). <span class="id" title="var">iNext</span>; <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "([% #Hrmap_safe] &amp; Hrmap &amp; Hna)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iHide</span> "Hinterp_buffer" <span class="id" title="keyword">as</span> <span class="id" title="var">Hinterp_buffer</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iHide</span> "Hrmap_safe" <span class="id" title="keyword">as</span> <span class="id" title="var">Hrmap_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iClear</span> "Cont".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.logrel.html#interp_conf"><span class="id" title="definition">interp_conf</span></a> /<a class="idref" href="cap_machine.logrel.html#registers_mapsto"><span class="id" title="definition">registers_mapsto</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.addr_reg.html#regmap_full_dom"><span class="id" title="axiom">regmap_full_dom</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;get&nbsp;all&nbsp;the&nbsp;registers&nbsp;we&nbsp;need&nbsp;for&nbsp;the&nbsp;remaining&nbsp;code&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExtractList</span> "Hrmap" <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t0"><span class="id" title="definition">r_t0</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t1"><span class="id" title="definition">r_t1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t4"><span class="id" title="definition">r_t4</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t5"><span class="id" title="definition">r_t5</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <span class="id" title="keyword">as</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>"HPC"<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>"Hr0"<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>"Hr1"<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>"Hr2"<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>"Hr3"<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>"Hr4"<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>"Hr5"<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>"Hr8"<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;1&nbsp;-&nbsp;step&nbsp;through&nbsp;the&nbsp;activation&nbsp;record&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">na_inv_acc</span> <span class="id" title="notation">with</span> "Hact Hna"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hact' [Hna Hcls'] ]";[<span class="id" title="var">solve_ndisj</span>|<span class="id" title="var">solve_ndisj</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.examples.callback.html#scall_epilogue_spec"><span class="id" title="axiom">scall_epilogue_spec</span></a> <span class="id" title="notation">with</span> "[- $HPC $Hact' $Hr1 $Hr2]"<span class="id" title="notation">)</span> ;[|<span class="id" title="tactic">apply</span> <span class="id" title="var">Hnext</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>; <span class="id" title="var">iIntros</span> "(HPC &amp; Hr1 &amp; Hr2 &amp; Hact')".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcls'" <span class="id" title="notation">with</span> "[$Hact' $Hna]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hna".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hr1" <span class="id" title="keyword">as</span> (<span class="id" title="var">w1'</span>) "Hr1".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Code&nbsp;after&nbsp;the&nbsp;return&nbsp;of&nbsp;the&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">na_inv_acc</span> <span class="id" title="notation">with</span> "Hcallback Hna"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"[&gt;[[[Hrestore Hprepa] Hassert] Hend] [Hna Hcls] ]"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="var">solve_ndisj</span>|<span class="id" title="var">solve_ndisj</span>|].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;2&nbsp;-&nbsp;restore&nbsp;locals&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">na_inv_acc</span> <span class="id" title="notation">with</span> "Hlocals Hna"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[&gt;Hlocal [Hna Hcls'] ]"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="var">solve_ndisj</span>|<span class="id" title="var">solve_ndisj</span>|].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<a class="idref" href="cap_machine.examples.callback.html#restore_locals"><span class="id" title="definition">restore_locals</span></a> <span class="id" title="var">restore_addrs</span> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <span class="id" title="keyword">with</span> "Hrestore" <span class="id" title="keyword">as</span> "Hrestore".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.examples.callback.html#restore_locals_spec"><span class="id" title="axiom">restore_locals_spec</span></a> <span class="id" title="var">_</span> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a> <span class="id" title="notation">{[</span> <a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a> <span class="id" title="notation">:=</span> <span class="id" title="var">w8</span><span class="id" title="notation">]}</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">w8</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">restore_addrs</span> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">a_restore</span> <span class="id" title="var">_</span> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <span class="id" title="var">b_local</span> <span class="id" title="var">e_locals</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">with</span> "[- $HPC $Hr2 $Hlocal $Hrestore]"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_bounds"><span class="id" title="axiom">contiguous_between_bounds</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcont_end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_addr</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_to_list_singleton</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hr8"; <span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_singleton</span> ; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span> ; <span class="id" title="var">iAssumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(HPC &amp; Hr2 &amp; Hr8 &amp; Hlocal &amp; Hrestore)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <span class="id" title="var">w8</span>)%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[Hr8]" <span class="id" title="keyword">as</span> "Hr8".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iApply</span> (<span class="id" title="lemma">big_sepM_singleton</span> (<span class="id" title="keyword">fun</span> <a id="k:113" class="idref" href="#k:113"><span class="id" title="binder"><span id="k:115" class="id">k</span></span></a> <a id="a:114" class="idref" href="#a:114"><span class="id" title="binder"><span id="a:116" class="id">a</span></span></a> =&gt; <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#k:113"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:114"><span class="id" title="variable">a</span></a>)%<span class="id" title="var">I</span> <a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a> <span class="id" title="var">w8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInsert</span> "Hrmap" <a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;3&nbsp;-&nbsp;Preparation&nbsp;of&nbsp;the&nbsp;assert&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepL2_length</span> <span class="id" title="notation">with</span> "Hlocal"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlength_local</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( (<span class="id" title="var">b_local</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">e_locals</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">Hsize_locals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_length"><span class="id" title="lemma">finz_seq_between_length</span></a> /= /<a class="idref" href="machine_utils.finz_interval.html#finz.dist"><span class="id" title="definition">finz.dist</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlength_local</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Hlength_local</span>. <span class="id" title="var">solve_addr</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.proofmode.region.html#region_mapsto_single"><span class="id" title="axiom">region_mapsto_single</span></a> <span class="id" title="notation">with</span> "Hlocal"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hlocal" ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hlocal" <span class="id" title="keyword">as</span> (?) "[Hlocal %Hv]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hv'</span>] ; <span class="id" title="tactic">clear</span> <span class="id" title="var">Hv</span> <span class="id" title="var">Hv'</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">w8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;specification&nbsp;requires&nbsp;the&nbsp;codefrag&nbsp;assertions&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<a class="idref" href="cap_machine.proofmode.region.html#codefrag"><span class="id" title="definition">codefrag</span></a> <span class="id" title="var">a_prepa</span> <span class="id" title="var">instrs_prepa</span>) <span class="id" title="keyword">with</span> "[Hprepa]" <span class="id" title="keyword">as</span> "Hprepa".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.proofmode.region.html#codefrag"><span class="id" title="definition">codefrag</span></a> /<a class="idref" href="cap_machine.proofmode.region.html#region_mapsto"><span class="id" title="definition">region_mapsto</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="cap_machine.proofmode.contiguous.html#region_addrs_of_contiguous_between"><span class="id" title="axiom">region_addrs_of_contiguous_between</span></a> <span class="id" title="var">prepa_addrs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">a_prepa</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> <span class="id" title="abbreviation">length</span> <span class="id" title="var">instrs_prepa</span>)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a_assert</span> <span class="id" title="tactic">by</span> <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">na_inv_acc</span> <span class="id" title="notation">with</span> "Hsecret Hna"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[&gt;Ha_secret [Hna Hcls_secret] ]"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="var">solve_ndisj</span>|<span class="id" title="var">solve_ndisj</span>|].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prepa_assert_spec"><span class="id" title="axiom">prepa_assert_spec</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">with</span> "[- $HPC $Hr2 $Hr4 $Hr5 $Hlocal $Ha_secret $Hprepa]"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">Unshelve</span>. 2: <span class="id" title="tactic">exact</span> <span class="id" title="var">prepa_addrs</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">a_prepa</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 4%<span class="id" title="var">nat</span>)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a_assert</span> <span class="id" title="tactic">by</span> <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span>:<a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between"><span class="id" title="inductive">contiguous_between</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_bounds"><span class="id" title="axiom">contiguous_between_bounds</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) ; <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span> ; <span class="id" title="var">iIntros</span> "(HPC &amp; Hr2 &amp; Hr4 &amp; Hr5 &amp; Hlocal &amp; Ha_secret &amp; Hprepa)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">a_prepa</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 4%<span class="id" title="var">nat</span>)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a_assert</span> <span class="id" title="tactic">by</span> <span class="id" title="var">solve_addr</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;+&nbsp;Cleaning&nbsp;+&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> ( (<span class="id" title="notation">[∗</span> <span class="id" title="notation">list</span><span class="id" title="notation">]</span> <a id="a_i:117" class="idref" href="#a_i:117"><span class="id" title="binder"><span id="a_i:118" class="id"><span id="a_i:121" class="id"><span id="a_i:122" class="id">a_i</span></span></span></span></a><span class="id" title="notation">;</span><a id="w_i:119" class="idref" href="#w_i:119"><span class="id" title="binder"><span id="w_i:120" class="id"><span id="w_i:123" class="id"><span id="w_i:124" class="id">w_i</span></span></span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="var">prepa_addrs</span><span class="id" title="notation">;</span><span class="id" title="var">instrs_prepa</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_i:117"><span class="id" title="variable">a_i</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w_i:119"><span class="id" title="variable">w_i</span></a>)%<span class="id" title="var">I</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> "[Hprepa]" <span class="id" title="keyword">as</span> "Hprepa".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.proofmode.region.html#codefrag"><span class="id" title="definition">codefrag</span></a> /<a class="idref" href="cap_machine.proofmode.region.html#region_mapsto"><span class="id" title="definition">region_mapsto</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">a_prepa</span> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 4%<span class="id" title="var">nat</span>)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a_assert</span> <span class="id" title="tactic">by</span> <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="cap_machine.proofmode.contiguous.html#region_addrs_of_contiguous_between"><span class="id" title="axiom">region_addrs_of_contiguous_between</span></a> <span class="id" title="var">prepa_addrs</span>) ; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcls_secret" <span class="id" title="notation">with</span> "[$Ha_secret $Hna]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hna".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcls'" <span class="id" title="notation">with</span> "[Hlocal $Hna]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hna".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iNext</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.proofmode.region.html#region_mapsto"><span class="id" title="definition">region_mapsto</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_singleton"><span class="id" title="lemma">finz_seq_between_singleton</span></a> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;4&nbsp;-&nbsp;Assert&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">na_inv_acc</span> <span class="id" title="notation">with</span> "Hinv_link Hna"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[&gt;[Hlink [Hentry_malloc Hentry_assert]] [Hna Hcls'] ]"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[<span class="id" title="var">solve_ndisj</span>|<span class="id" title="var">solve_ndisj</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.examples.macros.html#assert_success"><span class="id" title="axiom">assert_success</span></a> <span class="id" title="notation">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"[- $HPC $Hna $Hinv_assert $Hr0 $Hr1 $Hr2 $Hr3 $Hr4 $Hr5 $Hlink $Hentry_assert]"<span class="id" title="notation">)</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span>:<a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between"><span class="id" title="inductive">contiguous_between</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_bounds"><span class="id" title="axiom">contiguous_between_bounds</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span> ; <span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_ndisj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hassert" ; <span class="id" title="tactic">first</span> (<span class="id" title="var">iNext</span> ; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iIntros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr0 &amp; Hr1 &amp; Hr2 &amp; Hr3 &amp; Hr4 &amp; Hr5 &amp; HPC &amp; Hassert &amp; Hna &amp; Hlink &amp; Hentry_assert)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcls'" <span class="id" title="notation">with</span> "[$Hentry_assert $Hentry_malloc $Hlink $Hna]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hna".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;5&nbsp;-&nbsp;End&nbsp;-&nbsp;halts&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hcont_end'</span> := <span class="id" title="var">Hcont_end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_cons_inv_first"><span class="id" title="lemma">contiguous_between_cons_inv_first</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcont_end</span> <span class="id" title="keyword">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_instr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_halt"><span class="id" title="axiom">wp_halt</span></a> <span class="id" title="notation">with</span> "[$HPC $Hend]"<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_parameters.html#decode_encode_instrW_inv"><span class="id" title="lemma">decode_encode_instrW_inv</span></a>|..].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_base.html#isCorrectPC_ExecPCPerm_InBounds"><span class="id" title="axiom">isCorrectPC_ExecPCPerm_InBounds</span></a> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">Hcont_end</span>:= <span class="id" title="var">Hcont_end'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#region_addrs_of_contiguous_between"><span class="id" title="axiom">region_addrs_of_contiguous_between</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcont_end'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="machine_utils.finz_lemmas.html#InBounds_sub"><span class="id" title="lemma">InBounds_sub</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a_end</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hpc_bounds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ((<span class="id" title="var">a_end</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a_last</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hcont_end</span> ; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">h</span>: <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between"><span class="id" title="inductive">contiguous_between</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; (<span class="id" title="tactic">inversion</span> <span class="id" title="var">h</span> ; <span class="id" title="tactic">subst</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_addr</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span> ; <span class="id" title="var">iIntros</span> "[HPC Hi]".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;close&nbsp;invariants,&nbsp;reassemble&nbsp;registers,&nbsp;and&nbsp;finish&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcls" <span class="id" title="notation">with</span> "[$Hna $Hrestore $Hi $Hprepa $Hassert]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hna".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInsertList</span> "Hrmap" <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t0"><span class="id" title="definition">r_t0</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t1"><span class="id" title="definition">r_t1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t4"><span class="id" title="definition">r_t4</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#r_t5"><span class="id" title="definition">r_t5</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_pure</span>; <span class="id" title="var">wp_end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">r'</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">consider_next_reg</span> <span class="id" title="var">r'</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">consider_next_reg</span> <span class="id" title="var">r'</span> <a class="idref" href="cap_machine.addr_reg.html#r_t5"><span class="id" title="definition">r_t5</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">consider_next_reg</span> <span class="id" title="var">r'</span> <a class="idref" href="cap_machine.addr_reg.html#r_t4"><span class="id" title="definition">r_t4</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">consider_next_reg</span> <span class="id" title="var">r'</span> <a class="idref" href="cap_machine.addr_reg.html#r_t3"><span class="id" title="definition">r_t3</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">consider_next_reg</span> <span class="id" title="var">r'</span> <a class="idref" href="cap_machine.addr_reg.html#r_t2"><span class="id" title="definition">r_t2</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">consider_next_reg</span> <span class="id" title="var">r'</span> <a class="idref" href="cap_machine.addr_reg.html#r_t1"><span class="id" title="definition">r_t1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">consider_next_reg</span> <span class="id" title="var">r'</span> <a class="idref" href="cap_machine.addr_reg.html#r_t0"><span class="id" title="definition">r_t0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">consider_next_reg</span> <span class="id" title="var">r'</span> <a class="idref" href="cap_machine.addr_reg.html#r_t8"><span class="id" title="definition">r_t8</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;post-condition&nbsp;actually&nbsp;does&nbsp;not&nbsp;matter&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prog_call_full_run_spec" class="idref" href="#prog_call_full_run_spec"><span class="id" title="lemma">prog_call_full_run_spec</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;call&nbsp;*)</span> <a id="wadv:125" class="idref" href="#wadv:125"><span class="id" title="binder">wadv</span></a> <a id="w0:126" class="idref" href="#w0:126"><span class="id" title="binder">w0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;remaining&nbsp;registers&nbsp;*)</span> (<a id="rmap:127" class="idref" href="#rmap:127"><span class="id" title="binder">rmap</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;pc&nbsp;*)</span> <a id="a:128" class="idref" href="#a:128"><span class="id" title="binder">a</span></a> <a id="pc_p:129" class="idref" href="#pc_p:129"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:130" class="idref" href="#pc_b:130"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:131" class="idref" href="#pc_e:131"><span class="id" title="binder">pc_e</span></a> <a id="a_first:132" class="idref" href="#a_first:132"><span class="id" title="binder">a_first</span></a> <a id="a_last:133" class="idref" href="#a_last:133"><span class="id" title="binder">a_last</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;malloc&nbsp;*)</span> <a id="f_m:134" class="idref" href="#f_m:134"><span class="id" title="binder">f_m</span></a> <a id="b_m:135" class="idref" href="#b_m:135"><span class="id" title="binder">b_m</span></a> <a id="e_m:136" class="idref" href="#e_m:136"><span class="id" title="binder">e_m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;assert&nbsp;*)</span> <a id="f_a:137" class="idref" href="#f_a:137"><span class="id" title="binder">f_a</span></a> <a id="b_a:138" class="idref" href="#b_a:138"><span class="id" title="binder">b_a</span></a> <a id="e_a:139" class="idref" href="#e_a:139"><span class="id" title="binder">e_a</span></a> <a id="a_flag:140" class="idref" href="#a_flag:140"><span class="id" title="binder">a_flag</span></a> <a id="flagN:141" class="idref" href="#flagN:141"><span class="id" title="binder">flagN</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;linking&nbsp;*)</span> <a id="b_link:142" class="idref" href="#b_link:142"><span class="id" title="binder">b_link</span></a> <a id="a_link:143" class="idref" href="#a_link:143"><span class="id" title="binder">a_link</span></a> <a id="e_link:144" class="idref" href="#e_link:144"><span class="id" title="binder">e_link</span></a> <a id="malloc_entry:145" class="idref" href="#malloc_entry:145"><span class="id" title="binder">malloc_entry</span></a> <a id="assert_entry:146" class="idref" href="#assert_entry:146"><span class="id" title="binder">assert_entry</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="size:147" class="idref" href="#size:147"><span class="id" title="binder">size</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="secret_off:148" class="idref" href="#secret_off:148"><span class="id" title="binder">secret_off</span></a> <a id="secret_val:149" class="idref" href="#secret_val:149"><span class="id" title="binder">secret_val</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Validity&nbsp;PC&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#ExecPCPerm"><span class="id" title="definition">ExecPCPerm</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_p:129"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_base.html#SubBounds"><span class="id" title="definition">SubBounds</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_b:130"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_e:131"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_first:132"><span class="id" title="variable">a_first</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_last:133"><span class="id" title="variable">a_last</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between"><span class="id" title="inductive">contiguous_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:128"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_first:132"><span class="id" title="variable">a_first</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_last:133"><span class="id" title="variable">a_last</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Validity&nbsp;linking&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_link:142"><span class="id" title="variable">b_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_link:144"><span class="id" title="variable">e_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#malloc_entry:145"><span class="id" title="variable">malloc_entry</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_link:142"><span class="id" title="variable">b_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_link:144"><span class="id" title="variable">e_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#assert_entry:146"><span class="id" title="variable">assert_entry</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_link:143"><span class="id" title="variable">a_link</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_m:134"><span class="id" title="variable">f_m</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#malloc_entry:145"><span class="id" title="variable">malloc_entry</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_link:143"><span class="id" title="variable">a_link</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_a:137"><span class="id" title="variable">f_a</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#assert_entry:146"><span class="id" title="variable">assert_entry</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Validity&nbsp;secret*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a>0 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:148"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#size:147"><span class="id" title="variable">size</span></a> %<span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#rmap:127"><span class="id" title="variable">rmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.addr_reg.html#all_registers_s"><span class="id" title="definition">all_registers_s</span></a> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> <span class="id" title="notation">]}</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> ( <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_code"><span class="id" title="definition">prog_call_code</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:128"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_m:134"><span class="id" title="variable">f_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_a:137"><span class="id" title="variable">f_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#size:147"><span class="id" title="variable">size</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_off:148"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#secret_val:149"><span class="id" title="variable">secret_val</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#malloc_call_inv"><span class="id" title="definition">malloc_call_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_m:135"><span class="id" title="variable">b_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_m:136"><span class="id" title="variable">e_m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#assert_call_inv"><span class="id" title="definition">assert_call_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_a:138"><span class="id" title="variable">b_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_a:139"><span class="id" title="variable">e_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_flag:140"><span class="id" title="variable">a_flag</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#flag_call_inv"><span class="id" title="definition">flag_call_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_flag:140"><span class="id" title="variable">a_flag</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#flagN:141"><span class="id" title="variable">flagN</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_p:129"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_b:130"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_e:131"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_first:132"><span class="id" title="variable">a_first</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#wadv:125"><span class="id" title="variable">wadv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="r_i:150" class="idref" href="#r_i:150"><span class="id" title="binder"><span id="r_i:151" class="id">r_i</span></span></a><span class="id" title="notation">↦</span><a id="w_i:152" class="idref" href="#w_i:152"><span class="id" title="binder"><span id="w_i:153" class="id">w_i</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#rmap:127"><span class="id" title="variable">rmap</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r_i:150"><span class="id" title="variable">r_i</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w_i:152"><span class="id" title="variable">w_i</span></a><span class="id" title="notation">)</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Linking&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#pc_b:130"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RO"><span class="id" title="constructor">RO</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_link:142"><span class="id" title="variable">b_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_link:144"><span class="id" title="variable">e_link</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a_link:143"><span class="id" title="variable">a_link</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#malloc_entry:145"><span class="id" title="variable">malloc_entry</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_m:135"><span class="id" title="variable">b_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_m:136"><span class="id" title="variable">e_m</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_m:135"><span class="id" title="variable">b_m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#assert_entry:146"><span class="id" title="variable">assert_entry</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_a:138"><span class="id" title="variable">b_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#e_a:139"><span class="id" title="variable">e_a</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#b_a:138"><span class="id" title="variable">b_a</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="definition">na_own</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <span class="id" title="notation">⊤</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.logrel.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w0:126"><span class="id" title="variable">w0</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.logrel.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#wadv:125"><span class="id" title="variable">wadv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <span class="id" title="notation">{{</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="v:154" class="idref" href="#v:154"><span class="id" title="binder">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="notation">True</span><span class="id" title="notation">}}</span>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(?&amp;?&amp;?&amp;?&amp;?&amp;Hr30&amp;?&amp;?&amp;?&amp;assert_entry&amp;?&amp;?&amp;Hadv)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_wand</span> <span class="id" title="notation">with</span> "[-]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iApply</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_full_run_spec_aux"><span class="id" title="axiom">prog_call_full_run_spec_aux</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wadv</span> <span class="id" title="var">w0</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f_m</span> <span class="id" title="var">b_m</span> <span class="id" title="var">e_m</span> <span class="id" title="var">f_a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cycle</span> -1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="id" title="var">iFrame</span>|..] ; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "?" ; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call"><span class="id" title="section">program_call</span></a>.<br/>

<br/>
</div>

<div class="doc">
Adequacy theorem 
</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a id="program_call_adequacy" class="idref" href="#program_call_adequacy"><span class="id" title="section">program_call_adequacy</span></a>.<br/>

<br/>
</div>

<div class="doc">
Defininition of the memory layout 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <a id="DisjointList_list_Addr" class="idref" href="#DisjointList_list_Addr"><span class="id" title="instance">DisjointList_list_Addr</span></a> : <a class="idref" href="cap_machine.proofmode.disjoint_regions_tactics.html#DisjointList"><span class="id" title="class">DisjointList</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">exact</span> (@<a class="idref" href="cap_machine.proofmode.disjoint_regions_tactics.html#disjoint_list_default"><span class="id" title="inductive">disjoint_list_default</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#app"><span class="id" title="definition">app</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>). <span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl"><span class="id" title="module">ocpl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Context</span> `{ <a id="secret_off:155" class="idref" href="#secret_off:155"><span class="id" title="binder">secret_off</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> , <a id="secret_val:156" class="idref" href="#secret_val:156"><span class="id" title="binder">secret_val</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>, <a id="size:157" class="idref" href="#size:157"><span class="id" title="binder">size</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> }.<br/>
<span class="id" title="keyword">Context</span> `{ <a id="HVsize:158" class="idref" href="#HVsize:158"><span class="id" title="binder">HVsize</span></a> : 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.secret_off"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.size"><span class="id" title="variable">size</span></a> }.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="memory_layout" class="idref" href="#memory_layout"><span class="id" title="record">memory_layout</span></a> `{<a id="H:159" class="idref" href="#H:159"><span class="id" title="binder">MachineParameters</span></a>} := {<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Code&nbsp;of&nbsp;f&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="f_region_start" class="idref" href="#f_region_start"><span class="id" title="projection">f_region_start</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="f_start" class="idref" href="#f_start"><span class="id" title="projection">f_start</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="f_end" class="idref" href="#f_end"><span class="id" title="projection">f_end</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="f_size" class="idref" href="#f_size"><span class="id" title="projection">f_size</span></a>: (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_start:162"><span class="id" title="method">f_start</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">(</span></a><span class="id" title="abbreviation">length</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_instrs"><span class="id" title="definition">prog_call_instrs</span></a> 0 1 <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.size"><span class="id" title="variable">size</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.secret_off"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.secret_val"><span class="id" title="variable">secret_val</span></a>)<a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_end:163"><span class="id" title="method">f_end</span></a>)%<span class="id" title="var">a</span>;<br/>
&nbsp;&nbsp;<a id="f_region_start_offset" class="idref" href="#f_region_start_offset"><span class="id" title="projection">f_region_start_offset</span></a>: (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_region_start:161"><span class="id" title="method">f_region_start</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_start:162"><span class="id" title="method">f_start</span></a>;<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;adversary&nbsp;code&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="adv_region_start" class="idref" href="#adv_region_start"><span class="id" title="projection">adv_region_start</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="adv_start" class="idref" href="#adv_start"><span class="id" title="projection">adv_start</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="adv_end" class="idref" href="#adv_end"><span class="id" title="projection">adv_end</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="adv_instrs" class="idref" href="#adv_instrs"><span class="id" title="projection">adv_instrs</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a>;<br/>
&nbsp;&nbsp;<a id="adv_size" class="idref" href="#adv_size"><span class="id" title="projection">adv_size</span></a> : (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_start:167"><span class="id" title="method">adv_start</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">(</span></a><span class="id" title="abbreviation">length</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_instrs:169"><span class="id" title="method">adv_instrs</span></a><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_end:168"><span class="id" title="method">adv_end</span></a>)%<span class="id" title="var">a</span> ;<br/>
&nbsp;&nbsp;<a id="adv_region_start_offset" class="idref" href="#adv_region_start_offset"><span class="id" title="projection">adv_region_start_offset</span></a>: (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_region_start:166"><span class="id" title="method">adv_region_start</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_start:167"><span class="id" title="method">adv_start</span></a>;<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;malloc&nbsp;routine&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="l_malloc_start" class="idref" href="#l_malloc_start"><span class="id" title="projection">l_malloc_start</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="l_malloc_memptr" class="idref" href="#l_malloc_memptr"><span class="id" title="projection">l_malloc_memptr</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="l_malloc_mem_start" class="idref" href="#l_malloc_mem_start"><span class="id" title="projection">l_malloc_mem_start</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="l_malloc_end" class="idref" href="#l_malloc_end"><span class="id" title="projection">l_malloc_end</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
<br/>
&nbsp;&nbsp;<a id="l_malloc_code_size" class="idref" href="#l_malloc_code_size"><span class="id" title="projection">l_malloc_code_size</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_start:172"><span class="id" title="method">l_malloc_start</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> <span class="id" title="abbreviation">length</span> <a class="idref" href="cap_machine.examples.malloc.html#malloc_subroutine_instrs"><span class="id" title="definition">malloc_subroutine_instrs</span></a>)%<span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_memptr:173"><span class="id" title="method">l_malloc_memptr</span></a>;<br/>
<br/>
&nbsp;&nbsp;<a id="l_malloc_memptr_size" class="idref" href="#l_malloc_memptr_size"><span class="id" title="projection">l_malloc_memptr_size</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_memptr:173"><span class="id" title="method">l_malloc_memptr</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_mem_start:174"><span class="id" title="method">l_malloc_mem_start</span></a>;<br/>
<br/>
&nbsp;&nbsp;<a id="l_malloc_mem_size" class="idref" href="#l_malloc_mem_size"><span class="id" title="projection">l_malloc_mem_size</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_mem_start:174"><span class="id" title="method">l_malloc_mem_start</span></a> <a class="idref" href="cap_machine.addr_reg.html#8ccc7a9bb9ba1c27ed0dba9945a4cbb0"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_end:175"><span class="id" title="method">l_malloc_end</span></a>)%<span class="id" title="var">a</span>;<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;fail&nbsp;routine&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="l_assert_start" class="idref" href="#l_assert_start"><span class="id" title="projection">l_assert_start</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="l_assert_cap" class="idref" href="#l_assert_cap"><span class="id" title="projection">l_assert_cap</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="l_assert_flag" class="idref" href="#l_assert_flag"><span class="id" title="projection">l_assert_flag</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="l_assert_end" class="idref" href="#l_assert_end"><span class="id" title="projection">l_assert_end</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
<br/>
&nbsp;&nbsp;<a id="l_assert_code_size" class="idref" href="#l_assert_code_size"><span class="id" title="projection">l_assert_code_size</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_start:179"><span class="id" title="method">l_assert_start</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> <span class="id" title="abbreviation">length</span> <a class="idref" href="cap_machine.examples.assert.html#assert_subroutine_instrs"><span class="id" title="definition">assert_subroutine_instrs</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_cap:180"><span class="id" title="method">l_assert_cap</span></a>;<br/>
&nbsp;&nbsp;<a id="l_assert_cap_size" class="idref" href="#l_assert_cap_size"><span class="id" title="projection">l_assert_cap_size</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_cap:180"><span class="id" title="method">l_assert_cap</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_flag:181"><span class="id" title="method">l_assert_flag</span></a>;<br/>
&nbsp;&nbsp;<a id="l_assert_flag_size" class="idref" href="#l_assert_flag_size"><span class="id" title="projection">l_assert_flag_size</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_flag:181"><span class="id" title="method">l_assert_flag</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_end:182"><span class="id" title="method">l_assert_end</span></a>;<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;link&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="link_table_start" class="idref" href="#link_table_start"><span class="id" title="projection">link_table_start</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="link_table_end" class="idref" href="#link_table_end"><span class="id" title="projection">link_table_end</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
<br/>
&nbsp;&nbsp;<a id="link_table_size" class="idref" href="#link_table_size"><span class="id" title="projection">link_table_size</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#link_table_start:186"><span class="id" title="method">link_table_start</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 2)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#link_table_end:187"><span class="id" title="method">link_table_end</span></a>;<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;adversary&nbsp;link&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="adv_link_table_start" class="idref" href="#adv_link_table_start"><span class="id" title="projection">adv_link_table_start</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="adv_link_table_end" class="idref" href="#adv_link_table_end"><span class="id" title="projection">adv_link_table_end</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>;<br/>
&nbsp;&nbsp;<a id="adv_link_table_size" class="idref" href="#adv_link_table_size"><span class="id" title="projection">adv_link_table_size</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_link_table_start:189"><span class="id" title="method">adv_link_table_start</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_link_table_end:190"><span class="id" title="method">adv_link_table_end</span></a>;<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;disjointness&nbsp;of&nbsp;all&nbsp;the&nbsp;regions&nbsp;above&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="regions_disjoint" class="idref" href="#regions_disjoint"><span class="id" title="projection">regions_disjoint</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.proofmode.disjoint_regions_tactics.html#56e0f19e356e1b0c774a4732d76e1b0a"><span class="id" title="notation">##</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_region_start:166"><span class="id" title="method">adv_region_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_end:168"><span class="id" title="method">adv_end</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_region_start:161"><span class="id" title="method">f_region_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_end:163"><span class="id" title="method">f_end</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#link_table_start:186"><span class="id" title="method">link_table_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#link_table_end:187"><span class="id" title="method">link_table_end</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_link_table_start:189"><span class="id" title="method">adv_link_table_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_link_table_end:190"><span class="id" title="method">adv_link_table_end</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_start:179"><span class="id" title="method">l_assert_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_end:182"><span class="id" title="method">l_assert_end</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_mem_start:174"><span class="id" title="method">l_malloc_mem_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_end:175"><span class="id" title="method">l_malloc_end</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_memptr:173"><span class="id" title="method">l_malloc_memptr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_start:172"><span class="id" title="method">l_malloc_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_memptr:173"><span class="id" title="method">l_malloc_memptr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="call_prog" class="idref" href="#call_prog"><span class="id" title="definition">call_prog</span></a> `{<a id="H0:194" class="idref" href="#H0:194"><span class="id" title="binder">memory_layout</span></a>} : <a class="idref" href="cap_machine.examples.template_adequacy.html#prog"><span class="id" title="record">prog</span></a> :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="cap_machine.examples.template_adequacy.html#prog_start"><span class="id" title="projection">prog_start</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_start"><span class="id" title="method">f_start</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_end"><span class="id" title="projection">prog_end</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_end"><span class="id" title="method">f_end</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_instrs"><span class="id" title="projection">prog_instrs</span></a> := (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_instrs"><span class="id" title="definition">prog_call_instrs</span></a> 0 1 <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.size"><span class="id" title="variable">size</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.secret_off"><span class="id" title="variable">secret_off</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.secret_val"><span class="id" title="variable">secret_val</span></a>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_size"><span class="id" title="projection">prog_size</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_size"><span class="id" title="method">f_size</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="adv_prog" class="idref" href="#adv_prog"><span class="id" title="definition">adv_prog</span></a> `{<a id="H0:196" class="idref" href="#H0:196"><span class="id" title="binder">memory_layout</span></a>} : <a class="idref" href="cap_machine.examples.template_adequacy.html#prog"><span class="id" title="record">prog</span></a> :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="cap_machine.examples.template_adequacy.html#prog_start"><span class="id" title="projection">prog_start</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_start"><span class="id" title="method">adv_start</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_end"><span class="id" title="projection">prog_end</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_end"><span class="id" title="method">adv_end</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_instrs"><span class="id" title="projection">prog_instrs</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_instrs"><span class="id" title="method">adv_instrs</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_size"><span class="id" title="projection">prog_size</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_size"><span class="id" title="method">adv_size</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="layout" class="idref" href="#layout"><span class="id" title="definition">layout</span></a> `{<a id="H0:198" class="idref" href="#H0:198"><span class="id" title="binder">memory_layout</span></a>} : <a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.ocpl_library"><span class="id" title="record">ocpl_library</span></a> :=<br/>
&nbsp;&nbsp;{| <span class="comment">(*&nbsp;malloc&nbsp;library&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.malloc_start"><span class="id" title="projection">malloc_start</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_start"><span class="id" title="method">l_malloc_start</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.malloc_memptr"><span class="id" title="projection">malloc_memptr</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_memptr"><span class="id" title="method">l_malloc_memptr</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.malloc_mem_start"><span class="id" title="projection">malloc_mem_start</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_mem_start"><span class="id" title="method">l_malloc_mem_start</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.malloc_end"><span class="id" title="projection">malloc_end</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_end"><span class="id" title="method">l_malloc_end</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.malloc_code_size"><span class="id" title="projection">malloc_code_size</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_code_size"><span class="id" title="method">l_malloc_code_size</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.malloc_memptr_size"><span class="id" title="projection">malloc_memptr_size</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_memptr_size"><span class="id" title="method">l_malloc_memptr_size</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.malloc_mem_size"><span class="id" title="projection">malloc_mem_size</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_malloc_mem_size"><span class="id" title="method">l_malloc_mem_size</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;assertion&nbsp;fail&nbsp;library&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assert_start"><span class="id" title="projection">assert_start</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_start"><span class="id" title="method">l_assert_start</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assert_cap"><span class="id" title="projection">assert_cap</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_cap"><span class="id" title="method">l_assert_cap</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assert_flag"><span class="id" title="projection">assert_flag</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_flag"><span class="id" title="method">l_assert_flag</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assert_end"><span class="id" title="projection">assert_end</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_end"><span class="id" title="method">l_assert_end</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assert_code_size"><span class="id" title="projection">assert_code_size</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_code_size"><span class="id" title="method">l_assert_code_size</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assert_cap_size"><span class="id" title="projection">assert_cap_size</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_cap_size"><span class="id" title="method">l_assert_cap_size</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assert_flag_size"><span class="id" title="projection">assert_flag_size</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_flag_size"><span class="id" title="method">l_assert_flag_size</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;disjointness&nbsp;of&nbsp;the&nbsp;two&nbsp;libraries&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.libs_disjoint"><span class="id" title="projection">libs_disjoint</span></a> := <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;|}.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#regions_disjoint"><span class="id" title="method">regions_disjoint</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hdisjoint</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="cap_machine.proofmode.disjoint_regions_tactics.html#disjoint_list_cons"><span class="id" title="axiom">disjoint_list_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hdisjoint</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="var">set_solver</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="OCPLLibrary" class="idref" href="#OCPLLibrary"><span class="id" title="definition">OCPLLibrary</span></a> `{<a id="H0:200" class="idref" href="#H0:200"><span class="id" title="binder">memory_layout</span></a>} := <a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.library"><span class="id" title="definition">library</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#layout"><span class="id" title="definition">layout</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="call_table" class="idref" href="#call_table"><span class="id" title="definition">call_table</span></a> `{<a id="H0:202" class="idref" href="#H0:202"><span class="id" title="binder">memory_layout</span></a>} : @<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_priv"><span class="id" title="definition">tbl_priv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_prog"><span class="id" title="definition">call_prog</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#OCPLLibrary"><span class="id" title="definition">OCPLLibrary</span></a> :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="cap_machine.examples.template_adequacy.html#prog_lower_bound"><span class="id" title="projection">prog_lower_bound</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_region_start"><span class="id" title="method">f_region_start</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_start"><span class="id" title="projection">tbl_start</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#link_table_start"><span class="id" title="method">link_table_start</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_end"><span class="id" title="projection">tbl_end</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#link_table_end"><span class="id" title="method">link_table_end</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_size"><span class="id" title="projection">tbl_size</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#link_table_size"><span class="id" title="method">link_table_size</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_prog_link"><span class="id" title="projection">tbl_prog_link</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_region_start_offset"><span class="id" title="method">f_region_start_offset</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_disj"><span class="id" title="projection">tbl_disj</span></a> := <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;|}.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#regions_disjoint"><span class="id" title="method">regions_disjoint</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hdisjoint</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="cap_machine.proofmode.disjoint_regions_tactics.html#disjoint_list_cons"><span class="id" title="axiom">disjoint_list_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hdisjoint</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="var">disjoint_map_to_list</span>. <span class="id" title="var">set_solver</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="adv_table" class="idref" href="#adv_table"><span class="id" title="definition">adv_table</span></a> `{<a id="H0:204" class="idref" href="#H0:204"><span class="id" title="binder">memory_layout</span></a>} : @<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_pub"><span class="id" title="definition">tbl_pub</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_prog"><span class="id" title="definition">adv_prog</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#OCPLLibrary"><span class="id" title="definition">OCPLLibrary</span></a> :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="cap_machine.examples.template_adequacy.html#prog_lower_bound"><span class="id" title="projection">prog_lower_bound</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_region_start"><span class="id" title="method">adv_region_start</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_start"><span class="id" title="projection">tbl_start</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_link_table_start"><span class="id" title="method">adv_link_table_start</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_end"><span class="id" title="projection">tbl_end</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_link_table_end"><span class="id" title="method">adv_link_table_end</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_size"><span class="id" title="projection">tbl_size</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_link_table_size"><span class="id" title="method">adv_link_table_size</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_prog_link"><span class="id" title="projection">tbl_prog_link</span></a> := <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_region_start_offset"><span class="id" title="method">adv_region_start_offset</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_disj"><span class="id" title="projection">tbl_disj</span></a> := <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;|}.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#regions_disjoint"><span class="id" title="method">regions_disjoint</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hdisjoint</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="cap_machine.proofmode.disjoint_regions_tactics.html#disjoint_list_cons"><span class="id" title="axiom">disjoint_list_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hdisjoint</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="var">disjoint_map_to_list</span>. <span class="id" title="var">set_solver</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="program_call_adequacy.prog_call_correct" class="idref" href="#program_call_adequacy.prog_call_correct"><span class="id" title="section">prog_call_correct</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="d577b2c43294ea41c76de33b7a672205" class="idref" href="#d577b2c43294ea41c76de33b7a672205"><span class="id" title="binder">Σ</span></a>:<span class="id" title="record">gFunctors</span>} {<a id="memg:206" class="idref" href="#memg:206"><span class="id" title="binder">memg</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#memG"><span class="id" title="class">memG</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#d577b2c43294ea41c76de33b7a672205"><span class="id" title="variable">Σ</span></a>} {<a id="regg:207" class="idref" href="#regg:207"><span class="id" title="binder">regg</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#regG"><span class="id" title="class">regG</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#d577b2c43294ea41c76de33b7a672205"><span class="id" title="variable">Σ</span></a>} {<a id="sealsg:208" class="idref" href="#sealsg:208"><span class="id" title="binder">sealsg</span></a> : <a class="idref" href="cap_machine.seal_store.html#sealStoreG"><span class="id" title="class">sealStoreG</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#d577b2c43294ea41c76de33b7a672205"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="nainv:209" class="idref" href="#nainv:209"><span class="id" title="binder">nainv</span></a>: <a class="idref" href="cap_machine.logrel.html#logrel_na_invs"><span class="id" title="class">logrel_na_invs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#d577b2c43294ea41c76de33b7a672205"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a id="memlayout:211" class="idref" href="#memlayout:211"><span class="id" title="binder">memlayout</span></a>: <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#memory_layout"><span class="id" title="class">memory_layout</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prog_call_correct" class="idref" href="#prog_call_correct"><span class="id" title="lemma">prog_call_correct</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="w:212" class="idref" href="#w:212"><span class="id" title="binder">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.machine_base.html#is_z"><span class="id" title="definition">is_z</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:212"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="cap_machine.logrel.html#in_region"><span class="id" title="definition">in_region</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:212"><span class="id" title="variable">w</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_start"><span class="id" title="method">adv_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_end"><span class="id" title="method">adv_end</span></a>) <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_instrs"><span class="id" title="method">adv_instrs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="filtered_map:216" class="idref" href="#filtered_map:216"><span class="id" title="binder">filtered_map</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">(</span></a><a id="m:213" class="idref" href="#m:213"><span class="id" title="binder">m</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">),</span></a> <span class="id" title="definition">filter</span> (<span class="id" title="keyword">fun</span> '<a id="pat:215" class="idref" href="#pat:215"><span class="id" title="binder">(</span></a><a id="a:214" class="idref" href="#a:214"><span class="id" title="binder"><span id="pat:215" class="id">a</span></span></a><a id="pat:215" class="idref" href="#pat:215"><span class="id" title="binder">,</span></a> <a id="pat:215" class="idref" href="#pat:215"><span class="id" title="binder">_</span></a><a id="pat:215" class="idref" href="#pat:215"><span class="id" title="binder">)</span></a> =&gt; <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:214"><span class="id" title="variable">a</span></a> <span class="id" title="notation">∉</span> <a class="idref" href="cap_machine.examples.template_adequacy.html#minv_dom"><span class="id" title="projection">minv_dom</span></a> (<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.flag_inv"><span class="id" title="definition">flag_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#layout"><span class="id" title="definition">layout</span></a>)) <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#m:213"><span class="id" title="variable">m</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="rmap:217" class="idref" href="#rmap:217"><span class="id" title="binder">rmap</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#rmap:217"><span class="id" title="variable">rmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.addr_reg.html#all_registers_s"><span class="id" title="definition">all_registers_s</span></a> <span class="id" title="notation">∖</span> <span class="id" title="notation">{[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> <span class="id" title="notation">]}</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">inv</span> <a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.invN"><span class="id" title="definition">invN</span></a> (<a class="idref" href="cap_machine.examples.template_adequacy.html#minv_sep"><span class="id" title="definition">minv_sep</span></a> (<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.flag_inv"><span class="id" title="definition">flag_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#layout"><span class="id" title="definition">layout</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="definition">na_inv</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.mallocN"><span class="id" title="definition">mallocN</span></a> (<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.mallocInv"><span class="id" title="definition">mallocInv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#layout"><span class="id" title="definition">layout</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="definition">na_inv</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assertN"><span class="id" title="definition">assertN</span></a> (<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assertInv"><span class="id" title="definition">assertInv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#layout"><span class="id" title="definition">layout</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="definition">na_own</span> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <span class="id" title="notation">⊤</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> (<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_lower_bound"><span class="id" title="projection">prog_lower_bound</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_table"><span class="id" title="definition">call_table</span></a>) (<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_end"><span class="id" title="projection">prog_end</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_prog"><span class="id" title="definition">call_prog</span></a>) (<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_start"><span class="id" title="projection">prog_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_prog"><span class="id" title="definition">call_prog</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> (<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_lower_bound"><span class="id" title="projection">prog_lower_bound</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_table"><span class="id" title="definition">adv_table</span></a>) (<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_end"><span class="id" title="projection">prog_end</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_prog"><span class="id" title="definition">adv_prog</span></a>) (<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_start"><span class="id" title="projection">prog_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_prog"><span class="id" title="definition">adv_prog</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="r:218" class="idref" href="#r:218"><span class="id" title="binder"><span id="r:219" class="id">r</span></span></a><span class="id" title="notation">↦</span><a id="w:220" class="idref" href="#w:220"><span class="id" title="binder"><span id="w:221" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#rmap:217"><span class="id" title="variable">rmap</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#r:218"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:220"><span class="id" title="variable">w</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.machine_base.html#is_z"><span class="id" title="definition">is_z</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:220"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><span class="id" title="notation">⌝</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;P&nbsp;program&nbsp;and&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.examples.template_adequacy.html#prog_lower_bound"><span class="id" title="projection">prog_lower_bound</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_table"><span class="id" title="definition">call_table</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RO"><span class="id" title="constructor">RO</span></a> (<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_start"><span class="id" title="projection">tbl_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_table"><span class="id" title="definition">call_table</span></a>) (<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_end"><span class="id" title="projection">tbl_end</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_table"><span class="id" title="definition">call_table</span></a>) (<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_start"><span class="id" title="projection">tbl_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_table"><span class="id" title="definition">call_table</span></a>)<a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:222" class="idref" href="#a:222"><span class="id" title="binder"><span id="a:223" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:224" class="idref" href="#w:224"><span class="id" title="binder"><span id="w:225" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_region"><span class="id" title="definition">tbl_region</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_table"><span class="id" title="definition">call_table</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:222"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:224"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:226" class="idref" href="#a:226"><span class="id" title="binder"><span id="a:227" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:228" class="idref" href="#w:228"><span class="id" title="binder"><span id="w:229" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.examples.template_adequacy.html#prog_region"><span class="id" title="definition">prog_region</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_prog"><span class="id" title="definition">call_prog</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:226"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:228"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Adv&nbsp;program&nbsp;and&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.examples.template_adequacy.html#prog_lower_bound"><span class="id" title="projection">prog_lower_bound</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_table"><span class="id" title="definition">adv_table</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RO"><span class="id" title="constructor">RO</span></a> (<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_start"><span class="id" title="projection">tbl_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_table"><span class="id" title="definition">adv_table</span></a>) (<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_end"><span class="id" title="projection">tbl_end</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_table"><span class="id" title="definition">adv_table</span></a>) (<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_start"><span class="id" title="projection">tbl_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_table"><span class="id" title="definition">adv_table</span></a>)<a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:230" class="idref" href="#a:230"><span class="id" title="binder"><span id="a:231" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:232" class="idref" href="#w:232"><span class="id" title="binder"><span id="w:233" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_region"><span class="id" title="definition">tbl_region</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_table"><span class="id" title="definition">adv_table</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:230"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:232"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:234" class="idref" href="#a:234"><span class="id" title="binder"><span id="a:235" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:236" class="idref" href="#w:236"><span class="id" title="binder"><span id="w:237" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.examples.template_adequacy.html#prog_region"><span class="id" title="definition">prog_region</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_prog"><span class="id" title="definition">adv_prog</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#a:234"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:236"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <span class="id" title="notation">{{</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <span class="id" title="notation">True</span> <span class="id" title="notation">}}</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hints</span> <span class="id" title="var">Hfilter</span> <span class="id" title="var">rmap</span> <span class="id" title="var">Hdom</span>) "(#Hinv &amp; #Hmalloc &amp; #Hassert &amp; Hown &amp; HPC &amp; Hr_adv &amp; Hrmap &amp; Hcall_link &amp; Hcall_table &amp; Hcall
                                 &amp; Hadv_link &amp; Hadv_table &amp; Hadv)".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_sep</span> <span class="id" title="notation">with</span> "Hrmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hrmap #Hrmapvalid]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;setting&nbsp;up&nbsp;read&nbsp;only&nbsp;example&nbsp;program&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_code"><span class="id" title="definition">prog_call_code</span></a> (<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_start"><span class="id" title="method">f_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_end"><span class="id" title="method">f_end</span></a>) 0 1 <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.size"><span class="id" title="variable">size</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.secret_off"><span class="id" title="variable">secret_off</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.secret_val"><span class="id" title="variable">secret_val</span></a>) <span class="id" title="keyword">with</span> "[Hcall] "<span class="id" title="keyword">as</span> "Hprog".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_code"><span class="id" title="definition">prog_call_code</span></a> /<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_region"><span class="id" title="definition">prog_region</span></a> /= /<a class="idref" href="cap_machine.proofmode.mkregion_helpers.html#mkregion"><span class="id" title="definition">mkregion</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.iris_extra.html#big_sepM_to_big_sepL2"><span class="id" title="axiom">big_sepM_to_big_sepL2</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_NoDup"><span class="id" title="lemma">finz_seq_between_NoDup</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_size"><span class="id" title="method">f_size</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hsize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_length"><span class="id" title="lemma">finz_seq_between_length</span></a> /<a class="idref" href="machine_utils.finz_interval.html#finz.dist"><span class="id" title="definition">finz.dist</span></a>. <span class="id" title="var">solve_addr</span> +<span class="id" title="var">Hsize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;cleaning&nbsp;up&nbsp;the&nbsp;environment&nbsp;tables&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.examples.template_adequacy.html#tbl_region"><span class="id" title="definition">tbl_region</span></a> /<a class="idref" href="cap_machine.proofmode.mkregion_helpers.html#mkregion"><span class="id" title="definition">mkregion</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#link_table_size"><span class="id" title="method">link_table_size</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hsize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#link_table_start"><span class="id" title="method">link_table_start</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">link_table_mid</span> <span class="id" title="var">Hmid</span>]. <span class="id" title="var">solve_addr</span>+<span class="id" title="var">Hsize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_cons"><span class="id" title="lemma">finz_seq_between_cons</span></a>;[|<span class="id" title="var">solve_addr</span> +<span class="id" title="var">Hsize</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="cap_machine.addr_reg.html#addr_incr_eq"><span class="id" title="abbreviation">addr_incr_eq</span></a> <span class="id" title="var">Hmid</span>) /= <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_singleton"><span class="id" title="lemma">finz_seq_between_singleton</span></a> /=;[|<span class="id" title="var">solve_addr</span> +<span class="id" title="var">Hmid</span> <span class="id" title="var">Hsize</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_link_table_size"><span class="id" title="method">adv_link_table_size</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hsize_adv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_singleton"><span class="id" title="lemma">finz_seq_between_singleton</span></a> /=;[|<span class="id" title="var">solve_addr</span> +<span class="id" title="var">Hsize_adv</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hcall_table"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hlink_table_start Hcall_table]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>//. <span class="id" title="var">solve_addr</span> +<span class="id" title="var">Hmid</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hcall_table"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hlink_table_mid _]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hadv_table"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hadv_link_table_start _]";<span class="id" title="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;determine&nbsp;malloc&nbsp;validity&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.examples.malloc.html#simple_malloc_subroutine_valid"><span class="id" title="axiom">simple_malloc_subroutine_valid</span></a> <span class="id" title="notation">with</span> "[$Hmalloc]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#Hmalloc_val".<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;allocate&nbsp;adversary&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">inv_alloc</span> (<a class="idref" href="cap_machine.logrel.html#logN"><span class="id" title="definition">logN</span></a> <span class="id" title="notation">.@</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_link_table_start"><span class="id" title="method">adv_link_table_start</span></a>) <span class="id" title="notation">⊤</span> (<a class="idref" href="cap_machine.logrel.html#interp_ref_inv"><span class="id" title="definition">interp_ref_inv</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_link_table_start"><span class="id" title="method">adv_link_table_start</span></a> <a class="idref" href="cap_machine.logrel.html#interp"><span class="id" title="definition">interp</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">with</span> "[Hadv_link_table_start]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#Hadv_table_valid".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iNext</span>. <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="tactic">auto</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;allocate&nbsp;validity&nbsp;of&nbsp;adversary&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_size"><span class="id" title="method">adv_size</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hadv_size'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_region_start_offset"><span class="id" title="method">adv_region_start_offset</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hadv_region_offset</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.iris_extra.html#big_sepM_to_big_sepL2"><span class="id" title="axiom">big_sepM_to_big_sepL2</span></a> <span class="id" title="notation">with</span> "Hadv"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hadv /=". <span class="id" title="tactic">apply</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_NoDup"><span class="id" title="lemma">finz_seq_between_NoDup</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_length"><span class="id" title="lemma">finz_seq_between_length</span></a> /<a class="idref" href="machine_utils.finz_interval.html#finz.dist"><span class="id" title="definition">finz.dist</span></a> /=. <span class="id" title="var">solve_addr</span>+<span class="id" title="var">Hadv_size'</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<span class="id" title="notation">|={</span><span class="id" title="notation">⊤</span><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logrel.html#interp"><span class="id" title="definition">interp</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_start"><span class="id" title="method">adv_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_end"><span class="id" title="method">adv_end</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_start"><span class="id" title="method">adv_start</span></a>))%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[Hadv]" <span class="id" title="keyword">as</span> "&gt;#Hadv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iApply</span> (<a class="idref" href="cap_machine.logrel.html#region_valid_in_region"><span class="id" title="axiom">region_valid_in_region</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_instrs"><span class="id" title="method">adv_instrs</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">set_solver</span>+. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<span class="id" title="notation">|={</span><span class="id" title="notation">⊤</span><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logrel.html#interp"><span class="id" title="definition">interp</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_region_start"><span class="id" title="method">adv_region_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_end"><span class="id" title="method">adv_end</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_start"><span class="id" title="method">adv_start</span></a>))%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[Hadv_link]" <span class="id" title="keyword">as</span> "&gt;#Hadv_valid".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.logrel.html#fixpoint_interp1_eq"><span class="id" title="lemma">fixpoint_interp1_eq</span></a>. <span class="id" title="var">iSimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_cons"><span class="id" title="lemma">finz_seq_between_cons</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_region_start"><span class="id" title="method">adv_region_start</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">rewrite</span> (<a class="idref" href="cap_machine.addr_reg.html#addr_incr_eq"><span class="id" title="abbreviation">addr_incr_eq</span></a> <span class="id" title="var">Hadv_region_offset</span>) /=|<span class="id" title="var">solve_addr</span> +<span class="id" title="var">Hadv_region_offset</span> <span class="id" title="var">Hadv_size'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> <a class="idref" href="cap_machine.logrel.html#interp"><span class="id" title="definition">interp</span></a>. <span class="id" title="var">iSplitL</span>;[|<span class="id" title="var">iModIntro</span>;<span class="id" title="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">inv_alloc</span>. <span class="id" title="var">iNext</span>. <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.logrel.html#fixpoint_interp1_eq"><span class="id" title="lemma">fixpoint_interp1_eq</span></a>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_singleton"><span class="id" title="lemma">finz_seq_between_singleton</span></a>// /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="var">iExists</span> <a class="idref" href="cap_machine.logrel.html#interp"><span class="id" title="definition">interp</span></a>. <span class="id" title="var">iFrame</span> "#".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iModIntro</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> !<a class="idref" href="cap_machine.logrel.html#fixpoint_interp1_eq"><span class="id" title="lemma">fixpoint_interp1_eq</span></a> /=. <span class="id" title="var">iFrame</span> "#". <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_full_run_spec"><span class="id" title="axiom">prog_call_full_run_spec</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">with</span> "[- $HPC $Hown $Hr_adv $Hrmap $Hprog
             $Hlink_table_start $Hlink_table_mid $Hcall_link
             $Hadv_valid]"<span class="id" title="notation">)</span>;<span class="id" title="tactic">auto</span> ; <span class="id" title="var">cycle</span> -1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#malloc_call_inv"><span class="id" title="definition">malloc_call_inv</span></a> /<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.mallocInv"><span class="id" title="definition">mallocInv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#assert_call_inv"><span class="id" title="definition">assert_call_inv</span></a> /<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.assertInv"><span class="id" title="definition">assertInv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#flag_call_inv"><span class="id" title="definition">flag_call_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span> "#".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">inv_iff</span> <span class="id" title="notation">with</span> "Hinv []"<span class="id" title="notation">)</span>. <span class="id" title="var">iNext</span>. <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.examples.template_adequacy.html#minv_sep"><span class="id" title="definition">minv_sep</span></a> /=. <span class="id" title="var">iIntros</span> "HH". <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> (<span class="id" title="var">m</span>) "(Hm &amp; %Heq &amp; %HOK)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">m</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_flag"><span class="id" title="method">l_assert_flag</span></a>)) <span class="id" title="keyword">as</span> [? <span class="id" title="var">Hlook</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_singleton</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_lookup</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_flag"><span class="id" title="method">l_assert_flag</span></a> <span class="id" title="notation">with</span> "Hm"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hflag";<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HOK</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlook</span> <span class="id" title="keyword">as</span> -&gt;. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> "HH". <span class="id" title="var">iExists</span> <span class="id" title="notation">{[</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_flag"><span class="id" title="method">l_assert_flag</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> 0%<span class="id" title="var">Z</span> <span class="id" title="notation">]}</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_singleton</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">dom_singleton_L</span> /<a class="idref" href="cap_machine.examples.template_adequacy.html#minv_dom"><span class="id" title="projection">minv_dom</span></a> /=. <span class="id" title="var">iSplit</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.OK_invariant"><span class="id" title="definition">OK_invariant</span></a>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">w</span> <span class="id" title="var">Hw</span>. <span class="id" title="var">simplify_map_eq</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_base.html#ExecPCPerm_RWX"><span class="id" title="lemma">ExecPCPerm_RWX</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (1:=<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_end"><span class="id" title="method">f_end</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_region_start_offset"><span class="id" title="method">f_region_start_offset</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_size"><span class="id" title="method">f_size</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">HH'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_addr</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.proofmode.contiguous.html#contiguous_between_of_region_addrs"><span class="id" title="axiom">contiguous_between_of_region_addrs</span></a>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#f_size"><span class="id" title="method">f_size</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">HH</span>. <span class="id" title="var">solve_addr</span>+<span class="id" title="var">HH</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_base.html#le_addr_withinBounds'"><span class="id" title="lemma">le_addr_withinBounds'</span></a>. <span class="id" title="var">solve_addr</span>+<span class="id" title="var">Hsize</span> <span class="id" title="var">Hmid</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.machine_base.html#le_addr_withinBounds'"><span class="id" title="lemma">le_addr_withinBounds'</span></a>. <span class="id" title="var">solve_addr</span>+<span class="id" title="var">Hsize</span> <span class="id" title="var">Hmid</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">solve_addr</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy.prog_call_correct"><span class="id" title="section">prog_call_correct</span></a>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="prog_call_adequacy" class="idref" href="#prog_call_adequacy"><span class="id" title="lemma">prog_call_adequacy</span></a> `{<a id="H0:239" class="idref" href="#H0:239"><span class="id" title="binder">memory_layout</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:240" class="idref" href="#m:240"><span class="id" title="binder">m</span></a> <a id="m':241" class="idref" href="#m':241"><span class="id" title="binder">m'</span></a>: <a class="idref" href="cap_machine.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>) (<a id="reg:242" class="idref" href="#reg:242"><span class="id" title="binder">reg</span></a> <a id="reg':243" class="idref" href="#reg':243"><span class="id" title="binder">reg'</span></a>: <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) (<a id="es:244" class="idref" href="#es:244"><span class="id" title="binder">es</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.is_initial_memory"><span class="id" title="definition">is_initial_memory</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_prog"><span class="id" title="definition">call_prog</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_prog"><span class="id" title="definition">adv_prog</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#OCPLLibrary"><span class="id" title="definition">OCPLLibrary</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_table"><span class="id" title="definition">call_table</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_table"><span class="id" title="definition">adv_table</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#m:240"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.is_initial_registers"><span class="id" title="definition">is_initial_registers</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_prog"><span class="id" title="definition">call_prog</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_prog"><span class="id" title="definition">adv_prog</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#OCPLLibrary"><span class="id" title="definition">OCPLLibrary</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_table"><span class="id" title="definition">call_table</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_table"><span class="id" title="definition">adv_table</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#reg:242"><span class="id" title="variable">reg</span></a> <a class="idref" href="cap_machine.addr_reg.html#r_t30"><span class="id" title="definition">r_t30</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="w:245" class="idref" href="#w:245"><span class="id" title="binder">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.machine_base.html#is_z"><span class="id" title="definition">is_z</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:245"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="cap_machine.logrel.html#in_region"><span class="id" title="definition">in_region</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:245"><span class="id" title="variable">w</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_start"><span class="id" title="method">adv_start</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_end"><span class="id" title="method">adv_end</span></a>) (<a class="idref" href="cap_machine.examples.template_adequacy.html#prog_instrs"><span class="id" title="projection">prog_instrs</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_prog"><span class="id" title="definition">adv_prog</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="id" title="inductive">rtc</span> <span class="id" title="definition">erased_step</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#reg:242"><span class="id" title="variable">reg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#m:240"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#es:244"><span class="id" title="variable">es</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#reg':243"><span class="id" title="variable">reg'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#m':241"><span class="id" title="variable">m'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="w:246" class="idref" href="#w:246"><span class="id" title="binder">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#m':241"><span class="id" title="variable">m'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#l_assert_flag"><span class="id" title="method">l_assert_flag</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:246"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#w:246"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> 0%<span class="id" title="var">Z</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ? <span class="id" title="var">Hints</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">Σ'</span> := <span class="id" title="notation">#[]</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="cap_machine.examples.template_adequacy_ocpl.html#ocpl.ocpl_template_adequacy"><span class="id" title="axiom">ocpl_template_adequacy</span></a> <span class="id" title="var">Σ'</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#layout"><span class="id" title="definition">layout</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_prog"><span class="id" title="definition">call_prog</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_prog"><span class="id" title="definition">adv_prog</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#call_table"><span class="id" title="definition">call_table</span></a> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#adv_table"><span class="id" title="definition">adv_table</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hadequacy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">Hadequacy</span>;<span class="id" title="tactic">eauto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Σ</span> ? ? ? ? ?.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#prog_call_correct"><span class="id" title="axiom">prog_call_correct</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hints</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.exercises.subseg_buffer_call.html#program_call_adequacy"><span class="id" title="section">program_call_adequacy</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
