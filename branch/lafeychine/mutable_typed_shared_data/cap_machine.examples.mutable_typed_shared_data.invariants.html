<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">cap_machine.examples.mutable_typed_shared_data.invariants</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.proofmode.html#"><span class="id" title="library">proofmode</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.fundamental.html#"><span class="id" title="library">fundamental</span></a> <a class="idref" href="cap_machine.logrel.html#"><span class="id" title="library">logrel</span></a> <a class="idref" href="cap_machine.examples.macros.html#"><span class="id" title="library">macros</span></a> <a class="idref" href="cap_machine.examples.macros_helpers.html#"><span class="id" title="library">macros_helpers</span></a> <a class="idref" href="cap_machine.proofmode.html#"><span class="id" title="library">proofmode</span></a> <a class="idref" href="cap_machine.rules.html#"><span class="id" title="library">rules</span></a> <a class="idref" href="cap_machine.register_tactics.html#"><span class="id" title="library">register_tactics</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine.examples</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="cap_machine.examples.arch_sealing.html#"><span class="id" title="library">arch_sealing</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;This&nbsp;section&nbsp;redefines&nbsp;useful&nbsp;definitions&nbsp;from&nbsp;`arch_sealing`&nbsp;along&nbsp;with&nbsp;further&nbsp;explanations.&nbsp;*)</span><br/>
<span class="id" title="keyword">Section</span> <a id="invariants" class="idref" href="#invariants"><span class="id" title="section">invariants</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="0101b9beac487b383a5ba2a8f6922788" class="idref" href="#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="binder">Σ</span></a>:<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.base_logic.lib.iprop.html#gFunctors"><span class="id" title="record">gFunctors</span></a>} {<a id="memg:2" class="idref" href="#memg:2"><span class="id" title="binder">memg</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#memG"><span class="id" title="class">memG</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>} {<a id="regg:3" class="idref" href="#regg:3"><span class="id" title="binder">regg</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#regG"><span class="id" title="class">regG</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>} {<a id="sealsg:4" class="idref" href="#sealsg:4"><span class="id" title="binder">sealsg</span></a>: <a class="idref" href="cap_machine.seal_store.html#sealStoreG"><span class="id" title="class">sealStoreG</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="nainv:5" class="idref" href="#nainv:5"><span class="id" title="binder">nainv</span></a>: <a class="idref" href="cap_machine.logrel.html#logrel_na_invs"><span class="id" title="class">logrel_na_invs</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>} `{<a id="MP:6" class="idref" href="#MP:6"><span class="id" title="binder">MP</span></a>: <a class="idref" href="cap_machine.machine_parameters.html#MachineParameters"><span class="id" title="class">MachineParameters</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;`seal_pred`&nbsp;denotes&nbsp;that&nbsp;the&nbsp;sealed&nbsp;satisfies&nbsp;a&nbsp;predicate&nbsp;`Φ`,&nbsp;for&nbsp;a&nbsp;specific&nbsp;`τ`&nbsp;OType.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note:&nbsp;`seal_pred`&nbsp;does&nbsp;not&nbsp;need&nbsp;to&nbsp;be&nbsp;put&nbsp;inside&nbsp;an&nbsp;invariant,&nbsp;because&nbsp;it&nbsp;is&nbsp;`Persistent`.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="seal_pred" class="idref" href="#seal_pred"><span class="id" title="definition">seal_pred</span></a> <a id="d9994f383cd17b449c0ea4abe4a8d84e" class="idref" href="#d9994f383cd17b449c0ea4abe4a8d84e"><span class="id" title="binder">τ</span></a> <a id="ddd74b3e5ac7acdccfa97dcaa59e83fe" class="idref" href="#ddd74b3e5ac7acdccfa97dcaa59e83fe"><span class="id" title="binder">Φ</span></a> {<a id="Hpers:10" class="idref" href="#Hpers:10"><span class="id" title="binder">Hpers</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="w:9" class="idref" href="#w:9"><span class="id" title="binder">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_connectives.html#Persistent"><span class="id" title="class">Persistent</span></a> (<a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#ddd74b3e5ac7acdccfa97dcaa59e83fe"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:9"><span class="id" title="variable">w</span></a>)} := <a class="idref" href="cap_machine.seal_store.html#seal_pred"><span class="id" title="definition">seal_store.seal_pred</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#d9994f383cd17b449c0ea4abe4a8d84e"><span class="id" title="variable">τ</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#ddd74b3e5ac7acdccfa97dcaa59e83fe"><span class="id" title="variable">Φ</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note:&nbsp;`arch_sealing.seal_state`&nbsp;is&nbsp;the&nbsp;combination&nbsp;of&nbsp;`seal_pred`&nbsp;and&nbsp;a&nbsp;invariant.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&gt;&nbsp;This&nbsp;invariant&nbsp;pins&nbsp;`WSealRange`&nbsp;in&nbsp;memory&nbsp;to&nbsp;retrieve&nbsp;an&nbsp;access&nbsp;to&nbsp;it.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;For&nbsp;simplicity,&nbsp;`WSealRange`&nbsp;will&nbsp;be&nbsp;easily&nbsp;accessible&nbsp;(hidden&nbsp;in&nbsp;front&nbsp;of&nbsp;our&nbsp;instructions).&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Fact&nbsp;that&nbsp;the&nbsp;value&nbsp;`w`,&nbsp;if&nbsp;`interp&nbsp;w`,&nbsp;has&nbsp;been&nbsp;validly&nbsp;sealed&nbsp;satisfying&nbsp;a&nbsp;`Φ`&nbsp;predicate.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="valid_sealed" class="idref" href="#valid_sealed"><span class="id" title="definition">valid_sealed</span></a> <a id="w:11" class="idref" href="#w:11"><span class="id" title="binder">w</span></a> <a id="7e4be4415363190d87652b6811005fa5" class="idref" href="#7e4be4415363190d87652b6811005fa5"><span class="id" title="binder">τ</span></a> <a id="88e16403a2e8c3584cb2b35950a575fb" class="idref" href="#88e16403a2e8c3584cb2b35950a575fb"><span class="id" title="binder">Φ</span></a> := <a class="idref" href="cap_machine.examples.arch_sealing.html#valid_sealed"><span class="id" title="definition">arch_sealing.valid_sealed</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:11"><span class="id" title="variable">w</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#7e4be4415363190d87652b6811005fa5"><span class="id" title="variable">τ</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#88e16403a2e8c3584cb2b35950a575fb"><span class="id" title="variable">Φ</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma:&nbsp;If&nbsp;something&nbsp;is&nbsp;sealed,&nbsp;it&nbsp;is&nbsp;sufficient&nbsp;to&nbsp;know&nbsp;that&nbsp;the&nbsp;sealed&nbsp;satisfies&nbsp;a&nbsp;predicate&nbsp;`Φ`.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="interp_valid_sealed" class="idref" href="#interp_valid_sealed"><span class="id" title="definition">interp_valid_sealed</span></a> <a id="sb:14" class="idref" href="#sb:14"><span class="id" title="binder">sb</span></a> <a id="8386e35dda34fed27cb28fc91360cb4d" class="idref" href="#8386e35dda34fed27cb28fc91360cb4d"><span class="id" title="binder">τ</span></a> := <a class="idref" href="cap_machine.examples.arch_sealing.html#interp_valid_sealed"><span class="id" title="axiom">arch_sealing.interp_valid_sealed</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#sb:14"><span class="id" title="variable">sb</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#8386e35dda34fed27cb28fc91360cb4d"><span class="id" title="variable">τ</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma:&nbsp;Concludes&nbsp;that&nbsp;`Φ&nbsp;≡&nbsp;Φ'`&nbsp;if&nbsp;`seal_pred&nbsp;τ&nbsp;Φ`&nbsp;and&nbsp;`valid_sealed&nbsp;w&nbsp;τ&nbsp;Φ`&nbsp;have&nbsp;the&nbsp;same&nbsp;`τ`&nbsp;OType.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note:&nbsp;This&nbsp;is&nbsp;a&nbsp;more&nbsp;generic&nbsp;version&nbsp;of&nbsp;`arch_sealing.sealLL_valid_sealed_pred_eq`&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="seal_pred_valid_sealed_eq" class="idref" href="#seal_pred_valid_sealed_eq"><span class="id" title="lemma">seal_pred_valid_sealed_eq</span></a> <a id="caf12df89081b701dbf363ba98445dbe" class="idref" href="#caf12df89081b701dbf363ba98445dbe"><span class="id" title="binder">τ</span></a> <a id="w:17" class="idref" href="#w:17"><span class="id" title="binder">w</span></a> <a id="652bd9465001e3533fc08d9e71bdc2f1" class="idref" href="#652bd9465001e3533fc08d9e71bdc2f1"><span class="id" title="binder">Φ</span></a> <a id="a21647272b294d8dd35b14c71e5cb177" class="idref" href="#a21647272b294d8dd35b14c71e5cb177"><span class="id" title="binder">Φ'</span></a> {<a id="Hpers:21" class="idref" href="#Hpers:21"><span class="id" title="binder">Hpers</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="w:20" class="idref" href="#w:20"><span class="id" title="binder">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_connectives.html#Persistent"><span class="id" title="class">Persistent</span></a> (<a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#652bd9465001e3533fc08d9e71bdc2f1"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:20"><span class="id" title="variable">w</span></a>)} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#seal_pred"><span class="id" title="definition">seal_pred</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#caf12df89081b701dbf363ba98445dbe"><span class="id" title="variable">τ</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#652bd9465001e3533fc08d9e71bdc2f1"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#0f70793a7efc24c230ef5e3a6ac95b68"><span class="id" title="notation">-∗</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#valid_sealed"><span class="id" title="definition">valid_sealed</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:17"><span class="id" title="variable">w</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#caf12df89081b701dbf363ba98445dbe"><span class="id" title="variable">τ</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#a21647272b294d8dd35b14c71e5cb177"><span class="id" title="variable">Φ'</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6e96398fec71e244af9dd75e40876ca6"><span class="id" title="notation">-∗</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6e96398fec71e244af9dd75e40876ca6"><span class="id" title="notation">(</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#3737660a6294eb9f7af6df17be5eb5a3"><span class="id" title="notation">∀</span></a> <a id="w:22" class="idref" href="#w:22"><span class="id" title="binder">w</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#3737660a6294eb9f7af6df17be5eb5a3"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#1ab064278224e8da215d0768a08713fe"><span class="id" title="notation">▷</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#1ab064278224e8da215d0768a08713fe"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#652bd9465001e3533fc08d9e71bdc2f1"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:22"><span class="id" title="variable">w</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.internal_eq.html#29819c8800064fb1d81bca894bd0e454"><span class="id" title="notation">≡</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#a21647272b294d8dd35b14c71e5cb177"><span class="id" title="variable">Φ'</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:22"><span class="id" title="variable">w</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#1ab064278224e8da215d0768a08713fe"><span class="id" title="notation">)</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6e96398fec71e244af9dd75e40876ca6"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hsp Hvs".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hvs" <span class="id" title="keyword">as</span> (<span class="id" title="var">sb</span>) "(_ &amp; _ &amp; Hsp' &amp; _)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.seal_store.html#seal_pred_agree"><span class="id" title="axiom">seal_pred_agree</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">with</span></a> "Hsp Hsp'"<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.ltac_tactics.html#c65a9d4b357f2165cc71fe44c81db669"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#invariants"><span class="id" title="section">invariants</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;proof&nbsp;guideline&nbsp;for&nbsp;accessing&nbsp;the&nbsp;sealed&nbsp;predicate&nbsp;is&nbsp;as&nbsp;follows:&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;We&nbsp;assume:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;-&nbsp;`seal_pred&nbsp;τ&nbsp;φ`,&nbsp;for&nbsp;some&nbsp;known&nbsp;`φ`&nbsp;(e.g:&nbsp;`sealed_cap`)&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;-&nbsp;`interp&nbsp;w`,&nbsp;where&nbsp;`w&nbsp;=&nbsp;WSealed&nbsp;τ&nbsp;scap`&nbsp;for&nbsp;any&nbsp;given&nbsp;`scap`&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;1.&nbsp;Using&nbsp;`interp_valid_sealed`,&nbsp;we&nbsp;can&nbsp;get&nbsp;`▷&nbsp;valid_sealed&nbsp;(WSealed&nbsp;τ&nbsp;scap)&nbsp;τ&nbsp;Φ`.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;2.&nbsp;`Φ`&nbsp;is&nbsp;currently&nbsp;unknown,&nbsp;we&nbsp;have&nbsp;to&nbsp;use&nbsp;`seal_pred_valid_sealed_eq`&nbsp;to&nbsp;retrieve&nbsp;`φ`.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="invariants_cap" class="idref" href="#invariants_cap"><span class="id" title="section">invariants_cap</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="3eadb2a0aeaeef49bd6cd27b7316c266" class="idref" href="#3eadb2a0aeaeef49bd6cd27b7316c266"><span class="id" title="binder">Σ</span></a>:<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.base_logic.lib.iprop.html#gFunctors"><span class="id" title="record">gFunctors</span></a>} {<a id="memg:24" class="idref" href="#memg:24"><span class="id" title="binder">memg</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#memG"><span class="id" title="class">memG</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#3eadb2a0aeaeef49bd6cd27b7316c266"><span class="id" title="variable">Σ</span></a>} {<a id="regg:25" class="idref" href="#regg:25"><span class="id" title="binder">regg</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#regG"><span class="id" title="class">regG</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#3eadb2a0aeaeef49bd6cd27b7316c266"><span class="id" title="variable">Σ</span></a>} {<a id="sealsg:26" class="idref" href="#sealsg:26"><span class="id" title="binder">sealsg</span></a>: <a class="idref" href="cap_machine.seal_store.html#sealStoreG"><span class="id" title="class">sealStoreG</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#3eadb2a0aeaeef49bd6cd27b7316c266"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="nainv:27" class="idref" href="#nainv:27"><span class="id" title="binder">nainv</span></a>: <a class="idref" href="cap_machine.logrel.html#logrel_na_invs"><span class="id" title="class">logrel_na_invs</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#3eadb2a0aeaeef49bd6cd27b7316c266"><span class="id" title="variable">Σ</span></a>} `{<a id="MP:28" class="idref" href="#MP:28"><span class="id" title="binder">MP</span></a>: <a class="idref" href="cap_machine.machine_parameters.html#MachineParameters"><span class="id" title="class">MachineParameters</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="seal_capN" class="idref" href="#seal_capN"><span class="id" title="definition">seal_capN</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.namespaces.html#namespace"><span class="id" title="definition">namespace</span></a> := <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.namespaces.html#nroot"><span class="id" title="definition">nroot</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.namespaces.html#e79e436c08f66d063bd17fb4bcd1cac6"><span class="id" title="notation">.@</span></a> "seal_cap".<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;`sealed_cap`&nbsp;is&nbsp;the&nbsp;sealed&nbsp;predicate&nbsp;of&nbsp;a&nbsp;sealed&nbsp;buffer&nbsp;containing&nbsp;a&nbsp;capability.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;capability&nbsp;must&nbsp;be&nbsp;`interp`.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="sealed_cap" class="idref" href="#sealed_cap"><span class="id" title="definition">sealed_cap</span></a> : <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.base_logic.lib.iprop.html#iProp_solution.iProp"><span class="id" title="abbreviation">iProp</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#330adf52b7a0d14f442985c75a6ae5ae"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="w:29" class="idref" href="#w:29"><span class="id" title="binder">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.base_logic.lib.na_invariants.html#na_inv"><span class="id" title="definition">na_inv</span></a> <a class="idref" href="cap_machine.logrel.html#logrel_nais"><span class="id" title="method">logrel_nais</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#seal_capN"><span class="id" title="definition">seal_capN</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6a949150dff4dc18cd2632b730bdfc23"><span class="id" title="notation">∃</span></a> <a id="a_cap:30" class="idref" href="#a_cap:30"><span class="id" title="binder">a_cap</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6a949150dff4dc18cd2632b730bdfc23"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a><a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:29"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.16.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.machine_base.html#RW"><span class="id" title="constructor">RW</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#a_cap:30"><span class="id" title="variable">a_cap</span></a> (<a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#a_cap:30"><span class="id" title="variable">a_cap</span></a> <a class="idref" href="cap_machine.addr_reg.html#58e53c8acf01fb8822eb5bae448055ec"><span class="id" title="notation">^+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#a_cap:30"><span class="id" title="variable">a_cap</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">(</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6a949150dff4dc18cd2632b730bdfc23"><span class="id" title="notation">∃</span></a> <a id="w:31" class="idref" href="#w:31"><span class="id" title="binder">w</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#6a949150dff4dc18cd2632b730bdfc23"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#a_cap:30"><span class="id" title="variable">a_cap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:31"><span class="id" title="variable">w</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌜</span></a><a class="idref" href="cap_machine.machine_base.html#is_cap"><span class="id" title="definition">is_cap</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:31"><span class="id" title="variable">w</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#08ba0c98aaa0db435a5f99ebae3ae8e7"><span class="id" title="notation">⌝</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">∗</span></a> <a class="idref" href="cap_machine.logrel.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:31"><span class="id" title="variable">w</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#17a7b93bfefac02a752836d54e5bc9da"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">I</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note:&nbsp;`sealed_cap`&nbsp;is&nbsp;not&nbsp;`Timeless`&nbsp;because&nbsp;of&nbsp;the&nbsp;use&nbsp;of&nbsp;the&nbsp;non-atomic&nbsp;invariant.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&gt;&nbsp;In&nbsp;our&nbsp;case,&nbsp;any&nbsp;later&nbsp;can&nbsp;be&nbsp;stripped&nbsp;at&nbsp;time.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;One&nbsp;could&nbsp;use&nbsp;`a_cap&nbsp;↦ₐ{DFracDiscarded}&nbsp;w`&nbsp;to&nbsp;avoid&nbsp;using&nbsp;the&nbsp;non-atomic&nbsp;invariant.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&gt;&nbsp;However,&nbsp;this&nbsp;denies&nbsp;the&nbsp;right&nbsp;to&nbsp;write&nbsp;to&nbsp;`a_cap`&nbsp;making&nbsp;it&nbsp;read-only.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Required&nbsp;by&nbsp;`seal_pred`:&nbsp;`sealed_cap`&nbsp;is&nbsp;`Persistent`.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="sealed_cap_persistent" class="idref" href="#sealed_cap_persistent"><span class="id" title="instance">sealed_cap_persistent</span></a> <a id="w:32" class="idref" href="#w:32"><span class="id" title="binder">w</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_connectives.html#Persistent"><span class="id" title="class">Persistent</span></a> (<a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#sealed_cap"><span class="id" title="definition">sealed_cap</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:32"><span class="id" title="variable">w</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Capability-specific&nbsp;redefinitions&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="seal_pred_cap" class="idref" href="#seal_pred_cap"><span class="id" title="definition">seal_pred_cap</span></a> <a id="82ec14923c145b09282c7e32d3a824a0" class="idref" href="#82ec14923c145b09282c7e32d3a824a0"><span class="id" title="binder">τ</span></a> := <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#seal_pred"><span class="id" title="definition">seal_pred</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#82ec14923c145b09282c7e32d3a824a0"><span class="id" title="variable">τ</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#sealed_cap"><span class="id" title="definition">sealed_cap</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="valid_sealed_cap" class="idref" href="#valid_sealed_cap"><span class="id" title="definition">valid_sealed_cap</span></a> <a id="w:34" class="idref" href="#w:34"><span class="id" title="binder">w</span></a> <a id="8811648c61adae5d3bde45effec37c78" class="idref" href="#8811648c61adae5d3bde45effec37c78"><span class="id" title="binder">τ</span></a> := <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#valid_sealed"><span class="id" title="definition">valid_sealed</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#w:34"><span class="id" title="variable">w</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#8811648c61adae5d3bde45effec37c78"><span class="id" title="variable">τ</span></a> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#sealed_cap"><span class="id" title="definition">sealed_cap</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.examples.mutable_typed_shared_data.invariants.html#invariants_cap"><span class="id" title="section">invariants_cap</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
