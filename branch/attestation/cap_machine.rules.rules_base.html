<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">cap_machine.rules.rules_base</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">proofmode</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">invariants</span> <span class="id" title="library">gen_heap</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">weakestpre</span> <span class="id" title="library">ectx_lifting</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">frac</span> <span class="id" title="library">auth</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.logical_mapsto.html#"><span class="id" title="library">logical_mapsto</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.cap_lang.html#"><span class="id" title="library">cap_lang</span></a> <a class="idref" href="cap_machine.iris_extra.html#"><span class="id" title="library">iris_extra</span></a> <a class="idref" href="cap_machine.stdpp_extra.html#"><span class="id" title="library">stdpp_extra</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;---------------------------&nbsp;LTAC&nbsp;DEFINITIONS&nbsp;-----------------------------------&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_cons_hook</span> ::= <span class="id" title="var">destruct_cons_hook2</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv_head_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">progress</span> <span class="id" title="var">simplify_map_eq</span>/= <span class="comment">(*&nbsp;simplify&nbsp;memory&nbsp;stuff&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#of_to_val"><span class="id" title="axiom">of_to_val</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.cap_lang.html#of_val"><span class="id" title="definition">of_val</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_var</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">first</span>[<span class="id" title="tactic">discriminate</span> <span class="id" title="var">H</span>|<span class="id" title="tactic">injection</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">cap_lang.prim_step</span></a> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">is_var</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">fail</span> 1); <span class="comment">(*&nbsp;inversion&nbsp;yields&nbsp;many&nbsp;goals&nbsp;if&nbsp;<span class="inlinecode"><span class="id" title="var">e</span></span>&nbsp;is&nbsp;a&nbsp;variable&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;can&nbsp;thus&nbsp;better&nbsp;be&nbsp;avoided.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> φ := <span class="id" title="tactic">fresh</span> "φ" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [| φ]; <span class="id" title="tactic">subst</span> φ; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_rules" class="idref" href="#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:1" class="idref" href="#H:1"><span class="id" title="binder">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H0:3" class="idref" href="#H0:3"><span class="id" title="binder">memG</span></a> <a id="ebf069dbc779b42a15c441a6d39d5f83" class="idref" href="#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="binder"><span id="H0:3" class="id">Σ</span></span></a>, <a id="H1:4" class="idref" href="#H1:4"><span class="id" title="binder">regG</span></a> <a id="H1:4" class="idref" href="#H1:4"><span class="id" title="binder">Σ</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">c</span> : <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">la</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lw</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lregs</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">mem</span> : <a class="idref" href="cap_machine.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lmem</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Conditionally&nbsp;unify&nbsp;on&nbsp;the&nbsp;read&nbsp;register&nbsp;value&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="read_reg_inr" class="idref" href="#read_reg_inr"><span class="id" title="definition">read_reg_inr</span></a> (<a id="lregs:5" class="idref" href="#lregs:5"><span class="id" title="binder">lregs</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="r:6" class="idref" href="#r:6"><span class="id" title="binder">r</span></a> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) <a id="p:7" class="idref" href="#p:7"><span class="id" title="binder">p</span></a> <a id="b:8" class="idref" href="#b:8"><span class="id" title="binder">b</span></a> <a id="e:9" class="idref" href="#e:9"><span class="id" title="binder">e</span></a> <a id="a:10" class="idref" href="#a:10"><span class="id" title="binder">a</span></a> <a id="v:11" class="idref" href="#v:11"><span class="id" title="binder">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:5"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:6"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">b'</span> <span class="id" title="var">e'</span> <span class="id" title="var">a'</span> <span class="id" title="var">v'</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">b'</span> <span class="id" title="var">e'</span> <span class="id" title="var">a'</span> <span class="id" title="var">v'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:7"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:8"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:9"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:10"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:11"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="notation">False</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;registers&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_dupl_false" class="idref" href="#regname_dupl_false"><span class="id" title="lemma">regname_dupl_false</span></a> <a id="r:12" class="idref" href="#r:12"><span class="id" title="binder">r</span></a> <a id="lw1:13" class="idref" href="#lw1:13"><span class="id" title="binder">lw1</span></a> <a id="lw2:14" class="idref" href="#lw2:14"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:12"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:13"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:12"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:14"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">mapsto_valid_2</span> <span class="id" title="notation">with</span> "Hr1 Hr2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">dfrac_full_exclusive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_neq" class="idref" href="#regname_neq"><span class="id" title="lemma">regname_neq</span></a> <a id="r1:15" class="idref" href="#r1:15"><span class="id" title="binder">r1</span></a> <a id="r2:16" class="idref" href="#r2:16"><span class="id" title="binder">r2</span></a> <a id="lw1:17" class="idref" href="#lw1:17"><span class="id" title="binder">lw1</span></a> <a id="lw2:18" class="idref" href="#lw2:18"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:15"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:17"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:16"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:18"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:15"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:16"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2" (?). <span class="id" title="tactic">subst</span> <span class="id" title="var">r1</span>. <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_dupl_false"><span class="id" title="axiom">regname_dupl_false</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_1" class="idref" href="#map_of_regs_1"><span class="id" title="lemma">map_of_regs_1</span></a> (<a id="r1:19" class="idref" href="#r1:19"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:20" class="idref" href="#lw1:20"><span class="id" title="binder">lw1</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:19"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:20"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:21" class="idref" href="#k:21"><span class="id" title="binder"><span id="k:22" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:23" class="idref" href="#y:23"><span class="id" title="binder"><span id="y:24" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:19"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:20"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:21"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:23"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_1" class="idref" href="#regs_of_map_1"><span class="id" title="lemma">regs_of_map_1</span></a> (<a id="r1:25" class="idref" href="#r1:25"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:26" class="idref" href="#lw1:26"><span class="id" title="binder">lw1</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:27" class="idref" href="#k:27"><span class="id" title="binder"><span id="k:28" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:29" class="idref" href="#y:29"><span class="id" title="binder"><span id="y:30" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:25"><span class="id" title="variable">r1</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:26"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]}</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:27"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:29"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:25"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:26"><span class="id" title="variable">lw1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_singleton</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_2" class="idref" href="#map_of_regs_2"><span class="id" title="lemma">map_of_regs_2</span></a> (<a id="r1:31" class="idref" href="#r1:31"><span class="id" title="binder">r1</span></a> <a id="r2:32" class="idref" href="#r2:32"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:33" class="idref" href="#lw1:33"><span class="id" title="binder">lw1</span></a> <a id="lw2:34" class="idref" href="#lw2:34"><span class="id" title="binder">lw2</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:31"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:33"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:32"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:34"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:35" class="idref" href="#k:35"><span class="id" title="binder"><span id="k:36" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:37" class="idref" href="#y:37"><span class="id" title="binder"><span id="y:38" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:31"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:33"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:35"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:37"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:31"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:32"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2". <span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_2" class="idref" href="#regs_of_map_2"><span class="id" title="lemma">regs_of_map_2</span></a> (<a id="r1:39" class="idref" href="#r1:39"><span class="id" title="binder">r1</span></a> <a id="r2:40" class="idref" href="#r2:40"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:41" class="idref" href="#lw1:41"><span class="id" title="binder">lw1</span></a> <a id="lw2:42" class="idref" href="#lw2:42"><span class="id" title="binder">lw2</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:39"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:40"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:43" class="idref" href="#k:43"><span class="id" title="binder"><span id="k:44" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:45" class="idref" href="#y:45"><span class="id" title="binder"><span id="y:46" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:39"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:41"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:43"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:45"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:39"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:41"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:40"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:42"><span class="id" title="variable">lw2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_3" class="idref" href="#map_of_regs_3"><span class="id" title="lemma">map_of_regs_3</span></a> (<a id="r1:47" class="idref" href="#r1:47"><span class="id" title="binder">r1</span></a> <a id="r2:48" class="idref" href="#r2:48"><span class="id" title="binder">r2</span></a> <a id="r3:49" class="idref" href="#r3:49"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:50" class="idref" href="#w1:50"><span class="id" title="binder">w1</span></a> <a id="w2:51" class="idref" href="#w2:51"><span class="id" title="binder">w2</span></a> <a id="w3:52" class="idref" href="#w3:52"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:50"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:48"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:51"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:49"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:52"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:53" class="idref" href="#k:53"><span class="id" title="binder"><span id="k:54" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:55" class="idref" href="#y:55"><span class="id" title="binder"><span id="y:56" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:50"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:53"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:55"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:48"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:47"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:49"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:48"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:49"><span class="id" title="variable">r3</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_3" class="idref" href="#regs_of_map_3"><span class="id" title="lemma">regs_of_map_3</span></a> (<a id="r1:57" class="idref" href="#r1:57"><span class="id" title="binder">r1</span></a> <a id="r2:58" class="idref" href="#r2:58"><span class="id" title="binder">r2</span></a> <a id="r3:59" class="idref" href="#r3:59"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:60" class="idref" href="#w1:60"><span class="id" title="binder">w1</span></a> <a id="w2:61" class="idref" href="#w2:61"><span class="id" title="binder">w2</span></a> <a id="w3:62" class="idref" href="#w3:62"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:58"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:59"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:58"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:59"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:63" class="idref" href="#k:63"><span class="id" title="binder"><span id="k:64" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:65" class="idref" href="#y:65"><span class="id" title="binder"><span id="y:66" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:60"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:63"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:65"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:57"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:60"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:58"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:61"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:59"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:62"><span class="id" title="variable">w3</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? ? ?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_4" class="idref" href="#map_of_regs_4"><span class="id" title="lemma">map_of_regs_4</span></a> (<a id="r1:67" class="idref" href="#r1:67"><span class="id" title="binder">r1</span></a> <a id="r2:68" class="idref" href="#r2:68"><span class="id" title="binder">r2</span></a> <a id="r3:69" class="idref" href="#r3:69"><span class="id" title="binder">r3</span></a> <a id="r4:70" class="idref" href="#r4:70"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:71" class="idref" href="#w1:71"><span class="id" title="binder">w1</span></a> <a id="w2:72" class="idref" href="#w2:72"><span class="id" title="binder">w2</span></a> <a id="w3:73" class="idref" href="#w3:73"><span class="id" title="binder">w3</span></a> <a id="w4:74" class="idref" href="#w4:74"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:71"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:72"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:73"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w4:74"><span class="id" title="variable">w4</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:75" class="idref" href="#k:75"><span class="id" title="binder"><span id="k:76" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:77" class="idref" href="#y:77"><span class="id" title="binder"><span id="y:78" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:71"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:75"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:77"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:67"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:68"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:69"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:70"><span class="id" title="variable">r4</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3 H4".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H3 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_4" class="idref" href="#regs_of_map_4"><span class="id" title="lemma">regs_of_map_4</span></a> (<a id="r1:79" class="idref" href="#r1:79"><span class="id" title="binder">r1</span></a> <a id="r2:80" class="idref" href="#r2:80"><span class="id" title="binder">r2</span></a> <a id="r3:81" class="idref" href="#r3:81"><span class="id" title="binder">r3</span></a> <a id="r4:82" class="idref" href="#r4:82"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:83" class="idref" href="#w1:83"><span class="id" title="binder">w1</span></a> <a id="w2:84" class="idref" href="#w2:84"><span class="id" title="binder">w2</span></a> <a id="w3:85" class="idref" href="#w3:85"><span class="id" title="binder">w3</span></a> <a id="w4:86" class="idref" href="#w4:86"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:87" class="idref" href="#k:87"><span class="id" title="binder"><span id="k:88" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:89" class="idref" href="#y:89"><span class="id" title="binder"><span id="y:90" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:83"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:87"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:89"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r1:79"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:83"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:80"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:84"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r3:81"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w3:85"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#r4:82"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w4:86"><span class="id" title="variable">w4</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;memory&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="addr_dupl_false" class="idref" href="#addr_dupl_false"><span class="id" title="lemma">addr_dupl_false</span></a> <a id="la:91" class="idref" href="#la:91"><span class="id" title="binder">la</span></a> <a id="lw1:92" class="idref" href="#lw1:92"><span class="id" title="binder">lw1</span></a> <a id="lw2:93" class="idref" href="#lw2:93"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la:91"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:92"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:91"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:93"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ha1 Ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">mapsto_valid_2</span> <span class="id" title="notation">with</span> "Ha1 Ha2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">dfrac_full_exclusive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;semantic&nbsp;heap&nbsp;+&nbsp;a&nbsp;map&nbsp;of&nbsp;pointsto&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM_general" class="idref" href="#gen_heap_valid_inSepM_general"><span class="id" title="lemma">gen_heap_valid_inSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:94" class="idref" href="#L:94"><span class="id" title="binder">L</span></a> <a id="V:95" class="idref" href="#V:95"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:96" class="idref" href="#EqDecision0:96"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a>) (<a id="H:97" class="idref" href="#H:97"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="d28bbe011225204c88b57a270b5a3987" class="idref" href="#d28bbe011225204c88b57a270b5a3987"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:99" class="idref" href="#gen_heapG0:99"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d28bbe011225204c88b57a270b5a3987"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="616bc304c6b7e4c8af72eed31cf6fe79" class="idref" href="#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="binder">d</span></a><a id="616bc304c6b7e4c8af72eed31cf6fe79" class="idref" href="#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a>)) (<a id="0068bba064954ff1d2256a45ce198696" class="idref" href="#0068bba064954ff1d2256a45ce198696"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:102" class="idref" href="#l:102"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:94"><span class="id" title="variable">L</span></a>) (<a id="dq:103" class="idref" href="#dq:103"><span class="id" title="binder">dq</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="v:104" class="idref" href="#v:104"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:95"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:102"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:103"><span class="id" title="variable">dq</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:104"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#0068bba064954ff1d2256a45ce198696"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:105" class="idref" href="#k:105"><span class="id" title="binder"><span id="k:106" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:107" class="idref" href="#dqw:107"><span class="id" title="binder"><span id="dqw:108" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#616bc304c6b7e4c8af72eed31cf6fe79"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:105"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:107"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:107"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#0068bba064954ff1d2256a45ce198696"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:102"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:104"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>σ <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM" class="idref" href="#gen_heap_valid_inSepM"><span class="id" title="lemma">gen_heap_valid_inSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:109" class="idref" href="#L:109"><span class="id" title="binder">L</span></a> <a id="V:110" class="idref" href="#V:110"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:111" class="idref" href="#EqDecision0:111"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a>) (<a id="H:112" class="idref" href="#H:112"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="67028e5db0d7f321f964117e73116fa2" class="idref" href="#67028e5db0d7f321f964117e73116fa2"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:114" class="idref" href="#gen_heapG0:114"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:110"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#67028e5db0d7f321f964117e73116fa2"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="30194486bb6c4e804d25f7da04abfdab" class="idref" href="#30194486bb6c4e804d25f7da04abfdab"><span class="id" title="binder">σ</span></a> <a id="387984c2561d9e0751d72243983585d8" class="idref" href="#387984c2561d9e0751d72243983585d8"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:110"><span class="id" title="variable">V</span></a>) (<a id="l:117" class="idref" href="#l:117"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:109"><span class="id" title="variable">L</span></a>) (<a id="q:118" class="idref" href="#q:118"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span>) (<a id="v:119" class="idref" href="#v:119"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:110"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#387984c2561d9e0751d72243983585d8"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:117"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:119"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#30194486bb6c4e804d25f7da04abfdab"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:120" class="idref" href="#k:120"><span class="id" title="binder"><span id="k:121" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:122" class="idref" href="#y:122"><span class="id" title="binder"><span id="y:123" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#387984c2561d9e0751d72243983585d8"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:120"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:118"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:122"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#30194486bb6c4e804d25f7da04abfdab"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:117"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:119"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM'" class="idref" href="#gen_heap_valid_inSepM'"><span class="id" title="lemma">gen_heap_valid_inSepM'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:124" class="idref" href="#L:124"><span class="id" title="binder">L</span></a> <a id="V:125" class="idref" href="#V:125"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:126" class="idref" href="#EqDecision0:126"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a>) (<a id="H:127" class="idref" href="#H:127"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="4cf90600e8413682f73ea298d1219fe2" class="idref" href="#4cf90600e8413682f73ea298d1219fe2"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:129" class="idref" href="#gen_heapG0:129"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:125"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4cf90600e8413682f73ea298d1219fe2"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="edfcf2c1d0f2984bf130d5d32af280c0" class="idref" href="#edfcf2c1d0f2984bf130d5d32af280c0"><span class="id" title="binder">σ</span></a> <a id="373bdbf96b46bf3aa373e85ba19b5d69" class="idref" href="#373bdbf96b46bf3aa373e85ba19b5d69"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:125"><span class="id" title="variable">V</span></a>) (<a id="q:132" class="idref" href="#q:132"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#edfcf2c1d0f2984bf130d5d32af280c0"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:133" class="idref" href="#k:133"><span class="id" title="binder"><span id="k:134" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:135" class="idref" href="#y:135"><span class="id" title="binder"><span id="y:136" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#373bdbf96b46bf3aa373e85ba19b5d69"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:133"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:132"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:135"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:137" class="idref" href="#l:137"><span class="id" title="binder">l</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#L:124"><span class="id" title="variable">L</span></a>) (<a id="v:138" class="idref" href="#v:138"><span class="id" title="binder">v</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#V:125"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#373bdbf96b46bf3aa373e85ba19b5d69"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:137"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:138"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#edfcf2c1d0f2984bf130d5d32af280c0"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:137"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:138"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM'_general" class="idref" href="#gen_heap_valid_inSepM'_general"><span class="id" title="lemma">gen_heap_valid_inSepM'_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:139" class="idref" href="#L:139"><span class="id" title="binder">L</span></a> <a id="V:140" class="idref" href="#V:140"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:141" class="idref" href="#EqDecision0:141"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a>) (<a id="H:142" class="idref" href="#H:142"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="92fc1184c72183659a7f8012cd13be07" class="idref" href="#92fc1184c72183659a7f8012cd13be07"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:144" class="idref" href="#gen_heapG0:144"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#92fc1184c72183659a7f8012cd13be07"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="570cad8308dcbf910a2525b22eba0976" class="idref" href="#570cad8308dcbf910a2525b22eba0976"><span class="id" title="binder">d</span></a><a id="570cad8308dcbf910a2525b22eba0976" class="idref" href="#570cad8308dcbf910a2525b22eba0976"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a>)) (<a id="1cd9065e8a4e883005d819069f13ddb7" class="idref" href="#1cd9065e8a4e883005d819069f13ddb7"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#1cd9065e8a4e883005d819069f13ddb7"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:147" class="idref" href="#k:147"><span class="id" title="binder"><span id="k:148" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:149" class="idref" href="#dqw:149"><span class="id" title="binder"><span id="dqw:150" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:147"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:149"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:149"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:151" class="idref" href="#l:151"><span class="id" title="binder">l</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#L:139"><span class="id" title="variable">L</span></a>) (<a id="d:152" class="idref" href="#d:152"><span class="id" title="binder">d</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="v:153" class="idref" href="#v:153"><span class="id" title="binder">v</span></a>: <a class="idref" href="cap_machine.rules.rules_base.html#V:140"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#570cad8308dcbf910a2525b22eba0976"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:151"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#d:152"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:153"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1cd9065e8a4e883005d819069f13ddb7"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:151"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:153"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">d</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>σ <span class="id" title="var">l</span>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]". <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inclSepM_general" class="idref" href="#gen_heap_valid_inclSepM_general"><span class="id" title="lemma">gen_heap_valid_inclSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:154" class="idref" href="#L:154"><span class="id" title="binder">L</span></a> <a id="V:155" class="idref" href="#V:155"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:156" class="idref" href="#EqDecision0:156"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a>) (<a id="H:157" class="idref" href="#H:157"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="4083cb2bcc85852dfb10cc3813a0b868" class="idref" href="#4083cb2bcc85852dfb10cc3813a0b868"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:159" class="idref" href="#gen_heapG0:159"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:155"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4083cb2bcc85852dfb10cc3813a0b868"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="2fc7cc3ed54450ffecb827be278e72cb" class="idref" href="#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="binder">d</span></a><a id="2fc7cc3ed54450ffecb827be278e72cb" class="idref" href="#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:155"><span class="id" title="variable">V</span></a>)) (<a id="76873164e1875c9cabe83440d7af70c6" class="idref" href="#76873164e1875c9cabe83440d7af70c6"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:154"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:155"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#76873164e1875c9cabe83440d7af70c6"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:162" class="idref" href="#k:162"><span class="id" title="binder"><span id="k:163" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:164" class="idref" href="#dqw:164"><span class="id" title="binder"><span id="dqw:165" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:162"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:164"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:164"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><span class="id" title="notation">(</span><span class="id" title="definition">fmap</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.rules.rules_base.html#2fc7cc3ed54450ffecb827be278e72cb"><span class="id" title="variable">σ</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#76873164e1875c9cabe83440d7af70c6"><span class="id" title="variable">σ</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM'_general"><span class="id" title="axiom">gen_heap_valid_inSepM'_general</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H". <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">d</span>σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="var">HH'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hincl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HH'</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hincl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HH'</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;+&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inclSepM" class="idref" href="#gen_heap_valid_inclSepM"><span class="id" title="lemma">gen_heap_valid_inclSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:166" class="idref" href="#L:166"><span class="id" title="binder">L</span></a> <a id="V:167" class="idref" href="#V:167"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:168" class="idref" href="#EqDecision0:168"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a>) (<a id="H:169" class="idref" href="#H:169"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="de0bdd995243600a0219716b7c05224c" class="idref" href="#de0bdd995243600a0219716b7c05224c"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:171" class="idref" href="#gen_heapG0:171"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:167"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#de0bdd995243600a0219716b7c05224c"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ac8cc0af11d0313b0e423490272f7d38" class="idref" href="#ac8cc0af11d0313b0e423490272f7d38"><span class="id" title="binder">σ</span></a> <a id="96e39509c5c968a1f0fa15accc0fa1e6" class="idref" href="#96e39509c5c968a1f0fa15accc0fa1e6"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:166"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:167"><span class="id" title="variable">V</span></a>) (<a id="q:174" class="idref" href="#q:174"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#ac8cc0af11d0313b0e423490272f7d38"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:175" class="idref" href="#k:175"><span class="id" title="binder"><span id="k:176" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:177" class="idref" href="#y:177"><span class="id" title="binder"><span id="y:178" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#96e39509c5c968a1f0fa15accc0fa1e6"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:175"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:174"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:177"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#96e39509c5c968a1f0fa15accc0fa1e6"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#ac8cc0af11d0313b0e423490272f7d38"><span class="id" title="variable">σ</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM'"><span class="id" title="axiom">gen_heap_valid_inSepM'</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (σ' <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span>; <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_allSepM" class="idref" href="#gen_heap_valid_allSepM"><span class="id" title="lemma">gen_heap_valid_allSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:179" class="idref" href="#L:179"><span class="id" title="binder">L</span></a> <a id="V:180" class="idref" href="#V:180"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:181" class="idref" href="#EqDecision0:181"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a>) (<a id="H:182" class="idref" href="#H:182"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="EV:183" class="idref" href="#EV:183"><span class="id" title="binder">EV</span></a>: <span class="id" title="class">Equiv</span> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a>) (<a id="REV:184" class="idref" href="#REV:184"><span class="id" title="binder">REV</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#Reflexive"><span class="id" title="class">Reflexive</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#EV:183"><span class="id" title="variable">EV</span></a>) (<a id="LEV:185" class="idref" href="#LEV:185"><span class="id" title="binder">LEV</span></a>: @<span class="id" title="class">LeibnizEquiv</span> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#EV:183"><span class="id" title="variable">EV</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="f95f1e88d28d837cd72b8674833b46fb" class="idref" href="#f95f1e88d28d837cd72b8674833b46fb"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:187" class="idref" href="#gen_heapG0:187"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f95f1e88d28d837cd72b8674833b46fb"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="b42cfa1eec7d2b00a4392b11732c8740" class="idref" href="#b42cfa1eec7d2b00a4392b11732c8740"><span class="id" title="binder">σ</span></a> <a id="3ffff23e1e93db122c1bd2ae63df0d61" class="idref" href="#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:180"><span class="id" title="variable">V</span></a>) (<a id="q:190" class="idref" href="#q:190"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:191" class="idref" href="#l:191"><span class="id" title="binder">l</span></a>:<a class="idref" href="cap_machine.rules.rules_base.html#L:179"><span class="id" title="variable">L</span></a><span class="id" title="notation">),</span> <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:191"><span class="id" title="variable">l</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#b42cfa1eec7d2b00a4392b11732c8740"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:192" class="idref" href="#k:192"><span class="id" title="binder"><span id="k:193" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:194" class="idref" href="#y:194"><span class="id" title="binder"><span id="y:195" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:192"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.rules.rules_base.html#q:190"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#y:194"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#b42cfa1eec7d2b00a4392b11732c8740"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3ffff23e1e93db122c1bd2ae63df0d61"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * ? ? * <span class="id" title="var">H</span>σ'. <span class="id" title="var">iIntros</span> "A B".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<span class="id" title="notation">⌜</span> <span class="id" title="notation">forall</span> <a id="l:196" class="idref" href="#l:196"><span class="id" title="binder"><span id="l:197" class="id">l</span></span></a><span class="id" title="notation">,</span> σ <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:196"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> σ' <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:196"><span class="id" title="variable">l</span></a> <span class="id" title="notation">⌝</span>)%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[A B]" <span class="id" title="keyword">as</span> %<span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> (<span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span>σ' <span class="id" title="var">l</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="definition">is_Some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ' <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> <span class="id" title="var">H</span>σ'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inSepM"><span class="id" title="axiom">gen_heap_valid_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> σ σ') <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">H</span>σ' <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">map_leibniz</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">leibniz_equiv_iff</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">equiv</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#Reflexive"><span class="id" title="class">Reflexive</span></a>. <span class="id" title="tactic">intros</span> [ <span class="id" title="var">x</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="instance">option_equiv</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">REV</span>. } <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_update_inSepM" class="idref" href="#gen_heap_update_inSepM"><span class="id" title="lemma">gen_heap_update_inSepM</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="L:198" class="idref" href="#L:198"><span class="id" title="binder">L</span></a> <a id="V:199" class="idref" href="#V:199"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>} {<a id="EqDecision0:200" class="idref" href="#EqDecision0:200"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H:201" class="idref" href="#H:201"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a>} {<a id="eb108301922c3577e58b724777773441" class="idref" href="#eb108301922c3577e58b724777773441"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="gen_heapG0:203" class="idref" href="#gen_heapG0:203"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#eb108301922c3577e58b724777773441"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="019a176b853a03971213611fa9d8fc1e" class="idref" href="#019a176b853a03971213611fa9d8fc1e"><span class="id" title="binder">σ</span></a> <a id="109fa0b16cc8515a5eaa4883ae7aa4a8" class="idref" href="#109fa0b16cc8515a5eaa4883ae7aa4a8"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a>) (<a id="l:206" class="idref" href="#l:206"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#L:198"><span class="id" title="variable">L</span></a>) (<a id="v:207" class="idref" href="#v:207"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#V:199"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#109fa0b16cc8515a5eaa4883ae7aa4a8"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#l:206"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#019a176b853a03971213611fa9d8fc1e"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:208" class="idref" href="#k:208"><span class="id" title="binder"><span id="k:209" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:210" class="idref" href="#y:210"><span class="id" title="binder"><span id="y:211" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#109fa0b16cc8515a5eaa4883ae7aa4a8"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:208"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:210"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:206"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#v:207"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:212" class="idref" href="#k:212"><span class="id" title="binder"><span id="k:213" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:214" class="idref" href="#y:214"><span class="id" title="binder"><span id="y:215" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#l:206"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#v:207"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span><span class="id" title="notation">),</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:212"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:214"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]". <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><span class="id" title="var">v</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span>) <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_delete</span>. <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_lmem_version_update" class="idref" href="#gen_heap_lmem_version_update"><span class="id" title="lemma">gen_heap_lmem_version_update</span></a> `{<a id="HmemG:216" class="idref" href="#HmemG:216"><span class="id" title="binder">HmemG</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#memG"><span class="id" title="class">memG</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>, <a id="HregG:217" class="idref" href="#HregG:217"><span class="id" title="binder">HregG</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#regG"><span class="id" title="class">regG</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:218" class="idref" href="#lmem:218"><span class="id" title="binder">lmem</span></a> <a id="lm:219" class="idref" href="#lm:219"><span class="id" title="binder">lm</span></a> <a id="lmem':220" class="idref" href="#lmem':220"><span class="id" title="binder">lmem'</span></a> <a id="lm':221" class="idref" href="#lm':221"><span class="id" title="binder">lm'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="vmap:222" class="idref" href="#vmap:222"><span class="id" title="binder">vmap</span></a> <a id="vmap':223" class="idref" href="#vmap':223"><span class="id" title="binder">vmap'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#VMap"><span class="id" title="definition">VMap</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la:224" class="idref" href="#la:224"><span class="id" title="binder">la</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>) ( <a id="v:225" class="idref" href="#v:225"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="inductive">NoDup</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:224"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:218"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:219"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#update_cur_version_region"><span class="id" title="definition">update_cur_version_region</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:218"><span class="id" title="variable">lmem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:219"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:222"><span class="id" title="variable">vmap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:224"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#lmem':220"><span class="id" title="variable">lmem'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm':221"><span class="id" title="variable">lm'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap':223"><span class="id" title="variable">vmap'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:226" class="idref" href="#a:226"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:219"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:226"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:225"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#la:224"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:227" class="idref" href="#a:227"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:227"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules.rules_base.html#v:225"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#vmap:222"><span class="id" title="variable">vmap</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#la:224"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:219"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:228" class="idref" href="#k:228"><span class="id" title="binder"><span id="k:229" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:230" class="idref" href="#y:230"><span class="id" title="binder"><span id="y:231" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:218"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:228"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:230"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm':221"><span class="id" title="variable">lm'</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:232" class="idref" href="#k:232"><span class="id" title="binder"><span id="k:233" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:234" class="idref" href="#y:234"><span class="id" title="binder"><span id="y:235" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':220"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:232"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.rules.rules_base.html#y:234"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span> <span class="id" title="var">la</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">la</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">la</span> <span class="id" title="var">IH</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iIntros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span> <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">HNoDup_la</span> <span class="id" title="var">Hlmem_incl</span> <span class="id" title="var">Hupd</span> <span class="id" title="var">Hmaxv_lm</span> <span class="id" title="var">Hcur_lm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Hgen Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;no&nbsp;addresses&nbsp;updated&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupd</span> ; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">destruct_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lmem0</span> <span class="id" title="notation">⊆</span> <span class="id" title="var">lm0</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hlmem0_incl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#update_cur_version_region_preserves_lmem_incl"><span class="id" title="axiom">update_cur_version_region_preserves_lmem_incl</span></a>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.logical_mapsto.html#update_cur_version_addr"><span class="id" title="definition">update_cur_version_addr</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupd0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">vmap0</span> <span class="id" title="notation">!!</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">va</span> |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hvmap0_a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">last</span> ( <span class="id" title="var">simplify_eq</span> ; <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">IH</span> <span class="id" title="notation">with</span> "Hgen"<span class="id" title="notation">)</span>; <span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lm_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="cap_machine.logical_mapsto.html#update_cur_version_region_notin_preserves_cur"><span class="id" title="axiom">update_cur_version_region_notin_preserves_cur</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lm_a</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvmap0_a</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -/(<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">va</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">vmap0</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hvmap0_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_addr_same"><span class="id" title="axiom">is_cur_addr_same</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lm_a</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">simplify_map_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lm0</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">lw</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hlm0_a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlm0_a</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupd0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">simplify_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">last</span> (<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">IH</span> <span class="id" title="notation">with</span> "Hgen"<span class="id" title="notation">)</span>; <span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="var">IH</span> <span class="id" title="notation">with</span> "Hgen Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "&gt;[Hgen Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="cap_machine.logical_mapsto.html#update_cur_version_region_notin_preserves_lm"><span class="id" title="axiom">update_cur_version_region_notin_preserves_lm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hmaxv_lm_a</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> (<span class="id" title="notation">((</span><span class="id" title="lemma">gen_heap_alloc</span> <span class="id" title="var">lm0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">lw</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hgen"<span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> "(Hgen &amp; Ha &amp; _)"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span> ; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "[Hmem Ha]"<span class="id" title="notation">)</span>; <span class="id" title="var">last</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken_None</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prim_step_no_kappa" class="idref" href="#prim_step_no_kappa"><span class="id" title="lemma">prim_step_no_kappa</span></a> {<a id="e1:236" class="idref" href="#e1:236"><span class="id" title="binder">e1</span></a> <a id="1d226a438e22707dc43c73b8e3679b76" class="idref" href="#1d226a438e22707dc43c73b8e3679b76"><span class="id" title="binder">σ1</span></a> <a id="056b1aeae5790f5e0ffae3c2c3b0ab85" class="idref" href="#056b1aeae5790f5e0ffae3c2c3b0ab85"><span class="id" title="binder">κ</span></a> <a id="e2:239" class="idref" href="#e2:239"><span class="id" title="binder">e2</span></a> <a id="1b602eb7502925c5d82b6e551fa68ad5" class="idref" href="#1b602eb7502925c5d82b6e551fa68ad5"><span class="id" title="binder">σ2</span></a> <a id="efs:241" class="idref" href="#efs:241"><span class="id" title="binder">efs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:236"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1d226a438e22707dc43c73b8e3679b76"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#056b1aeae5790f5e0ffae3c2c3b0ab85"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:239"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1b602eb7502925c5d82b6e551fa68ad5"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:241"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#056b1aeae5790f5e0ffae3c2c3b0ab85"><span class="id" title="variable">κ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prim_step_no_efs" class="idref" href="#prim_step_no_efs"><span class="id" title="lemma">prim_step_no_efs</span></a> {<a id="e1:242" class="idref" href="#e1:242"><span class="id" title="binder">e1</span></a> <a id="5f2d43f254a148f8b491a5e3d2c65183" class="idref" href="#5f2d43f254a148f8b491a5e3d2c65183"><span class="id" title="binder">σ1</span></a> <a id="9326916d849804237b426616d9f97753" class="idref" href="#9326916d849804237b426616d9f97753"><span class="id" title="binder">κ</span></a> <a id="e2:245" class="idref" href="#e2:245"><span class="id" title="binder">e2</span></a> <a id="54f850c6b88d82ed52c2937166dfda3b" class="idref" href="#54f850c6b88d82ed52c2937166dfda3b"><span class="id" title="binder">σ2</span></a> <a id="efs:247" class="idref" href="#efs:247"><span class="id" title="binder">efs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:242"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5f2d43f254a148f8b491a5e3d2c65183"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9326916d849804237b426616d9f97753"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:245"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#54f850c6b88d82ed52c2937166dfda3b"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:247"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:247"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="state_interp_transient" class="idref" href="#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> (<a id="86441114472cf5330bda49c0ac1b891e" class="idref" href="#86441114472cf5330bda49c0ac1b891e"><span class="id" title="binder">φ</span></a> <a id="dca37e00b6bb826db0f80e3d46bd7a34" class="idref" href="#dca37e00b6bb826db0f80e3d46bd7a34"><span class="id" title="binder">φ</span></a><a id="dca37e00b6bb826db0f80e3d46bd7a34" class="idref" href="#dca37e00b6bb826db0f80e3d46bd7a34"><span class="id" title="binder">t</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>) (<a id="lr:250" class="idref" href="#lr:250"><span class="id" title="binder">lr</span></a> <a id="lrt:251" class="idref" href="#lrt:251"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="lm:252" class="idref" href="#lm:252"><span class="id" title="binder">lm</span></a> <a id="lmt:253" class="idref" href="#lmt:253"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="df:254" class="idref" href="#df:254"><span class="id" title="binder">df</span></a> <a id="dft:255" class="idref" href="#dft:255"><span class="id" title="binder">dft</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="cap_machine.logical_mapsto.html#LDFrac"><span class="id" title="definition">LDFrac</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#86441114472cf5330bda49c0ac1b891e"><span class="id" title="variable">φ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:256" class="idref" href="#k:256"><span class="id" title="binder"><span id="k:257" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:258" class="idref" href="#y:258"><span class="id" title="binder"><span id="y:259" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:250"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:256"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:258"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;∗&nbsp;⌜&nbsp;lreg_strip&nbsp;lrt&nbsp;⊆&nbsp;reg&nbsp;φt&nbsp;⌝&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:260" class="idref" href="#k:260"><span class="id" title="binder"><span id="k:261" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:262" class="idref" href="#y:262"><span class="id" title="binder"><span id="y:263" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:254"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:252"><span class="id" title="variable">lm</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:260"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:262"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:262"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">∃</span> <a id="lreg_t:264" class="idref" href="#lreg_t:264"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:265" class="idref" href="#lmem_t:265"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:266" class="idref" href="#cur_map:266"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:251"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:264"><span class="id" title="variable">lreg_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:253"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:265"><span class="id" title="variable">lmem_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dca37e00b6bb826db0f80e3d46bd7a34"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dca37e00b6bb826db0f80e3d46bd7a34"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#dca37e00b6bb826db0f80e3d46bd7a34"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dca37e00b6bb826db0f80e3d46bd7a34"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:264"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:265"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:266"><span class="id" title="variable">cur_map</span></a><span class="id" title="notation">⌝</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#df:254"><span class="id" title="variable">df</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:252"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#dft:255"><span class="id" title="variable">dft</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:253"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⌝</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="Ep:267" class="idref" href="#Ep:267"><span class="id" title="binder">Ep</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#86441114472cf5330bda49c0ac1b891e"><span class="id" title="variable">φ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:268" class="idref" href="#k:268"><span class="id" title="binder"><span id="k:269" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:270" class="idref" href="#y:270"><span class="id" title="binder"><span id="y:271" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:250"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:268"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:270"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:272" class="idref" href="#k:272"><span class="id" title="binder"><span id="k:273" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:274" class="idref" href="#y:274"><span class="id" title="binder"><span id="y:275" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:254"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:252"><span class="id" title="variable">lm</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:272"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:274"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:274"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:267"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dca37e00b6bb826db0f80e3d46bd7a34"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dca37e00b6bb826db0f80e3d46bd7a34"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:276" class="idref" href="#k:276"><span class="id" title="binder"><span id="k:277" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:278" class="idref" href="#y:278"><span class="id" title="binder"><span id="y:279" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:251"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:276"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:278"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:280" class="idref" href="#k:280"><span class="id" title="binder"><span id="k:281" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:282" class="idref" href="#y:282"><span class="id" title="binder"><span id="y:283" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:255"><span class="id" title="variable">dft</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:253"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:280"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:282"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:282"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">))</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_corr" class="idref" href="#state_interp_corr"><span class="id" title="lemma">state_interp_corr</span></a> {<a id="9fd19771f0ca5bfa1f044b90378c5d71" class="idref" href="#9fd19771f0ca5bfa1f044b90378c5d71"><span class="id" title="binder">σ</span></a> <a id="lregs:285" class="idref" href="#lregs:285"><span class="id" title="binder">lregs</span></a> <a id="lmem:286" class="idref" href="#lmem:286"><span class="id" title="binder">lmem</span></a> <a id="df:287" class="idref" href="#df:287"><span class="id" title="binder">df</span></a> <a id="Ep:288" class="idref" href="#Ep:288"><span class="id" title="binder">Ep</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#df:287"><span class="id" title="variable">df</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:286"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9fd19771f0ca5bfa1f044b90378c5d71"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:289" class="idref" href="#k:289"><span class="id" title="binder"><span id="k:290" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:291" class="idref" href="#y:291"><span class="id" title="binder"><span id="y:292" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:285"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:289"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:291"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:293" class="idref" href="#k:293"><span class="id" title="binder"><span id="k:294" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:295" class="idref" href="#y:295"><span class="id" title="binder"><span id="y:296" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:287"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:286"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:293"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:295"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:295"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:288"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9fd19771f0ca5bfa1f044b90378c5d71"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:297" class="idref" href="#k:297"><span class="id" title="binder"><span id="k:298" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:299" class="idref" href="#y:299"><span class="id" title="binder"><span id="y:300" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:285"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:297"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:299"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:301" class="idref" href="#k:301"><span class="id" title="binder"><span id="k:302" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:303" class="idref" href="#y:303"><span class="id" title="binder"><span id="y:304" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:287"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:286"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:301"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:303"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:303"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">∃</span> <a id="lreg_t:305" class="idref" href="#lreg_t:305"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:306" class="idref" href="#lmem_t:306"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:307" class="idref" href="#cur_map:307"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:285"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:305"><span class="id" title="variable">lreg_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:286"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:306"><span class="id" title="variable">lmem_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9fd19771f0ca5bfa1f044b90378c5d71"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#9fd19771f0ca5bfa1f044b90378c5d71"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:305"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:306"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:307"><span class="id" title="variable">cur_map</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;∗&nbsp;⌜&nbsp;lreg_strip&nbsp;regs&nbsp;⊆&nbsp;reg&nbsp;σ&nbsp;⌝.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hr Hm".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>. <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 (<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.stdpp_extra.html#snd_prod_merge_subseteq"><span class="id" title="axiom">snd_prod_merge_subseteq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmem_incl</span>; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_intro" class="idref" href="#state_interp_transient_intro"><span class="id" title="lemma">state_interp_transient_intro</span></a> {<a id="Ep:308" class="idref" href="#Ep:308"><span class="id" title="binder">Ep</span></a>} {<a id="e2d8056cfff59532ddb46e655b9599f9" class="idref" href="#e2d8056cfff59532ddb46e655b9599f9"><span class="id" title="binder">φ</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:310" class="idref" href="#lr:310"><span class="id" title="binder">lr</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:311" class="idref" href="#lm:311"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} {<a id="df:312" class="idref" href="#df:312"><span class="id" title="binder">df</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LDFrac"><span class="id" title="definition">LDFrac</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#df:312"><span class="id" title="variable">df</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:311"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2d8056cfff59532ddb46e655b9599f9"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:313" class="idref" href="#k:313"><span class="id" title="binder"><span id="k:314" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:315" class="idref" href="#y:315"><span class="id" title="binder"><span id="y:316" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:310"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:313"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:315"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:317" class="idref" href="#k:317"><span class="id" title="binder"><span id="k:318" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:319" class="idref" href="#y:319"><span class="id" title="binder"><span id="y:320" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:312"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:311"><span class="id" title="variable">lm</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:317"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:319"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:319"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:308"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2d8056cfff59532ddb46e655b9599f9"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2d8056cfff59532ddb46e655b9599f9"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:310"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:310"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:311"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:311"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:312"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:312"><span class="id" title="variable">df</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(%Hdom &amp; Hφ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_corr"><span class="id" title="axiom">state_interp_corr</span></a> <span class="id" title="notation">with</span> "[$Hφ $Hregs $Hmem]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hφ &amp; Hregs &amp; Hmem &amp; Hcorr)"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hcorr" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">cur_map</span>) "(%Hlr_incl &amp; %Hlm_incl &amp; %Hcorr)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span> ; [|<span class="id" title="var">iSplit</span> ; [<span class="id" title="var">iPureIntro</span> ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">assumption</span> | <span class="id" title="var">now</span> <span class="id" title="var">iIntros</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr'</span>, <span class="id" title="var">lm'</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span> "%".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_elim_abort" class="idref" href="#state_interp_transient_elim_abort"><span class="id" title="lemma">state_interp_transient_elim_abort</span></a> {<a id="d36385c75e2d169fefd285cb87a96416" class="idref" href="#d36385c75e2d169fefd285cb87a96416"><span class="id" title="binder">φ</span></a> <a id="0e216b4d042fc97b353be57bb8d4e65c" class="idref" href="#0e216b4d042fc97b353be57bb8d4e65c"><span class="id" title="binder">φ</span></a><a id="0e216b4d042fc97b353be57bb8d4e65c" class="idref" href="#0e216b4d042fc97b353be57bb8d4e65c"><span class="id" title="binder">t</span></a>: <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:323" class="idref" href="#lr:323"><span class="id" title="binder">lr</span></a> <a id="lrt:324" class="idref" href="#lrt:324"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:325" class="idref" href="#lm:325"><span class="id" title="binder">lm</span></a> <a id="lmt:326" class="idref" href="#lmt:326"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} {<a id="df:327" class="idref" href="#df:327"><span class="id" title="binder">df</span></a> <a id="dft:328" class="idref" href="#dft:328"><span class="id" title="binder">dft</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d36385c75e2d169fefd285cb87a96416"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0e216b4d042fc97b353be57bb8d4e65c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#0e216b4d042fc97b353be57bb8d4e65c"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:323"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:324"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:325"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:326"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:327"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:328"><span class="id" title="variable">dft</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d36385c75e2d169fefd285cb87a96416"><span class="id" title="variable">φ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:329" class="idref" href="#k:329"><span class="id" title="binder"><span id="k:330" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:331" class="idref" href="#y:331"><span class="id" title="binder"><span id="y:332" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lr:323"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:329"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:331"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:333" class="idref" href="#k:333"><span class="id" title="binder"><span id="k:334" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:335" class="idref" href="#y:335"><span class="id" title="binder"><span id="y:336" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:327"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:325"><span class="id" title="variable">lm</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:333"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:335"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:335"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hφ &amp; Hregs &amp; Hmem &amp; _)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_elim_commit" class="idref" href="#state_interp_transient_elim_commit"><span class="id" title="lemma">state_interp_transient_elim_commit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Ep:337" class="idref" href="#Ep:337"><span class="id" title="binder">Ep</span></a>} {<a id="4982de2048cadaea8ee125753e0195d2" class="idref" href="#4982de2048cadaea8ee125753e0195d2"><span class="id" title="binder">φ</span></a> <a id="6b5378bee25ea47bf7a7306a02cc9614" class="idref" href="#6b5378bee25ea47bf7a7306a02cc9614"><span class="id" title="binder">φ</span></a><a id="6b5378bee25ea47bf7a7306a02cc9614" class="idref" href="#6b5378bee25ea47bf7a7306a02cc9614"><span class="id" title="binder">t</span></a>: <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:340" class="idref" href="#lr:340"><span class="id" title="binder">lr</span></a> <a id="lrt:341" class="idref" href="#lrt:341"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:342" class="idref" href="#lm:342"><span class="id" title="binder">lm</span></a> <a id="lmt:343" class="idref" href="#lmt:343"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} {<a id="df:344" class="idref" href="#df:344"><span class="id" title="binder">df</span></a> <a id="dft:345" class="idref" href="#dft:345"><span class="id" title="binder">dft</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LDFrac"><span class="id" title="definition">LDFrac</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4982de2048cadaea8ee125753e0195d2"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6b5378bee25ea47bf7a7306a02cc9614"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#6b5378bee25ea47bf7a7306a02cc9614"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:340"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:341"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:342"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:343"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:344"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:345"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:337"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6b5378bee25ea47bf7a7306a02cc9614"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#6b5378bee25ea47bf7a7306a02cc9614"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:346" class="idref" href="#k:346"><span class="id" title="binder"><span id="k:347" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:348" class="idref" href="#y:348"><span class="id" title="binder"><span id="y:349" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:341"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:346"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:348"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:350" class="idref" href="#k:350"><span class="id" title="binder"><span id="k:351" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:352" class="idref" href="#y:352"><span class="id" title="binder"><span id="y:353" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:345"><span class="id" title="variable">dft</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:343"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:350"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#y:352"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:352"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hφ &amp; Hregs &amp; Hmem &amp; _ &amp; _ &amp; Hupd)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hupd" <span class="id" title="notation">with</span> "[$Hφ $Hregs $Hmem]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hφ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_cap_lang" class="idref" href="#wp_cap_lang"><span class="id" title="lemma">wp_cap_lang</span></a> {<a id="s:354" class="idref" href="#s:354"><span class="id" title="binder">s</span></a> <a id="E:355" class="idref" href="#E:355"><span class="id" title="binder">E</span></a>} {<a id="ead71198a02555a4cc72ec8048f7928f" class="idref" href="#ead71198a02555a4cc72ec8048f7928f"><span class="id" title="binder">Φ</span></a>} : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="e1:357" class="idref" href="#e1:357"><span class="id" title="binder">e1</span></a> : <span class="id" title="projection">language.expr</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:357"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="1782fbc8d622ae2cce9cdfb9769e4282" class="idref" href="#1782fbc8d622ae2cce9cdfb9769e4282"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1782fbc8d622ae2cce9cdfb9769e4282"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:355"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="definition">head_reducible</span> <a class="idref" href="cap_machine.rules.rules_base.html#e1:357"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1782fbc8d622ae2cce9cdfb9769e4282"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e2:359" class="idref" href="#e2:359"><span class="id" title="binder">e2</span></a> : <span class="id" title="projection">language.expr</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="0fd31d635216eb8fc6c5c0542bb7527a" class="idref" href="#0fd31d635216eb8fc6c5c0542bb7527a"><span class="id" title="binder">σ2</span></a> : <span class="id" title="projection">ectx_language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:357"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#1782fbc8d622ae2cce9cdfb9769e4282"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:359"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0fd31d635216eb8fc6c5c0542bb7527a"><span class="id" title="variable">σ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:355"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0fd31d635216eb8fc6c5c0542bb7527a"><span class="id" title="variable">σ2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#ead71198a02555a4cc72ec8048f7928f"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> <a class="idref" href="cap_machine.rules.rules_base.html#e2:359"><span class="id" title="variable">e2</span></a>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:354"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:355"><span class="id" title="variable">E</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:357"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ead71198a02555a4cc72ec8048f7928f"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? <span class="id" title="var">Hnoval</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>) "Hσ1 /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> σ1 <span class="id" title="notation">with</span> "[$Hσ1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[%Hred H]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iIntros</span> (? ? ?) "%Hstep Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.rules.rules_base.html#prim_step_no_efs"><span class="id" title="axiom">prim_step_no_efs</span></a> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.rules.rules_base.html#prim_step_no_kappa"><span class="id" title="axiom">prim_step_no_kappa</span></a> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">Hstep</span> <span class="id" title="notation">with</span> "Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_instr_exec" class="idref" href="#wp_instr_exec"><span class="id" title="lemma">wp_instr_exec</span></a> {<a id="s:361" class="idref" href="#s:361"><span class="id" title="binder">s</span></a> <a id="E:362" class="idref" href="#E:362"><span class="id" title="binder">E</span></a>} {<a id="58f98472beb52f7fe0122c1e5894c5be" class="idref" href="#58f98472beb52f7fe0122c1e5894c5be"><span class="id" title="binder">Φ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="3e7070565450a77be0431fb86cee7ac9" class="idref" href="#3e7070565450a77be0431fb86cee7ac9"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3e7070565450a77be0431fb86cee7ac9"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:362"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e2:365" class="idref" href="#e2:365"><span class="id" title="binder">e2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ConfFlag"><span class="id" title="inductive">ConfFlag</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="b6dadd1cdcf770f89cc0ec03ce406f40" class="idref" href="#b6dadd1cdcf770f89cc0ec03ce406f40"><span class="id" title="binder">σ2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3e7070565450a77be0431fb86cee7ac9"><span class="id" title="variable">σ1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e2:365"><span class="id" title="variable">e2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b6dadd1cdcf770f89cc0ec03ce406f40"><span class="id" title="variable">σ2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:362"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b6dadd1cdcf770f89cc0ec03ce406f40"><span class="id" title="variable">σ2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#58f98472beb52f7fe0122c1e5894c5be"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:365"><span class="id" title="variable">e2</span></a>))<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:361"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:362"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#58f98472beb52f7fe0122c1e5894c5be"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_cap_lang"><span class="id" title="axiom">wp_cap_lang</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1) "Hσ1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">with</span> "Hσ1"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2) "%Hstep".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hstep</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Program Definition</span> <a id="wp_lift_atomic_head_step_no_fork_determ" class="idref" href="#wp_lift_atomic_head_step_no_fork_determ"><span class="id" title="definition">wp_lift_atomic_head_step_no_fork_determ</span></a> {<a id="s:367" class="idref" href="#s:367"><span class="id" title="binder">s</span></a> <a id="E:368" class="idref" href="#E:368"><span class="id" title="binder">E</span></a> <a id="05c3782e40aac7e312d5431a6866ec3a" class="idref" href="#05c3782e40aac7e312d5431a6866ec3a"><span class="id" title="binder">Φ</span></a>} <a id="e1:370" class="idref" href="#e1:370"><span class="id" title="binder">e1</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:370"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="acb2f7e529239b3f9d52a275b3e622ed" class="idref" href="#acb2f7e529239b3f9d52a275b3e622ed"><span class="id" title="binder">σ1</span></a>:<a class="idref" href="cap_machine.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) <a id="ns:372" class="idref" href="#ns:372"><span class="id" title="binder">ns</span></a> <a id="05dbaed166b9b7be293fb7519f0ec16a" class="idref" href="#05dbaed166b9b7be293fb7519f0ec16a"><span class="id" title="binder">κ</span></a> <a id="a6a7990faedf3ca3389ecbe41f7f9f53" class="idref" href="#a6a7990faedf3ca3389ecbe41f7f9f53"><span class="id" title="binder">κs</span></a> <a id="nt:375" class="idref" href="#nt:375"><span class="id" title="binder">nt</span></a><span class="id" title="notation">,</span> <span class="id" title="method">state_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#acb2f7e529239b3f9d52a275b3e622ed"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ns:372"><span class="id" title="variable">ns</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#05dbaed166b9b7be293fb7519f0ec16a"><span class="id" title="variable">κ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a6a7990faedf3ca3389ecbe41f7f9f53"><span class="id" title="variable">κs</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#nt:375"><span class="id" title="variable">nt</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:368"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="edaab4a63e4dda741ec611c75e2f2b27" class="idref" href="#edaab4a63e4dda741ec611c75e2f2b27"><span class="id" title="binder">κ</span></a> <a id="e2:377" class="idref" href="#e2:377"><span class="id" title="binder">e2</span></a> (<a id="79e11778b59507c9421e94e7229bf249" class="idref" href="#79e11778b59507c9421e94e7229bf249"><span class="id" title="binder">σ2</span></a>:<a class="idref" href="cap_machine.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) <a id="efs:379" class="idref" href="#efs:379"><span class="id" title="binder">efs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.cap_lang.html#prim_step"><span class="id" title="inductive">cap_lang.prim_step</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e1:370"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#acb2f7e529239b3f9d52a275b3e622ed"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#edaab4a63e4dda741ec611c75e2f2b27"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:377"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#79e11778b59507c9421e94e7229bf249"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#efs:379"><span class="id" title="variable">efs</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <span class="id" title="notation">|==&gt;</span> <span class="id" title="notation">(</span><span class="id" title="method">state_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#79e11778b59507c9421e94e7229bf249"><span class="id" title="variable">σ2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ns:372"><span class="id" title="variable">ns</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#a6a7990faedf3ca3389ecbe41f7f9f53"><span class="id" title="variable">κs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#nt:375"><span class="id" title="variable">nt</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#05c3782e40aac7e312d5431a6866ec3a"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<a class="idref" href="cap_machine.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e2:377"><span class="id" title="variable">e2</span></a>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.rules.rules_base.html#e1:370"><span class="id" title="variable">e1</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:367"><span class="id" title="variable">s</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:368"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="cap_machine.rules.rules_base.html#05c3782e40aac7e312d5431a6866ec3a"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "H". <span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>)  "Hσ1 /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span> <span class="id" title="notation">with</span> "[Hσ1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> (<span class="id" title="var">κ'</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span>) "[H1 H2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<span class="id" title="definition">head_reducible</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">κ'</span>, <span class="id" title="var">e2</span>, σ2, <span class="id" title="var">efs</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> (? ? ?) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H1" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#cap_lang_determ"><span class="id" title="axiom">cap_lang_determ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hs1</span> <span class="id" title="var">Hs2</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq1</span> [<span class="id" title="var">Heq2</span> [<span class="id" title="var">Heq3</span> <span class="id" title="var">Heq4</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">iMod</span> "H2". <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">inv</span> <span class="id" title="var">Hs1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;predicates&nbsp;on&nbsp;memory&nbsp;maps&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="extract_sep_if_split" class="idref" href="#extract_sep_if_split"><span class="id" title="lemma">extract_sep_if_split</span></a> (<a id="a:380" class="idref" href="#a:380"><span class="id" title="binder">a</span></a> <a id="pc_a:381" class="idref" href="#pc_a:381"><span class="id" title="binder">pc_a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) <a id="P:382" class="idref" href="#P:382"><span class="id" title="binder">P</span></a> <a id="Q:383" class="idref" href="#Q:383"><span class="id" title="binder">Q</span></a> <a id="R:384" class="idref" href="#R:384"><span class="id" title="binder">R</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:380"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:381"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:382"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Q:383"><span class="id" title="variable">Q</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#R:384"><span class="id" title="variable">R</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">≡</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:380"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:381"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#P:382"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Q:383"><span class="id" title="variable">Q</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#a:380"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:381"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#R:384"><span class="id" title="variable">R</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">pc_a</span>)%<span class="id" title="var">la</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iIntros</span> "[H1 H2]"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_0" class="idref" href="#memMap_resource_0"><span class="id" title="lemma">memMap_resource_0</span></a>  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">True</span> <span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:385" class="idref" href="#la:385"><span class="id" title="binder"><span id="la:386" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:387" class="idref" href="#w:387"><span class="id" title="binder"><span id="w:388" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:385"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:387"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_1" class="idref" href="#memMap_resource_1"><span class="id" title="lemma">memMap_resource_1</span></a> (<a id="a:389" class="idref" href="#a:389"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w:390" class="idref" href="#w:390"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a:389"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:390"><span class="id" title="variable">w</span></a>  <span class="id" title="notation">⊣⊢</span> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:391" class="idref" href="#la:391"><span class="id" title="binder"><span id="la:392" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:393" class="idref" href="#w:393"><span class="id" title="binder"><span id="w:394" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a:389"><span class="id" title="variable">a</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w:390"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:391"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:393"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_0"><span class="id" title="axiom">memMap_resource_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[HH _]".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_1_dq" class="idref" href="#memMap_resource_1_dq"><span class="id" title="lemma">memMap_resource_1_dq</span></a> (<a id="a:395" class="idref" href="#a:395"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w:396" class="idref" href="#w:396"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <a id="dq:397" class="idref" href="#dq:397"><span class="id" title="binder">dq</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a:395"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:397"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:396"><span class="id" title="variable">w</span></a>  <span class="id" title="notation">⊣⊢</span> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:398" class="idref" href="#la:398"><span class="id" title="binder"><span id="la:399" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:400" class="idref" href="#w:400"><span class="id" title="binder"><span id="w:401" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a:395"><span class="id" title="variable">a</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w:396"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:398"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:397"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:400"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[HH _]".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne" class="idref" href="#memMap_resource_2ne"><span class="id" title="lemma">memMap_resource_2ne</span></a> (<a id="a1:402" class="idref" href="#a1:402"><span class="id" title="binder">a1</span></a> <a id="a2:403" class="idref" href="#a2:403"><span class="id" title="binder">a2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w1:404" class="idref" href="#w1:404"><span class="id" title="binder">w1</span></a> <a id="w2:405" class="idref" href="#w2:405"><span class="id" title="binder">w2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#a1:402"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a2:403"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:406" class="idref" href="#a:406"><span class="id" title="binder"><span id="a:407" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:408" class="idref" href="#w:408"><span class="id" title="binder"><span id="w:409" class="id">w</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#a1:402"><span class="id" title="variable">a1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#w1:404"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">a2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:406"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:408"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#a1:402"><span class="id" title="variable">a1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w1:404"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#a2:403"><span class="id" title="variable">a2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w2:405"><span class="id" title="variable">w2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a2</span> <span class="id" title="var">w2</span>); <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>. 2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_0"><span class="id" title="axiom">memMap_resource_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 [H2 _ ] ]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 H2]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="address_neq" class="idref" href="#address_neq"><span class="id" title="lemma">address_neq</span></a> <a id="la1:410" class="idref" href="#la1:410"><span class="id" title="binder">la1</span></a> <a id="la2:411" class="idref" href="#la2:411"><span class="id" title="binder">la2</span></a> <a id="lw1:412" class="idref" href="#lw1:412"><span class="id" title="binder">lw1</span></a> <a id="lw2:413" class="idref" href="#lw2:413"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la1:410"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:412"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la2:411"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:413"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:410"><span class="id" title="variable">la1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:411"><span class="id" title="variable">la2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ha1 Ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="machine_utils.finz_base.html#finz_eq_dec"><span class="id" title="instance">finz_eq_dec</span></a> <span class="id" title="var">la1</span><span class="id" title="notation">.1</span> <span class="id" title="var">la2</span><span class="id" title="notation">.1</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="instance">Nat.eq_dec</span> <span class="id" title="var">la1</span><span class="id" title="notation">.2</span> <span class="id" title="var">la2</span><span class="id" title="notation">.2</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExFalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">la1</span> <span class="id" title="keyword">with</span> <span class="id" title="var">la2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#addr_dupl_false"><span class="id" title="axiom">addr_dupl_false</span></a> <span class="id" title="notation">with</span> "[$Ha1] [$Ha2]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#injective_projections"><span class="id" title="lemma">injective_projections</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne_apply" class="idref" href="#memMap_resource_2ne_apply"><span class="id" title="lemma">memMap_resource_2ne_apply</span></a> (<a id="la1:414" class="idref" href="#la1:414"><span class="id" title="binder">la1</span></a> <a id="la2:415" class="idref" href="#la2:415"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:416" class="idref" href="#lw1:416"><span class="id" title="binder">lw1</span></a> <a id="lw2:417" class="idref" href="#lw2:417"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#la1:414"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:416"><span class="id" title="variable">lw1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#la2:415"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:417"><span class="id" title="variable">lw2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:418" class="idref" href="#la:418"><span class="id" title="binder"><span id="la:419" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:420" class="idref" href="#lw:420"><span class="id" title="binder"><span id="lw:421" class="id">lw</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:414"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:416"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:418"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:420"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:414"><span class="id" title="variable">la1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:415"><span class="id" title="variable">la2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hi Hr2a".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#address_neq"><span class="id" title="axiom">address_neq</span></a>  <span class="id" title="notation">with</span> "Hi Hr2a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hne</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iSplitL</span> "Hi"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen" class="idref" href="#memMap_resource_2gen"><span class="id" title="lemma">memMap_resource_2gen</span></a> (<a id="la1:422" class="idref" href="#la1:422"><span class="id" title="binder">la1</span></a> <a id="la2:423" class="idref" href="#la2:423"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:424" class="idref" href="#lw1:424"><span class="id" title="binder">lw1</span></a> <a id="lw2:425" class="idref" href="#lw2:425"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="notation">∃</span> <a id="lmem:426" class="idref" href="#lmem:426"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:427" class="idref" href="#la:427"><span class="id" title="binder"><span id="la:428" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:429" class="idref" href="#lw:429"><span class="id" title="binder"><span id="lw:430" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:426"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:427"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:429"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:423"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:422"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:426"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:422"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:424"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:426"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:422"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:424"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:422"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:424"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:423"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:422"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:423"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:425"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HeqZ</span> <span class="id" title="var">HeqV</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#Z.eqb_eq"><span class="id" title="lemma">Z.eqb_eq</span></a>, <a class="idref" href="machine_utils.finz_base.html#finz_to_z_eq"><span class="id" title="lemma">finz_to_z_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqZ</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.eqb_eq"><span class="id" title="lemma">Nat.eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">la2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">la1</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#injective_projections"><span class="id" title="lemma">injective_projections</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_1"><span class="id" title="axiom">memMap_resource_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (<span class="id" title="var">lmem</span>) "[HH -&gt;]". <span class="id" title="tactic">by</span> <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> "[Hmap _]". <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.rules.rules_base.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (<span class="id" title="var">mem</span>) "[HH -&gt;]" ; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> "Hmap"; <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_d" class="idref" href="#memMap_resource_2gen_d"><span class="id" title="lemma">memMap_resource_2gen_d</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="3c6bc2c903796ef0f12926a43a442949" class="idref" href="#3c6bc2c903796ef0f12926a43a442949"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la1:432" class="idref" href="#la1:432"><span class="id" title="binder">la1</span></a> <a id="la2:433" class="idref" href="#la2:433"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:434" class="idref" href="#lw1:434"><span class="id" title="binder">lw1</span></a> <a id="lw2:435" class="idref" href="#lw2:435"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">∃</span> <a id="lmem:436" class="idref" href="#lmem:436"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:437" class="idref" href="#la:437"><span class="id" title="binder"><span id="la:438" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:439" class="idref" href="#lw:439"><span class="id" title="binder"><span id="lw:440" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:436"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#3c6bc2c903796ef0f12926a43a442949"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:437"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:439"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:433"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:432"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:436"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:432"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:434"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:436"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:432"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:434"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#3c6bc2c903796ef0f12926a43a442949"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:432"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:434"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:433"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:432"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3c6bc2c903796ef0f12926a43a442949"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:433"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:435"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> (<span class="id" title="var">lmem</span>) "[Hmem Hif]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ((<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_d_dq" class="idref" href="#memMap_resource_2gen_d_dq"><span class="id" title="lemma">memMap_resource_2gen_d_dq</span></a> (<a id="4b32b31ab34f36268edd95f9cf383963" class="idref" href="#4b32b31ab34f36268edd95f9cf383963"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la1:442" class="idref" href="#la1:442"><span class="id" title="binder">la1</span></a> <a id="la2:443" class="idref" href="#la2:443"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="dq1:444" class="idref" href="#dq1:444"><span class="id" title="binder">dq1</span></a> <a id="dq2:445" class="idref" href="#dq2:445"><span class="id" title="binder">dq2</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="lw1:446" class="idref" href="#lw1:446"><span class="id" title="binder">lw1</span></a> <a id="lw2:447" class="idref" href="#lw2:447"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">∃</span> <a id="lmem:448" class="idref" href="#lmem:448"><span class="id" title="binder">lmem</span></a> <a id="dfracs:449" class="idref" href="#dfracs:449"><span class="id" title="binder">dfracs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:450" class="idref" href="#la:450"><span class="id" title="binder"><span id="la:451" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dlw:452" class="idref" href="#dlw:452"><span class="id" title="binder"><span id="dlw:453" class="id">dlw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:449"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:448"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#4b32b31ab34f36268edd95f9cf383963"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:450"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:452"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:452"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:443"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:442"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:448"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:442"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:446"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:448"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:442"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:446"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:443"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:442"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:449"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:442"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:444"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:449"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:442"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:444"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#4b32b31ab34f36268edd95f9cf383963"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:442"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq1:444"><span class="id" title="variable">dq1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:446"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:443"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:442"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4b32b31ab34f36268edd95f9cf383963"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:443"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq2:445"><span class="id" title="variable">dq2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:447"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> (<span class="id" title="var">mem</span> <span class="id" title="var">dfracs</span>) "[Hmem [Hif Hif'] ]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ((<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> "Hif'" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> "Hif'" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Not&nbsp;the&nbsp;world's&nbsp;most&nbsp;beautiful&nbsp;lemma,&nbsp;but&nbsp;it&nbsp;does&nbsp;avoid&nbsp;us&nbsp;having&nbsp;to&nbsp;fiddle&nbsp;around&nbsp;with&nbsp;a&nbsp;later&nbsp;under&nbsp;an&nbsp;if&nbsp;in&nbsp;proofs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_clater" class="idref" href="#memMap_resource_2gen_clater"><span class="id" title="lemma">memMap_resource_2gen_clater</span></a> (<a id="la1:454" class="idref" href="#la1:454"><span class="id" title="binder">la1</span></a> <a id="la2:455" class="idref" href="#la2:455"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:456" class="idref" href="#lw1:456"><span class="id" title="binder">lw1</span></a> <a id="lw2:457" class="idref" href="#lw2:457"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="040c65e80794ba6c93f64595085522a9" class="idref" href="#040c65e80794ba6c93f64595085522a9"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#040c65e80794ba6c93f64595085522a9"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:454"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:456"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:455"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:454"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#040c65e80794ba6c93f64595085522a9"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:455"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:457"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> (<span class="id" title="notation">∃</span> <a id="lmem:459" class="idref" href="#lmem:459"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:460" class="idref" href="#la:460"><span class="id" title="binder"><span id="la:461" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:462" class="idref" href="#lw:462"><span class="id" title="binder"><span id="lw:463" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:459"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#040c65e80794ba6c93f64595085522a9"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:460"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:462"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:455"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:454"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:459"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:454"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:456"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:459"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:454"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:456"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hc1 Hc2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iNext</span>. <span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;More&nbsp;general&nbsp;lemmas&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_clater_dq" class="idref" href="#memMap_resource_2gen_clater_dq"><span class="id" title="lemma">memMap_resource_2gen_clater_dq</span></a> (<a id="la1:464" class="idref" href="#la1:464"><span class="id" title="binder">la1</span></a> <a id="la2:465" class="idref" href="#la2:465"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="dq1:466" class="idref" href="#dq1:466"><span class="id" title="binder">dq1</span></a> <a id="dq2:467" class="idref" href="#dq2:467"><span class="id" title="binder">dq2</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="lw1:468" class="idref" href="#lw1:468"><span class="id" title="binder">lw1</span></a> <a id="lw2:469" class="idref" href="#lw2:469"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="8bfbcef820866b7ff296c750ba7eec22" class="idref" href="#8bfbcef820866b7ff296c750ba7eec22"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#8bfbcef820866b7ff296c750ba7eec22"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:464"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq1:466"><span class="id" title="variable">dq1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw1:468"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#la2:465"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:464"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.rules.rules_base.html#8bfbcef820866b7ff296c750ba7eec22"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la2:465"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dq2:467"><span class="id" title="variable">dq2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:469"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">∃</span> <a id="lmem:471" class="idref" href="#lmem:471"><span class="id" title="binder">lmem</span></a> <a id="dfracs:472" class="idref" href="#dfracs:472"><span class="id" title="binder">dfracs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:473" class="idref" href="#la:473"><span class="id" title="binder"><span id="la:474" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dlw:475" class="idref" href="#dlw:475"><span class="id" title="binder"><span id="dlw:476" class="id">dlw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:472"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:471"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#8bfbcef820866b7ff296c750ba7eec22"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la:473"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:475"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.rules.rules_base.html#dlw:475"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:465"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:464"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:471"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:464"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:468"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:471"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:464"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw1:468"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.rules.rules_base.html#la2:465"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#la1:464"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:472"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:464"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:466"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dfracs:472"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la1:464"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#dq1:466"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hc1 Hc2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.logical_mapsto.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>),(<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">dq1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>),(<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">dq1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_delete" class="idref" href="#memMap_delete"><span class="id" title="lemma">memMap_delete</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="la:477" class="idref" href="#la:477"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:478" class="idref" href="#lw:478"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <a id="lmem:479" class="idref" href="#lmem:479"><span class="id" title="binder">lmem</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:479"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:477"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:478"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:480" class="idref" href="#la:480"><span class="id" title="binder"><span id="la:481" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:482" class="idref" href="#lw:482"><span class="id" title="binder"><span id="lw:483" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:479"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:480"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:482"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#la:477"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:478"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:484" class="idref" href="#k:484"><span class="id" title="binder"><span id="k:485" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:486" class="idref" href="#y:486"><span class="id" title="binder"><span id="y:487" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">delete</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:477"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:479"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:484"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:486"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">lmem</span> <span class="id" title="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <a id="mem_remove_dq" class="idref" href="#mem_remove_dq"><span class="id" title="lemma">mem_remove_dq</span></a> <a id="lmem:488" class="idref" href="#lmem:488"><span class="id" title="binder">lmem</span></a> <a id="dq:489" class="idref" href="#dq:489"><span class="id" title="binder">dq</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:490" class="idref" href="#la:490"><span class="id" title="binder"><span id="la:491" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:492" class="idref" href="#lw:492"><span class="id" title="binder"><span id="lw:493" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:488"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:490"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:489"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:492"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊣⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:494" class="idref" href="#la:494"><span class="id" title="binder"><span id="la:495" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:496" class="idref" href="#dw:496"><span class="id" title="binder"><span id="dw:497" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:488"><span class="id" title="variable">lmem</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#dq:489"><span class="id" title="variable">dq</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lmem:488"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:494"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:496"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:496"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInduction</span> (<span class="id" title="var">lmem</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">la</span> <span class="id" title="var">k</span> <span class="id" title="var">lmem</span>] "IH" <span class="id" title="keyword">using</span> <span class="id" title="lemma">map_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span> <span class="id" title="lemma">dom_empty_L</span> <span class="id" title="lemma">elements_empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/= /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <span class="id" title="lemma">merge_empty</span> <span class="id" title="lemma">big_sepM_empty</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">dom_insert_L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">elements</span> (<span class="id" title="notation">{[</span><span class="id" title="var">la</span><span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>) <span class="id" title="notation">≡ₚ</span> <span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">elements_union_singleton</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default_permutation"><span class="id" title="axiom">create_gmap_default_permutation</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dq</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hperm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hperm</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Ha Hmem]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_merge</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_op"><span class="id" title="definition">prod_op</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="var">dq</span> <span class="id" title="notation">!!</span> <span class="id" title="var">la</span>);<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "IH". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Ha Hmem]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_merge</span> /<a class="idref" href="cap_machine.stdpp_extra.html#prod_op"><span class="id" title="definition">prod_op</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="var">dq</span> <span class="id" title="notation">!!</span> <span class="id" title="var">la</span>);<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "IH". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;more&nbsp;general&nbsp;version&nbsp;of&nbsp;load&nbsp;to&nbsp;work&nbsp;also&nbsp;with&nbsp;any&nbsp;fraction&nbsp;and&nbsp;persistent&nbsp;points&nbsp;tos&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_valid_inSepM_general" class="idref" href="#gen_mem_valid_inSepM_general"><span class="id" title="lemma">gen_mem_valid_inSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:498" class="idref" href="#lmem:498"><span class="id" title="binder">lmem</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)) (<a id="lmem':499" class="idref" href="#lmem':499"><span class="id" title="binder">lmem'</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la:500" class="idref" href="#la:500"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:501" class="idref" href="#lw:501"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="dq:502" class="idref" href="#dq:502"><span class="id" title="binder">dq</span></a> : <span class="id" title="inductive">dfrac</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:498"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:500"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:502"><span class="id" title="variable">dq</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:501"><span class="id" title="variable">lw</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':499"><span class="id" title="variable">lmem'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:503" class="idref" href="#a:503"><span class="id" title="binder"><span id="a:504" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="dqw:505" class="idref" href="#dqw:505"><span class="id" title="binder"><span id="dqw:506" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:498"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:503"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:505"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dqw:505"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#lmem':499"><span class="id" title="variable">lmem'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:500"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:501"><span class="id" title="variable">lw</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lmem</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">dq</span> <span class="id" title="var">Hmem_pc</span>) "Hm Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hpc_a Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpc_a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_valid_inSepM" class="idref" href="#gen_mem_valid_inSepM"><span class="id" title="lemma">gen_mem_valid_inSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:507" class="idref" href="#lmem:507"><span class="id" title="binder">lmem</span></a> <a id="lm:508" class="idref" href="#lm:508"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="la:509" class="idref" href="#la:509"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:510" class="idref" href="#lw:510"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:507"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:509"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:510"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lm:508"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:511" class="idref" href="#la:511"><span class="id" title="binder"><span id="la:512" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:513" class="idref" href="#lw:513"><span class="id" title="binder"><span id="lw:514" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:507"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:511"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:513"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.rules.rules_base.html#lm:508"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:509"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:510"><span class="id" title="variable">lw</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">Hmem_pc</span>) "Hm Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#memMap_delete"><span class="id" title="axiom">memMap_delete</span></a> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hpc_a Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpc_a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_update_inSepM" class="idref" href="#gen_mem_update_inSepM"><span class="id" title="lemma">gen_mem_update_inSepM</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="c591a96d44d6308d87b19ba7246a8e34" class="idref" href="#c591a96d44d6308d87b19ba7246a8e34"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>} {<a id="gen_heapG0:516" class="idref" href="#gen_heapG0:516"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c591a96d44d6308d87b19ba7246a8e34"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="lmem:517" class="idref" href="#lmem:517"><span class="id" title="binder">lmem</span></a> <a id="lmem':518" class="idref" href="#lmem':518"><span class="id" title="binder">lmem'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="la:519" class="idref" href="#la:519"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:520" class="idref" href="#lw:520"><span class="id" title="binder">lw</span></a> <a id="lw':521" class="idref" href="#lw':521"><span class="id" title="binder">lw'</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem':518"><span class="id" title="variable">lmem'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:519"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw':521"><span class="id" title="variable">lw'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:517"><span class="id" title="variable">lmem</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:522" class="idref" href="#la:522"><span class="id" title="binder"><span id="la:523" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:524" class="idref" href="#lw:524"><span class="id" title="binder"><span id="lw:525" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem':518"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:522"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:524"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la:519"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:520"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:526" class="idref" href="#a:526"><span class="id" title="binder"><span id="a:527" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:528" class="idref" href="#w:528"><span class="id" title="binder"><span id="w:529" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#la:519"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:520"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem'</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:526"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:528"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span>);[|<span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "[$Hmap $Hl]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_delete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">insert_delete_insert</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;FAIL&nbsp;RULES&nbsp;----------------------------------&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Bind&nbsp;Scope&nbsp;expr_scope&nbsp;with&nbsp;language.expr&nbsp;cap_lang.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC" class="idref" href="#wp_notCorrectPC"><span class="id" title="lemma">wp_notCorrectPC</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">forall</span> <a id="E:530" class="idref" href="#E:530"><span class="id" title="binder">E</span></a> (<a id="lw:531" class="idref" href="#lw:531"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:531"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:531"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:530"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:531"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hnpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">ϕ</span>) "HPC Hϕ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">nt</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">ns</span>) "Hσ1 /="; <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span>) "(Hr &amp; Hm &amp; %HLinv)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr HPC"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">fupd_frame_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">e1</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_fail_inv"><span class="id" title="axiom">step_fail_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> [-&gt; -&gt;]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">intro</span> <span class="id" title="var">contra</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">contra</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hϕ HPC"; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hϕ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Subcases&nbsp;for&nbsp;respecitvely&nbsp;permissions&nbsp;and&nbsp;bounds&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC_perm" class="idref" href="#wp_notCorrectPC_perm"><span class="id" title="lemma">wp_notCorrectPC_perm</span></a> <a id="E:532" class="idref" href="#E:532"><span class="id" title="binder">E</span></a> <a id="pc_p:533" class="idref" href="#pc_p:533"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:534" class="idref" href="#pc_b:534"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:535" class="idref" href="#pc_e:535"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:536" class="idref" href="#pc_a:536"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:537" class="idref" href="#pc_v:537"><span class="id" title="binder">pc_v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#pc_p:533"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.machine_base.html#RX"><span class="id" title="constructor">RX</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:533"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.machine_base.html#RWX"><span class="id" title="constructor">RWX</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:533"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:534"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:535"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:536"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:537"><span class="id" title="variable">pc_v</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:532"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <span class="id" title="notation">True</span> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hperm</span> φ) "HPC Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_notCorrectPC"><span class="id" title="axiom">wp_notCorrectPC</span></a> <span class="id" title="notation">with</span> "[HPC]"<span class="id" title="notation">)</span> ; [<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#not_isCorrectLPC_perm"><span class="id" title="axiom">not_isCorrectLPC_perm</span></a>; <span class="id" title="tactic">eauto</span>|<span class="id" title="var">iFrame</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "HPC /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_notCorrectPC_range" class="idref" href="#wp_notCorrectPC_range"><span class="id" title="lemma">wp_notCorrectPC_range</span></a> <a id="E:538" class="idref" href="#E:538"><span class="id" title="binder">E</span></a> <a id="pc_p:539" class="idref" href="#pc_p:539"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:540" class="idref" href="#pc_b:540"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:541" class="idref" href="#pc_e:541"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:542" class="idref" href="#pc_a:542"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:543" class="idref" href="#pc_v:543"><span class="id" title="binder">pc_v</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#pc_b:540"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.addr_reg.html#ecb49afb136c57143f8ddd1e3e9a03fe"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:542"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.addr_reg.html#ecb49afb136c57143f8ddd1e3e9a03fe"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:541"><span class="id" title="variable">pc_e</span></a>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:539"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:540"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:541"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:542"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:543"><span class="id" title="variable">pc_v</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:538"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <span class="id" title="notation">True</span> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hperm</span> φ) "HPC Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp_notCorrectPC"><span class="id" title="axiom">wp_notCorrectPC</span></a> <span class="id" title="notation">with</span> "[HPC]"<span class="id" title="notation">)</span> ; [<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#not_isCorrectLPC_bounds"><span class="id" title="axiom">not_isCorrectLPC_bounds</span></a>; <span class="id" title="tactic">eauto</span>|<span class="id" title="var">iFrame</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "HPC /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;ATOMIC&nbsp;RULES&nbsp;--------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_halt" class="idref" href="#wp_halt"><span class="id" title="lemma">wp_halt</span></a> <a id="E:544" class="idref" href="#E:544"><span class="id" title="binder">E</span></a> <a id="pc_p:545" class="idref" href="#pc_p:545"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:546" class="idref" href="#pc_b:546"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:547" class="idref" href="#pc_e:547"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:548" class="idref" href="#pc_a:548"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:549" class="idref" href="#pc_v:549"><span class="id" title="binder">pc_v</span></a> <a id="lw:550" class="idref" href="#lw:550"><span class="id" title="binder">lw</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:550"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#Halt"><span class="id" title="constructor">Halt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:545"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:546"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:547"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:548"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:549"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:545"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:546"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:547"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:548"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:549"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:548"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:549"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:550"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:544"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#HaltedV"><span class="id" title="constructor">HaltedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:545"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:546"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:547"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:548"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:549"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:548"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:549"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:550"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinstr</span> <span class="id" title="var">Hvpc</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (φ) "[Hpc Hpca] Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">nt</span>) "Hσ1 /=". <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr Hpc"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpca"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">rewrite</span> -/((<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_correct_PC"><span class="id" title="axiom">state_corresponds_mem_correct_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>. <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hφ Hpc Hpca"; <span class="id" title="var">last</span> (<span class="id" title="var">iApply</span> "Hφ" ; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_fail" class="idref" href="#wp_fail"><span class="id" title="lemma">wp_fail</span></a> <a id="E:551" class="idref" href="#E:551"><span class="id" title="binder">E</span></a> <a id="pc_p:552" class="idref" href="#pc_p:552"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:553" class="idref" href="#pc_b:553"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:554" class="idref" href="#pc_e:554"><span class="id" title="binder">pc_e</span></a> <a id="pc_a:555" class="idref" href="#pc_a:555"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:556" class="idref" href="#pc_v:556"><span class="id" title="binder">pc_v</span></a> <a id="lw:557" class="idref" href="#lw:557"><span class="id" title="binder">lw</span></a> :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:557"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.machine_base.html#Fail"><span class="id" title="constructor">Fail</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:552"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:553"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:554"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:555"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:556"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:552"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:553"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:554"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:555"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:556"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:555"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:556"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:557"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.rules.rules_base.html#E:551"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">{{{</span> <span class="id" title="notation">RET</span> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:552"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:553"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:554"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:555"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:556"><span class="id" title="variable">pc_v</span></a><a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">)</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:555"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:556"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:557"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">}}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinstr</span> <span class="id" title="var">Hvpc</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (φ) "[Hpc Hpca] Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">nt</span>) "Hσ1 /=". <span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hr Hpc"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpca"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span> <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt; &amp; (<span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">rewrite</span> -/((<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_correct_PC"><span class="id" title="axiom">state_corresponds_mem_correct_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>. <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hφ Hpc Hpca"; <span class="id" title="var">last</span> (<span class="id" title="var">iApply</span> "Hφ" ; <span class="id" title="var">iFrame</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;PURE&nbsp;RULES&nbsp;----------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_safe</span> := <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_puredet</span> := <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">inv_head_step</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_pure</span> := <span class="id" title="tactic">intros</span> ?; <span class="id" title="tactic">apply</span> <span class="id" title="lemma">nsteps_once</span>, <span class="id" title="lemma">pure_head_step_pure_step</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; [<span class="id" title="var">solve_exec_safe</span>|]; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="projection">head_step</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_failed" class="idref" href="#pure_seq_failed"><span class="id" title="instance">pure_seq_failed</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_halted" class="idref" href="#pure_seq_halted"><span class="id" title="instance">pure_seq_halted</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_done" class="idref" href="#pure_seq_done"><span class="id" title="instance">pure_seq_done</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a>)) (<a class="idref" href="cap_machine.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules.rules_base.html#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Used&nbsp;to&nbsp;close&nbsp;the&nbsp;failing&nbsp;cases&nbsp;of&nbsp;the&nbsp;ftlr.<br/>
&nbsp;&nbsp;-&nbsp;Hcont&nbsp;is&nbsp;the&nbsp;(iris)&nbsp;name&nbsp;of&nbsp;the&nbsp;closing&nbsp;hypothesis&nbsp;(usually&nbsp;"Hφ")<br/>
&nbsp;&nbsp;-&nbsp;fail_case_name&nbsp;is&nbsp;one&nbsp;constructor&nbsp;of&nbsp;the&nbsp;spec_name,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;indicating&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;case<br/>
&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_case_name</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">fail_case_name</span> ; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailWP</span> <span class="id" title="var">Hcont</span> <span class="id" title="var">fail_case_name</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="var">cbn</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iApply</span> <span class="id" title="var">Hcont</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_case_name</span>).<br/>

<br/>
<span class="comment">(*&nbsp;-----------------&nbsp;useful&nbsp;definitions&nbsp;to&nbsp;factor&nbsp;out&nbsp;the&nbsp;wp&nbsp;specs&nbsp;----------------&nbsp;*)</span><br/>

<br/>
<span class="comment">(*---&nbsp;register&nbsp;equality&nbsp;---*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="addr_ne_reg_ne" class="idref" href="#addr_ne_reg_ne"><span class="id" title="lemma">addr_ne_reg_ne</span></a> {<a id="regs:558" class="idref" href="#regs:558"><span class="id" title="binder">regs</span></a> : <span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>} {<a id="r1:559" class="idref" href="#r1:559"><span class="id" title="binder">r1</span></a> <a id="r2:560" class="idref" href="#r2:560"><span class="id" title="binder">r2</span></a> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="p0:561" class="idref" href="#p0:561"><span class="id" title="binder">p0</span></a> <a id="b0:562" class="idref" href="#b0:562"><span class="id" title="binder">b0</span></a> <a id="e0:563" class="idref" href="#e0:563"><span class="id" title="binder">e0</span></a> <a id="a0:564" class="idref" href="#a0:564"><span class="id" title="binder">a0</span></a> <a id="p:565" class="idref" href="#p:565"><span class="id" title="binder">p</span></a> <a id="b:566" class="idref" href="#b:566"><span class="id" title="binder">b</span></a> <a id="e:567" class="idref" href="#e:567"><span class="id" title="binder">e</span></a> <a id="a:568" class="idref" href="#a:568"><span class="id" title="binder">a</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:558"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r1:559"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p0:561"><span class="id" title="variable">p0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b0:562"><span class="id" title="variable">b0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e0:563"><span class="id" title="variable">e0</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0:564"><span class="id" title="variable">a0</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:558"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r2:560"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:565"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:566"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:567"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:568"><span class="id" title="variable">a</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0:564"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:568"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r1:559"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r2:560"><span class="id" title="variable">r2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hr1</span> <span class="id" title="var">Hr2</span> <span class="id" title="var">Hne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">decide</span> (<span class="id" title="var">r1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">r2</span>)); <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;regs_of&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="regs_of_argument" class="idref" href="#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> (<a id="arg:569" class="idref" href="#arg:569"><span class="id" title="binder">arg</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e03f39daf98516fa530d3f6f5a1b4d92"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>): <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#arg:569"><span class="id" title="variable">arg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#inl"><span class="id" title="constructor">inl</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#inr"><span class="id" title="constructor">inr</span></a> <span class="id" title="var">r</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="regs_of" class="idref" href="#regs_of"><span class="id" title="definition">regs_of</span></a> (<a id="i:571" class="idref" href="#i:571"><span class="id" title="binder">i</span></a>: <a class="idref" href="cap_machine.machine_base.html#instr"><span class="id" title="inductive">instr</span></a>): <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#i:571"><span class="id" title="variable">i</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Lea"><span class="id" title="constructor">Lea</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetP"><span class="id" title="constructor">GetP</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetB"><span class="id" title="constructor">GetB</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetE"><span class="id" title="constructor">GetE</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetA"><span class="id" title="constructor">GetA</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetOType"><span class="id" title="constructor">GetOType</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#GetWType"><span class="id" title="constructor">GetWType</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Add"><span class="id" title="constructor">Add</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Sub"><span class="id" title="constructor">Sub</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Lt"><span class="id" title="constructor">Lt</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Mov"><span class="id" title="constructor">Mov</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Restrict"><span class="id" title="constructor">Restrict</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Subseg"><span class="id" title="constructor">Subseg</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Load"><span class="id" title="constructor">Load</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Store"><span class="id" title="constructor">Store</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Jnz"><span class="id" title="constructor">Jnz</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#Seal"><span class="id" title="constructor">Seal</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#UnSeal"><span class="id" title="constructor">UnSeal</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.machine_base.html#IsUnique"><span class="id" title="constructor">IsUnique</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;@Denis&nbsp;add&nbsp;enclaves&nbsp;instructions&nbsp;here&nbsp;*)</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="indom_regs_incl" class="idref" href="#indom_regs_incl"><span class="id" title="lemma">indom_regs_incl</span></a> <a id="D:573" class="idref" href="#D:573"><span class="id" title="binder">D</span></a> (<a id="regs:574" class="idref" href="#regs:574"><span class="id" title="binder">regs</span></a> <a id="regs':575" class="idref" href="#regs':575"><span class="id" title="binder">regs'</span></a>: <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#D:573"><span class="id" title="variable">D</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:574"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:574"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':575"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="r:576" class="idref" href="#r:576"><span class="id" title="binder">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r:576"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#D:573"><span class="id" title="variable">D</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="w:577" class="idref" href="#w:577"><span class="id" title="binder">w</span></a>:<a class="idref" href="cap_machine.machine_base.html#Word"><span class="id" title="inductive">Word</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#regs:574"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:576"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:577"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#regs':575"><span class="id" title="variable">regs'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:576"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:577"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">HD</span> <span class="id" title="var">Hincl</span> <span class="id" title="var">rr</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <span class="id" title="var">rr</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> @<span class="id" title="method">elem_of_dom</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">D</span> := <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>). <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">elem_of_subseteq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="indom_lregs_incl" class="idref" href="#indom_lregs_incl"><span class="id" title="lemma">indom_lregs_incl</span></a> <a id="D:578" class="idref" href="#D:578"><span class="id" title="binder">D</span></a> (<a id="lregs:579" class="idref" href="#lregs:579"><span class="id" title="binder">lregs</span></a> <a id="lregs':580" class="idref" href="#lregs':580"><span class="id" title="binder">lregs'</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#D:578"><span class="id" title="variable">D</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:579"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:579"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs':580"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="r:581" class="idref" href="#r:581"><span class="id" title="binder">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r:581"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#D:578"><span class="id" title="variable">D</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="w:582" class="idref" href="#w:582"><span class="id" title="binder">w</span></a>:<a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#lregs:579"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:581"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:582"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#lregs':580"><span class="id" title="variable">lregs'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:581"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:582"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">HD</span> <span class="id" title="var">Hincl</span> <span class="id" title="var">rr</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <span class="id" title="var">rr</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> @<span class="id" title="method">elem_of_dom</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">D</span> := <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>). <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">elem_of_subseteq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;incrementPC&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incrementPC" class="idref" href="#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a id="regs:583" class="idref" href="#regs:583"><span class="id" title="binder">regs</span></a>: <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:583"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a'</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_Some_inv" class="idref" href="#incrementPC_Some_inv"><span class="id" title="lemma">incrementPC_Some_inv</span></a> <a id="regs:584" class="idref" href="#regs:584"><span class="id" title="binder">regs</span></a> <a id="regs':585" class="idref" href="#regs':585"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:584"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':585"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:586" class="idref" href="#p:586"><span class="id" title="binder">p</span></a> <a id="b:587" class="idref" href="#b:587"><span class="id" title="binder">b</span></a> <a id="e:588" class="idref" href="#e:588"><span class="id" title="binder">e</span></a> <a id="a:589" class="idref" href="#a:589"><span class="id" title="binder">a</span></a> <a id="a':590" class="idref" href="#a':590"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:584"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:586"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:587"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:588"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:589"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:589"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':590"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':585"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:586"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:587"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:588"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':590"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> | ] | ] | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 5 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_None_inv" class="idref" href="#incrementPC_None_inv"><span class="id" title="lemma">incrementPC_None_inv</span></a> <a id="regs:591" class="idref" href="#regs:591"><span class="id" title="binder">regs</span></a> <a id="pg:592" class="idref" href="#pg:592"><span class="id" title="binder">pg</span></a> <a id="b:593" class="idref" href="#b:593"><span class="id" title="binder">b</span></a> <a id="e:594" class="idref" href="#e:594"><span class="id" title="binder">e</span></a> <a id="a:595" class="idref" href="#a:595"><span class="id" title="binder">a</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:591"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:591"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pg:592"><span class="id" title="variable">pg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:593"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:594"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:595"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:595"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> | ] | ] |];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_overflow_mono" class="idref" href="#incrementPC_overflow_mono"><span class="id" title="lemma">incrementPC_overflow_mono</span></a> <a id="regs:596" class="idref" href="#regs:596"><span class="id" title="binder">regs</span></a> <a id="regs':597" class="idref" href="#regs':597"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:596"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#regs:596"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:596"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':597"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':597"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">HPC</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span> <span class="id" title="var">HPC</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">HPC'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HPC</span> <span class="id" title="var">HPC'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span> |- *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">aa</span> | ] | ]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">aa</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_overflow_antimono" class="idref" href="#incrementPC_overflow_antimono"><span class="id" title="lemma">incrementPC_overflow_antimono</span></a> <a id="regs:598" class="idref" href="#regs:598"><span class="id" title="binder">regs</span></a> <a id="regs':599" class="idref" href="#regs':599"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:598"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':599"><span class="id" title="variable">regs'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:598"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':599"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hincl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs'</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HrpPC</span>; <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HrpPC</span> <span class="id" title="var">Hincl</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*&nbsp;todo:&nbsp;instead,&nbsp;define&nbsp;updatePC&nbsp;on&nbsp;top&nbsp;of&nbsp;incrementPC&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_fail_updatePC" class="idref" href="#incrementPC_fail_updatePC"><span class="id" title="lemma">incrementPC_fail_updatePC</span></a> <a id="regs:600" class="idref" href="#regs:600"><span class="id" title="binder">regs</span></a> <a id="m:601" class="idref" href="#m:601"><span class="id" title="binder">m</span></a> <a id="etbl:602" class="idref" href="#etbl:602"><span class="id" title="binder">etbl</span></a> <a id="ecur:603" class="idref" href="#ecur:603"><span class="id" title="binder">ecur</span></a>:<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:600"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:600"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:601"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:602"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:603"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a'</span> | ] |]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a'</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_success_updatePC" class="idref" href="#incrementPC_success_updatePC"><span class="id" title="lemma">incrementPC_success_updatePC</span></a> <a id="regs:604" class="idref" href="#regs:604"><span class="id" title="binder">regs</span></a> <a id="m:605" class="idref" href="#m:605"><span class="id" title="binder">m</span></a> <a id="etbl:606" class="idref" href="#etbl:606"><span class="id" title="binder">etbl</span></a> <a id="ecur:607" class="idref" href="#ecur:607"><span class="id" title="binder">ecur</span></a> <a id="regs':608" class="idref" href="#regs':608"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs:604"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#regs':608"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="p:609" class="idref" href="#p:609"><span class="id" title="binder">p</span></a> <a id="b:610" class="idref" href="#b:610"><span class="id" title="binder">b</span></a> <a id="e:611" class="idref" href="#e:611"><span class="id" title="binder">e</span></a> <a id="a:612" class="idref" href="#a:612"><span class="id" title="binder">a</span></a> <a id="a':613" class="idref" href="#a':613"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:604"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:609"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:610"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:611"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:612"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:612"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':613"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:604"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:605"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:606"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:607"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:609"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:610"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:611"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':613"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:605"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:606"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:607"><span class="id" title="variable">ecur</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs':608"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:609"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:610"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:611"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':613"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a'</span>|]|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a'</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:?; [| <span class="id" title="tactic">congruence</span>]. <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span> <span class="id" title="var">regs'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 5 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_success_incl" class="idref" href="#updatePC_success_incl"><span class="id" title="lemma">updatePC_success_incl</span></a> <a id="m:614" class="idref" href="#m:614"><span class="id" title="binder">m</span></a> <a id="m':615" class="idref" href="#m':615"><span class="id" title="binder">m'</span></a> <a id="regs:616" class="idref" href="#regs:616"><span class="id" title="binder">regs</span></a> <a id="regs':617" class="idref" href="#regs':617"><span class="id" title="binder">regs'</span></a> <a id="etbl:618" class="idref" href="#etbl:618"><span class="id" title="binder">etbl</span></a> <a id="etbl':619" class="idref" href="#etbl':619"><span class="id" title="binder">etbl'</span></a> <a id="ecur:620" class="idref" href="#ecur:620"><span class="id" title="binder">ecur</span></a> <a id="ecur':621" class="idref" href="#ecur':621"><span class="id" title="binder">ecur'</span></a> <a id="w:622" class="idref" href="#w:622"><span class="id" title="binder">w</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:616"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':617"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:616"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:614"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:618"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:620"><span class="id" title="variable">ecur</span></a> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:622"><span class="id" title="variable">w</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:614"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:618"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:620"><span class="id" title="variable">ecur</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs':617"><span class="id" title="variable">regs'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':615"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':619"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':621"><span class="id" title="variable">ecur'</span></a> |}<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:622"><span class="id" title="variable">w</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs'</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':615"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':619"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':621"><span class="id" title="variable">ecur'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hincl</span> <span class="id" title="var">Hu</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ <span class="id" title="var">w1</span> |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hrr</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hrr</span> <span class="id" title="var">Hincl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hregs'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hregs'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w1</span> <span class="id" title="keyword">as</span> [|[ ? ? ? <span class="id" title="var">a1</span>|] | ]; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ha1</span>; <span class="id" title="var">simplify_eq</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HH</span>: <span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="reg1:623" class="idref" href="#reg1:623"><span class="id" title="binder"><span id="reg1:625" class="id">reg1</span></span></a> <a id="reg2:624" class="idref" href="#reg2:624"><span class="id" title="binder"><span id="reg2:626" class="id">reg2</span></span></a>:<a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.rules.rules_base.html#reg1:623"><span class="id" title="variable">reg1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg2:624"><span class="id" title="variable">reg2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg1:623"><span class="id" title="variable">reg1</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg2:624"><span class="id" title="variable">reg2</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">intros</span> * -&gt;; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">Hu</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HH</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">lookup_insert</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;{  <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hu</span>. }<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_fail_incl" class="idref" href="#updatePC_fail_incl"><span class="id" title="lemma">updatePC_fail_incl</span></a> <a id="m:627" class="idref" href="#m:627"><span class="id" title="binder">m</span></a> <a id="m':628" class="idref" href="#m':628"><span class="id" title="binder">m'</span></a> <a id="regs:629" class="idref" href="#regs:629"><span class="id" title="binder">regs</span></a> <a id="regs':630" class="idref" href="#regs':630"><span class="id" title="binder">regs'</span></a> <a id="etbl:631" class="idref" href="#etbl:631"><span class="id" title="binder">etbl</span></a> <a id="etbl':632" class="idref" href="#etbl':632"><span class="id" title="binder">etbl'</span></a> <a id="ecur:633" class="idref" href="#ecur:633"><span class="id" title="binder">ecur</span></a> <a id="ecur':634" class="idref" href="#ecur':634"><span class="id" title="binder">ecur'</span></a>  :<br/>
&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#regs:629"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:629"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs':630"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs:629"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m:627"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl:631"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur:633"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#regs':630"><span class="id" title="variable">regs'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#m':628"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#etbl':632"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.rules.rules_base.html#ecur':634"><span class="id" title="variable">ecur'</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> <span class="id" title="var">HPC</span>] <span class="id" title="var">Hincl</span> <span class="id" title="var">Hfail</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hfail</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">HPC</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfail</span>. <span class="id" title="var">have</span> -&gt; := <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a1</span> | ] |]; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>;[].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">incrementPC_inv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC_Some_inv"><span class="id" title="axiom">incrementPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC_None_inv"><span class="id" title="axiom">incrementPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_incrementPC" class="idref" href="#updatePC_incrementPC"><span class="id" title="lemma">updatePC_incrementPC</span></a> {<a id="501cca2634b7aa7c5fa3115f4e1a6e41" class="idref" href="#501cca2634b7aa7c5fa3115f4e1a6e41"><span class="id" title="binder">φ</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#501cca2634b7aa7c5fa3115f4e1a6e41"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="r':636" class="idref" href="#r':636"><span class="id" title="binder">r'</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#501cca2634b7aa7c5fa3115f4e1a6e41"><span class="id" title="variable">φ</span></a>) <span class="id" title="notation">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#501cca2634b7aa7c5fa3115f4e1a6e41"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#r':636"><span class="id" title="variable">r'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a>, <a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a>, <a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;incrementLPC&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incrementLPC" class="idref" href="#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> (<a id="regs:637" class="idref" href="#regs:637"><span class="id" title="binder">regs</span></a>: <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:637"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a'</span> <span class="id" title="var">v</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_incrementPC_some&nbsp;regs&nbsp;regs'&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;Some&nbsp;regs'&nbsp;-&gt;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementPC&nbsp;(lreg_strip&nbsp;regs)&nbsp;=&nbsp;Some&nbsp;(lreg_strip&nbsp;regs').&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/incrementPC&nbsp;/incrementLPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intros&nbsp;Hlpc.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/lreg_strip&nbsp;lookup_fmap;&nbsp;cbn.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(regs&nbsp;!!&nbsp;PC)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">lw</span>|</span>&nbsp;eqn:Heq&nbsp;;&nbsp;rewrite&nbsp;Heq;&nbsp;cbn&nbsp;in&nbsp;*;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct_lword&nbsp;lw;&nbsp;cbn&nbsp;in&nbsp;*;&nbsp;try&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;simplify_eq.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;rewrite&nbsp;fmap_insert.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_incrementPC_none&nbsp;regs&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;None&nbsp;&lt;-&gt;&nbsp;incrementPC&nbsp;(lreg_strip&nbsp;regs)&nbsp;=&nbsp;None.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intros.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/incrementPC&nbsp;/incrementLPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/lreg_strip&nbsp;lookup_fmap;&nbsp;cbn.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(regs&nbsp;!!&nbsp;PC)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">LX</span>|</span>&nbsp;eqn:Heq&nbsp;;&nbsp;rewrite&nbsp;Heq;&nbsp;cbn;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;LX&nbsp;;&nbsp;cbn&nbsp;;&nbsp;<span class="inlinecode">(<span class="id" title="tactic">clear</span>;</span> <span class="inlinecode"><span class="id" title="tactic">firstorder</span>)</span> <span class="inlinecode">|</span> <span class="inlinecode">|</span> <span class="inlinecode">(<span class="id" title="tactic">clear</span>;</span> <span class="inlinecode"><span class="id" title="tactic">firstorder</span>)</span>.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;sb&nbsp;as&nbsp;<span class="inlinecode">?</span> <span class="inlinecode">?</span> <span class="inlinecode">?</span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode">|</span> <span class="inlinecode"></span>&nbsp;;&nbsp;eauto;&nbsp;cbn;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(a'&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_fail_updatePC&nbsp;regs&nbsp;m&nbsp;etbl&nbsp;ecur:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;None&nbsp;-&gt;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;updatePC&nbsp;{|&nbsp;reg&nbsp;:=&nbsp;(lreg_strip&nbsp;regs);&nbsp;mem&nbsp;:=&nbsp;m;&nbsp;etable&nbsp;:=&nbsp;etbl&nbsp;;&nbsp;enumcur&nbsp;:=&nbsp;ecur&nbsp;|}&nbsp;=&nbsp;None.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intro&nbsp;Hincr.&nbsp;apply&nbsp;incrementLPC_incrementPC_none&nbsp;in&nbsp;Hincr.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;apply&nbsp;incrementPC_fail_updatePC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementLPC_Some_inv" class="idref" href="#incrementLPC_Some_inv"><span class="id" title="lemma">incrementLPC_Some_inv</span></a> <a id="lregs:638" class="idref" href="#lregs:638"><span class="id" title="binder">lregs</span></a> <a id="lregs':639" class="idref" href="#lregs':639"><span class="id" title="binder">lregs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:638"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs':639"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:640" class="idref" href="#p:640"><span class="id" title="binder">p</span></a> <a id="b:641" class="idref" href="#b:641"><span class="id" title="binder">b</span></a> <a id="e:642" class="idref" href="#e:642"><span class="id" title="binder">e</span></a> <a id="a:643" class="idref" href="#a:643"><span class="id" title="binder">a</span></a> <a id="v:644" class="idref" href="#v:644"><span class="id" title="binder">v</span></a> <a id="a':645" class="idref" href="#a':645"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:638"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:640"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:641"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:642"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:643"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:644"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:643"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':645"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs':639"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:640"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:641"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:642"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a':645"><span class="id" title="variable">a'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:644"><span class="id" title="variable">v</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> ? | ] | ] | ]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 6 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementLPC_None_inv" class="idref" href="#incrementLPC_None_inv"><span class="id" title="lemma">incrementLPC_None_inv</span></a> <a id="lregs:646" class="idref" href="#lregs:646"><span class="id" title="binder">lregs</span></a> <a id="pg:647" class="idref" href="#pg:647"><span class="id" title="binder">pg</span></a> <a id="b:648" class="idref" href="#b:648"><span class="id" title="binder">b</span></a> <a id="e:649" class="idref" href="#e:649"><span class="id" title="binder">e</span></a> <a id="a:650" class="idref" href="#a:650"><span class="id" title="binder">a</span></a> <a id="v:651" class="idref" href="#v:651"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:646"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:646"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pg:647"><span class="id" title="variable">pg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:648"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:649"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:650"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:651"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#a:650"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> ? | ] | ] |]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;incrementLPC_success_updatePC&nbsp;regs&nbsp;m&nbsp;etbl&nbsp;ecur&nbsp;regs'&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;incrementLPC&nbsp;regs&nbsp;=&nbsp;Some&nbsp;regs'&nbsp;-&gt;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;∃&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;a'&nbsp;(v&nbsp;:&nbsp;Version),&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regs&nbsp;!!&nbsp;PC&nbsp;=&nbsp;Some&nbsp;(LCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;v)&nbsp;∧&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updatePC&nbsp;{|&nbsp;reg&nbsp;:=&nbsp;(lreg_strip&nbsp;regs);&nbsp;mem&nbsp;:=&nbsp;m;&nbsp;etable&nbsp;:=&nbsp;etbl&nbsp;;&nbsp;enumcur&nbsp;:=&nbsp;ecur&nbsp;|}&nbsp;=&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;(NextI,&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|&nbsp;reg&nbsp;:=&nbsp;(&lt;<span class="inlinecode"><span class="id" title="var">PC</span>:=<span class="id" title="var">WCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span>&gt;&nbsp;(lreg_strip&nbsp;regs));&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mem&nbsp;:=&nbsp;m;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;etable&nbsp;:=&nbsp;etbl&nbsp;;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enumcur&nbsp;:=&nbsp;ecur&nbsp;|})&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧&nbsp;regs'&nbsp;=&nbsp;&lt;<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">PC</span></span> <span class="inlinecode">:=</span> <span class="inlinecode">(<span class="id" title="var">LCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">v</span>)</span> <span class="inlinecode"></span>&gt;&nbsp;regs.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intro&nbsp;Hincr.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;opose&nbsp;proof&nbsp;(incrementLPC_incrementPC_some&nbsp;_&nbsp;_&nbsp;Hincr)&nbsp;as&nbsp;HincrPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;eapply&nbsp;(incrementPC_success_updatePC&nbsp;_&nbsp;m&nbsp;etbl&nbsp;ecur)&nbsp;in&nbsp;HincrPC.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;HincrPC&nbsp;as&nbsp;(p'&amp;b'&amp;e'&amp;a''&amp;a'''&amp;Hregs&amp;Heq&amp;Hupd&amp;Hregseq).&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/incrementLPC&nbsp;in&nbsp;Hincr.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(regs&nbsp;!!&nbsp;PC)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">wpc</span></span> <span class="inlinecode">|</span>;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct_lword&nbsp;wpc;&nbsp;try&nbsp;done.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;/lreg_strip&nbsp;fmap_insert&nbsp;//=&nbsp;-/(lreg_strip&nbsp;regs)&nbsp;&nbsp;in&nbsp;Hregseq.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;exists&nbsp;p,&nbsp;b,&nbsp;e,&nbsp;a,&nbsp;a',&nbsp;v.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;repeat&nbsp;(split;&nbsp;try&nbsp;done).&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;rewrite&nbsp;Hupd&nbsp;Hregseq.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">incrementLPC_inv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_Some_inv"><span class="id" title="axiom">incrementLPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_None_inv"><span class="id" title="axiom">incrementLPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "incrementLPC_inv" "as" <span class="id" title="var">simple_intropattern</span>(<span class="id" title="var">pat</span>):=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_Some_inv"><span class="id" title="axiom">incrementLPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">pat</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC_None_inv"><span class="id" title="axiom">incrementLPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_rules_opt" class="idref" href="#cap_lang_rules_opt"><span class="id" title="section">cap_lang_rules_opt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H:652" class="idref" href="#H:652"><span class="id" title="binder">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="H0:654" class="idref" href="#H0:654"><span class="id" title="binder">memG</span></a> <a id="79724b30a3fa6e89e66494988b373344" class="idref" href="#79724b30a3fa6e89e66494988b373344"><span class="id" title="binder"><span id="H0:654" class="id">Σ</span></span></a>, <a id="H1:655" class="idref" href="#H1:655"><span class="id" title="binder">regG</span></a> <a id="H1:655" class="idref" href="#H1:655"><span class="id" title="binder">Σ</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">c</span> : <a class="idref" href="cap_machine.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="cap_machine.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">la</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lw</span>: <a class="idref" href="cap_machine.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <a class="idref" href="cap_machine.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lregs</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">mem</span> : <a class="idref" href="cap_machine.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lmem</span> : <a class="idref" href="cap_machine.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="wp_opt" class="idref" href="#wp_opt"><span class="id" title="definition">wp_opt</span></a> {<a id="A:656" class="idref" href="#A:656"><span class="id" title="binder">A</span></a>} (<a id="f48b5f738bae394f913a174b0c1c8437" class="idref" href="#f48b5f738bae394f913a174b0c1c8437"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:656"><span class="id" title="variable">A</span></a>) (<a id="4c63bff1a62054780dc771355bd8e46d" class="idref" href="#4c63bff1a62054780dc771355bd8e46d"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="10f42574e3a320251e0a97a6095000ea" class="idref" href="#10f42574e3a320251e0a97a6095000ea"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:656"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#f48b5f738bae394f913a174b0c1c8437"><span class="id" title="variable">φ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#4c63bff1a62054780dc771355bd8e46d"><span class="id" title="variable">Φf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> φ' =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#10f42574e3a320251e0a97a6095000ea"><span class="id" title="variable">Φs</span></a> φ'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_unfold" class="idref" href="#wp_opt_unfold"><span class="id" title="lemma">wp_opt_unfold</span></a> {<a id="A:661" class="idref" href="#A:661"><span class="id" title="binder">A</span></a>} {<a id="0fad72eae2c3dab355384eb7d7f14a50" class="idref" href="#0fad72eae2c3dab355384eb7d7f14a50"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:661"><span class="id" title="variable">A</span></a>} {<a id="f3aba1e670a38fde72157ea471408490" class="idref" href="#f3aba1e670a38fde72157ea471408490"><span class="id" title="binder">Φf</span></a> <a id="32291c699c72b17073cb8e579a608af8" class="idref" href="#32291c699c72b17073cb8e579a608af8"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#0fad72eae2c3dab355384eb7d7f14a50"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#f3aba1e670a38fde72157ea471408490"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:665" class="idref" href="#x:665"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#0fad72eae2c3dab355384eb7d7f14a50"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:665"><span class="id" title="variable">x</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#32291c699c72b17073cb8e579a608af8"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:665"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0fad72eae2c3dab355384eb7d7f14a50"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f3aba1e670a38fde72157ea471408490"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#32291c699c72b17073cb8e579a608af8"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; [<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>| <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_eqn" class="idref" href="#wp_opt_eqn"><span class="id" title="lemma">wp_opt_eqn</span></a> {<a id="A:666" class="idref" href="#A:666"><span class="id" title="binder">A</span></a>} (<a id="37082b7dd4dcbbd7a162cfe90d66020d" class="idref" href="#37082b7dd4dcbbd7a162cfe90d66020d"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:666"><span class="id" title="variable">A</span></a>) (<a id="00b447ccbf3b57cbab6f67d6e6f920e0" class="idref" href="#00b447ccbf3b57cbab6f67d6e6f920e0"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="23d1d59adbc5b29520d967464948e08b" class="idref" href="#23d1d59adbc5b29520d967464948e08b"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:666"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#37082b7dd4dcbbd7a162cfe90d66020d"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#00b447ccbf3b57cbab6f67d6e6f920e0"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x:670" class="idref" href="#x:670"><span class="id" title="binder">x</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#37082b7dd4dcbbd7a162cfe90d66020d"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:670"><span class="id" title="variable">x</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#23d1d59adbc5b29520d967464948e08b"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:670"><span class="id" title="variable">x</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#37082b7dd4dcbbd7a162cfe90d66020d"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#00b447ccbf3b57cbab6f67d6e6f920e0"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#23d1d59adbc5b29520d967464948e08b"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="var">cbn</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_is_Some" class="idref" href="#wp_opt_is_Some"><span class="id" title="lemma">wp_opt_is_Some</span></a> {<a id="A:671" class="idref" href="#A:671"><span class="id" title="binder">A</span></a> <a id="c779cd77469795bd5c46ba22d2b7250a" class="idref" href="#c779cd77469795bd5c46ba22d2b7250a"><span class="id" title="binder">Φs</span></a> <a id="3cc51e5418b2e88a006c2ce0dfa5287d" class="idref" href="#3cc51e5418b2e88a006c2ce0dfa5287d"><span class="id" title="binder">Φf</span></a>} {<a id="32503e3952a53bef96b623766e023aaf" class="idref" href="#32503e3952a53bef96b623766e023aaf"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:671"><span class="id" title="variable">A</span></a>} : <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.rules.rules_base.html#32503e3952a53bef96b623766e023aaf"><span class="id" title="variable">φ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#32503e3952a53bef96b623766e023aaf"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3cc51e5418b2e88a006c2ce0dfa5287d"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c779cd77469795bd5c46ba22d2b7250a"><span class="id" title="variable">Φs</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#32503e3952a53bef96b623766e023aaf"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">False</span> <a class="idref" href="cap_machine.rules.rules_base.html#c779cd77469795bd5c46ba22d2b7250a"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_univ" class="idref" href="#wp_opt_univ"><span class="id" title="lemma">wp_opt_univ</span></a> {<a id="A:675" class="idref" href="#A:675"><span class="id" title="binder">A</span></a> <a id="6140a82fb5ea70d2567fddb0d8cc4e80" class="idref" href="#6140a82fb5ea70d2567fddb0d8cc4e80"><span class="id" title="binder">Φs</span></a>} {<a id="33dfd0f6c8c54a088522f45e1abae69b" class="idref" href="#33dfd0f6c8c54a088522f45e1abae69b"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:675"><span class="id" title="variable">A</span></a>} : <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:678" class="idref" href="#x:678"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#6140a82fb5ea70d2567fddb0d8cc4e80"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:678"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#33dfd0f6c8c54a088522f45e1abae69b"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">True</span> <a class="idref" href="cap_machine.rules.rules_base.html#6140a82fb5ea70d2567fddb0d8cc4e80"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> φ.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_bind" class="idref" href="#wp_opt_bind"><span class="id" title="lemma">wp_opt_bind</span></a> {<a id="A:679" class="idref" href="#A:679"><span class="id" title="binder">A</span></a> <a id="B:680" class="idref" href="#B:680"><span class="id" title="binder">B</span></a>} {<a id="6886046587f6340f329b1d0df3d8e1f0" class="idref" href="#6886046587f6340f329b1d0df3d8e1f0"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:679"><span class="id" title="variable">A</span></a>} {<a id="K:682" class="idref" href="#K:682"><span class="id" title="binder">K</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:679"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B:680"><span class="id" title="variable">B</span></a>} {<a id="bd7869f751ac81ac608fea00490611dd" class="idref" href="#bd7869f751ac81ac608fea00490611dd"><span class="id" title="binder">Φf</span></a> <a id="0888a657d3a9ee0b5e3e82b90bc7d406" class="idref" href="#0888a657d3a9ee0b5e3e82b90bc7d406"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6886046587f6340f329b1d0df3d8e1f0"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bd7869f751ac81ac608fea00490611dd"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="66da164fd33921428a567bead75b9672" class="idref" href="#66da164fd33921428a567bead75b9672"><span class="id" title="binder">φ'</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#K:682"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#66da164fd33921428a567bead75b9672"><span class="id" title="variable">φ'</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#bd7869f751ac81ac608fea00490611dd"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0888a657d3a9ee0b5e3e82b90bc7d406"><span class="id" title="variable">Φs</span></a>) <span class="id" title="notation">⊣⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#6886046587f6340f329b1d0df3d8e1f0"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">≫=</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:682"><span class="id" title="variable">K</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#bd7869f751ac81ac608fea00490611dd"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0888a657d3a9ee0b5e3e82b90bc7d406"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt_mono" class="idref" href="#wp_opt_mono"><span class="id" title="lemma">wp_opt_mono</span></a> {<a id="A:686" class="idref" href="#A:686"><span class="id" title="binder">A</span></a>} {<a id="m:687" class="idref" href="#m:687"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:686"><span class="id" title="variable">A</span></a>} {<a id="42032cfe311fc1f8c595df53000833e6" class="idref" href="#42032cfe311fc1f8c595df53000833e6"><span class="id" title="binder">Φf</span></a> <a id="a2a916ee765b7c8794ea937e02cbca88" class="idref" href="#a2a916ee765b7c8794ea937e02cbca88"><span class="id" title="binder">Φs1</span></a> <a id="7dadf4f7eaabd7460d23745fab15ee6d" class="idref" href="#7dadf4f7eaabd7460d23745fab15ee6d"><span class="id" title="binder">Φs2</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:691" class="idref" href="#x:691"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a2a916ee765b7c8794ea937e02cbca88"><span class="id" title="variable">Φs1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:691"><span class="id" title="variable">x</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#7dadf4f7eaabd7460d23745fab15ee6d"><span class="id" title="variable">Φs2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:691"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#m:687"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#42032cfe311fc1f8c595df53000833e6"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a2a916ee765b7c8794ea937e02cbca88"><span class="id" title="variable">Φs1</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#m:687"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#42032cfe311fc1f8c595df53000833e6"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7dadf4f7eaabd7460d23745fab15ee6d"><span class="id" title="variable">Φs2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(HΦs &amp; Hwp)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "HΦs".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="wp_opt2" class="idref" href="#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> {<a id="A1:692" class="idref" href="#A1:692"><span class="id" title="binder">A1</span></a> <a id="A2:693" class="idref" href="#A2:693"><span class="id" title="binder">A2</span></a>} <a id="Ep:694" class="idref" href="#Ep:694"><span class="id" title="binder">Ep</span></a> (<a id="c94d0098b0ee0f16ee589f31f7445313" class="idref" href="#c94d0098b0ee0f16ee589f31f7445313"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:692"><span class="id" title="variable">A1</span></a>) (<a id="f97f7224adbbe14cddf609ed5046f01c" class="idref" href="#f97f7224adbbe14cddf609ed5046f01c"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:693"><span class="id" title="variable">A2</span></a>) (<a id="566afcfd8a741a2f442dbbe70c59cbfb" class="idref" href="#566afcfd8a741a2f442dbbe70c59cbfb"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="4c2bc4c352240a3fca0149e2219349ad" class="idref" href="#4c2bc4c352240a3fca0149e2219349ad"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:692"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:693"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#c94d0098b0ee0f16ee589f31f7445313"><span class="id" title="variable">φ1</span></a> , <a class="idref" href="cap_machine.rules.rules_base.html#f97f7224adbbe14cddf609ed5046f01c"><span class="id" title="variable">φ2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> , <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:694"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#566afcfd8a741a2f442dbbe70c59cbfb"><span class="id" title="variable">Φf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x1</span> , <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x2</span> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:694"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#4c2bc4c352240a3fca0149e2219349ad"><span class="id" title="variable">Φs</span></a> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:694"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <span class="id" title="notation">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_diag_univ" class="idref" href="#wp2_diag_univ"><span class="id" title="lemma">wp2_diag_univ</span></a> {<a id="A:701" class="idref" href="#A:701"><span class="id" title="binder">A</span></a>} {<a id="de0c2f0c74fbc61a3cb87962fd0c212e" class="idref" href="#de0c2f0c74fbc61a3cb87962fd0c212e"><span class="id" title="binder">φ</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:701"><span class="id" title="variable">A</span></a>} {<a id="Ep:703" class="idref" href="#Ep:703"><span class="id" title="binder">Ep</span></a> <a id="2b08dac20da0353d7a2fc1f21b930df0" class="idref" href="#2b08dac20da0353d7a2fc1f21b930df0"><span class="id" title="binder">Φf</span></a>} {<a id="ee4324e14eeb8dade6c888379a73b96f" class="idref" href="#ee4324e14eeb8dade6c888379a73b96f"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:701"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:701"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#2b08dac20da0353d7a2fc1f21b930df0"><span class="id" title="variable">Φf</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x:706" class="idref" href="#x:706"><span class="id" title="binder">x</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#ee4324e14eeb8dade6c888379a73b96f"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:706"><span class="id" title="variable">x</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:706"><span class="id" title="variable">x</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:703"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#de0c2f0c74fbc61a3cb87962fd0c212e"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#de0c2f0c74fbc61a3cb87962fd0c212e"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2b08dac20da0353d7a2fc1f21b930df0"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#ee4324e14eeb8dade6c888379a73b96f"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ; [<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span> | <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_wp2" class="idref" href="#wp_wp2"><span class="id" title="lemma">wp_wp2</span></a> {<a id="Ep:707" class="idref" href="#Ep:707"><span class="id" title="binder">Ep</span></a> <a id="A1:708" class="idref" href="#A1:708"><span class="id" title="binder">A1</span></a> <a id="A2:709" class="idref" href="#A2:709"><span class="id" title="binder">A2</span></a>} {<a id="f975a4cb217e1f5da4a5abb885cdb927" class="idref" href="#f975a4cb217e1f5da4a5abb885cdb927"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:708"><span class="id" title="variable">A1</span></a>} {<a id="8062c29160075c35e29f1ffc8ea4f475" class="idref" href="#8062c29160075c35e29f1ffc8ea4f475"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:709"><span class="id" title="variable">A2</span></a>} {<a id="66dc0e15df735d509f6b34b9ba602adc" class="idref" href="#66dc0e15df735d509f6b34b9ba602adc"><span class="id" title="binder">Φf</span></a> <a id="fae2f6f8a63c85ba195ed00c2c3ab9ee" class="idref" href="#fae2f6f8a63c85ba195ed00c2c3ab9ee"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:707"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f975a4cb217e1f5da4a5abb885cdb927"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8062c29160075c35e29f1ffc8ea4f475"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#66dc0e15df735d509f6b34b9ba602adc"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:714" class="idref" href="#x1:714"><span class="id" title="binder">x1</span></a> <a id="x2:715" class="idref" href="#x2:715"><span class="id" title="binder">x2</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#fae2f6f8a63c85ba195ed00c2c3ab9ee"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:715"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8062c29160075c35e29f1ffc8ea4f475"><span class="id" title="variable">φ2</span></a> (<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:707"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#66dc0e15df735d509f6b34b9ba602adc"><span class="id" title="variable">Φf</span></a>) (<span class="id" title="keyword">fun</span> <a id="x:716" class="idref" href="#x:716"><span class="id" title="binder">x</span></a> =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:707"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#fae2f6f8a63c85ba195ed00c2c3ab9ee"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:716"><span class="id" title="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1 , φ2; <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> "Hk" <span class="id" title="keyword">as</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_val" class="idref" href="#wp2_val"><span class="id" title="lemma">wp2_val</span></a> {<a id="A1:717" class="idref" href="#A1:717"><span class="id" title="binder">A1</span></a> <a id="A2:718" class="idref" href="#A2:718"><span class="id" title="binder">A2</span></a>} {<a id="x1:719" class="idref" href="#x1:719"><span class="id" title="binder">x1</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:717"><span class="id" title="variable">A1</span></a>} {<a id="x2:720" class="idref" href="#x2:720"><span class="id" title="binder">x2</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A2:718"><span class="id" title="variable">A2</span></a>} {<a id="c41d8ff9064060b32e5dfa700cbb4ada" class="idref" href="#c41d8ff9064060b32e5dfa700cbb4ada"><span class="id" title="binder">Φf</span></a> <a id="df71862bb4298264b08552e29ad922bb" class="idref" href="#df71862bb4298264b08552e29ad922bb"><span class="id" title="binder">Φs</span></a> <a id="Ep:723" class="idref" href="#Ep:723"><span class="id" title="binder">Ep</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:723"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#df71862bb4298264b08552e29ad922bb"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:719"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:720"><span class="id" title="variable">x2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:723"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:719"><span class="id" title="variable">x1</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:720"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#c41d8ff9064060b32e5dfa700cbb4ada"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df71862bb4298264b08552e29ad922bb"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_eqn" class="idref" href="#wp_opt2_eqn"><span class="id" title="lemma">wp_opt2_eqn</span></a> {<a id="Ep:724" class="idref" href="#Ep:724"><span class="id" title="binder">Ep</span></a>} {<a id="A1:725" class="idref" href="#A1:725"><span class="id" title="binder">A1</span></a> <a id="A2:726" class="idref" href="#A2:726"><span class="id" title="binder">A2</span></a>} {<a id="e833265df39b453237a81281cc10f7de" class="idref" href="#e833265df39b453237a81281cc10f7de"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:725"><span class="id" title="variable">A1</span></a>} {<a id="622cdc8c0dc6bbdda69edbec09253678" class="idref" href="#622cdc8c0dc6bbdda69edbec09253678"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:726"><span class="id" title="variable">A2</span></a>} (<a id="e3c9bf02377fbd6118cd08b8c2b27fef" class="idref" href="#e3c9bf02377fbd6118cd08b8c2b27fef"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="507615542346c16c333045d76bae469b" class="idref" href="#507615542346c16c333045d76bae469b"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:725"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:726"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:724"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e833265df39b453237a81281cc10f7de"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#622cdc8c0dc6bbdda69edbec09253678"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e3c9bf02377fbd6118cd08b8c2b27fef"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:731" class="idref" href="#x1:731"><span class="id" title="binder">x1</span></a> <a id="x2:732" class="idref" href="#x2:732"><span class="id" title="binder">x2</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#e833265df39b453237a81281cc10f7de"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:731"><span class="id" title="variable">x1</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#622cdc8c0dc6bbdda69edbec09253678"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:732"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#507615542346c16c333045d76bae469b"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:731"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:732"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:724"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e833265df39b453237a81281cc10f7de"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#622cdc8c0dc6bbdda69edbec09253678"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e3c9bf02377fbd6118cd08b8c2b27fef"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#507615542346c16c333045d76bae469b"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_eqn_both" class="idref" href="#wp_opt2_eqn_both"><span class="id" title="lemma">wp_opt2_eqn_both</span></a> {<a id="Ep:733" class="idref" href="#Ep:733"><span class="id" title="binder">Ep</span></a>} {<a id="A1:734" class="idref" href="#A1:734"><span class="id" title="binder">A1</span></a> <a id="A2:735" class="idref" href="#A2:735"><span class="id" title="binder">A2</span></a>} {<a id="b7ee910856ff3cd9d36121f9a365d733" class="idref" href="#b7ee910856ff3cd9d36121f9a365d733"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:734"><span class="id" title="variable">A1</span></a>} {<a id="16aec6f04d03759ebb498f5e4ac8f46f" class="idref" href="#16aec6f04d03759ebb498f5e4ac8f46f"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:735"><span class="id" title="variable">A2</span></a>} (<a id="20ff5b2ec705713a686457b220fca57d" class="idref" href="#20ff5b2ec705713a686457b220fca57d"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) (<a id="4c9a5de9a3a386489d6682820d7e32a9" class="idref" href="#4c9a5de9a3a386489d6682820d7e32a9"><span class="id" title="binder">Φs</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:734"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:735"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.rules.rules_base.html#4aab464b7a633c4b88ca9f9fc47f66b7"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:733"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b7ee910856ff3cd9d36121f9a365d733"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#16aec6f04d03759ebb498f5e4ac8f46f"><span class="id" title="variable">φ2</span></a> (<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#b7ee910856ff3cd9d36121f9a365d733"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#16aec6f04d03759ebb498f5e4ac8f46f"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#20ff5b2ec705713a686457b220fca57d"><span class="id" title="variable">Φf</span></a>) (<span class="id" title="keyword">fun</span> <a id="x1:740" class="idref" href="#x1:740"><span class="id" title="binder">x1</span></a> <a id="x2:741" class="idref" href="#x2:741"><span class="id" title="binder">x2</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#b7ee910856ff3cd9d36121f9a365d733"><span class="id" title="variable">φ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:740"><span class="id" title="variable">x1</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#16aec6f04d03759ebb498f5e4ac8f46f"><span class="id" title="variable">φ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:741"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">→</span> <a class="idref" href="cap_machine.rules.rules_base.html#4c9a5de9a3a386489d6682820d7e32a9"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:740"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:741"><span class="id" title="variable">x2</span></a>) <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:733"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b7ee910856ff3cd9d36121f9a365d733"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#16aec6f04d03759ebb498f5e4ac8f46f"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#20ff5b2ec705713a686457b220fca57d"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4c9a5de9a3a386489d6682820d7e32a9"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_mod" class="idref" href="#wp_opt2_mod"><span class="id" title="lemma">wp_opt2_mod</span></a> {<a id="Ep:742" class="idref" href="#Ep:742"><span class="id" title="binder">Ep</span></a>} {<a id="A1:743" class="idref" href="#A1:743"><span class="id" title="binder">A1</span></a> <a id="A2:744" class="idref" href="#A2:744"><span class="id" title="binder">A2</span></a>} {<a id="bcd22b0d6c09f82611eaf0db2f1705ad" class="idref" href="#bcd22b0d6c09f82611eaf0db2f1705ad"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:743"><span class="id" title="variable">A1</span></a>} {<a id="f01ffe68661da12fd0aae655a82dff07" class="idref" href="#f01ffe68661da12fd0aae655a82dff07"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:744"><span class="id" title="variable">A2</span></a>} {<a id="a71b11d9f13bb4f26fa8709d89608716" class="idref" href="#a71b11d9f13bb4f26fa8709d89608716"><span class="id" title="binder">Φf</span></a> <a id="6bad096d983ce2b70d1ade549bf1fac8" class="idref" href="#6bad096d983ce2b70d1ade549bf1fac8"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:742"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:742"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bcd22b0d6c09f82611eaf0db2f1705ad"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f01ffe68661da12fd0aae655a82dff07"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a71b11d9f13bb4f26fa8709d89608716"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6bad096d983ce2b70d1ade549bf1fac8"><span class="id" title="variable">Φs</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:742"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#bcd22b0d6c09f82611eaf0db2f1705ad"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#f01ffe68661da12fd0aae655a82dff07"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a71b11d9f13bb4f26fa8709d89608716"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6bad096d983ce2b70d1ade549bf1fac8"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "&gt;H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_bind" class="idref" href="#wp_opt2_bind"><span class="id" title="lemma">wp_opt2_bind</span></a> {<a id="Ep:749" class="idref" href="#Ep:749"><span class="id" title="binder">Ep</span></a>} {<a id="A1:750" class="idref" href="#A1:750"><span class="id" title="binder">A1</span></a> <a id="A2:751" class="idref" href="#A2:751"><span class="id" title="binder">A2</span></a>} {<a id="B1:752" class="idref" href="#B1:752"><span class="id" title="binder">B1</span></a> <a id="B2:753" class="idref" href="#B2:753"><span class="id" title="binder">B2</span></a>} {<a id="d1c8d2f2ddaa03ffa6b097276b187d43" class="idref" href="#d1c8d2f2ddaa03ffa6b097276b187d43"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:750"><span class="id" title="variable">A1</span></a>} {<a id="8c52a56468e7c9dd234b034c214dbd95" class="idref" href="#8c52a56468e7c9dd234b034c214dbd95"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:751"><span class="id" title="variable">A2</span></a>} {<a id="k1:756" class="idref" href="#k1:756"><span class="id" title="binder">k1</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A1:750"><span class="id" title="variable">A1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B1:752"><span class="id" title="variable">B1</span></a>} {<a id="k2:757" class="idref" href="#k2:757"><span class="id" title="binder">k2</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A2:751"><span class="id" title="variable">A2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#B2:753"><span class="id" title="variable">B2</span></a>} {<a id="4db54b022d62309117385cef72ac3d0d" class="idref" href="#4db54b022d62309117385cef72ac3d0d"><span class="id" title="binder">Φf</span></a> <a id="d94c24b19c6c9a9d8dc393d43f7451e2" class="idref" href="#d94c24b19c6c9a9d8dc393d43f7451e2"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:749"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d1c8d2f2ddaa03ffa6b097276b187d43"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8c52a56468e7c9dd234b034c214dbd95"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4db54b022d62309117385cef72ac3d0d"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="x1:760" class="idref" href="#x1:760"><span class="id" title="binder">x1</span></a> <a id="x2:761" class="idref" href="#x2:761"><span class="id" title="binder">x2</span></a> =&gt; <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:749"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#k1:756"><span class="id" title="variable">k1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:760"><span class="id" title="variable">x1</span></a>) (<a class="idref" href="cap_machine.rules.rules_base.html#k2:757"><span class="id" title="variable">k2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:761"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#4db54b022d62309117385cef72ac3d0d"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d94c24b19c6c9a9d8dc393d43f7451e2"><span class="id" title="variable">Φs</span></a>) <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:749"><span class="id" title="variable">Ep</span></a> (<a id="x1:763" class="idref" href="#x1:763"><span class="id" title="binder">x1</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#d1c8d2f2ddaa03ffa6b097276b187d43"><span class="id" title="variable">φ1</span></a> <span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#k1:756"><span class="id" title="variable">k1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:763"><span class="id" title="variable">x1</span></a>) (<a id="x2:762" class="idref" href="#x2:762"><span class="id" title="binder">x2</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.rules.rules_base.html#8c52a56468e7c9dd234b034c214dbd95"><span class="id" title="variable">φ2</span></a> <span class="id" title="notation">;</span> <a class="idref" href="cap_machine.rules.rules_base.html#k2:757"><span class="id" title="variable">k2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:762"><span class="id" title="variable">x2</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#4db54b022d62309117385cef72ac3d0d"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d94c24b19c6c9a9d8dc393d43f7451e2"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_mod"><span class="id" title="axiom">wp_opt2_mod</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">now</span> <span class="id" title="var">iMod</span> "Hk" <span class="id" title="keyword">as</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_opt2_mono" class="idref" href="#wp_opt2_mono"><span class="id" title="lemma">wp_opt2_mono</span></a> {<a id="Ep:764" class="idref" href="#Ep:764"><span class="id" title="binder">Ep</span></a>} {<a id="A1:765" class="idref" href="#A1:765"><span class="id" title="binder">A1</span></a> <a id="A2:766" class="idref" href="#A2:766"><span class="id" title="binder">A2</span></a>} {<a id="fb017f83164a8d2f4bda14b52c848ae4" class="idref" href="#fb017f83164a8d2f4bda14b52c848ae4"><span class="id" title="binder">φ1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A1:765"><span class="id" title="variable">A1</span></a>} {<a id="87e2c1ff912c174083cf3778b2ad9114" class="idref" href="#87e2c1ff912c174083cf3778b2ad9114"><span class="id" title="binder">φ2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A2:766"><span class="id" title="variable">A2</span></a>} {<a id="7e2f3beb0b3fdd62a3d752dac98facba" class="idref" href="#7e2f3beb0b3fdd62a3d752dac98facba"><span class="id" title="binder">Φf</span></a> <a id="a24e93a8fc6d0e133c7f0a389c82e14b" class="idref" href="#a24e93a8fc6d0e133c7f0a389c82e14b"><span class="id" title="binder">Φsa</span></a> <a id="d552ff00cafee90b2b77beb720edffd2" class="idref" href="#d552ff00cafee90b2b77beb720edffd2"><span class="id" title="binder">Φsb</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="x1:772" class="idref" href="#x1:772"><span class="id" title="binder">x1</span></a> <a id="x2:773" class="idref" href="#x2:773"><span class="id" title="binder">x2</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#a24e93a8fc6d0e133c7f0a389c82e14b"><span class="id" title="variable">Φsa</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:772"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:773"><span class="id" title="variable">x2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#d552ff00cafee90b2b77beb720edffd2"><span class="id" title="variable">Φsb</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x1:772"><span class="id" title="variable">x1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x2:773"><span class="id" title="variable">x2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:764"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fb017f83164a8d2f4bda14b52c848ae4"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#87e2c1ff912c174083cf3778b2ad9114"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7e2f3beb0b3fdd62a3d752dac98facba"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a24e93a8fc6d0e133c7f0a389c82e14b"><span class="id" title="variable">Φsa</span></a> <span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:764"><span class="id" title="variable">Ep</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#fb017f83164a8d2f4bda14b52c848ae4"><span class="id" title="variable">φ1</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#87e2c1ff912c174083cf3778b2ad9114"><span class="id" title="variable">φ2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7e2f3beb0b3fdd62a3d752dac98facba"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d552ff00cafee90b2b77beb720edffd2"><span class="id" title="variable">Φsb</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> φ1, φ2; <span class="id" title="var">cbn</span>; <span class="id" title="var">iIntros</span> "(Hab &amp; Hwp)"; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hab".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_instr_exec_opt" class="idref" href="#wp_instr_exec_opt"><span class="id" title="lemma">wp_instr_exec_opt</span></a> {<a id="s:774" class="idref" href="#s:774"><span class="id" title="binder">s</span></a> <a id="E:775" class="idref" href="#E:775"><span class="id" title="binder">E</span></a> <a id="e7662e2e69d427540e59923737ecb516" class="idref" href="#e7662e2e69d427540e59923737ecb516"><span class="id" title="binder">Φ</span></a> <a id="pc_a:777" class="idref" href="#pc_a:777"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:778" class="idref" href="#pc_v:778"><span class="id" title="binder">pc_v</span></a> <a id="dq:779" class="idref" href="#dq:779"><span class="id" title="binder">dq</span></a> <a id="regs:780" class="idref" href="#regs:780"><span class="id" title="binder">regs</span></a> <a id="lw:781" class="idref" href="#lw:781"><span class="id" title="binder">lw</span></a> <a id="pc_p:782" class="idref" href="#pc_p:782"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:783" class="idref" href="#pc_b:783"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:784" class="idref" href="#pc_e:784"><span class="id" title="binder">pc_e</span></a> <a id="instr:785" class="idref" href="#instr:785"><span class="id" title="binder">instr</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:782"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:783"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:784"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:777"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:778"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:780"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:782"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:783"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:784"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:777"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:778"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:781"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:785"><span class="id" title="variable">instr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of"><span class="id" title="definition">regs_of</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:785"><span class="id" title="variable">instr</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:780"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:777"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:778"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:779"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:781"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:786" class="idref" href="#k:786"><span class="id" title="binder"><span id="k:787" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:788" class="idref" href="#y:788"><span class="id" title="binder"><span id="y:789" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:780"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:786"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:788"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="8782678765d1d713289a654802c53733" class="idref" href="#8782678765d1d713289a654802c53733"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8782678765d1d713289a654802c53733"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:791" class="idref" href="#k:791"><span class="id" title="binder"><span id="k:792" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:793" class="idref" href="#y:793"><span class="id" title="binder"><span id="y:794" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:780"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:791"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:793"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#pc_a:777"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_v:778"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dq:779"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:781"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:775"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="wa:795" class="idref" href="#wa:795"><span class="id" title="binder">wa</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8782678765d1d713289a654802c53733"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:782"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:783"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:784"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:777"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8782678765d1d713289a654802c53733"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:777"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wa:795"><span class="id" title="variable">wa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#isCorrectPC"><span class="id" title="inductive">isCorrectPC</span></a> (<a class="idref" href="cap_machine.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_p:782"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_b:783"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_e:784"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#pc_a:777"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_parameters.html#decodeInstrW"><span class="id" title="definition">decodeInstrW</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#wa:795"><span class="id" title="variable">wa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:785"><span class="id" title="variable">instr</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:775"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.cap_lang.html#exec_opt"><span class="id" title="definition">exec_opt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#instr:785"><span class="id" title="variable">instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8782678765d1d713289a654802c53733"><span class="id" title="variable">σ1</span></a>) (<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:775"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8782678765d1d713289a654802c53733"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#e7662e2e69d427540e59923737ecb516"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> (<a id="c2:796" class="idref" href="#c2:796"><span class="id" title="binder">c2</span></a> : <a class="idref" href="cap_machine.cap_lang.html#Conf"><span class="id" title="definition">Conf</span></a>) =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#E:775"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=&gt;</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c2:796"><span class="id" title="variable">c2</span></a><span class="id" title="notation">.2</span> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.rules.rules_base.html#e7662e2e69d427540e59923737ecb516"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c2:796"><span class="id" title="variable">c2</span></a><span class="id" title="notation">.1</span>))<span class="id" title="notation">)</span>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.rules.rules_base.html#s:774"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#E:775"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#e7662e2e69d427540e59923737ecb516"><span class="id" title="variable">Φ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcorrpc</span> <span class="id" title="var">Hregspc</span> <span class="id" title="var">Hdecode</span> <span class="id" title="var">Hregs_incl</span>) "(&gt;Hcode &amp; &gt;Hregs &amp; H)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_instr_exec"><span class="id" title="axiom">wp_instr_exec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1) "Hσ1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregsincl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">Hregs_pc</span> := <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hregspc</span> <span class="id" title="var">Hregsincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hcode"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlcode</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">Hstep</span>) "Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="notation">{|</span> <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="var">reg</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <span class="id" title="var">mem</span>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <span class="id" title="var">etable</span>; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <span class="id" title="var">enumcur</span> <span class="id" title="notation">|}</span> <span class="id" title="notation">with</span> "[Hr Hm $Hregs $Hcode]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;allow&nbsp;changing&nbsp;cur_map?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word_cap"><span class="id" title="axiom">state_corresponds_reg_get_word_cap</span></a> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_correct_PC"><span class="id" title="axiom">state_corresponds_mem_correct_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <span class="id" title="var">lw</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "[%] Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>) <span class="id" title="var">HLinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_get_word"><span class="id" title="axiom">state_corresponds_mem_get_word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span> <span class="id" title="var">lw</span> <span class="id" title="var">HLinv</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a> ; [ <span class="id" title="tactic">apply</span> <span class="id" title="var">HLinv</span> | | | | <span class="id" title="tactic">apply</span> <span class="id" title="var">Hregs_pc</span> | ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.machine_base.html#isCorrectPC_withinBounds"><span class="id" title="axiom">isCorrectPC_withinBounds</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcorrpc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.cap_lang.html#exec"><span class="id" title="definition">exec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.cap_lang.html#exec_opt"><span class="id" title="definition">exec_opt</span></a> <span class="id" title="var">instr</span> {| <a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="var">reg</span>; <a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <span class="id" title="var">mem</span>; <a class="idref" href="cap_machine.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <span class="id" title="var">etable</span>; <a class="idref" href="cap_machine.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <span class="id" title="var">enumcur</span> |});<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_opt_updatePC&nbsp;{φ&nbsp;Φs&nbsp;Φf&nbsp;w&nbsp;E}:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;reg&nbsp;φ&nbsp;!!&nbsp;PC&nbsp;=&nbsp;Some&nbsp;w&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;a',&nbsp;⌜&nbsp;w&nbsp;=&nbsp;WCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;⌝&nbsp;-∗&nbsp;⌜&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(⌜&nbsp;incrementPC&nbsp;(reg&nbsp;φ)&nbsp;=&nbsp;None&nbsp;⌝&nbsp;-∗&nbsp;Φf)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⊢&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;|={E}=&gt;&nbsp;wp_opt&nbsp;(updatePC&nbsp;φ)&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;updatePC,&nbsp;incrementPC.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(-&gt;)&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;w&nbsp;eqn:Heqw;&nbsp;iFrame;&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;destruct&nbsp;sb&nbsp;eqn:Heqsb;&nbsp;iFrame;&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;destruct&nbsp;(f1&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{rewrite&nbsp;bi.and_elim_l.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;}&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;bi.and_elim_r.&nbsp;now&nbsp;iApply&nbsp;"Hsf".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_phys_log_corresponds_update_reg" class="idref" href="#state_phys_log_corresponds_update_reg"><span class="id" title="lemma">state_phys_log_corresponds_update_reg</span></a> {<a id="reg:797" class="idref" href="#reg:797"><span class="id" title="binder">reg</span></a> <a id="mem:798" class="idref" href="#mem:798"><span class="id" title="binder">mem</span></a> <a id="lr:799" class="idref" href="#lr:799"><span class="id" title="binder">lr</span></a> <a id="lm:800" class="idref" href="#lm:800"><span class="id" title="binder">lm</span></a> <a id="cur_map:801" class="idref" href="#cur_map:801"><span class="id" title="binder">cur_map</span></a> <a id="i:802" class="idref" href="#i:802"><span class="id" title="binder">i</span></a> <a id="w:803" class="idref" href="#w:803"><span class="id" title="binder">w</span></a> <a id="lw:804" class="idref" href="#lw:804"><span class="id" title="binder">lw</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:804"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:803"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:804"><span class="id" title="variable">lw</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:801"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#reg:797"><span class="id" title="variable">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#mem:798"><span class="id" title="variable">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:799"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:800"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:801"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#i:802"><span class="id" title="variable">i</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#w:803"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">reg</span>) <a class="idref" href="cap_machine.rules.rules_base.html#mem:798"><span class="id" title="variable">mem</span></a> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.rules.rules_base.html#i:802"><span class="id" title="variable">i</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.rules.rules_base.html#lw:804"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:800"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:801"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hlw</span> <span class="id" title="var">Hcw</span> ((<span class="id" title="var">HLreg</span> &amp; <span class="id" title="var">HLcurreg</span>) &amp; <span class="id" title="var">HLmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.logical_mapsto.html#lreg_strip"><span class="id" title="definition">lreg_strip</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fmap_insert</span> <span class="id" title="var">HLreg</span> <span class="id" title="var">Hlw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">map_Forall_insert_2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_insert_dec" class="idref" href="#lookup_insert_dec"><span class="id" title="lemma">lookup_insert_dec</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">forall</span> <span class="id" title="notation">{</span><a id="K:805" class="idref" href="#K:805"><span class="id" title="binder">K</span></a> : <span class="id" title="keyword">Type</span>} {<a id="M:806" class="idref" href="#M:806"><span class="id" title="binder">M</span></a> : <span class="id" title="notation">forall</span> <span class="id" title="var">_</span> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="keyword">Type</span>} {<a id="H:807" class="idref" href="#H:807"><span class="id" title="binder">H</span></a> : <span class="id" title="class">FMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:806"><span class="id" title="variable">M</span></a>} {<a id="H0:809" class="idref" href="#H0:809"><span class="id" title="binder">H0</span></a> : <span class="id" title="notation">forall</span> <a id="A:808" class="idref" href="#A:808"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">Lookup</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:805"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:808"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:806"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:808"><span class="id" title="variable">A</span></a>)}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H1:811" class="idref" href="#H1:811"><span class="id" title="binder">H1</span></a> : <span class="id" title="notation">forall</span> <a id="A:810" class="idref" href="#A:810"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">Empty</span> (<a class="idref" href="cap_machine.rules.rules_base.html#M:806"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:810"><span class="id" title="variable">A</span></a>)} {<a id="H2:813" class="idref" href="#H2:813"><span class="id" title="binder">H2</span></a> : <span class="id" title="notation">forall</span> <a id="A:812" class="idref" href="#A:812"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">PartialAlter</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:805"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:812"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:806"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:812"><span class="id" title="variable">A</span></a>)} {<a id="H3:814" class="idref" href="#H3:814"><span class="id" title="binder">H3</span></a> : <span class="id" title="class">OMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:806"><span class="id" title="variable">M</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H4:815" class="idref" href="#H4:815"><span class="id" title="binder">H4</span></a> : <span class="id" title="class">Merge</span> <a class="idref" href="cap_machine.rules.rules_base.html#M:806"><span class="id" title="variable">M</span></a>} {<a id="H5:817" class="idref" href="#H5:817"><span class="id" title="binder">H5</span></a> : <span class="id" title="notation">forall</span> <a id="A:816" class="idref" href="#A:816"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span><span class="id" title="notation">,</span> <span class="id" title="class">MapFold</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:805"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:816"><span class="id" title="variable">A</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#M:806"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:816"><span class="id" title="variable">A</span></a>)} {<a id="EqDecision0:818" class="idref" href="#EqDecision0:818"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="class">RelDecision</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">_</span> : <span class="id" title="class">FinMap</span> <a class="idref" href="cap_machine.rules.rules_base.html#K:805"><span class="id" title="variable">K</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#M:806"><span class="id" title="variable">M</span></a>} {<a id="A:819" class="idref" href="#A:819"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>} {<a id="m:820" class="idref" href="#m:820"><span class="id" title="binder">m</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#M:806"><span class="id" title="variable">M</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#A:819"><span class="id" title="variable">A</span></a>} {<a id="i:821" class="idref" href="#i:821"><span class="id" title="binder">i</span></a> <a id="j:822" class="idref" href="#j:822"><span class="id" title="binder">j</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#K:805"><span class="id" title="variable">K</span></a>} {<a id="x:823" class="idref" href="#x:823"><span class="id" title="binder">x</span></a> <a id="y:824" class="idref" href="#y:824"><span class="id" title="binder">y</span></a> : <a class="idref" href="cap_machine.rules.rules_base.html#A:819"><span class="id" title="variable">A</span></a><span class="id" title="notation">},</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#m:820"><span class="id" title="variable">m</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#j:822"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:824"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#i:821"><span class="id" title="variable">i</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#x:823"><span class="id" title="variable">x</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">m</span><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#j:822"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">(</span></a><span class="id" title="definition">bool_decide</span> (<a class="idref" href="cap_machine.rules.rules_base.html#i:821"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#j:822"><span class="id" title="variable">j</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#x:823"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:824"><span class="id" title="variable">y</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="lemma">bool_decide_reflect</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">j</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">subst</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_corr" class="idref" href="#state_interp_transient_corr"><span class="id" title="lemma">state_interp_transient_corr</span></a> {<a id="491be61ad67bb2bcadb526cde93961b8" class="idref" href="#491be61ad67bb2bcadb526cde93961b8"><span class="id" title="binder">φ</span></a> <a id="e63b39f398d604a2762c571d643695c2" class="idref" href="#e63b39f398d604a2762c571d643695c2"><span class="id" title="binder">φ</span></a><a id="e63b39f398d604a2762c571d643695c2" class="idref" href="#e63b39f398d604a2762c571d643695c2"><span class="id" title="binder">t</span></a> <a id="lr:827" class="idref" href="#lr:827"><span class="id" title="binder">lr</span></a> <a id="lrt:828" class="idref" href="#lrt:828"><span class="id" title="binder">lrt</span></a> <a id="lm:829" class="idref" href="#lm:829"><span class="id" title="binder">lm</span></a> <a id="lmt:830" class="idref" href="#lmt:830"><span class="id" title="binder">lmt</span></a> <a id="df:831" class="idref" href="#df:831"><span class="id" title="binder">df</span></a> <a id="dft:832" class="idref" href="#dft:832"><span class="id" title="binder">dft</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#491be61ad67bb2bcadb526cde93961b8"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e63b39f398d604a2762c571d643695c2"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e63b39f398d604a2762c571d643695c2"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:827"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:828"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:829"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:830"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:831"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:832"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="lreg_t:833" class="idref" href="#lreg_t:833"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:834" class="idref" href="#lmem_t:834"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:835" class="idref" href="#cur_map:835"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:828"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:833"><span class="id" title="variable">lreg_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:830"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:834"><span class="id" title="variable">lmem_t</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e63b39f398d604a2762c571d643695c2"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e63b39f398d604a2762c571d643695c2"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#e63b39f398d604a2762c571d643695c2"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#e63b39f398d604a2762c571d643695c2"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lreg_t:833"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem_t:834"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:835"><span class="id" title="variable">cur_map</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "(Hσ &amp; Hregs &amp; Hmem &amp; %Hres &amp; Hcommit)".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_reg_lookup&nbsp;lrt&nbsp;{r&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;Φs&nbsp;Φf}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(lrt&nbsp;!!&nbsp;r)&nbsp;False&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;lwr&nbsp;=&gt;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;-∗&nbsp;Φs&nbsp;(lword_get_word&nbsp;lwr)))&nbsp;⊢&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(reg&nbsp;φt&nbsp;!!&nbsp;r)&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;"(Hσr&nbsp;&amp;&nbsp;Hk)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iPoseProof&nbsp;(state_interp_regs_transient_corr&nbsp;with&nbsp;"Hσr")&nbsp;as&nbsp;"*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(lrt&nbsp;!!&nbsp;r)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">lwr</span>|</span>&nbsp;eqn:Heqr&nbsp;;&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;map_subseteq_spec&nbsp;in&nbsp;Hregs_incl.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;erewrite&nbsp;Hregs_incl.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;iApply&nbsp;"Hk".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;rewrite&nbsp;lookup_fmap&nbsp;Heqr.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup" class="idref" href="#wp2_reg_lookup"><span class="id" title="lemma">wp2_reg_lookup</span></a> {<a id="Ep:836" class="idref" href="#Ep:836"><span class="id" title="binder">Ep</span></a>} {<a id="lrt:837" class="idref" href="#lrt:837"><span class="id" title="binder">lrt</span></a> <a id="lmt:838" class="idref" href="#lmt:838"><span class="id" title="binder">lmt</span></a> <a id="dft:839" class="idref" href="#dft:839"><span class="id" title="binder">dft</span></a> <a id="r:840" class="idref" href="#r:840"><span class="id" title="binder">r</span></a> <a id="a0881b830a8da9e42d938ae296e98c0b" class="idref" href="#a0881b830a8da9e42d938ae296e98c0b"><span class="id" title="binder">φ</span></a> <a id="8386074204ed99348db2e593422628a9" class="idref" href="#8386074204ed99348db2e593422628a9"><span class="id" title="binder">φ</span></a><a id="8386074204ed99348db2e593422628a9" class="idref" href="#8386074204ed99348db2e593422628a9"><span class="id" title="binder">t</span></a> <a id="lr:843" class="idref" href="#lr:843"><span class="id" title="binder">lr</span></a> <a id="lm:844" class="idref" href="#lm:844"><span class="id" title="binder">lm</span></a> <a id="df:845" class="idref" href="#df:845"><span class="id" title="binder">df</span></a> <a id="af6114cdaae591ca52b9e14745d39fe6" class="idref" href="#af6114cdaae591ca52b9e14745d39fe6"><span class="id" title="binder">Φs</span></a> <a id="5bc3621d67c3e506edb36a2b14a02e12" class="idref" href="#5bc3621d67c3e506edb36a2b14a02e12"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#r:840"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:837"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0881b830a8da9e42d938ae296e98c0b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:843"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:837"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:844"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:838"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:845"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:839"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lwr:848" class="idref" href="#lwr:848"><span class="id" title="binder">lwr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a0881b830a8da9e42d938ae296e98c0b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:843"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:837"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:844"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:838"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:845"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:839"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#af6114cdaae591ca52b9e14745d39fe6"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwr:848"><span class="id" title="variable">lwr</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwr:848"><span class="id" title="variable">lwr</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:836"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#lrt:837"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:840"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#8386074204ed99348db2e593422628a9"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:840"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#5bc3621d67c3e506edb36a2b14a02e12"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#af6114cdaae591ca52b9e14745d39fe6"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient_corr"><span class="id" title="axiom">state_interp_transient_corr</span></a> <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%HInv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HInv</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lregs_t</span> &amp; <span class="id" title="var">lmem_t</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hregs_incl</span> &amp; <span class="id" title="var">Hmem_incl</span> &amp; <span class="id" title="var">HInv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="method">elem_of_dom</span> <span class="id" title="var">lrt</span> <span class="id" title="var">r</span>) <span class="id" title="var">Hdom</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">lrw</span> &amp; <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_subseteq_spec</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hregs_incl</span> <span class="id" title="var">r</span> <span class="id" title="var">lrw</span> <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hregs_incl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">Hregs_incl</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_word_of_argument&nbsp;{src&nbsp;lw&nbsp;Φf&nbsp;Φs&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;regs_of_argument&nbsp;src&nbsp;⊆&nbsp;dom&nbsp;lrt&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(word_of_argumentL&nbsp;lrt&nbsp;src)&nbsp;False&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;lw&nbsp;=&gt;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;-∗&nbsp;Φs&nbsp;(lword_get_word&nbsp;lw))&nbsp;⊢&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wp_opt&nbsp;(word_of_argument&nbsp;(reg&nbsp;φt)&nbsp;src)&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(Hdom)&nbsp;"(Hσr&nbsp;&amp;&nbsp;HΦs)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;src&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">z</span>|<span class="id" title="var">r</span></span>;&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;iApply&nbsp;("HΦs"&nbsp;with&nbsp;"Hσr").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;now&nbsp;iApply&nbsp;(wp_reg_lookup&nbsp;lrt&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">H</span>σ<span class="id" title="var">r</span></span> <span class="inlinecode">$<span class="id" title="var">HΦs</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_word_of_argument" class="idref" href="#wp2_word_of_argument"><span class="id" title="lemma">wp2_word_of_argument</span></a> {<a id="Ep:849" class="idref" href="#Ep:849"><span class="id" title="binder">Ep</span></a>} {<a id="src:850" class="idref" href="#src:850"><span class="id" title="binder">src</span></a> <a id="lw:851" class="idref" href="#lw:851"><span class="id" title="binder">lw</span></a> <a id="54425734511b516968e033a63b0a82c3" class="idref" href="#54425734511b516968e033a63b0a82c3"><span class="id" title="binder">Φf</span></a> <a id="72b9a6ff87edecc9234e3517d8594011" class="idref" href="#72b9a6ff87edecc9234e3517d8594011"><span class="id" title="binder">Φs</span></a> <a id="61a72dc844821cd00249377f7158a7d6" class="idref" href="#61a72dc844821cd00249377f7158a7d6"><span class="id" title="binder">φ</span></a> <a id="09841143e45445ef210263f8ab1a9660" class="idref" href="#09841143e45445ef210263f8ab1a9660"><span class="id" title="binder">φ</span></a><a id="09841143e45445ef210263f8ab1a9660" class="idref" href="#09841143e45445ef210263f8ab1a9660"><span class="id" title="binder">t</span></a> <a id="lr:856" class="idref" href="#lr:856"><span class="id" title="binder">lr</span></a> <a id="lrt:857" class="idref" href="#lrt:857"><span class="id" title="binder">lrt</span></a> <a id="lm:858" class="idref" href="#lm:858"><span class="id" title="binder">lm</span></a> <a id="lmt:859" class="idref" href="#lmt:859"><span class="id" title="binder">lmt</span></a> <a id="df:860" class="idref" href="#df:860"><span class="id" title="binder">df</span></a> <a id="dft:861" class="idref" href="#dft:861"><span class="id" title="binder">dft</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:850"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:857"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#61a72dc844821cd00249377f7158a7d6"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#09841143e45445ef210263f8ab1a9660"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#09841143e45445ef210263f8ab1a9660"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:856"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:857"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:858"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:859"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:860"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:861"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lw:862" class="idref" href="#lw:862"><span class="id" title="binder">lw</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#61a72dc844821cd00249377f7158a7d6"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#09841143e45445ef210263f8ab1a9660"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#09841143e45445ef210263f8ab1a9660"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:856"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:857"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:858"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:859"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:860"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:861"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#72b9a6ff87edecc9234e3517d8594011"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:862"><span class="id" title="variable">lw</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:862"><span class="id" title="variable">lw</span></a>)<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:849"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:857"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:850"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#word_of_argument"><span class="id" title="definition">word_of_argument</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#09841143e45445ef210263f8ab1a9660"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#09841143e45445ef210263f8ab1a9660"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:850"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#54425734511b516968e033a63b0a82c3"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#72b9a6ff87edecc9234e3517d8594011"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσr &amp; HΦs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span>|<span class="id" title="var">r</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"HΦs" <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hσr $HΦs]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_word_get_cap" class="idref" href="#wp2_word_get_cap"><span class="id" title="lemma">wp2_word_get_cap</span></a> {<a id="Ep:863" class="idref" href="#Ep:863"><span class="id" title="binder">Ep</span></a>} {<a id="w:864" class="idref" href="#w:864"><span class="id" title="binder">w</span></a> <a id="61c0b0961c16530fec8c80d784172fb3" class="idref" href="#61c0b0961c16530fec8c80d784172fb3"><span class="id" title="binder">Φf</span></a> <a id="2132b4acaf10c3745366184f36555d46" class="idref" href="#2132b4acaf10c3745366184f36555d46"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#61c0b0961c16530fec8c80d784172fb3"><span class="id" title="variable">Φf</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="p:867" class="idref" href="#p:867"><span class="id" title="binder">p</span></a> <a id="b:868" class="idref" href="#b:868"><span class="id" title="binder">b</span></a> <a id="e:869" class="idref" href="#e:869"><span class="id" title="binder">e</span></a> <a id="a:870" class="idref" href="#a:870"><span class="id" title="binder">a</span></a> <a id="v:871" class="idref" href="#v:871"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#2132b4acaf10c3745366184f36555d46"><span class="id" title="variable">Φs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#p:867"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:868"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:869"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:870"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:871"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#p:867"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:868"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:869"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:870"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:863"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_cap"><span class="id" title="definition">lword_get_cap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:864"><span class="id" title="variable">w</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#get_wcap"><span class="id" title="definition">get_wcap</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#w:864"><span class="id" title="variable">w</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#61c0b0961c16530fec8c80d784172fb3"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2132b4acaf10c3745366184f36555d46"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span> | [<span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span> | <span class="id" title="var">x</span>] | <span class="id" title="var">w</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_mem_lookup" class="idref" href="#wp2_mem_lookup"><span class="id" title="lemma">wp2_mem_lookup</span></a> {<a id="Ep:872" class="idref" href="#Ep:872"><span class="id" title="binder">Ep</span></a>} {<a id="lrt:873" class="idref" href="#lrt:873"><span class="id" title="binder">lrt</span></a> <a id="lmt:874" class="idref" href="#lmt:874"><span class="id" title="binder">lmt</span></a> <a id="dft:875" class="idref" href="#dft:875"><span class="id" title="binder">dft</span></a> <a id="2f6035c7b47a6c19bb3ff468a6957d36" class="idref" href="#2f6035c7b47a6c19bb3ff468a6957d36"><span class="id" title="binder">φ</span></a> <a id="3cfdcd08e0efe459fc578cd7a1d9a4d7" class="idref" href="#3cfdcd08e0efe459fc578cd7a1d9a4d7"><span class="id" title="binder">φ</span></a><a id="3cfdcd08e0efe459fc578cd7a1d9a4d7" class="idref" href="#3cfdcd08e0efe459fc578cd7a1d9a4d7"><span class="id" title="binder">t</span></a> <a id="lr:878" class="idref" href="#lr:878"><span class="id" title="binder">lr</span></a> <a id="lm:879" class="idref" href="#lm:879"><span class="id" title="binder">lm</span></a> <a id="df:880" class="idref" href="#df:880"><span class="id" title="binder">df</span></a> <a id="73ce3aa42fb82bbf51e6aa664e8fc2d5" class="idref" href="#73ce3aa42fb82bbf51e6aa664e8fc2d5"><span class="id" title="binder">Φs</span></a> <a id="61ef637d8b3736cb725f75270a059721" class="idref" href="#61ef637d8b3736cb725f75270a059721"><span class="id" title="binder">Φf</span></a> <a id="r:883" class="idref" href="#r:883"><span class="id" title="binder">r</span></a> <a id="p:884" class="idref" href="#p:884"><span class="id" title="binder">p</span></a> <a id="b:885" class="idref" href="#b:885"><span class="id" title="binder">b</span></a> <a id="e:886" class="idref" href="#e:886"><span class="id" title="binder">e</span></a> <a id="a:887" class="idref" href="#a:887"><span class="id" title="binder">a</span></a> <a id="v:888" class="idref" href="#v:888"><span class="id" title="binder">v</span></a> <a id="lwa:889" class="idref" href="#lwa:889"><span class="id" title="binder">lwa</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:885"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:886"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:887"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lrt:873"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:883"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:884"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:885"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:886"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:887"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:888"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmt:874"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:887"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules.rules_base.html#v:888"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwa:889"><span class="id" title="variable">lwa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2f6035c7b47a6c19bb3ff468a6957d36"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3cfdcd08e0efe459fc578cd7a1d9a4d7"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#3cfdcd08e0efe459fc578cd7a1d9a4d7"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:878"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:873"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:879"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:874"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:880"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:875"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#2f6035c7b47a6c19bb3ff468a6957d36"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3cfdcd08e0efe459fc578cd7a1d9a4d7"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#3cfdcd08e0efe459fc578cd7a1d9a4d7"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:878"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:873"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:879"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:874"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:880"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:875"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#73ce3aa42fb82bbf51e6aa664e8fc2d5"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwa:889"><span class="id" title="variable">lwa</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lwa:889"><span class="id" title="variable">lwa</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:872"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#lmt:874"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:887"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.rules.rules_base.html#v:888"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3cfdcd08e0efe459fc578cd7a1d9a4d7"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#3cfdcd08e0efe459fc578cd7a1d9a4d7"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#a:887"><span class="id" title="variable">a</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#61ef637d8b3736cb725f75270a059721"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#73ce3aa42fb82bbf51e6aa664e8fc2d5"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hin_bounds</span> <span class="id" title="var">Hlrt_r</span> <span class="id" title="var">Hlmt_a</span>) "(Hσr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient_corr"><span class="id" title="axiom">state_interp_transient_corr</span></a> <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hcor".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> &amp; <span class="id" title="var">lm'</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlrt_incl</span> &amp; <span class="id" title="var">Hlmt_incl</span> &amp; <span class="id" title="var">Hinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>, <span class="id" title="var">Hlrt_r</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_mem_get_word"><span class="id" title="axiom">state_corresponds_mem_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_z_of_argument" class="idref" href="#wp2_z_of_argument"><span class="id" title="lemma">wp2_z_of_argument</span></a> {<a id="Ep:890" class="idref" href="#Ep:890"><span class="id" title="binder">Ep</span></a>} {<a id="src:891" class="idref" href="#src:891"><span class="id" title="binder">src</span></a> <a id="28e55500a1080241435e057b633c9a8d" class="idref" href="#28e55500a1080241435e057b633c9a8d"><span class="id" title="binder">Φf</span></a> <a id="0f2e7d5ad0d29d887495da97d107959d" class="idref" href="#0f2e7d5ad0d29d887495da97d107959d"><span class="id" title="binder">Φs</span></a> <a id="b459fca73780d89fe5d4de2a3d75e069" class="idref" href="#b459fca73780d89fe5d4de2a3d75e069"><span class="id" title="binder">φ</span></a> <a id="30c56c367817b490168fc9bde2a2d885" class="idref" href="#30c56c367817b490168fc9bde2a2d885"><span class="id" title="binder">φ</span></a><a id="30c56c367817b490168fc9bde2a2d885" class="idref" href="#30c56c367817b490168fc9bde2a2d885"><span class="id" title="binder">t</span></a> <a id="lr:896" class="idref" href="#lr:896"><span class="id" title="binder">lr</span></a> <a id="lrt:897" class="idref" href="#lrt:897"><span class="id" title="binder">lrt</span></a> <a id="lm:898" class="idref" href="#lm:898"><span class="id" title="binder">lm</span></a> <a id="lmt:899" class="idref" href="#lmt:899"><span class="id" title="binder">lmt</span></a> <a id="df:900" class="idref" href="#df:900"><span class="id" title="binder">df</span></a> <a id="dft:901" class="idref" href="#dft:901"><span class="id" title="binder">dft</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:891"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:897"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b459fca73780d89fe5d4de2a3d75e069"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#30c56c367817b490168fc9bde2a2d885"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#30c56c367817b490168fc9bde2a2d885"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:896"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:897"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:898"><span class="id" title="variable">lm</span></a>  <a class="idref" href="cap_machine.rules.rules_base.html#lmt:899"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:900"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:901"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b459fca73780d89fe5d4de2a3d75e069"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#30c56c367817b490168fc9bde2a2d885"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#30c56c367817b490168fc9bde2a2d885"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:896"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:897"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:898"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:899"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:900"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:901"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#28e55500a1080241435e057b633c9a8d"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">((</span><span class="id" title="notation">∀</span> <a id="z:902" class="idref" href="#z:902"><span class="id" title="binder">z</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b459fca73780d89fe5d4de2a3d75e069"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#30c56c367817b490168fc9bde2a2d885"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#30c56c367817b490168fc9bde2a2d885"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:896"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:897"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:898"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:899"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:900"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:901"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#0f2e7d5ad0d29d887495da97d107959d"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:902"><span class="id" title="variable">z</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:902"><span class="id" title="variable">z</span></a><span class="id" title="notation">))</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:890"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#z_of_argumentL"><span class="id" title="definition">z_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:897"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:891"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.cap_lang.html#z_of_argument"><span class="id" title="definition">z_of_argument</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#30c56c367817b490168fc9bde2a2d885"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#30c56c367817b490168fc9bde2a2d885"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#src:891"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#28e55500a1080241435e057b633c9a8d"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#0f2e7d5ad0d29d887495da97d107959d"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hregs</span>) "(Hφ &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <span class="id" title="var">Ep</span> (<span class="id" title="var">lrt</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:905" class="idref" href="#y:905"><span class="id" title="binder"><span id="y:909" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:905"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.logical_mapsto.html#LInt"><span class="id" title="abbreviation">LInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ<span class="id" title="var">t</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:903" class="idref" href="#y:903"><span class="id" title="binder"><span id="y:907" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.rules.rules_base.html#y:903"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Φf</span> <span class="id" title="var">Φs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφ Hk]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;More&nbsp;expressive&nbsp;version&nbsp;of&nbsp;update_state_interp_from_reg_nomod.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;needed&nbsp;for&nbsp;operations&nbsp;that&nbsp;edit&nbsp;a&nbsp;current&nbsp;(in&nbsp;terms&nbsp;of&nbsp;version)&nbsp;word,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requiring&nbsp;us&nbsp;to&nbsp;re-prove&nbsp;"currentness"&nbsp;of&nbsp;the&nbsp;edited&nbsp;word.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Think&nbsp;e.g.&nbsp;shrinking&nbsp;the&nbsp;bounds&nbsp;of&nbsp;a&nbsp;capability&nbsp;read&nbsp;from&nbsp;a&nbsp;register.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_regs_mod" class="idref" href="#update_state_interp_from_regs_mod"><span class="id" title="lemma">update_state_interp_from_regs_mod</span></a> {<a id="cab1c441c02d8497623a29958d20a7e5" class="idref" href="#cab1c441c02d8497623a29958d20a7e5"><span class="id" title="binder">σ</span></a> <a id="dst:912" class="idref" href="#dst:912"><span class="id" title="binder">dst</span></a> <a id="lw2:913" class="idref" href="#lw2:913"><span class="id" title="binder">lw2</span></a> <a id="Ep:914" class="idref" href="#Ep:914"><span class="id" title="binder">Ep</span></a> <a id="lregs:915" class="idref" href="#lregs:915"><span class="id" title="binder">lregs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:912"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:915"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:916" class="idref" href="#cur_map:916"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:915"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:916"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:913"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:916"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cab1c441c02d8497623a29958d20a7e5"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:917" class="idref" href="#k:917"><span class="id" title="binder"><span id="k:918" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:919" class="idref" href="#y:919"><span class="id" title="binder"><span id="y:920" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:915"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:917"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:919"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:914"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cab1c441c02d8497623a29958d20a7e5"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:912"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:913"><span class="id" title="variable">lw2</span></a>)) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:921" class="idref" href="#k:921"><span class="id" title="binder"><span id="k:922" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:923" class="idref" href="#y:923"><span class="id" title="binder"><span id="y:924" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:912"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:913"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:921"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:923"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdst</span> <span class="id" title="var">Hcur</span>) "(Hσ &amp; Hregs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dst</span> <span class="id" title="var">lw2</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">cur_map</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">Hcur</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="var">Hregs_incl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> <span class="id" title="var">HLinv</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_regs_mod" class="idref" href="#update_state_interp_transient_from_regs_mod"><span class="id" title="lemma">update_state_interp_transient_from_regs_mod</span></a> {<a id="6b0f92e0cc57aa9e2a8158365d6f1d88" class="idref" href="#6b0f92e0cc57aa9e2a8158365d6f1d88"><span class="id" title="binder">σ</span></a> <a id="a192662a16f1aa5609c995ef51861dce" class="idref" href="#a192662a16f1aa5609c995ef51861dce"><span class="id" title="binder">σ</span></a><a id="a192662a16f1aa5609c995ef51861dce" class="idref" href="#a192662a16f1aa5609c995ef51861dce"><span class="id" title="binder">t</span></a> <a id="lr:927" class="idref" href="#lr:927"><span class="id" title="binder">lr</span></a> <a id="lrt:928" class="idref" href="#lrt:928"><span class="id" title="binder">lrt</span></a> <a id="lm:929" class="idref" href="#lm:929"><span class="id" title="binder">lm</span></a> <a id="lmt:930" class="idref" href="#lmt:930"><span class="id" title="binder">lmt</span></a> <a id="df:931" class="idref" href="#df:931"><span class="id" title="binder">df</span></a> <a id="dft:932" class="idref" href="#dft:932"><span class="id" title="binder">dft</span></a> <a id="dst:933" class="idref" href="#dst:933"><span class="id" title="binder">dst</span></a> <a id="lw2:934" class="idref" href="#lw2:934"><span class="id" title="binder">lw2</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:933"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:928"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:935" class="idref" href="#cur_map:935"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:928"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:935"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:934"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:935"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#6b0f92e0cc57aa9e2a8158365d6f1d88"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a192662a16f1aa5609c995ef51861dce"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a192662a16f1aa5609c995ef51861dce"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:927"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:928"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:929"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:930"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:931"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:932"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#6b0f92e0cc57aa9e2a8158365d6f1d88"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a192662a16f1aa5609c995ef51861dce"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a192662a16f1aa5609c995ef51861dce"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:933"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:934"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:927"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:933"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:934"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:929"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:930"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:931"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:932"><span class="id" title="variable">dft</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hcur</span>) "(Hσ &amp; Hregs &amp; Hmem &amp; %Hcor &amp; %Hdom_eq &amp; Hcommit)"; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span> "Hσ Hregs Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iPureIntro</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> &amp; <span class="id" title="var">lm'</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlrt_incl</span> &amp; <span class="id" title="var">Hlmt_incl</span> &amp; <span class="id" title="var">Hinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">dst</span><span class="id" title="notation">:=</span><span class="id" title="var">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr'</span>), <span class="id" title="var">lm'</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">insert_mono</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <span class="id" title="var">lr'</span> <span class="id" title="var">cur_map</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hcur_lr'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">_</span> <span class="id" title="var">Hcur'</span>] <span class="id" title="var">_</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lr'</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hcur</span> <span class="id" title="var">cur_map</span> <span class="id" title="var">Hcur_lr'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hregs</span> ?] ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lreg_corresponds_insert_respects"><span class="id" title="axiom">lreg_corresponds_insert_respects</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iSplit</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Ep</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcommit" <span class="id" title="notation">with</span> "H"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hcur</span> <span class="id" title="notation">with</span> "[$Hσ $Hregs]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;lemma&nbsp;updates&nbsp;the&nbsp;state&nbsp;for&nbsp;operations&nbsp;where&nbsp;a&nbsp;current&nbsp;word&nbsp;is<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;immediately&nbsp;moved&nbsp;(to&nbsp;another&nbsp;register).&nbsp;Since&nbsp;the&nbsp;word&nbsp;was&nbsp;not&nbsp;edited,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;it&nbsp;was&nbsp;read&nbsp;from&nbsp;a&nbsp;register,&nbsp;it&nbsp;is&nbsp;obviously&nbsp;already&nbsp;"current"&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_reg_nomod" class="idref" href="#update_state_interp_from_reg_nomod"><span class="id" title="lemma">update_state_interp_from_reg_nomod</span></a> {<a id="9e891e52fb1a48d5718ca60138dbfea0" class="idref" href="#9e891e52fb1a48d5718ca60138dbfea0"><span class="id" title="binder">σ</span></a> <a id="src:937" class="idref" href="#src:937"><span class="id" title="binder">src</span></a> <a id="dst:938" class="idref" href="#dst:938"><span class="id" title="binder">dst</span></a> <a id="lw:939" class="idref" href="#lw:939"><span class="id" title="binder">lw</span></a> <a id="Ep:940" class="idref" href="#Ep:940"><span class="id" title="binder">Ep</span></a> <a id="regs:941" class="idref" href="#regs:941"><span class="id" title="binder">regs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:938"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:941"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#regs:941"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#src:937"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:939"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9e891e52fb1a48d5718ca60138dbfea0"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:942" class="idref" href="#k:942"><span class="id" title="binder"><span id="k:943" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:944" class="idref" href="#y:944"><span class="id" title="binder"><span id="y:945" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:941"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:942"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:944"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:940"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#9e891e52fb1a48d5718ca60138dbfea0"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:938"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:939"><span class="id" title="variable">lw</span></a>)) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:946" class="idref" href="#k:946"><span class="id" title="binder"><span id="k:947" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:948" class="idref" href="#y:948"><span class="id" title="binder"><span id="y:949" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:938"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw:939"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:946"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:948"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdst</span> <span class="id" title="var">Hsrc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a>; <span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_int" class="idref" href="#update_state_interp_int"><span class="id" title="lemma">update_state_interp_int</span></a> {<a id="3936606363920fe9f6e56366bcc6eb6b" class="idref" href="#3936606363920fe9f6e56366bcc6eb6b"><span class="id" title="binder">σ</span></a> <a id="dst:951" class="idref" href="#dst:951"><span class="id" title="binder">dst</span></a> <a id="z:952" class="idref" href="#z:952"><span class="id" title="binder">z</span></a> <a id="Ep:953" class="idref" href="#Ep:953"><span class="id" title="binder">Ep</span></a> <a id="regs:954" class="idref" href="#regs:954"><span class="id" title="binder">regs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:951"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:954"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3936606363920fe9f6e56366bcc6eb6b"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:955" class="idref" href="#k:955"><span class="id" title="binder"><span id="k:956" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:957" class="idref" href="#y:957"><span class="id" title="binder"><span id="y:958" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#regs:954"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:955"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:957"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:953"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#3936606363920fe9f6e56366bcc6eb6b"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:951"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:952"><span class="id" title="variable">z</span></a>)) <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:959" class="idref" href="#k:959"><span class="id" title="binder"><span id="k:960" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:961" class="idref" href="#y:961"><span class="id" title="binder"><span id="y:962" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:951"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:952"><span class="id" title="variable">z</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:959"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:961"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <span class="id" title="var">z</span>)); <span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_int" class="idref" href="#update_state_interp_transient_int"><span class="id" title="lemma">update_state_interp_transient_int</span></a> {<a id="18c0cbdae76663c3dc5890063b74f541" class="idref" href="#18c0cbdae76663c3dc5890063b74f541"><span class="id" title="binder">σ</span></a> <a id="7e094e669c723787968b35eefd7b2c69" class="idref" href="#7e094e669c723787968b35eefd7b2c69"><span class="id" title="binder">σ</span></a><a id="7e094e669c723787968b35eefd7b2c69" class="idref" href="#7e094e669c723787968b35eefd7b2c69"><span class="id" title="binder">t</span></a> <a id="lr:965" class="idref" href="#lr:965"><span class="id" title="binder">lr</span></a> <a id="lrt:966" class="idref" href="#lrt:966"><span class="id" title="binder">lrt</span></a> <a id="lm:967" class="idref" href="#lm:967"><span class="id" title="binder">lm</span></a> <a id="lmt:968" class="idref" href="#lmt:968"><span class="id" title="binder">lmt</span></a> <a id="df:969" class="idref" href="#df:969"><span class="id" title="binder">df</span></a> <a id="dft:970" class="idref" href="#dft:970"><span class="id" title="binder">dft</span></a> <a id="dst:971" class="idref" href="#dst:971"><span class="id" title="binder">dst</span></a> <a id="z:972" class="idref" href="#z:972"><span class="id" title="binder">z</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:971"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:966"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#18c0cbdae76663c3dc5890063b74f541"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7e094e669c723787968b35eefd7b2c69"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#7e094e669c723787968b35eefd7b2c69"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:965"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:966"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:967"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:968"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:969"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:970"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#18c0cbdae76663c3dc5890063b74f541"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7e094e669c723787968b35eefd7b2c69"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#7e094e669c723787968b35eefd7b2c69"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:971"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:972"><span class="id" title="variable">z</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:965"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:971"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#z:972"><span class="id" title="variable">z</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:967"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:968"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:969"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:970"><span class="id" title="variable">dft</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_transient_from_regs_mod"><span class="id" title="axiom">update_state_interp_transient_from_regs_mod</span></a> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <span class="id" title="var">z</span>) <span class="id" title="var">Hdom</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_cap_mod" class="idref" href="#update_state_interp_from_cap_mod"><span class="id" title="lemma">update_state_interp_from_cap_mod</span></a> {<a id="618075f9089db307f320aec2aa70667e" class="idref" href="#618075f9089db307f320aec2aa70667e"><span class="id" title="binder">σ</span></a> <a id="dst:974" class="idref" href="#dst:974"><span class="id" title="binder">dst</span></a> <a id="lw2:975" class="idref" href="#lw2:975"><span class="id" title="binder">lw2</span></a> <a id="Ep:976" class="idref" href="#Ep:976"><span class="id" title="binder">Ep</span></a> <a id="lregs:977" class="idref" href="#lregs:977"><span class="id" title="binder">lregs</span></a> <a id="lmem:978" class="idref" href="#lmem:978"><span class="id" title="binder">lmem</span></a> <a id="df:979" class="idref" href="#df:979"><span class="id" title="binder">df</span></a> <a id="p:980" class="idref" href="#p:980"><span class="id" title="binder">p</span></a> <a id="b:981" class="idref" href="#b:981"><span class="id" title="binder">b</span></a> <a id="e:982" class="idref" href="#e:982"><span class="id" title="binder">e</span></a> <a id="a:983" class="idref" href="#a:983"><span class="id" title="binder">a</span></a> <a id="v:984" class="idref" href="#v:984"><span class="id" title="binder">v</span></a> <a id="r:985" class="idref" href="#r:985"><span class="id" title="binder">r</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:974"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:977"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#df:979"><span class="id" title="variable">df</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:978"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lregs:977"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:985"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:980"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:981"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:982"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:983"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:984"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:981"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:982"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:983"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmem:978"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:983"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:984"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:975"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#618075f9089db307f320aec2aa70667e"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:986" class="idref" href="#k:986"><span class="id" title="binder"><span id="k:987" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:988" class="idref" href="#y:988"><span class="id" title="binder"><span id="y:989" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:977"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:986"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:988"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:990" class="idref" href="#la:990"><span class="id" title="binder"><span id="la:991" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:992" class="idref" href="#dw:992"><span class="id" title="binder"><span id="dw:993" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:979"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:978"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:990"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:992"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:992"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.rules.rules_base.html#Ep:976"><span class="id" title="variable">Ep</span></a><span class="id" title="notation">}=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#618075f9089db307f320aec2aa70667e"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:974"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:975"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:994" class="idref" href="#k:994"><span class="id" title="binder"><span id="k:995" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:996" class="idref" href="#y:996"><span class="id" title="binder"><span id="y:997" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:974"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:975"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#k:994"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#y:996"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:998" class="idref" href="#la:998"><span class="id" title="binder"><span id="la:999" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:1000" class="idref" href="#dw:1000"><span class="id" title="binder"><span id="dw:1001" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:979"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmem:978"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:998"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.rules.rules_base.html#dw:1000"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.logical_mapsto.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dw:1000"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdst</span> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span>) "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">cur_map</span>) "(Hr &amp; Hm &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.rules.rules_base.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dst</span> <span class="id" title="var">lw2</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">cur_map</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.stdpp_extra.html#snd_prod_merge_subseteq"><span class="id" title="axiom">snd_prod_merge_subseteq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmem_incl</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HLinv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hinv_reg</span> <span class="id" title="var">Hinv_mem</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lmem_corresponds_read_iscur"><span class="id" title="axiom">lmem_corresponds_read_iscur</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_cap_mod" class="idref" href="#update_state_interp_transient_from_cap_mod"><span class="id" title="lemma">update_state_interp_transient_from_cap_mod</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="c1b706fcc5b31ad6b76ab5c3d2988932" class="idref" href="#c1b706fcc5b31ad6b76ab5c3d2988932"><span class="id" title="binder">σ</span></a> <a id="19edd49f8954b5ffcab3ba10b1c87231" class="idref" href="#19edd49f8954b5ffcab3ba10b1c87231"><span class="id" title="binder">σ</span></a><a id="19edd49f8954b5ffcab3ba10b1c87231" class="idref" href="#19edd49f8954b5ffcab3ba10b1c87231"><span class="id" title="binder">t</span></a> <a id="lr:1004" class="idref" href="#lr:1004"><span class="id" title="binder">lr</span></a> <a id="lrt:1005" class="idref" href="#lrt:1005"><span class="id" title="binder">lrt</span></a> <a id="lm:1006" class="idref" href="#lm:1006"><span class="id" title="binder">lm</span></a> <a id="lmt:1007" class="idref" href="#lmt:1007"><span class="id" title="binder">lmt</span></a> <a id="df:1008" class="idref" href="#df:1008"><span class="id" title="binder">df</span></a> <a id="dft:1009" class="idref" href="#dft:1009"><span class="id" title="binder">dft</span></a> <a id="dst:1010" class="idref" href="#dst:1010"><span class="id" title="binder">dst</span></a> <a id="lw2:1011" class="idref" href="#lw2:1011"><span class="id" title="binder">lw2</span></a> <a id="r:1012" class="idref" href="#r:1012"><span class="id" title="binder">r</span></a> <a id="p:1013" class="idref" href="#p:1013"><span class="id" title="binder">p</span></a> <a id="b:1014" class="idref" href="#b:1014"><span class="id" title="binder">b</span></a> <a id="e:1015" class="idref" href="#e:1015"><span class="id" title="binder">e</span></a> <a id="a:1016" class="idref" href="#a:1016"><span class="id" title="binder">a</span></a> <a id="v:1017" class="idref" href="#v:1017"><span class="id" title="binder">v</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#dst:1010"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1005"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lrt:1005"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.rules.rules_base.html#r:1012"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#p:1013"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1014"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1015"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1016"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1017"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#b:1014"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#e:1015"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1016"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lmt:1007"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a:1016"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#v:1017"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1011"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#c1b706fcc5b31ad6b76ab5c3d2988932"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#19edd49f8954b5ffcab3ba10b1c87231"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#19edd49f8954b5ffcab3ba10b1c87231"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1004"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1005"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1006"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1007"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:1008"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:1009"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#c1b706fcc5b31ad6b76ab5c3d2988932"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#19edd49f8954b5ffcab3ba10b1c87231"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#19edd49f8954b5ffcab3ba10b1c87231"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1010"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1011"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:1004"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#dst:1010"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1011"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#lm:1006"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1007"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:1008"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:1009"><span class="id" title="variable">dft</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span>) "(Hσ &amp; Hregs &amp; Hmem &amp; %Hcor &amp; %Hdom_eq &amp; Hcommit)"; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span> "Hσ Hregs Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iPureIntro</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> &amp; <span class="id" title="var">lm'</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlrt_incl</span> &amp; <span class="id" title="var">Hlmt_incl</span> &amp; <span class="id" title="var">Hinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">dst</span><span class="id" title="notation">:=</span><span class="id" title="var">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr'</span>), <span class="id" title="var">lm'</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">insert_mono</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <span class="id" title="var">lr'</span> <span class="id" title="var">cur_map</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hcur_lr'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">_</span> <span class="id" title="var">Hcur'</span>] <span class="id" title="var">_</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lr'</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hinv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hregs</span> ?] ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha</span>, <span class="id" title="var">Hr</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lmem_corresponds_read_iscur"><span class="id" title="axiom">lmem_corresponds_read_iscur</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.logical_mapsto.html#lreg_corresponds_insert_respects"><span class="id" title="axiom">lreg_corresponds_insert_respects</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a>; <span class="id" title="tactic">eauto</span> ; <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iSplit</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">Ep</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hcommit" <span class="id" title="notation">with</span> "H"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hdom_eq</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Hdom_eq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_from_cap_mod"><span class="id" title="axiom">update_state_interp_from_cap_mod</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hdom_eq</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span> <span class="id" title="notation">with</span> "[$Hσ $Hregs $Hmem]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;denis&nbsp;says:&nbsp;will&nbsp;fix&nbsp;later&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Probably&nbsp;missing&nbsp;some&nbsp;assumptions.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_mem_mod" class="idref" href="#update_state_interp_transient_from_mem_mod"><span class="id" title="lemma">update_state_interp_transient_from_mem_mod</span></a> {<a id="8fc7b32ef4ec3ae2afe28fc28d6a5569" class="idref" href="#8fc7b32ef4ec3ae2afe28fc28d6a5569"><span class="id" title="binder">σ</span></a> <a id="4dcad3ba97d4c64269c69eb25aaa69c1" class="idref" href="#4dcad3ba97d4c64269c69eb25aaa69c1"><span class="id" title="binder">σ</span></a><a id="4dcad3ba97d4c64269c69eb25aaa69c1" class="idref" href="#4dcad3ba97d4c64269c69eb25aaa69c1"><span class="id" title="binder">t</span></a> <a id="lr:1020" class="idref" href="#lr:1020"><span class="id" title="binder">lr</span></a> <a id="lrt:1021" class="idref" href="#lrt:1021"><span class="id" title="binder">lrt</span></a> <a id="lm:1022" class="idref" href="#lm:1022"><span class="id" title="binder">lm</span></a> <a id="lmt:1023" class="idref" href="#lmt:1023"><span class="id" title="binder">lmt</span></a> <a id="df:1024" class="idref" href="#df:1024"><span class="id" title="binder">df</span></a> <a id="dft:1025" class="idref" href="#dft:1025"><span class="id" title="binder">dft</span></a> <a id="a:1026" class="idref" href="#a:1026"><span class="id" title="binder">a</span></a> <a id="la:1027" class="idref" href="#la:1027"><span class="id" title="binder">la</span></a> <a id="lw:1028" class="idref" href="#lw:1028"><span class="id" title="binder">lw</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:1029" class="idref" href="#cur_map:1029"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1021"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1029"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1028"><span class="id" title="variable">lw</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1029"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#8fc7b32ef4ec3ae2afe28fc28d6a5569"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4dcad3ba97d4c64269c69eb25aaa69c1"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#4dcad3ba97d4c64269c69eb25aaa69c1"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1020"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1021"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1022"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1023"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:1024"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:1025"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#8fc7b32ef4ec3ae2afe28fc28d6a5569"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_mem"><span class="id" title="definition">update_mem</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#4dcad3ba97d4c64269c69eb25aaa69c1"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#4dcad3ba97d4c64269c69eb25aaa69c1"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a:1026"><span class="id" title="variable">a</span></a> (<a class="idref" href="cap_machine.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1028"><span class="id" title="variable">lw</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#lr:1020"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1021"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1022"><span class="id" title="variable">lm</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.rules.rules_base.html#la:1027"><span class="id" title="variable">la</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.rules.rules_base.html#lw:1028"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmt</span>) <a class="idref" href="cap_machine.rules.rules_base.html#df:1024"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:1025"><span class="id" title="variable">dft</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="word_of_argumentL_cur" class="idref" href="#word_of_argumentL_cur"><span class="id" title="lemma">word_of_argumentL_cur</span></a> {<a id="lregs:1030" class="idref" href="#lregs:1030"><span class="id" title="binder">lregs</span></a> <a id="src:1031" class="idref" href="#src:1031"><span class="id" title="binder">src</span></a> <a id="lw2:1032" class="idref" href="#lw2:1032"><span class="id" title="binder">lw2</span></a> <a id="cur_map:1033" class="idref" href="#cur_map:1033"><span class="id" title="binder">cur_map</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1030"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#src:1031"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1032"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lregs:1030"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1033"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lw2:1032"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#cur_map:1033"><span class="id" title="variable">cur_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hreg</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span> <span class="id" title="var">Hreg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;updatePC_impl&nbsp;{φ}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;updatePC&nbsp;φ&nbsp;=&nbsp;(reg'&nbsp;←&nbsp;incrementPC&nbsp;(reg&nbsp;φ);&nbsp;Some&nbsp;(NextI&nbsp;,&nbsp;update_regs&nbsp;φ&nbsp;reg')).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;updatePC,&nbsp;incrementPC.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(reg&nbsp;φ&nbsp;!!&nbsp;PC);&nbsp;last&nbsp;done.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;w;&nbsp;try&nbsp;done.&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;sb;&nbsp;try&nbsp;done.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;now&nbsp;destruct&nbsp;(f1&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;wp_opt_incrementPC&nbsp;{φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;Φs&nbsp;Φf}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;PC&nbsp;∈&nbsp;dom&nbsp;lrt&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt&nbsp;lr&nbsp;lrt&nbsp;∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(wp_opt&nbsp;(incrementLPC&nbsp;lrt)&nbsp;(∀&nbsp;φt'&nbsp;lrt',&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt'&nbsp;lr&nbsp;lrt'&nbsp;-∗&nbsp;Φf)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fun&nbsp;lrt'&nbsp;=&gt;&nbsp;∀&nbsp;φt',&nbsp;state_interp_regs_transient&nbsp;φ&nbsp;φt'&nbsp;lr&nbsp;lrt'&nbsp;-∗&nbsp;Φs&nbsp;(reg&nbsp;φt')))&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;⊢&nbsp;wp_opt&nbsp;(incrementPC&nbsp;(reg&nbsp;φt))&nbsp;Φf&nbsp;Φs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(Hdom)&nbsp;"(Hφr&nbsp;&amp;&nbsp;Hk)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;wp_opt_bind.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;incrementLPC,&nbsp;incrementPC.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;change&nbsp;(wp_opt&nbsp;match&nbsp;lrt&nbsp;!!&nbsp;PC&nbsp;with&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;(LCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;v)&nbsp;=&gt;&nbsp;match&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;a'&nbsp;=&gt;&nbsp;Some&nbsp;(&lt;<span class="inlinecode"><span class="id" title="var">PC</span>:=<span class="id" title="var">LCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>&gt;&nbsp;lrt)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;?Φf&nbsp;?Φs)&nbsp;with&nbsp;(wp_opt&nbsp;((lrt&nbsp;!!&nbsp;PC)&nbsp;≫=&nbsp;(fun&nbsp;w&nbsp;=&gt;&nbsp;match&nbsp;w&nbsp;with&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(LCap&nbsp;p&nbsp;b&nbsp;e&nbsp;a&nbsp;v)&nbsp;=&gt;&nbsp;match&nbsp;(a&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;a'&nbsp;=&gt;&nbsp;Some&nbsp;(&lt;<span class="inlinecode"><span class="id" title="var">PC</span>:=<span class="id" title="var">LCap</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">a'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>&gt;&nbsp;lrt)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;=&gt;&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end)&nbsp;)&nbsp;Φf&nbsp;Φs).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;&lt;-wp_opt_bind.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;((wp_reg_lookup&nbsp;lrt&nbsp;(r&nbsp;:=&nbsp;PC)&nbsp;(φt&nbsp;:=&nbsp;φt))&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">H</span>φ<span class="id" title="var">r</span></span> <span class="inlinecode"><span class="id" title="var">Hk</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;wp_opt_eqn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;wp_opt_is_Some;&nbsp;last&nbsp;by&nbsp;apply&nbsp;elem_of_dom.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;(wp_opt_mono&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">Hk</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(x)&nbsp;"Hk&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;x&nbsp;eqn:Heqx;&nbsp;try&nbsp;(now&nbsp;iApply&nbsp;"Hk");&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;sb;&nbsp;try&nbsp;(now&nbsp;iApply&nbsp;"Hk");&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;destruct&nbsp;(f1&nbsp;+&nbsp;1)*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;("Hk"&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;(update_state_interp_transient_from_regs_mod&nbsp;Hdom&nbsp;with&nbsp;"Hφr").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;intros&nbsp;cur_map&nbsp;Hcurregs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;eapply&nbsp;is_cur_word_cap_change,&nbsp;(map_Forall_lookup_1&nbsp;_&nbsp;_&nbsp;_&nbsp;_&nbsp;Hcurregs).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_opt_incrementPC" class="idref" href="#wp2_opt_incrementPC"><span class="id" title="lemma">wp2_opt_incrementPC</span></a> {<a id="Ep:1034" class="idref" href="#Ep:1034"><span class="id" title="binder">Ep</span></a>} {<a id="5d2c63bf5fe782a182a7370d7ad287f6" class="idref" href="#5d2c63bf5fe782a182a7370d7ad287f6"><span class="id" title="binder">φ</span></a> <a id="a55a86585d9e9f3599ccb771664e656c" class="idref" href="#a55a86585d9e9f3599ccb771664e656c"><span class="id" title="binder">φ</span></a><a id="a55a86585d9e9f3599ccb771664e656c" class="idref" href="#a55a86585d9e9f3599ccb771664e656c"><span class="id" title="binder">t</span></a> <a id="lr:1037" class="idref" href="#lr:1037"><span class="id" title="binder">lr</span></a> <a id="lrt:1038" class="idref" href="#lrt:1038"><span class="id" title="binder">lrt</span></a> <a id="lm:1039" class="idref" href="#lm:1039"><span class="id" title="binder">lm</span></a> <a id="lmt:1040" class="idref" href="#lmt:1040"><span class="id" title="binder">lmt</span></a> <a id="df:1041" class="idref" href="#df:1041"><span class="id" title="binder">df</span></a> <a id="dft:1042" class="idref" href="#dft:1042"><span class="id" title="binder">dft</span></a> <a id="d5704f1b93c1773711009320e7c0c14f" class="idref" href="#d5704f1b93c1773711009320e7c0c14f"><span class="id" title="binder">Φs</span></a> <a id="62e9e8b1e706c517eeb513ce5c579a41" class="idref" href="#62e9e8b1e706c517eeb513ce5c579a41"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1038"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5d2c63bf5fe782a182a7370d7ad287f6"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a55a86585d9e9f3599ccb771664e656c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a55a86585d9e9f3599ccb771664e656c"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1037"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1038"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1039"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1040"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:1041"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:1042"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="7a9ded4264422f3e3470c630dae9cab4" class="idref" href="#7a9ded4264422f3e3470c630dae9cab4"><span class="id" title="binder">φ</span></a><a id="7a9ded4264422f3e3470c630dae9cab4" class="idref" href="#7a9ded4264422f3e3470c630dae9cab4"><span class="id" title="binder">t'</span></a> <a id="lrt':1046" class="idref" href="#lrt':1046"><span class="id" title="binder">lrt'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5d2c63bf5fe782a182a7370d7ad287f6"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#7a9ded4264422f3e3470c630dae9cab4"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#7a9ded4264422f3e3470c630dae9cab4"><span class="id" title="variable">t'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lr:1037"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':1046"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1039"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1040"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:1041"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:1042"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#62e9e8b1e706c517eeb513ce5c579a41"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lrt':1047" class="idref" href="#lrt':1047"><span class="id" title="binder">lrt'</span></a> <a id="rs':1048" class="idref" href="#rs':1048"><span class="id" title="binder">rs'</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.rules.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#5d2c63bf5fe782a182a7370d7ad287f6"><span class="id" title="variable">φ</span></a> (<a class="idref" href="cap_machine.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a55a86585d9e9f3599ccb771664e656c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a55a86585d9e9f3599ccb771664e656c"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rs':1048"><span class="id" title="variable">rs'</span></a>) <a class="idref" href="cap_machine.rules.rules_base.html#lr:1037"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':1047"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lm:1039"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lmt:1040"><span class="id" title="variable">lmt</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#df:1041"><span class="id" title="variable">df</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#dft:1042"><span class="id" title="variable">dft</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.rules.rules_base.html#d5704f1b93c1773711009320e7c0c14f"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt':1047"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#rs':1048"><span class="id" title="variable">rs'</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#Ep:1034"><span class="id" title="variable">Ep</span></a> (<a class="idref" href="cap_machine.rules.rules_base.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#lrt:1038"><span class="id" title="variable">lrt</span></a>) (<a class="idref" href="cap_machine.rules.rules_base.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a class="idref" href="cap_machine.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#a55a86585d9e9f3599ccb771664e656c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.rules.rules_base.html#a55a86585d9e9f3599ccb771664e656c"><span class="id" title="variable">t</span></a>)) <a class="idref" href="cap_machine.rules.rules_base.html#62e9e8b1e706c517eeb513ce5c579a41"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.rules.rules_base.html#d5704f1b93c1773711009320e7c0c14f"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hφr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.rules.rules_base.html#wp_opt2_eqn"><span class="id" title="axiom">wp_opt2_eqn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφr Hk]"<span class="id" title="notation">)</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφr %Heq1 %Heq2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"Hk" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <span class="id" title="var">_</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(</span><span class="id" title="notation">reg</span> <span class="id" title="notation">φ</span><span class="id" title="notation">t</span><span class="id" title="notation">)</span><span class="id" title="notation">))</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.rules.rules_base.html#update_state_interp_transient_from_regs_mod"><span class="id" title="axiom">update_state_interp_transient_from_regs_mod</span></a> <span class="id" title="var">Hdom</span> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f2</span> <span class="id" title="var">v</span>) <span class="id" title="notation">with</span> "Hφr"<span class="id" title="notation">)</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cur_map</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.logical_mapsto.html#is_cur_lword_lea"><span class="id" title="axiom">is_cur_lword_lea</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">lw</span> := <a class="idref" href="cap_machine.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f1</span> <span class="id" title="var">v</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.rules.rules_base.html#cap_lang_rules_opt"><span class="id" title="section">cap_lang_rules_opt</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
